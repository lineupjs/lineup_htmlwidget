{"version":3,"sources":["webpack://LineUpJS/webpack/universalModuleDefinition","webpack://LineUpJS/webpack/bootstrap","webpack://LineUpJS/./node_modules/tslib/tslib.es6.js","webpack://LineUpJS/./src/model/Column.ts","webpack://LineUpJS/./src/model/annotations.ts","webpack://LineUpJS/./src/model/INumberColumn.ts","webpack://LineUpJS/./src/renderer/utils.ts","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/colors.js","webpack://LineUpJS/./src/model/NumberColumn.ts","webpack://LineUpJS/./src/model/missing.ts","webpack://LineUpJS/./src/styles/index.ts","webpack://LineUpJS/./src/renderer/interfaces.ts","webpack://LineUpJS/./src/renderer/missing.ts","webpack://LineUpJS/./src/model/Ranking.ts","webpack://LineUpJS/./node_modules/d3-array/src/ascending.js","webpack://LineUpJS/./node_modules/d3-array/src/bisector.js","webpack://LineUpJS/./node_modules/d3-array/src/bisect.js","webpack://LineUpJS/./node_modules/d3-array/src/cross.js","webpack://LineUpJS/./node_modules/d3-array/src/number.js","webpack://LineUpJS/./node_modules/d3-array/src/extent.js","webpack://LineUpJS/./node_modules/d3-array/src/array.js","webpack://LineUpJS/./node_modules/d3-array/src/constant.js","webpack://LineUpJS/./node_modules/d3-array/src/identity.js","webpack://LineUpJS/./node_modules/d3-array/src/range.js","webpack://LineUpJS/./node_modules/d3-array/src/ticks.js","webpack://LineUpJS/./node_modules/d3-array/src/threshold/sturges.js","webpack://LineUpJS/./node_modules/d3-array/src/histogram.js","webpack://LineUpJS/./node_modules/d3-array/src/quantile.js","webpack://LineUpJS/./node_modules/d3-array/src/max.js","webpack://LineUpJS/./node_modules/d3-array/src/mean.js","webpack://LineUpJS/./node_modules/d3-array/src/median.js","webpack://LineUpJS/./node_modules/d3-array/src/min.js","webpack://LineUpJS/./node_modules/d3-array/src/index.js","webpack://LineUpJS/./node_modules/d3-dispatch/src/dispatch.js","webpack://LineUpJS/./src/internal/AEventDispatcher.ts","webpack://LineUpJS/./node_modules/popper.js/dist/esm/popper.js","webpack://LineUpJS/./src/ui/dialogs/ADialog.ts","webpack://LineUpJS/./node_modules/d3-time/src/interval.js","webpack://LineUpJS/./node_modules/d3-time/src/millisecond.js","webpack://LineUpJS/./node_modules/d3-time/src/duration.js","webpack://LineUpJS/./node_modules/d3-time/src/second.js","webpack://LineUpJS/./node_modules/d3-time/src/minute.js","webpack://LineUpJS/./node_modules/d3-time/src/hour.js","webpack://LineUpJS/./node_modules/d3-time/src/day.js","webpack://LineUpJS/./node_modules/d3-time/src/week.js","webpack://LineUpJS/./node_modules/d3-time/src/month.js","webpack://LineUpJS/./node_modules/d3-time/src/year.js","webpack://LineUpJS/./node_modules/d3-time/src/utcMinute.js","webpack://LineUpJS/./node_modules/d3-time/src/utcHour.js","webpack://LineUpJS/./node_modules/d3-time/src/utcDay.js","webpack://LineUpJS/./node_modules/d3-time/src/utcWeek.js","webpack://LineUpJS/./node_modules/d3-time/src/utcMonth.js","webpack://LineUpJS/./node_modules/d3-time/src/utcYear.js","webpack://LineUpJS/./node_modules/d3-time/src/index.js","webpack://LineUpJS/./src/internal/math.ts","webpack://LineUpJS/./src/model/MappingFunction.ts","webpack://LineUpJS/./src/provider/ADataProvider.ts","webpack://LineUpJS/./src/model/CategoricalColumn.ts","webpack://LineUpJS/./src/model/StringColumn.ts","webpack://LineUpJS/./src/model/BooleansColumn.ts","webpack://LineUpJS/./src/model/CategoricalMapColumn.ts","webpack://LineUpJS/./src/model/CategoricalsColumn.ts","webpack://LineUpJS/./src/model/DatesMapColumn.ts","webpack://LineUpJS/./src/model/NumberMapColumn.ts","webpack://LineUpJS/./src/model/SetColumn.ts","webpack://LineUpJS/./src/model/StringMapColumn.ts","webpack://LineUpJS/./src/model/StringsColumn.ts","webpack://LineUpJS/./src/model/LinksColumn.ts","webpack://LineUpJS/./src/model/DummyColumn.ts","webpack://LineUpJS/./src/model/index.ts","webpack://LineUpJS/./src/model/ValueColumn.ts","webpack://LineUpJS/./node_modules/d3-time-format/src/locale.js","webpack://LineUpJS/./node_modules/d3-time-format/src/defaultLocale.js","webpack://LineUpJS/./node_modules/d3-time-format/src/isoFormat.js","webpack://LineUpJS/./node_modules/d3-time-format/src/isoParse.js","webpack://LineUpJS/./node_modules/d3-time-format/src/index.js","webpack://LineUpJS/./src/model/ICategoricalColumn.ts","webpack://LineUpJS/./node_modules/d3-color/src/define.js","webpack://LineUpJS/./node_modules/d3-color/src/color.js","webpack://LineUpJS/./node_modules/d3-color/src/math.js","webpack://LineUpJS/./node_modules/d3-color/src/lab.js","webpack://LineUpJS/./node_modules/d3-color/src/cubehelix.js","webpack://LineUpJS/./node_modules/d3-color/src/index.js","webpack://LineUpJS/./src/model/CompositeColumn.ts","webpack://LineUpJS/./src/model/internal.ts","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/ramp.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-single/Blues.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-single/Greens.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-single/Greys.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-single/Oranges.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-single/Purples.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-single/Reds.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/rainbow.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/cubehelix.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/viridis.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/YlOrRd.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/YlOrBr.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/BuGn.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/BuPu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/GnBu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/OrRd.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/PuBuGn.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/PuBu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/PuRd.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/RdPu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/YlGnBu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/sequential-multi/YlGn.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/BrBG.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/PRGn.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/PiYG.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/PuOr.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/RdBu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/RdGy.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/RdYlBu.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/RdYlGn.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/diverging/Spectral.js","webpack://LineUpJS/./src/model/ColorMappingFunction.ts","webpack://LineUpJS/./src/model/NumbersColumn.ts","webpack://LineUpJS/./src/ui/missing.ts","webpack://LineUpJS/./node_modules/lineupengine/build/lineupengine.js","webpack://LineUpJS/./src/ui/dialogs/utils.ts","webpack://LineUpJS/./node_modules/d3-format/src/formatDecimal.js","webpack://LineUpJS/./node_modules/d3-format/src/exponent.js","webpack://LineUpJS/./node_modules/d3-format/src/formatSpecifier.js","webpack://LineUpJS/./node_modules/d3-format/src/formatTrim.js","webpack://LineUpJS/./node_modules/d3-format/src/formatPrefixAuto.js","webpack://LineUpJS/./node_modules/d3-format/src/defaultLocale.js","webpack://LineUpJS/./node_modules/d3-format/src/formatRounded.js","webpack://LineUpJS/./node_modules/d3-format/src/formatTypes.js","webpack://LineUpJS/./node_modules/d3-format/src/identity.js","webpack://LineUpJS/./node_modules/d3-format/src/locale.js","webpack://LineUpJS/./node_modules/d3-format/src/formatGroup.js","webpack://LineUpJS/./node_modules/d3-format/src/formatNumerals.js","webpack://LineUpJS/./node_modules/d3-format/src/precisionFixed.js","webpack://LineUpJS/./node_modules/d3-format/src/precisionPrefix.js","webpack://LineUpJS/./node_modules/d3-format/src/precisionRound.js","webpack://LineUpJS/./node_modules/d3-format/src/index.js","webpack://LineUpJS/./src/model/DateColumn.ts","webpack://LineUpJS/./src/ui/dialogs/ChangeRendererDialog.ts","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/category10.js","webpack://LineUpJS/./src/ui/dialogs/RenameDialog.ts","webpack://LineUpJS/./src/ui/dialogs/BooleanFilterDialog.ts","webpack://LineUpJS/./src/ui/dialogs/CategoricalFilterDialog.ts","webpack://LineUpJS/./src/ui/dialogs/CategoricalMappingFilterDialog.ts","webpack://LineUpJS/./src/ui/dialogs/CompositeChildrenDialog.ts","webpack://LineUpJS/./src/ui/dialogs/CutOffHierarchyDialog.ts","webpack://LineUpJS/./src/ui/dialogs/EditPatternDialog.ts","webpack://LineUpJS/./src/ui/dialogs/NumberFilterDialog.ts","webpack://LineUpJS/./src/ui/dialogs/ReduceDialog.ts","webpack://LineUpJS/./src/ui/dialogs/ScriptEditDialog.ts","webpack://LineUpJS/./src/ui/dialogs/SearchDialog.ts","webpack://LineUpJS/./src/ui/dialogs/StringFilterDialog.ts","webpack://LineUpJS/./src/ui/dialogs/WeightsEditDialog.ts","webpack://LineUpJS/./src/ui/dialogs/GroupDialog.ts","webpack://LineUpJS/./src/ui/dialogs/SortDialog.ts","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Accent.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Dark2.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Pastel1.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Pastel2.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Set1.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Set2.js","webpack://LineUpJS/./node_modules/d3-scale-chromatic/src/categorical/Set3.js","webpack://LineUpJS/./src/ui/dialogs/ColorMappingDialog.ts","webpack://LineUpJS/./src/ui/dialogs/MappingLineDialog.ts","webpack://LineUpJS/./src/ui/dialogs/MappingDialog.ts","webpack://LineUpJS/./src/ui/dialogs/DateFilterDialog.ts","webpack://LineUpJS/./src/ui/toolbar.ts","webpack://LineUpJS/./src/ui/dialogs/groupNumber.ts","webpack://LineUpJS/./src/ui/dialogs/groupString.ts","webpack://LineUpJS/./src/ui/dialogs/groupDate.ts","webpack://LineUpJS/./src/model/LinkColumn.ts","webpack://LineUpJS/./src/model/Group.ts","webpack://LineUpJS/./src/model/BoxPlotColumn.ts","webpack://LineUpJS/./src/model/RankColumn.ts","webpack://LineUpJS/./src/model/ArrayColumn.ts","webpack://LineUpJS/./src/internal/utils.ts","webpack://LineUpJS/./src/model/StackColumn.ts","webpack://LineUpJS/./src/internal/dnd.ts","webpack://LineUpJS/./src/ui/dialogs/MoreColumnOptionsDialog.ts","webpack://LineUpJS/./src/ui/header.ts","webpack://LineUpJS/./src/model/HierarchyColumn.ts","webpack://LineUpJS/./src/model/MapColumn.ts","webpack://LineUpJS/./src/model/DatesColumn.ts","webpack://LineUpJS/./src/ui/panel/SearchBox.ts","webpack://LineUpJS/./src/model/CompositeNumberColumn.ts","webpack://LineUpJS/./src/model/AggregateGroupColumn.ts","webpack://LineUpJS/./src/interfaces.ts","webpack://LineUpJS/./src/config.ts","webpack://LineUpJS/./src/model/IDateColumn.ts","webpack://LineUpJS/./src/ui/animation.ts","webpack://LineUpJS/./src/ui/RenderColumn.ts","webpack://LineUpJS/./src/ui/MultiLevelRenderColumn.ts","webpack://LineUpJS/./src/ui/SelectionManager.ts","webpack://LineUpJS/./src/ui/EngineRanking.ts","webpack://LineUpJS/./src/internal/debounce.ts","webpack://LineUpJS/./src/renderer/ActionRenderer.ts","webpack://LineUpJS/./src/renderer/AggregateGroupRenderer.ts","webpack://LineUpJS/./src/renderer/StringCellRenderer.ts","webpack://LineUpJS/./src/renderer/AnnotationRenderer.ts","webpack://LineUpJS/./src/renderer/impose.ts","webpack://LineUpJS/./src/renderer/BarCellRenderer.ts","webpack://LineUpJS/./src/renderer/DefaultCellRenderer.ts","webpack://LineUpJS/./src/renderer/BooleanCellRenderer.ts","webpack://LineUpJS/./src/renderer/BoxplotCellRenderer.ts","webpack://LineUpJS/./src/renderer/BrightnessCellRenderer.ts","webpack://LineUpJS/./src/renderer/CategoricalCellRenderer.ts","webpack://LineUpJS/./src/renderer/UpSetCellRenderer.ts","webpack://LineUpJS/./src/renderer/CategoricalHeatmapCellRenderer.ts","webpack://LineUpJS/./src/renderer/CategoricalStackedDistributionlCellRenderer.ts","webpack://LineUpJS/./src/renderer/CircleCellRenderer.ts","webpack://LineUpJS/./src/renderer/DotCellRenderer.ts","webpack://LineUpJS/./src/renderer/GroupCellRenderer.ts","webpack://LineUpJS/./src/renderer/ANumbersCellRenderer.ts","webpack://LineUpJS/./src/renderer/HeatmapCellRenderer.ts","webpack://LineUpJS/./src/ui/dialogs/InputNumberDialog.ts","webpack://LineUpJS/./src/renderer/HistogramCellRenderer.ts","webpack://LineUpJS/./src/renderer/ImageCellRenderer.ts","webpack://LineUpJS/./src/renderer/InterleavingCellRenderer.ts","webpack://LineUpJS/./src/renderer/LinkCellRenderer.ts","webpack://LineUpJS/./src/renderer/TableCellRenderer.ts","webpack://LineUpJS/./src/renderer/LinkMapCellRenderer.ts","webpack://LineUpJS/./src/renderer/LoadingCellRenderer.ts","webpack://LineUpJS/./src/renderer/MapBarCellRenderer.ts","webpack://LineUpJS/./src/renderer/RankCellRenderer.ts","webpack://LineUpJS/./src/renderer/SparklineCellRenderer.ts","webpack://LineUpJS/./src/renderer/VerticalBarCellRenderer.ts","webpack://LineUpJS/./src/renderer/DateCellRenderer.ts","webpack://LineUpJS/./src/renderer/index.ts","webpack://LineUpJS/./node_modules/d3-interpolate/src/basis.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/constant.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/color.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/rgb.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/array.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/basisClosed.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/date.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/number.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/object.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/string.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/transform/parse.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/value.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/round.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/transform/decompose.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/transform/index.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/zoom.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/hsl.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/hcl.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/cubehelix.js","webpack://LineUpJS/./node_modules/d3-interpolate/src/index.js","webpack://LineUpJS/./src/model/SelectionColumn.ts","webpack://LineUpJS/./src/model/IArrayColumn.ts","webpack://LineUpJS/./src/model/interfaces.ts","webpack://LineUpJS/./src/model/ActionColumn.ts","webpack://LineUpJS/./src/model/GroupColumn.ts","webpack://LineUpJS/./src/model/OrdinalColumn.ts","webpack://LineUpJS/./src/renderer/AAggregatedGroupRenderer.ts","webpack://LineUpJS/./src/renderer/MultiLevelCellRenderer.ts","webpack://LineUpJS/./node_modules/d3-scale/src/init.js","webpack://LineUpJS/./node_modules/d3-collection/src/map.js","webpack://LineUpJS/./node_modules/d3-collection/src/set.js","webpack://LineUpJS/./node_modules/d3-scale/src/array.js","webpack://LineUpJS/./node_modules/d3-scale/src/constant.js","webpack://LineUpJS/./node_modules/d3-scale/src/number.js","webpack://LineUpJS/./node_modules/d3-scale/src/continuous.js","webpack://LineUpJS/./node_modules/d3-scale/src/tickFormat.js","webpack://LineUpJS/./node_modules/d3-scale/src/linear.js","webpack://LineUpJS/./node_modules/d3-scale/src/nice.js","webpack://LineUpJS/./node_modules/d3-scale/src/log.js","webpack://LineUpJS/./node_modules/d3-scale/src/pow.js","webpack://LineUpJS/./node_modules/d3-scale/src/index.js","webpack://LineUpJS/./src/model/BooleanColumn.ts","webpack://LineUpJS/./src/model/ImpositionBoxPlotColumn.ts","webpack://LineUpJS/./src/model/ImpositionCompositeColumn.ts","webpack://LineUpJS/./src/model/ImpositionCompositesColumn.ts","webpack://LineUpJS/./src/model/LinkMapColumn.ts","webpack://LineUpJS/./src/provider/utils.ts","webpack://LineUpJS/./src/provider/LocalDataProvider.ts","webpack://LineUpJS/./src/ui/LineUp.ts","webpack://LineUpJS/./src/ui/dialogs/DialogManager.ts","webpack://LineUpJS/./src/ui/EngineRenderer.ts","webpack://LineUpJS/./src/model/ReduceColumn.ts","webpack://LineUpJS/./src/model/ScriptColumn.ts","webpack://LineUpJS/./src/ui/dialogs/AddonDialog.ts","webpack://LineUpJS/./src/ui/panel/Hierarchy.ts","webpack://LineUpJS/./src/ui/panel/SidePanelEntryVis.ts","webpack://LineUpJS/./src/ui/dialogs/RenameRankingDialog.ts","webpack://LineUpJS/./src/ui/dialogs/MoreRankingOptionsDialog.ts","webpack://LineUpJS/./src/ui/panel/SidePanelRanking.ts","webpack://LineUpJS/./src/ui/dialogs/ChooseRankingDialog.ts","webpack://LineUpJS/./src/ui/panel/SidePanel.ts","webpack://LineUpJS/./src/ui/SlopeGraph.ts","webpack://LineUpJS/./src/internal/drag.ts","webpack://LineUpJS/./src/model/NestedColumn.ts","webpack://LineUpJS/./src/model/AnnotateColumn.ts","webpack://LineUpJS/./src/internal/merge.ts","webpack://LineUpJS/./src/browser.ts","webpack://LineUpJS/./src/ui/ALineUp.ts","webpack://LineUpJS/./src/ui/index.ts","webpack://LineUpJS/./src/provider/RemoteDataProvider.ts","webpack://LineUpJS/./src/provider/index.ts","webpack://LineUpJS/./src/model/MultiLevelCompositeColumn.ts","webpack://LineUpJS/./src/internal/OrderedSet.ts","webpack://LineUpJS/./src/provider/ACommonDataProvider.ts","webpack://LineUpJS/./src/renderer/SelectionRenderer.ts","webpack://LineUpJS/./src/ui/taggle/Taggle.ts","webpack://LineUpJS/./node_modules/fast-deep-equal/index.js","webpack://LineUpJS/./src/ui/taggle/TaggleRenderer.ts","webpack://LineUpJS/./src/ui/taggle/spaceFillingRule.ts","webpack://LineUpJS/./src/ui/dialogs/index.ts","webpack://LineUpJS/./src/ui/panel/index.ts","webpack://LineUpJS/./src/builder/column/ColumnBuilder.ts","webpack://LineUpJS/./src/builder/LineUpBuilder.ts","webpack://LineUpJS/./src/builder/RankingBuilder.ts","webpack://LineUpJS/./src/builder/DataBuilder.ts","webpack://LineUpJS/./src/builder/column/CategoricalColumnBuilder.ts","webpack://LineUpJS/./src/builder/column/NumberColumnBuilder.ts","webpack://LineUpJS/./src/builder/column/StringColumnBuilder.ts","webpack://LineUpJS/./src/builder/column/DateColumnBuilder.ts","webpack://LineUpJS/./src/builder/column/HierarchyColumnBuilder.ts","webpack://LineUpJS/./src/builder/column/ActionsColumnBuilder.ts","webpack://LineUpJS/./src/builder/adapter/column.ts","webpack://LineUpJS/./src/builder/adapter/ranking.ts","webpack://LineUpJS/./src/builder/adapter/utils.ts","webpack://LineUpJS/./src/builder/adapter/lineup.ts","webpack://LineUpJS/./src/builder/adapter/index.ts","webpack://LineUpJS/./src/builder/index.ts","webpack://LineUpJS/./node_modules/detect-browser/index.js","webpack://LineUpJS/./src/index.ts","webpack://LineUpJS/./node_modules/reflect-metadata/Reflect.js","webpack://LineUpJS/./src/styles/_vars.scss"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__assign","assign","arguments","length","apply","__decorate","decorators","target","desc","getOwnPropertyDescriptor","Reflect","decorate","__spreadArrays","il","k","a","j","jl","id","width","parent","uid","renderer","type","groupRenderer","summaryRenderer","visible","metadata","label","description","Boolean","fixed","frozen","assignNewId","idGenerator","fqid","fqpath","indexOf","createEventList","concat","Column","EVENT_WIDTH_CHANGED","EVENT_LABEL_CHANGED","EVENT_METADATA_CHANGED","EVENT_VISIBILITY_CHANGED","EVENT_SUMMARY_RENDERER_TYPE_CHANGED","EVENT_RENDERER_TYPE_CHANGED","EVENT_GROUP_RENDERER_TYPE_CHANGED","EVENT_DIRTY","EVENT_DIRTY_HEADER","EVENT_DIRTY_VALUES","on","listener","getWidth","hide","setVisible","show","isVisible","getVisible","fire","flatten","offset","_levelsToGo","_padding","w","push","col","setWidth","setWidthImpl","setMetaData","bak","getMetaData","sortByMe","ascending","priority","findMyRanker","sortBy","groupByMe","toggleGrouping","isGroupedBy","getGroupCriteria","toggleMySorting","toggleSorting","isSortedByMeImpl","selector","ranker","asc","undefined","criterias","index","findIndex","isSortedByMe","getSortCriteria","groupSortByMe","groupSortBy","toggleMyGroupSorting","toggleGroupSorting","isGroupSortedByMe","getGroupSortCriteria","removeMe","remove","attach","detach","insertAfterMe","insertAfter","dump","toDescRef","getRenderer","getGroupRenderer","getSummaryRenderer","restore","_factory","rendererType","getLabel","row","String","getValue","_row","getExportValue","format","getColor","DEFAULT_COLOR","isMissing","compare","_a","_b","group","groupCompare","toLowerCase","localeCompare","isFiltered","filter","setRenderer","setDefaultRenderer","setGroupRenderer","setDefaultGroupRenderer","setSummaryRenderer","setDefaultSummaryRenderer","setDefaultWidth","markDirty","FLAT_ALL_COLUMNS","supportType","for","category","SupportType","SortByDefault","order","isSortingAscByDefault","clazz","hasMetadata","string","featureLevel","categorical","number","date","array","map","composite","support","other","categories","Categories","Category","cat","toolbar","keys","dialogAddons","cache","Map","isSupportType","categoryOf","getMetadata","getPrototypeOf","categoryOfDesc","models","getAllToolbarActions","has","actions","obj","toolbarIcon","getOwnMetadata","set","getAllToolbarDialogAddons","cacheKey","symbol","ESortMethod","EAdvancedSortMethod","DEFAULT_FORMATTER","isNumberColumn","getNumber","match","compareBoxPlot","aVal","getBoxPlotData","bVal","method","getSortMethod","numberCompare","getBoxPlotNumber","data","getRawBoxPlotData","NaN","isBoxPlotColumn","isNumbersColumn","getNumbers","aMissing","bMissing","isNaN","noNumberFilter","min","Infinity","max","filterMissing","isEqualNumberFilter","isNumberIncluded","isFinite","isDummyNumberFilter","restoreNumberFilter","v","attr","node","attrs","styles","text","forEach","getAttribute","setAttribute","style","getPropertyValue","setProperty","setText","noop","noRenderer","template","update","render","textContent","callback","from","querySelectorAll","forEachChild","children","matchColumns","columns","childElementCount","every","dataset","columnId","column","rendererId","idsAndRenderer","Set","idAndRenderer","removeChild","cnode","querySelector","insertAdjacentHTML","lastElementChild","appendChild","innerHTML","join","wideEnough","labels","adaptTextColorToBgColor","bgColor","adaptDynamicColorToBgColor","title","adapt","color","innerText","console","assert","ownerDocument","span","createElement","classList","add","idCounter","uniqueId","prefix","toString","NUM_EXAMPLE_VALUES","exampleText","rows","examples","specifier","colors","slice","currentFilter","numberFormat","currentGroupThresholds","groupSortMethod","median","mapping","original","clone","colorMapping","missingValue","NumberColumn","stratifyThreshholds","domain","range","stratifyThresholds","EVENT_MAPPING_CHANGED","EVENT_COLOR_MAPPING_CHANGED","EVENT_FILTER_CHANGED","EVENT_SORTMETHOD_CHANGED","EVENT_GROUPING_CHANGED","raw","getRawValue","getRange","getRawNumber","getOriginalMapping","getMapping","setMapping","eq","getColorMapping","setColorMapping","getFilter","setFilter","getGroupThresholds","setGroupThresholds","threshold","treshholdIndex","setSortMethod","sortMethod","isMissingValue","isArray","isUnknown","FIRST_IS_NAN","FIRST_IS_MISSING","missingGroup","getStyle","defaultValue","COLUMN_PADDING","parseInt","DASH","height","UPSET","circle","inactive","parseFloat","stroke","DOT","size","opacity","BOX_PLOT","box","sort","outlier","AGGREGATE","strokeWidth","SLOPEGRAPH_WIDTH","CANVAS_HEIGHT","ERenderMode","renderMissingValue","ctx","x","y","dashX","Math","dashY","fillStyle","fillRect","renderMissingDOM","missing","toggle","renderMissingCanvas","maxSortCriteria","maxGroupColumns","sortCriteria","groupSortCriteria","groupColumns","comparator","groupComparator","grouper","g","groups","gi","dirtyOrder","Ranking","EVENT_DIRTY_ORDER","startsWith","EVENT_GROUPS_CHANGED","EVENT_ADD_COLUMN","EVENT_REMOVE_COLUMN","EVENT_GROUP_CRITERIA_CHANGED","EVENT_MOVE_COLUMN","EVENT_GROUP_SORT_CRITERIA_CHANGED","EVENT_COLUMN_VISIBILITY_CHANGED","EVENT_SORT_CRITERIA_CHANGED","EVENT_ORDER_CHANGED","setLabel","setOrder","setGroups","old","getOrder","oldGroups","getGroups","clear","child","sortColumn","help","find","groupBy","restoreSortCriteria","dumped","setSortCriteria","setGroupSortCriteria","levelsToGo","padding","acc","getPrimarySortCriteria","toggleSortingLogic","newSort","current","defaultAsc","splice","newGroupings","setGroupCriteria","hierarchyLogic","entries","entry","values","equalCriteria","triggerResort","cols","groupColumn","setMaxSortCriteria","getMaxSortCriteria","setMaxGroupColumns","getMaxGroupColumns","triggerGroupResort","sortCriterias","bakMulti","insert","forward","oldValue","newValue","move","error","moveAfter","reference","findByPath","indices","split","Number","shift","at","ref","unforward","isSortCriteria","sortCriteriaChanged","isGroupSortCriteria","groupSortCriteriaChanged","newGrouping","isGroupColumn","removed","idOrFilter","flatColumns","some","ai","bi","f","left","lo","hi","mid","right","ascendingBisect","bisector","bisectRight","bisect","valueof","start","stop","step","ceil","e10","sqrt","e5","e2","reverse","ticks","count","tickIncrement","floor","power","log","LN10","pow","tickStep","step0","abs","step1","LN2","identity","extent","sturges","histogram","xz","x0","x1","tz","pop","bin","bins","_","constant","thresholds","i0","value0","sum","numbers","quantile","dispatch","Error","Dispatch","parseTypenames","typenames","types","trim","typename","T","copy","that","args","suffix","events","listenerEvents","listeners","forwarder","fireImpl","primaryType","origin","listenersChanged","_type","_active","context","source","isBrowser","document","longerTimeoutBrowsers","timeoutDuration","navigator","userAgent","debounce","Promise","fn","called","resolve","then","scheduled","setTimeout","isFunction","functionToCheck","getStyleComputedProperty","element","nodeType","css","defaultView","getComputedStyle","getParentNode","nodeName","parentNode","host","getScrollParent","body","_getStyleComputedProp","overflow","overflowX","overflowY","test","isIE11","MSInputMethodContext","documentMode","isIE10","isIE","version","getOffsetParent","documentElement","noOffsetParent","offsetParent","nextElementSibling","getRoot","findCommonOffsetParent","element1","element2","compareDocumentPosition","Node","DOCUMENT_POSITION_FOLLOWING","end","createRange","setStart","setEnd","commonAncestorContainer","contains","firstElementChild","element1root","getScroll","upperSide","html","scrollingElement","getBordersSize","axis","sideA","sideB","getSize","computedStyle","getWindowSizes","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","props","descriptor","configurable","writable","protoProps","staticProps","_extends","getClientRect","offsets","bottom","top","getBoundingClientRect","rect","scrollTop","scrollLeft","e","result","sizes","clientWidth","clientHeight","horizScrollbar","offsetWidth","vertScrollbar","offsetHeight","getOffsetRectRelativeToArbitraryNode","fixedPosition","isHTML","childrenRect","parentRect","scrollParent","borderTopWidth","borderLeftWidth","marginTop","marginLeft","subtract","modifier","includeScroll","getFixedPositionOffsetParent","parentElement","el","getBoundaries","popper","boundariesElement","boundaries","excludeScroll","relativeOffset","innerWidth","innerHeight","getViewportOffsetRectRelativeToArtbitraryNode","boundariesNode","isFixed","_getWindowSizes","isPaddingNumber","computeAutoPlacement","placement","refRect","rects","sortedAreas","area","_ref","filteredAreas","_ref2","computedPlacement","variation","getReferenceOffsets","state","getOuterSizes","marginBottom","marginRight","getOppositePlacement","hash","replace","matched","getPopperOffsets","referenceOffsets","popperRect","popperOffsets","isHoriz","mainSide","secondarySide","measurement","secondaryMeasurement","arr","check","runModifiers","modifiers","ends","prop","cur","warn","enabled","isDestroyed","arrowStyles","attributes","flipped","options","positionFixed","flip","originalPlacement","position","isCreated","onUpdate","onCreate","isModifierEnabled","modifierName","getSupportedPropertyName","prefixes","upperProp","charAt","toUpperCase","toCheck","destroy","removeAttribute","willChange","disableEventListeners","removeOnDestroy","getWindow","setupEventListeners","updateBound","addEventListener","passive","scrollElement","attachToScrollParents","event","scrollParents","isBody","eventsEnabled","enableEventListeners","scheduleUpdate","cancelAnimationFrame","removeEventListener","isNumeric","setStyles","unit","isFirefox","isModifierRequired","requestingName","requestedName","requesting","isRequired","_requesting","requested","placements","validPlacements","clockwise","counter","BEHAVIORS","FLIP","CLOCKWISE","COUNTERCLOCKWISE","parseOffset","basePlacement","useHeight","fragments","frag","divider","search","splitRegex","ops","op","mergeWithPrevious","reduce","str","toValue","index2","Defaults","shiftvariation","_data$offsets","isVertical","side","shiftOffsets","preventOverflow","transformProp","popperStyles","transform","primary","escapeWithReference","secondary","keepTogether","opSide","arrow","_data$offsets$arrow","arrowElement","len","sideCapitalized","altSide","arrowElementSize","center","popperMarginSide","popperBorderSide","sideValue","round","placementOpposite","flipOrder","behavior","refOffsets","overlapsRef","overflowsLeft","overflowsRight","overflowsTop","overflowsBottom","overflowsBoundaries","flippedVariationByRef","flipVariations","flippedVariationByContent","flipVariationsByContent","flippedVariation","getOppositeVariation","inner","subtractLength","bound","computeStyle","legacyGpuAccelerationOption","gpuAcceleration","offsetParentRect","shouldRound","noRound","referenceWidth","popperWidth","isVariation","horizontalToInteger","verticalToInteger","getRoundedOffsets","devicePixelRatio","prefixedProperty","invertTop","invertLeft","applyStyle","onLoad","modifierOptions","Popper","_this","requestAnimationFrame","jquery","Utils","global","PopperUtils","dialog","fullDialog","resetPossible","toggleDialog","attachment","level","equals","open","manager","removeLike","build","closest","merge","auto","self","focus","reset","onclick","evt","stopPropagation","preventDefault","onsubmit","checkValidity","submit","cancel","findInput","t0","Date","t1","newInterval","floori","offseti","field","interval","d0","d1","previous","setTime","millisecond","durationMinute","durationWeek","second","getMilliseconds","getUTCSeconds","minute","getSeconds","getMinutes","hour","getHours","day","setHours","setDate","getDate","getTimezoneOffset","weekday","getDay","sunday","monday","tuesday","wednesday","thursday","friday","saturday","month","setMonth","getMonth","getFullYear","year","setFullYear","utcMinute","setUTCSeconds","getUTCMinutes","utcHour","setUTCMinutes","getUTCHours","utcDay","setUTCHours","setUTCDate","getUTCDate","utcWeekday","getUTCDay","utcSunday","utcMonday","utcTuesday","utcWednesday","utcThursday","utcFriday","utcSaturday","utcMonth","setUTCMonth","getUTCMonth","getUTCFullYear","utcYear","setUTCFullYear","getNumberOfBins","scale","histGen","sorted","hist","q1","q3","whiskerLow","sortedMapped","whiskerHigh","_target","propertyKey","computeStats","mean","maxBin","LazyBoxPlotData","computeHist","missingCount","precision","similar","delta","toScale","clamp","exponent","isMapAbleColumn","isSame","fixDomain","invert","ScaleMappingFunction","_code","Function","code","value_min","value_max","value_range","value_domain","linear","mi","ma","ScriptMappingFunction","createMappingFunction","restoreMapping","rankings","selection","aggregations","createHelper","fromDescRef","fixDesc","columnTypes","multiSelections","multiSelection","ADataProvider","EVENT_ADD_RANKING","EVENT_REMOVE_RANKING","EVENT_SELECTION_CHANGED","EVENT_ADD_DESC","EVENT_CLEAR_DESC","EVENT_JUMP_TO_NEAREST","EVENT_GROUP_AGGREGATION_CHANGED","pushRanking","existing","cloneRanking","insertRanking","takeSnapshot","ranking","hasString","hasColumn","toClone","triggerReorder","removeRanking","cleanUpRanking","clearRankings","getRankings","getFirstRanking","getLastRanking","ensureOneRanking","_ranking","nextId","accessor","rankAccessor","isSelected","setter","select","deselect","setterAll","selectAll","deselectAll","isAggregated","setAggregated","dumpColumn","restoreColumn","getSelection","descRef","restoreRanking","layout","deriveRanking","bundle","toCol","findDesc","unaggregateParents","delete","aggregateAllOf","aggregateAll","jumpToNearest","selectAllOf","setSelection","clearSelection","toggleSelection","additional","selectedRows","view","exportTable","EVENT_AGGREGATE","lookup","missingCategory","CategoricalColumn","getCategory","vs","getValues","getLabels","getMap","cats","getMapLabel","getSet","EAlignment","currentGroupCriteria","alignment","escape","StringColumn","RegExp","groupCriteria","FILTER_MISSING","aValue","bValue","criteria","ArrayColumn","parseValue","getCategories","MapColumn","dateFormat","parse","dateParse","DatesMapColumn","getDates","DatesColumn","DateColumn","NumberMapColumn","separator","SetColumn","normalize","sv","av","bv","ValueColumn","StringMapColumn","StringsColumn","patternFunction","pattern","patternTemplates","LinksColumn","setPattern","LinkColumn","getPattern","EVENT_PATTERN_CHANGED","getLinks","href","alt","transformValue","defineColumn","functions","init","CustomColumn","ActionColumn","aggregate","AggregateGroupColumn","annotate","AnnotateColumn","boolean","BooleanColumn","booleans","boxplot","BoxPlotColumn","categoricalMap","categoricals","dateMap","dates","GroupColumn","hierarchy","HierarchyColumn","imposition","ImpositionCompositeColumn","impositionBoxPlot","ImpositionBoxPlotColumn","impositions","ImpositionCompositesColumn","ReduceColumn","nested","NestedColumn","NumbersColumn","numberMap","ordinal","OrdinalColumn","rank","RankColumn","script","ScriptColumn","SelectionColumn","stack","StackColumn","stringMap","strings","link","linkMap","LinkMapColumn","links","loaded","lazyLoaded","EVENT_DATA_LOADED","isLoaded","getRaw","setLoaded","RENDERER_LOADING","localDate","H","M","S","L","utcDate","UTC","newYear","timeFormat","timeParse","utcFormat","utcParse","pads","numberRe","percentRe","requoteRe","pad","fill","sign","requote","formatRe","names","formatLookup","parseWeekdayNumberSunday","exec","parseWeekdayNumberMonday","u","parseWeekNumberSunday","U","parseWeekNumberISO","V","parseWeekNumberMonday","W","parseFullYear","parseYear","parseZone","Z","parseMonthNumber","parseDayOfMonth","parseDayOfYear","parseHour24","parseMinutes","parseSeconds","parseMilliseconds","parseMicroseconds","parseLiteralPercent","parseUnixTimestamp","Q","parseUnixTimestampSeconds","formatDayOfMonth","formatHour24","formatHour12","formatDayOfYear","formatMilliseconds","formatMicroseconds","formatMonthNumber","formatMinutes","formatSeconds","formatWeekdayNumberMonday","formatWeekNumberSunday","formatWeekNumberISO","formatWeekdayNumberSunday","formatWeekNumberMonday","formatYear","formatFullYear","formatZone","z","formatUTCDayOfMonth","formatUTCHour24","formatUTCHour12","formatUTCDayOfYear","formatUTCMilliseconds","getUTCMilliseconds","formatUTCMicroseconds","formatUTCMonthNumber","formatUTCMinutes","formatUTCSeconds","formatUTCWeekdayNumberMonday","dow","formatUTCWeekNumberSunday","formatUTCWeekNumberISO","formatUTCWeekdayNumberSunday","formatUTCWeekNumberMonday","formatUTCYear","formatUTCFullYear","formatUTCZone","formatLiteralPercent","formatUnixTimestamp","formatUnixTimestampSeconds","locale","locale_dateTime","dateTime","locale_date","locale_time","time","locale_periods","periods","locale_weekdays","days","locale_shortWeekdays","shortDays","locale_months","months","locale_shortMonths","shortMonths","periodRe","periodLookup","weekdayRe","weekdayLookup","shortWeekdayRe","shortWeekdayLookup","monthRe","monthLookup","shortMonthRe","shortMonthLookup","formats","utcFormats","parses","parseSpecifier","newFormat","charCodeAt","newParse","newDate","week","X","formatLocale","toISOString","isSetColumn","toCategory","nextColor","compareCategory","aNull","bNull","findMostFrequent","topCat","topCount","groupCompareCategory","aMostFrequent","bMostFrequent","toCategories","isCategoricalColumn","isEmptyFilter","isEqualCategoricalFilter","al","bl","arrayEquals","isCategoryIncluded","filterObj","includes","extend","definition","Color","reI","reN","reP","reHex3","reHex6","reRgbInteger","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","color_formatHex","rgb","formatHex","color_formatRgb","formatRgb","Rgb","rgbn","rgba","hsla","rgbConvert","rgb_formatHex","hex","rgb_formatRgb","h","Hsl","hslConvert","hsl","hsl2rgb","m1","m2","channels","displayable","formatHsl","brighter","darker","deg2rad","PI","rad2deg","Xn","Yn","Zn","t2","t3","labConvert","Lab","Hcl","hcl2lab","rgb2lrgb","xyz2lab","lab","lab2xyz","lrgb2rgb","hclConvert","atan2","hcl","cos","sin","A","B","C","D","E","ED","EB","BC_DA","cubehelix","Cubehelix","cubehelixConvert","cosh","sinh","isMultiLevelColumn","_children","CompositeColumn","canJustAddNumbers","insertImpl","moveImpl","oldIndex","removeImpl","joinGroups","parents","subGroups","toGroupID","unifyParents","colorPool","act","medianIndex","va","vb","scheme","ramp","warm","cool","magma","inferno","plasma","SolidColorFunction","base","steps","perStep","quantize","QuantizedColorFunction","CustomColorMappingFunction","asColorFunction","DEFAULT_COLOR_FUNCTION","sequentialColors","divergentColors","lookupInterpolatingColor","sequential","interpolateBlues","interpolateGreens","interpolateGreys","interpolateOranges","interpolatePurples","interpolateReds","interpolateCool","interpolateCubehelixDefault","interpolateWarm","interpolatePlasma","interpolateMagma","interpolateViridis","interpolateInferno","interpolateYlOrRd","interpolateYlOrBr","interpolateBuGn","interpolateBuPu","interpolateGnBu","interpolateOrRd","interpolatePuBuGn","interpolatePuBu","interpolatePuRd","interpolateRdPu","interpolateYlGnBu","interpolateYlGn","interpolateRainbow","ts","divergent","interpolateBrBG","interpolatePRGn","interpolatePiYG","interpolatePuOr","interpolateRdBu","interpolateRdGy","interpolateRdYlBu","interpolateRdYlGn","interpolateSpectral","InterpolatingColorFunction","createColorMappingFunction","restoreColorMapping","dataLength","getRawNumbers","CENTER","filterMissingText","filterMissingMarkup","bakMissing","idPrefix","filterMissingNumberMarkup","findFilterMissing","previousElementSibling","updateFilterMissingNumberMarkup","checked","disabled","default","race","abort","catch","lastFilled","key2index","exceptions","findValidStart","posByKey","pos","fillCacheTillKey","defaultRowHeight","fillCache","heightOf","exceptionsLookup","exceptionHeightOf","numberOfRows","positions","UPDATE","UPDATE_CREATE","UPDATE_REMOVE","SHOW","HIDE","nodeY","delay","animation","totalHeight","now","first","last","firstRowPos","endPos","y2","R","O","added","common","NONE","ALL","SOME","SOME_BOTTOM","SOME_TOP","handlers","animationWaiting","immediateTimeout","timersWaiting","prevs","handle","handleAnimation","handleImmediate","handleTimeouts","asInfo","setImmediate","__le_scroller__","pool","loadingPool","loading","forcedFirst","forcedLast","visibleFirstRowPos","scrollListener","abortAnimation","async","minScrollDelta","mixins","scrollingHint","batchSize","adapter","createAdapter","fragment","createDocumentFragment","addMixin","addAtBeginning","addAtBottom","removeFromBeginning","removeFromBottom","updateOffset","scroller","bodyScroller","tagName","insertBefore","firstChild","onScrolledVertically","recreate","cleanUp","updateRow","createRow","item","selectProxy","recycle","proxy","replaceChild","removeAll","forEachRow","lastChild","updateSizer","toFixed","bodySizer","recreateAnimated","recreatePure","clearPool","previousKey","currentKey","nodeYCurrentHeight","animate","phases","offsetTop","endsWith","clearTimeout","revalidate","onScrolledImpl","onScrolled","shiftLast","shiftFirst","rules","updateRules","addRule","updateRule","deleteRule","P","hashedId","tableIds","header","updateColumns","ruleNames","F","tableId","cellPool","visibleColumns","visibleFirstColumnPos","columnAdapter","createColumnAdapter","columnMixins","columnFragment","leftShift","addColumnMixin","addColumnAtStart","addColumnAtEnd","removeColumnFromStart","removeColumnFromEnd","updateColumnOffset","headerScroller","syncFrozen","onScrolledHorizontally","onScrolledHorizontallyImpl","removeCellFromStart","recycleCell","removeCellFromEnd","removeFrozenCells","removeFrozenColumns","removeAllColumns","removeAllCells","selectCell","updateCell","createCell","addCellAtStart","insertFrozenCells","insertFrozenColumns","addCellAtEnd","verifyRows","updateHeaders","updateHeader","createHeader","mergeColumns","cell","updateColumnWidths","updateShifts","prefetchTimeout","cleanupTimeout","prefetchRows","cleanUpRows","prefetchDown","prefetchUp","triggerPrefetch","cleanUpTop","cleanUpBottom","triggerCleanUp","hidden","onVisibilityChanged","sections","columnPadding","main","pushTable","doc","pushSeparator","widthChanged","I","IColumn","updateFilterState","filtered","active","sortMethods","methods","colorOf","toExponential","coefficient","formatDecimal","re","formatSpecifier","FormatSpecifier","align","zero","comma","prefixExponent","out","i1","toPrecision","formatRounded","grouping","thousands","substring","currencyPrefix","currency","currencySuffix","decimal","numerals","formatNumerals","percent","minus","nan","formatTypes","formatType","maybeSuffix","valuePrefix","valueSuffix","valueNegative","formatTrim","formatPrefix","currentGrouper","getTime","getDateGrouper","setDateGrouper","choose","trueMedian","currentGroup","currentSummary","summary","ADialog","before","newDescription","updateFilter","isTrue","isFalse","onchange","input","noFilter","joint","oninput","items","random","substr","createChildren","mergeDropAble","resizeable","className","summaryNode","statsOf","innerNodes","innerNodePaths","path","getCutOff","maxDepth","setCustomValidity","setCutOff","newNode","newNodeIndex","maxDepthText","templates","interactive","wrapper","getReduce","setReduce","getScript","setScript","provider","checkbox","searchAndJump","isRegex","valid","weights","getWeights","setWeights","weight","addons","getToolbarDialogAddons","addon","append","updateDisabled","disable","trigger","sortOrder","gradient","isCustom","continuouos","quantized","toggles","updateGradients","customs","custom","s0","s1","dm1","toColor","background","stepSize","half","steppedGradient","interpolate","line","unnormalizeRaw","normalizeRaw","container","button","shiftKey","onStart","normalized","onEnd","updated","drag","onDrag","domainCircle","rangeCircle","destroyed","mappingLines","loadedData","mappingAdapter","updateLines","computeScale","rawDomain","mappingSample","scaleType","others","bb","currentTarget","copyMapping","createMappings","selectedIndex","applyMapping","newScale","valueAsDate","to","ui","onClick","dialogContext","dialogManager","uiDialog","dialogClass","extraArgs","uiSortMethod","removeAboveLevel","ctrlKey","isAscByDefault","next","shortcut","featureCategory","sortGroupBy","rename","vis","_evt","collapse","mcol","setCollapsed","getCollapsed","toolbarAddons","sortNumber","sortNumbers","sortBoxPlot","sortDates","sortGroup","groupNumber","isThreshold","groupString","isRegexCheck","invalid","reportValidity","groupDate","granularity","circular","toolbarActions","filterNumber","filterDate","filterString","filterCategorical","filterOrdinal","filterBoolean","colorMapped","cutoff","editMapping","editPattern","editWeights","compositeContained","splitCombined","invertSelection","ss","sortActions","cacheAddon","getFullToolbar","icons","possible","getPossibleRenderer","getToolbar","flags","advancedModelFeatures","advancedRankingFeatures","advancedUIFeatures","isSortAble","isGroupAble","isGroupSortAble","getLink","defaultGroup","createRankDesc","_dataLength","originalLabels","_d","splicer","setSplicer","EVENT_SPLICE_CHANGED","getSplicer","equal","findOption","equalArrays","fixCSS","createStackDesc","collapsed","adaptChange","adaptWidthChange","EVENT_COLLAPSE_CHANGED","EVENT_WEIGHTS_CHANGED","EVENT_MULTI_LEVEL_CHANGED","full","oldWeight","factor","widths","guess","compute","COLLAPSED_RENDERER","hasDnDType","dataTransfer","available","typesToCheck","dndTransferStorage","isEdgeDnD","updateDropEffect","dT","effectAllowed","copyDnD","dropEffect","dropAble","mimeTypes","onDrop","onDragOver","effect","getData","mime","createToolbarMenuItems","updateIconState","dragAble","rearrangeAble","createShortcutMenuItems","toggleToolbarIcons","dragAbleColumn","resolveDrop","MIMETYPE_PREFIX","alternative","JSON","pushChild","mergeImpl","mergeWith","all","numberish","draginfo","toInsertParent","rearrangeDropAble","ueberElement","mouseMove","clientX","mouseUp","onmousedown","dragWidth","colId","typeCat","sortGroups","groupedBy","addIconDOM","showLabel","action","setHighlightColumn","willAutoHide","addIcon","shortcuts","hybrids","moreEntries","defaultVisibleClientWidth","rotated","scrollWidth","toggleRotatedHeader","availableWidth","shortCuts","moreIcon","needMore","total","onDragStart","draggable","payload","setData","over","stringify","currentMaxDepth","currentLeaves","currentLeavesNameCache","currentLeavesPathCache","hierarchySeparator","initHierarchy","currentNode","computeLeaves","updateCaches","EVENT_CUTOFF_CHANGED","leaves","visit","depth","resolveInnerNodes","queue","isHierarchical","deriveHierarchy","byKey","toKeyValue","EDateSort","formatItem","placeholder","onfocus","onblur","blur","onkeydown","handleKey","buildDialog","isItem","onmouseenter","highlighted","onmouseleave","ul","KEYS","which","click","highlightPrevious","highlightNext","SearchBox","EVENT_SELECT","filterResults","empty","allChildrenHidden","CompositeNumberColumn","createAggregateDesc","DENSE_HISTOGRAM","MIN_LABEL_WIDTH","HOVER_DELAY_SHOW_DETAIL","defaultOptions","renderers","labelRotation","summaryHeader","animated","expandLineOnHover","sidePanel","sidePanelCollapsed","hierarchyIndicator","defaultSlopeGraphMode","overviewMode","rowHeight","groupHeight","groupPadding","rowPadding","levelOfDetail","customRowUpdate","dynamicHeight","disableFrozenColumns","ignoreUnsupportedBrowser","isDateColumn","isDateIncluded","defaultDateGrouper","isDefaultDateGrouper","toDateGroup","centuryP","century","decadeP","decade","toGroupLookup","item2groupIndex","group2firstItemIndex","relativeIndex","toKey","lineupAnimation","previousData","currentData","prevHelper","currHelper","previousFinder","currentRowIndex","referenceIndex","appearPosition","_previousFinder","currentFinder","previousRowIndex","removePosition","singleRenderer","single","singleTemplate","cloneNode","elem","asElement","singleId","groupTemplate","groupId","summaryTemplate","summaryId","isGroup","oldRenderer","currentRenderer","oldGroup","getGroup","getRow","renderCell","helper","summaries","mc","cc","gridColumnStart","updateNested","updateWidthRule","sub","hr","showHint","startNode","elementFromPoint","clientY","endNode","xShift","yShift","SelectionManager","EVENT_SELECT_RANGE","startIndex","endIndex","sy","ey","MIN_DISTANCE","dataIndex","relIndex","selectRange","OrderedSet","updateState","selectedDataIndices","AEventDispatcher","RankingEvents","EVENT_UPDATE_DATA","EVENT_UPDATE_HIST","EVENT_HIGHLIGHT_CHANGED","roptions","highlight","canvasPool","oldLeft","canvasMouseHandler","timer","enter","leave","updateHoveredRow","EngineRanking","isCanvasRenderedRow","highlightHandler","delayedUpdate","updateBody","delayedUpdateAll","updateAll","delayedUpdateColumnWidths","createCol","reindex","updateHist","disableListener","_oldValue","renderCtx","_context","createRenderer","_document","selectCanvas","rowFlags","rowany","__lu__","visibleRenderedWidth","renderRow","canvas","getContext","imageSmoothingEnabled","clearRect","save","translate","updateCanvasCell","rowIndex","updateHeaderOf","agg","meta","lod","forcedLod","computedLod","wasLod","wasGroup","canvas2","updateCanvasBody","enableHighlightListening","enable","hover","inplace","updateSelection","updateColumn","after","groupData","toMeta","rowContext","totalNumberOfRows","setHighlight","findNearest","dataIndices","lookFor","firstBeforePos","firstAfterPos","nearestPos","scrollIntoView","regular","posOf","scrollHeight","found","getHighlight","debounceUpdate","timeToDelay","tm","canRender","SUMMARY","icon","ni","createGroup","groupActions","createSummary","colWidth","_i","_group","interactiveSummary","form","actCol","StringCellRenderer","setValue","imposer","valueHint","renderValue","CELL","_hist","bar","backgroundColor","groupTitle","summaryTitle","_col","_mode","sortedByMe","renderDOMBoxPlot","topPadding","strokeStyle","beginPath","bottomPos","middlePos","moveTo","lineTo","renderBoxPlot","createAggregatedBoxPlot","BoxplotCellRenderer","_comtext","_interactive","hasRange","computeLabel","whiskers","leftWhisker","rightWhisker","outliers","numOutliers","unshift","insertAdjacentElement","toHeatMapColor","valueColor","globalHist","filterUpdate","interactiveHist","staticSummary","showLabels","without","contained","calculateSetPath","cellDimension","catindexes","createDOMContext","templateRows","templateRow","display","hasTrueValues","posx","globalAlpha","union","visibility","stackedBar","flexGrow","getDOMRenderer","dots","tmp","vi","_v","boxRaw","createContext","mover","offsetX","onmousemove","ioptions","guessedBins","createHist","getHistDOMRenderer","filterMin","filterMax","minHint","maxHint","minValue","unpercent","maxValue","dialogCtx","minDelta","px","initFilter","stats","nodes","backgroundImage","grouped","dummyBin","groupedHist","LinkCellRenderer","createFixed","TableCellRenderer","example","createFixedGroup","groupByKey","getLinkMap","LinkMapCellRenderer","fromTSpan","toTSpan","moveNext","yPos","repeat","matchRows","one","xpos","isGrouped","chosen","defaultCellRenderer","brightness","catdistributionbar","dot","heatmap","catheatmap","image","interleaving","MultiLevelCellRenderer","mapbars","SelectionRenderer","sparkline","table","upset","verticalbar","chooseRenderer","chooseGroupRenderer","chooseSummaryRenderer","possibleRenderer","GROUP","possibleGroupRenderer","possibleSummaryRenderer","basis","v0","v1","v2","v3","gamma","nogamma","exponential","rgbGamma","rgbSpline","spline","rgbBasis","nb","na","reA","reB","cssNode","cssRoot","cssView","svgNode","am","bm","bs","lastIndex","q","valueOf","degrees","translateX","translateY","rotate","skewX","scaleX","scaleY","atan","interpolateTransform","pxComma","pxParen","degParen","xa","ya","xb","yb","decompose","createElementNS","baseVal","consolidate","matrix","SQRT2","hue","cubehelixGamma","cubehelixLong","createSelectionDesc","setImpl","setValues","toggleValue","SELECTED_GROUP","NOT_SELECTED_GROUP","isMapColumn","isArrayColumn","createActionDesc","EGroupSortMethod","createGroupDesc","aggregatedIndex","gridClass","createData","stacked","useGrid","option","missingWeight","ci","stackShift","initRange","each","proto","clamper","bimap","r0","r1","polymap","unknown","transformer","untransform","piecewise","output","rescale","rangeRound","continuous","linearish","tickFormat","nice","transformLog","transformExp","exp","transformLogn","transformExpn","pow10","reflect","loggish","logs","pows","log10","log2","logp","powp","transformPow","transformSqrt","transformSquare","powish","trueMarker","GROUP_TRUE","GROUP_FALSE","createImpositionBoxPlotDesc","createImpositionDesc","createImpositionsDesc","cleanCategories","deriveType","categoricalThreshold","deriveColumnDescriptions","config","deriveColors","exportRanking","opts","newline","quote","quoteChar","verboseColumnHeaders","_data","filterGlobally","jumpToSearchResult","maxNestedSortingCriteria","_dataRows","toRows","reorderAll","getTotalNumberOfRows","getMaxNestedSortingCriteria","clearData","appendData","sortImpl","ga","gb","rowGroup","viewRaw","viewRawRows","fetch","orders","getD","isBrowserSupported","panel","collapseable","pushUpdateAble","setDataProvider","escKeyListener","removeLast","openDialogs","mask","clipPath","clearHighlight","takeDown","setUp","histCache","slopeGraphs","updateAbles","zoomFactor","enabledHighlightListening","useGridLayout","toDisable","initProvider","zoomOut","updateZoomFactor","zoomIn","fontSize","updateAble","EngineRenderer","takeDownProvider","addRanking","setHighlightToNearest","histo","SlopeGraph","BAND","ITEM","updateRotatedHeaderState","section","slope","localData","round2","defaultHeight","updateSlopeGraphs","leftRanking","rightRanking","rebuild","nearest","createReduceDesc","selected","EVENT_REDUCE_CHANGED","DEFAULT_SCRIPT","createScriptDesc","allFactory","_all","byName","byID","byIndex","EVENT_SCRIPT_CHANGED","clean","raws","ColumnContext","ColumnWrapper","groupAdder","groupSortAdder","sortAdder","renderGroups","renderSorting","renderGroupSorting","toColumn","extras","addonKey","onChange","prevent","customize","addGroupAdder","addSortAdder","addGroupSortAdder","addAdder","adder","onSelect","used","dropdown","updateHierarchy","updateList","isWrapper","additionalDescs","chooser","descs","initChooser","changeDataStorage","wrapDesc","getColumns","updateChooser","updateStats","createEntry","makeActive","updateRanking","groupByType","SidePanel","EMode","leftSlopes","rightSlopes","initHeader","scroll","leftContext","rightContext","was","prepareRightSlopes","computeSlopes","fakeGroups","padded","slopes","gr","heightPerRow","ItemSlope","fakeGroup","createFakeGroup","free","intersection","GroupSlope","ri","leftVisibleFirst","leftVisibleLast","rightVisibleFirst","rightVisibleLast","ownerSVGElement","paths","matchLength","selectionLookup","__data__","ids","dragHandle","toContainerRelative","clientLeft","handleShift","createNestedDesc","ciResult","annotations","EVENT_VALUE_CHANGED","TYPE_OBJECT","toMerge","keyName","SUPPORTED_FIREFOX_VERSION","SUPPORTED_CHROME_VERSION","SUPPORTED_EDGE_VERSION","getUnsupportedBrowserError","info","fVersion","ignoreIncompatibleBrowser","highlightListeners","ALineUp","_enable","server","maxCacheSize","loadFromServer","computeMissing","unionAdd","loadInCache","_m","toLoad","MultiLevelCompositeColumn","list","addAll","deleteAll","callbackfn","thisArg","iterator","rowGetter","_id","isComplexAccessor","resolveComplex","rankingIndex","ranks","_desc","nextRankingId","pushDesc","clearColumns","deriveDefault","addSupportType","rangeSelection","rankingId","distance","violationChanged","_rule","violation","setViolation","spaceFilling","switchRule","keyList","hasProp","arrA","arrB","dateA","dateB","regexpA","regexpB","isDynamicLeafHeight","rule","resizeListener","TaggleRenderer","availableHeight","spaceFillingRule","visibleHeight","lastItems","unselected","groupSeparators","_color","asArray","asMap","buildColumn","ColumnBuilder","rotation","registerRenderer","registerToolbarAction","registerToolbarDialogAddon","groupRowHeight","disableAdvancedRankingFeatures","disableAdvancedModelFeatures","disableAdvancedUIFeatures","supportTypes","allColumns","impose","categoricalColumn","scripted","weightedSum","numberColumn","numberColumn1","weight1","numberColumn2","weight2","numberColumnAndWeights","post","operation","numberColumns","RankingBuilder","ALL_MAGIC_FLAG","addColumn","buildRanking","providerOptions","rankBuilders","_deriveColors","singleSelection","noCriteriaLimits","limitCriteria","sortingCritera","groupingCriteria","deriveColumns","registerColumnType","defaultRanking","addSupportTypes","builder","buildData","LocalDataProvider","LineUp","buildTaggle","Taggle","asOrdinal","asSet","derive","isSet","val","buildCategoricalColumn","asBoxPlot","extra","ext","buildNumberColumn","editable","buildStringColumn","buildDateColumn","buildHierarchicalColumn","groupAction","buildActionsColumn","si","pick","changed","lineupOptions","prevRankings","prevColumns","prevHighlight","onSelectionChanged","onHighlightChanged","componentDidMount","buildProvider","createInstance","resolveColumnDescs","columnDescs","deriveColumnNames","resolveRankings","builders","rankingBuilders","buildColumns","buildRankings","updateLineUp","changeDetector","providerChanged","changedLineUpOptions","updateProvider","columnsChanged","componentDidUpdate","componentWillUnmount","builderAdapter","buildString","buildNumber","buildHierarchy","buildDate","buildCategorical","buildActions","buildGeneric","buildWeightedSumRanking","buildSupportRanking","buildScriptRanking","buildReduceRanking","buildNestedRanking","buildImposeRanking","buildAllColumnsRanking","isTypeInstance","superClass","Adapter","asTaggle","asLineUp","BrowserInfo","os","NodeInfo","process","platform","BotInfo","bot","REQUIRED_VERSION_PARTS","userAgentRules","operatingSystemRules","parseUserAgent","ua","matchedRule","browser","regex","uaMatch","versionParts","ii","createVersionParts","detectOS","getNodeVersion","detect","buildId","license","createLocalDataProvider","createLineUp","createTaggle","exporter","makeExporter","hasOwn","supportsSymbol","toPrimitiveSymbol","toPrimitive","iteratorSymbol","supportsCreate","supportsProto","downLevel","HashMap","MakeDictionary","functionPrototype","usePolyfill","env","_Map","cacheSentinel","arraySentinel","MapIterator","_index","_keys","_values","_selector","done","throw","return","_cacheKey","_cacheIndex","_find","getKey","getEntry","CreateMapPolyfill","_Set","_map","Metadata","WeakMap","UUID_SIZE","rootKey","CreateUniqueKey","_key","GetOrCreateWeakMapTable","CreateUUID","FillRandomBytes","buffer","Uint8Array","crypto","getRandomValues","msCrypto","byte","CreateWeakMapPolyfill","GetOrCreateMetadataMap","Create","targetMetadata","IsUndefined","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","GetMethod","IsCallable","IsObject","GetIterator","IteratorStep","nextValue","IteratorClose","Type","IsNull","ToPrimitive","PreferredType","hint","exoticToPrim","toString_1","toString_2","OrdinaryToPrimitive","ToPropertyKey","argument","ToString","IsArray","IsConstructor","func","OrdinaryGetPrototypeOf","prototypeProto","decorated","decorator","DecorateConstructor","DecorateProperty","metadataKey","metadataValue","IsPropertyKey","OrdinaryHasMetadata","OrdinaryGetMetadata","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeys_1","parentKeys_1"],"mappings":"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","file":"LineUpJS.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LineUpJS\"] = factory();\n\telse\n\t\troot[\"LineUpJS\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 101);\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import AEventDispatcher from '../internal/AEventDispatcher';\nimport {similar} from '../internal/math';\nimport {fixCSS} from '../internal/utils';\nimport {defaultGroup} from './Group';\nimport {IColumnDesc, IDataRow, IGroup, IGroupData} from './interfaces';\nimport {isMissingValue} from './missing';\nimport Ranking, {ISortCriteria} from './Ranking';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {isSortingAscByDefault} from './annotations';\n\nexport {IColumnDesc} from './interfaces';\n\nexport interface IFlatColumn {\n  readonly col: Column;\n  readonly offset: number;\n  readonly width: number;\n}\n\nexport interface IColumnParent {\n  remove(col: Column): boolean;\n\n  insert(col: Column, index?: number): Column | null;\n\n  insertAfter(col: Column, reference: Column): Column | null;\n\n  move(col: Column, index?: number): Column | null;\n\n  moveAfter(col: Column, reference: Column): Column | null;\n\n  findMyRanker(): Ranking | null;\n\n  readonly fqid: string;\n\n  indexOf(col: Column): number;\n\n  at(index: number): Column;\n\n  readonly fqpath: string;\n\n}\n\n\nexport interface IColumnMetaData {\n  label: string;\n  description: string;\n}\n\n\n/**\n * emitted when the width property changes\n * @asMemberOf Column\n * @event\n */\nexport declare function widthChanged(previous: number, current: number): void;\n\n/**\n * emitted when the label property changes\n * @asMemberOf Column\n * @event\n */\nexport declare function labelChanged(previous: string, current: string): void;\n\n/**\n * emitted when the meta data property changes\n * @asMemberOf Column\n * @event\n */\nexport declare function metaDataChanged(previous: IColumnMetaData, current: IColumnMetaData): void;\n\n/**\n * emitted when state of the column is dirty\n * @asMemberOf Column\n * @event\n */\nexport declare function dirty(): void;\n\n/**\n * emitted when state of the column related to its header is dirty\n * @asMemberOf Column\n * @event\n */\nexport declare function dirtyHeader(): void;\n\n/**\n * emitted when state of the column related to its values is dirty\n * @asMemberOf Column\n * @event\n */\nexport declare function dirtyValues(): void;\n\n/**\n * emitted when the renderer type property changes\n * @asMemberOf Column\n * @event\n */\nexport declare function rendererTypeChanged(previous: string, current: string): void;\n\n/**\n * emitted when the group renderer property changes\n * @asMemberOf Column\n * @event\n */\nexport declare function groupRendererChanged(previous: string, current: string): void;\n\n/**\n * emitted when the pattern property changes\n * @asMemberOf Column\n * @event\n */\nexport declare function summaryRendererChanged(previous: string, current: string): void;\n\n/**\n * emitted when the visibility of this column changes\n * @asMemberOf Column\n * @event\n */\nexport declare function visibilityChanged(previous: boolean, current: boolean): void;\n\n\n/**\n * a column in LineUp\n */\nexport default class Column extends AEventDispatcher {\n  /**\n   * default color that should be used\n   * @type {string}\n   */\n  static readonly DEFAULT_COLOR = '#C1C1C1';\n  /**\n   * magic variable for showing all columns\n   * @type {number}\n   */\n  static readonly FLAT_ALL_COLUMNS = -1;\n\n  static readonly EVENT_WIDTH_CHANGED = 'widthChanged';\n  static readonly EVENT_LABEL_CHANGED = 'labelChanged';\n  static readonly EVENT_METADATA_CHANGED = 'metaDataChanged';\n  static readonly EVENT_DIRTY = 'dirty';\n  static readonly EVENT_DIRTY_HEADER = 'dirtyHeader';\n  static readonly EVENT_DIRTY_VALUES = 'dirtyValues';\n  static readonly EVENT_RENDERER_TYPE_CHANGED = 'rendererTypeChanged';\n  static readonly EVENT_GROUP_RENDERER_TYPE_CHANGED = 'groupRendererChanged';\n  static readonly EVENT_SUMMARY_RENDERER_TYPE_CHANGED = 'summaryRendererChanged';\n  static readonly EVENT_VISIBILITY_CHANGED = 'visibilityChanged';\n\n  /**\n   * the id of this column\n   */\n  private uid: string;\n\n  /**\n   * width of the column\n   * @type {number}\n   * @private\n   */\n  private width: number = 100;\n\n  /**\n   * parent column of this column, set when added to a ranking or combined column\n   */\n  parent: Readonly<IColumnParent> | null = null;\n\n  private metadata: Readonly<IColumnMetaData>;\n  private renderer: string;\n  private groupRenderer: string;\n  private summaryRenderer: string;\n  private visible: boolean;\n\n  constructor(id: string, public readonly desc: Readonly<IColumnDesc>) {\n    super();\n    this.uid = fixCSS(id);\n    this.renderer = this.desc.renderer || this.desc.type;\n    this.groupRenderer = this.desc.groupRenderer || this.desc.type;\n    this.summaryRenderer = this.desc.summaryRenderer || this.desc.type;\n    this.width = this.desc.width != null && this.desc.width > 0 ? this.desc.width : 100;\n    this.visible = this.desc.visible !== false;\n\n    this.metadata = {\n      label: desc.label || this.id,\n      description: desc.description || ''\n    };\n  }\n\n  get fixed() {\n    return Boolean(this.desc.fixed);\n  }\n\n  get frozen() {\n    return Boolean(this.desc.frozen);\n  }\n\n  get id() {\n    return this.uid;\n  }\n\n  assignNewId(idGenerator: () => string) {\n    this.uid = fixCSS(idGenerator());\n  }\n\n  get label() {\n    return this.metadata.label;\n  }\n\n  get description() {\n    return this.metadata.description;\n  }\n\n  /**\n   * returns the fully qualified id i.e. path the parent\n   * @returns {string}\n   */\n  get fqid() {\n    return this.parent ? `${this.parent.fqid}_${this.id}` : this.id;\n  }\n\n  get fqpath() {\n    return this.parent ? `${this.parent.fqpath}@${this.parent.indexOf(this)}` : '';\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([Column.EVENT_WIDTH_CHANGED,\n      Column.EVENT_LABEL_CHANGED, Column.EVENT_METADATA_CHANGED, Column.EVENT_VISIBILITY_CHANGED, Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED,\n      Column.EVENT_RENDERER_TYPE_CHANGED, Column.EVENT_GROUP_RENDERER_TYPE_CHANGED,\n      Column.EVENT_DIRTY, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES]);\n  }\n\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  getWidth() {\n    return this.width;\n  }\n\n  hide() {\n    this.setVisible(false);\n  }\n\n  show() {\n    this.setVisible(true);\n  }\n\n  isVisible() {\n    return this.visible;\n  }\n\n  getVisible() {\n    return this.isVisible();\n  }\n\n  setVisible(value: boolean) {\n    if (this.visible === value) {\n      return;\n    }\n    this.fire([Column.EVENT_VISIBILITY_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.visible, this.visible = value);\n  }\n\n  /**\n   * visitor pattern for flattening the columns\n   * @param {IFlatColumn} r the result array\n   * @param {number} offset left offset\n   * @param {number} _levelsToGo how many levels down\n   * @param {number} _padding padding between columns\n   * @returns {number} the used width by this column\n   */\n  flatten(r: IFlatColumn[], offset: number, _levelsToGo = 0, _padding = 0): number {\n    const w = this.getWidth();\n    r.push({col: this, offset, width: w});\n    return w;\n  }\n\n  setWidth(value: number) {\n    if (similar(this.width, value, 0.5)) {\n      return;\n    }\n    this.fire([Column.EVENT_WIDTH_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.width, this.width = value);\n  }\n\n  setWidthImpl(value: number) {\n    this.width = value;\n  }\n\n  setMetaData(value: Readonly<IColumnMetaData>) {\n    if (value.label === this.label && this.description === value.description) {\n      return;\n    }\n    const bak = this.getMetaData();\n    //copy to avoid reference\n    this.metadata = {\n      label: value.label,\n      description: value.description\n    };\n\n    this.fire([Column.EVENT_LABEL_CHANGED, Column.EVENT_METADATA_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], bak, this.getMetaData());\n  }\n\n  getMetaData(): Readonly<IColumnMetaData> {\n    return Object.assign({}, this.metadata);\n  }\n\n  /**\n   * triggers that the ranking is sorted by this column\n   * @param ascending ascending order?\n   * @param priority sorting priority\n   * @returns {boolean} was successful\n   */\n  sortByMe(ascending = isSortingAscByDefault(this), priority = 0) {\n    const r = this.findMyRanker();\n    if (r) {\n      return r.sortBy(this, ascending, priority);\n    }\n    return false;\n  }\n\n  groupByMe(): boolean {\n    const r = this.findMyRanker();\n    if (r) {\n      return r.toggleGrouping(this);\n    }\n    return false;\n  }\n\n  /**\n   *\n   * @return {number}\n   */\n  isGroupedBy(): number {\n    const r = this.findMyRanker();\n    if (!r) {\n      return -1;\n    }\n    return r.getGroupCriteria().indexOf(this);\n  }\n\n  /**\n   * toggles the sorting order of this column in the ranking\n   * @returns {boolean} was successful\n   */\n  toggleMySorting() {\n    const r = this.findMyRanker();\n    if (r) {\n      return r.toggleSorting(this);\n    }\n    return false;\n  }\n\n  private isSortedByMeImpl(selector: ((r: Ranking) => ISortCriteria[])): { asc: 'asc' | 'desc' | undefined, priority: number | undefined } {\n    const ranker = this.findMyRanker();\n    if (!ranker) {\n      return {asc: undefined, priority: undefined};\n    }\n    const criterias = selector(ranker);\n    const index = criterias.findIndex((c) => c.col === this);\n    if (index < 0) {\n      return {asc: undefined, priority: undefined};\n    }\n    return {\n      asc: criterias[index].asc ? 'asc' : 'desc',\n      priority: index\n    };\n  }\n\n  isSortedByMe() {\n    return this.isSortedByMeImpl((r) => r.getSortCriteria());\n  }\n\n  groupSortByMe(ascending = isSortingAscByDefault(this), priority = 0) {\n    const r = this.findMyRanker();\n    if (r) {\n      return r.groupSortBy(this, ascending, priority);\n    }\n    return false;\n  }\n\n  toggleMyGroupSorting() {\n    const r = this.findMyRanker();\n    if (r) {\n      return r.toggleGroupSorting(this);\n    }\n    return false;\n  }\n\n  isGroupSortedByMe() {\n    return this.isSortedByMeImpl((r) => r.getGroupSortCriteria());\n  }\n\n  /**\n   * removes the column from the ranking\n   * @returns {boolean} was successful\n   */\n  removeMe() {\n    if (this.fixed) {\n      return false;\n    }\n    if (this.parent) {\n      return this.parent.remove(this);\n    }\n    return false;\n  }\n\n  /**\n   * called when the columns added to a ranking\n   */\n  attach(parent: IColumnParent)  {\n    this.parent = parent;\n  }\n\n  /**\n   * called when the column is removed from the ranking\n   */\n  detach() {\n    this.parent = null;\n  }\n\n  /**\n   * inserts the given column after itself\n   * @param col the column to insert\n   * @returns {boolean} was successful\n   */\n  insertAfterMe(col: Column) {\n    if (this.parent) {\n      return this.parent.insertAfter(col, this) != null;\n    }\n    return false;\n  }\n\n  /**\n   * finds the underlying ranking column\n   * @returns {Ranking|null} my current ranking\n   */\n  findMyRanker(): Ranking | null {\n    if (this.parent) {\n      return this.parent.findMyRanker();\n    }\n    return null;\n  }\n\n  /**\n   * dumps this column to JSON compatible format\n   * @param toDescRef helper mapping function\n   * @returns {any} dump of this column\n   */\n  dump(toDescRef: (desc: any) => any): any {\n    const r: any = {\n      id: this.id,\n      desc: toDescRef(this.desc),\n      width: this.width\n    };\n    if (this.label !== (this.desc.label || this.id)) {\n      r.label = this.label;\n    }\n    if (this.getRenderer() !== this.desc.type) {\n      r.renderer = this.getRenderer();\n    }\n    if (this.getGroupRenderer() !== this.desc.type) {\n      r.groupRenderer = this.getGroupRenderer();\n    }\n    if (this.getSummaryRenderer() !== this.desc.type) {\n      r.summaryRenderer = this.getSummaryRenderer();\n    }\n    return r;\n  }\n\n  /**\n   * restore the column content from a dump\n   * @param dump column dump\n   * @param _factory helper for creating columns\n   */\n  restore(dump: any, _factory: (dump: any) => Column | null) {\n    this.width = dump.width || this.width;\n    this.metadata = {\n      label: dump.label || this.label,\n      description: this.description\n    };\n    if (dump.renderer || dump.rendererType) {\n      this.renderer = dump.renderer || dump.rendererType;\n    }\n    if (dump.groupRenderer) {\n      this.groupRenderer = dump.groupRenderer;\n    }\n    if (dump.summaryRenderer) {\n      this.summaryRenderer = dump.summaryRenderer;\n    }\n  }\n\n  /**\n   * return the label of a given row for the current column\n   * @param row the current row\n   * @return {string} the label of this column at the specified row\n   */\n  getLabel(row: IDataRow): string {\n    return String(this.getValue(row));\n  }\n\n  /**\n   * return the value of a given row for the current column\n   * @param _row the current row\n   * @return the value of this column at the specified row\n   */\n  getValue(_row: IDataRow): any {\n    return ''; //no value\n  }\n\n  /**\n   * returns the value to be used when exporting\n   * @param format format hint\n   */\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    return format === 'text' ? this.getLabel(row) : this.getValue(row);\n  }\n\n  getColor(_row: IDataRow) {\n    return Column.DEFAULT_COLOR;\n  }\n\n  isMissing(row: IDataRow) {\n    return isMissingValue(this.getValue(row));\n  }\n\n  /**\n   * compare function used to determine the order according to the values of the current column\n   * @param _a first element\n   * @param _b second element\n   * @return {number}\n   */\n  compare(_a: IDataRow, _b: IDataRow) {\n    return 0; //can't compare\n  }\n\n  /**\n   * group the given row into a bin/group\n   * @param _row\n   * @return {IGroup}\n   */\n  group(_row: IDataRow): IGroup {\n    return defaultGroup;\n  }\n\n  /**\n   * compares groups\n   * @param {IGroupData} a\n   * @param {IGroupData} b\n   * @return {number}\n   */\n  groupCompare(a: IGroupData, b: IGroupData) {\n    return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n  }\n\n  /**\n   * flag whether any filter is applied\n   * @return {boolean}\n   */\n  isFiltered() {\n    return false;\n  }\n\n  /**\n   * predicate whether the current row should be included\n   * @param row\n   * @return {boolean}\n   */\n  filter(row: IDataRow) {\n    return row != null;\n  }\n\n  /**\n   * determines the renderer type that should be used to render this column. By default the same type as the column itself\n   * @return {string}\n   */\n  getRenderer(): string {\n    return this.renderer;\n  }\n\n  getGroupRenderer(): string {\n    return this.groupRenderer;\n  }\n\n  getSummaryRenderer(): string {\n    return this.summaryRenderer;\n  }\n\n  setRenderer(renderer: string) {\n    if (renderer === this.renderer) {\n      // nothing changes\n      return;\n    }\n    this.fire([Column.EVENT_RENDERER_TYPE_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.renderer, this.renderer = renderer);\n  }\n\n  protected setDefaultRenderer(renderer: string) {\n    if (this.renderer !== this.desc.type || this.desc.renderer) {\n      return;\n    }\n    return this.setRenderer(renderer);\n  }\n\n  setGroupRenderer(renderer: string) {\n    if (renderer === this.groupRenderer) {\n      // nothing changes\n      return;\n    }\n    this.fire([Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.groupRenderer, this.groupRenderer = renderer);\n  }\n\n  protected setDefaultGroupRenderer(renderer: string) {\n    if (this.groupRenderer !== this.desc.type || this.desc.groupRenderer) {\n      return;\n    }\n    return this.setGroupRenderer(renderer);\n  }\n\n  setSummaryRenderer(renderer: string) {\n    if (renderer === this.summaryRenderer) {\n      // nothing changes\n      return;\n    }\n    this.fire([Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], this.summaryRenderer, this.summaryRenderer = renderer);\n  }\n\n  protected setDefaultSummaryRenderer(renderer: string) {\n    if (this.summaryRenderer !== this.desc.type || this.desc.summaryRenderer) {\n      return;\n    }\n    return this.setSummaryRenderer(renderer);\n  }\n\n  protected setDefaultWidth(width: number) {\n    if (this.width !== 100 || this.desc.width) {\n      return;\n    }\n    return this.setWidthImpl(width);\n  }\n\n  /**\n   * marks the header, values, or both as dirty such that the values are reevaluated\n   * @param type specify in more detail what is dirty, by default whole column\n   */\n  markDirty(type: 'header' | 'values' | 'all' = 'all') {\n    switch (type) {\n      case 'header':\n        return this.fire([Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY]);\n      case 'values':\n        return this.fire([Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY]);\n      default:\n        return this.fire([Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY]);\n    }\n  }\n}\n","import 'reflect-metadata';\r\nimport Column from './Column';\r\nimport {IColumnDesc} from './interfaces';\r\n\r\nconst supportType = Symbol.for('SupportType');\r\nconst category = Symbol.for('Category');\r\n\r\nexport function SupportType() {\r\n  return Reflect.metadata(supportType, true);\r\n}\r\n\r\nexport function SortByDefault(order: 'ascending'|'descending' = 'ascending') {\r\n  if (order === 'descending') {\r\n    return Reflect.metadata(Symbol.for('sortDescendingByDefault'), true);\r\n  }\r\n  return (d: any) => d;\r\n}\r\n\r\nexport function isSortingAscByDefault(col: Column) {\r\n  const clazz = (<any>col).constructor;\r\n  return !Reflect.hasMetadata(Symbol.for('sortDescendingByDefault'), clazz);\r\n}\r\n\r\nexport class Categories {\r\n  readonly string = {label: 'label', order: 1, name: 'string', featureLevel: 'basic'};\r\n  readonly categorical = {label: 'categorical', order: 2, name: 'categorical', featureLevel: 'basic'};\r\n  readonly number = {label: 'numerical', order: 3, name: 'number', featureLevel: 'basic'};\r\n  readonly date = {label: 'date', order: 4, name: 'date', featureLevel: 'basic'};\r\n  readonly array = {label: 'matrix', order: 5, name: 'array', featureLevel: 'advanced'};\r\n  readonly map = {label: 'map', order: 6, name: 'map', featureLevel: 'advanced'};\r\n  readonly composite = {label: 'combined', order: 7, name: 'composite', featureLevel: 'advanced'};\r\n  readonly support = {label: 'support', order: 8, name: 'support', featureLevel: 'advanced'};\r\n  readonly other = {label: 'others', order: 9, name: 'other', featureLevel: 'advanced'};\r\n}\r\n\r\nexport const categories = new Categories();\r\n\r\nexport function Category(cat: keyof Categories) {\r\n  return Reflect.metadata(category, cat);\r\n}\r\n\r\nexport function toolbar(...keys: string[]) {\r\n  return Reflect.metadata(Symbol.for('toolbarIcon'), keys);\r\n}\r\n\r\nexport function dialogAddons(key: string, ...keys: string[]) {\r\n  return Reflect.metadata(Symbol.for(`toolbarDialogAddon${key}`), keys);\r\n}\r\n\r\nconst cache = new Map<string, string[]>();\r\n\r\nexport function isSupportType(col: Column) {\r\n  const clazz = (<any>col).constructor;\r\n  return Reflect.hasMetadata(supportType, clazz);\r\n}\r\n\r\nexport interface IColumnCategory {\r\n  label: string;\r\n  name: string;\r\n  order: number;\r\n  featureLevel: 'basic' | 'advanced';\r\n}\r\n\r\nexport function categoryOf(col: (typeof Column) | Column): IColumnCategory {\r\n  const cat = <keyof Categories>Reflect.getMetadata(category, col instanceof Column ? Object.getPrototypeOf(col).constructor : col) || 'other';\r\n  return <IColumnCategory>categories[cat] || categories.other;\r\n}\r\n\r\nexport function categoryOfDesc(col: IColumnDesc | string, models: { [key: string]: typeof Column }): IColumnCategory {\r\n  const type = typeof col === 'string' ? col : col.type;\r\n  const clazz = models[type];\r\n  return clazz ? categoryOf(clazz) : <IColumnCategory>categories.other;\r\n}\r\n\r\nexport function getAllToolbarActions(col: Column) {\r\n  if (cache.has(col.desc.type)) {\r\n    return cache.get(col.desc.type)!;\r\n  }\r\n  const actions = <string[]>[];\r\n\r\n  // walk up the prototype chain\r\n  let obj = <any>col;\r\n  const toolbarIcon = Symbol.for('toolbarIcon');\r\n  do {\r\n    const m = <string[]>Reflect.getOwnMetadata(toolbarIcon, obj.constructor);\r\n    if (m) {\r\n      actions.push(...m);\r\n    }\r\n    obj = Object.getPrototypeOf(obj);\r\n  } while (obj);\r\n  cache.set(col.desc.type, actions);\r\n  return actions;\r\n}\r\n\r\n\r\nexport function getAllToolbarDialogAddons(col: Column, key: string) {\r\n  const cacheKey = `${col.desc.type}@${key}`;\r\n  if (cache.has(cacheKey)) {\r\n    return cache.get(cacheKey)!;\r\n  }\r\n  const actions = <string[]>[];\r\n\r\n  // walk up the prototype chain\r\n  let obj = <any>col;\r\n  const symbol = Symbol.for(`toolbarDialogAddon${key}`);\r\n  do {\r\n    const m = <string[]>Reflect.getOwnMetadata(symbol, obj.constructor);\r\n    if (m) {\r\n      actions.push(...m);\r\n    }\r\n    obj = Object.getPrototypeOf(obj);\r\n  } while (obj);\r\n  cache.set(cacheKey, actions);\r\n  return actions;\r\n}\r\n","import {format} from 'd3-format';\r\nimport {IAdvancedBoxPlotData, IBoxPlotData, similar} from '../internal';\r\nimport Column from './Column';\r\nimport {IArrayColumn} from './IArrayColumn';\r\nimport {IColumnDesc, IDataRow} from './interfaces';\r\nimport {IMapAbleColumn, IMappingFunction} from './MappingFunction';\r\nimport {FIRST_IS_NAN} from './missing';\r\n\r\nexport {} from '../internal';\r\n\r\n\r\nexport interface INumberColumn extends Column {\r\n  getNumber(row: IDataRow): number;\r\n\r\n  getRawNumber(row: IDataRow): number;\r\n}\r\n\r\n\r\nexport const DEFAULT_FORMATTER = format('.3n');\r\n\r\nexport default INumberColumn;\r\n\r\n\r\nexport interface INumberDesc {\r\n  /**\r\n   * dump of mapping function\r\n   */\r\n  map?: any;\r\n  /**\r\n   * either map or domain should be available\r\n   */\r\n  domain?: [number, number];\r\n  /**\r\n   * @default [0,1]\r\n   */\r\n  range?: [number, number];\r\n  /**\r\n   * d3 formatting option\r\n   * @default .3n\r\n   */\r\n  numberFormat?: string;\r\n\r\n  /**\r\n   * missing value to use\r\n   * @default 0\r\n   */\r\n  missingValue?: number;\r\n}\r\n\r\n/**\r\n * checks whether the given column or description is a number column, i.e. the value is a number\r\n * @param col\r\n * @returns {boolean}\r\n */\r\nexport function isNumberColumn(col: Column): col is INumberColumn;\r\nexport function isNumberColumn(col: IColumnDesc): col is INumberDesc & IColumnDesc;\r\nexport function isNumberColumn(col: Column | IColumnDesc) {\r\n  return (col instanceof Column && typeof (<INumberColumn>col).getNumber === 'function' || (!(col instanceof Column) && (<IColumnDesc>col).type.match(/(number|stack|ordinal)/) != null));\r\n}\r\n\r\nexport function compareBoxPlot(col: IBoxPlotColumn, a: IDataRow, b: IDataRow) {\r\n  const aVal = col.getBoxPlotData(a);\r\n  const bVal = col.getBoxPlotData(b);\r\n  if (aVal == null) {\r\n    return bVal == null ? 0 : FIRST_IS_NAN;\r\n  }\r\n  if (bVal == null) {\r\n    return FIRST_IS_NAN * -1;\r\n  }\r\n  const method = <keyof IBoxPlotData>col.getSortMethod();\r\n  return numberCompare(<number>aVal[method], <number>bVal[method]);\r\n}\r\n\r\nexport function getBoxPlotNumber(col: IBoxPlotColumn, row: IDataRow, mode: 'raw' | 'normalized'): number {\r\n  const data = mode === 'normalized' ? col.getBoxPlotData(row) : col.getRawBoxPlotData(row);\r\n  if (data == null) {\r\n    return NaN;\r\n  }\r\n  return <number>data[<keyof IBoxPlotData>col.getSortMethod()];\r\n}\r\n\r\nexport enum ESortMethod {\r\n  min = 'min',\r\n  max = 'max',\r\n  median = 'median',\r\n  q1 = 'q1',\r\n  q3 = 'q3'\r\n}\r\n\r\nexport interface IBoxPlotColumn extends INumberColumn, IMapAbleColumn {\r\n  getBoxPlotData(row: IDataRow): IBoxPlotData | null;\r\n\r\n  getMapping(): IMappingFunction;\r\n\r\n  getRawBoxPlotData(row: IDataRow): IBoxPlotData | null;\r\n\r\n  getSortMethod(): string;\r\n\r\n  setSortMethod(sortMethod: string): void;\r\n}\r\n\r\nexport function isBoxPlotColumn(col: Column): col is IBoxPlotColumn {\r\n  return typeof (<IBoxPlotColumn>col).getBoxPlotData === 'function';\r\n}\r\n\r\nexport enum EAdvancedSortMethod {\r\n  min = 'min',\r\n  max = 'max',\r\n  median = 'median',\r\n  q1 = 'q1',\r\n  q3 = 'q3',\r\n  mean = 'mean'\r\n}\r\n\r\nexport interface IAdvancedBoxPlotColumn extends IBoxPlotColumn {\r\n  getBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null;\r\n\r\n  getRawBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null;\r\n}\r\n\r\nexport interface INumbersColumn extends IAdvancedBoxPlotColumn, IArrayColumn<number> {\r\n  getNumbers(row: IDataRow): number[];\r\n\r\n  getRawNumbers(row: IDataRow): number[];\r\n}\r\n\r\nexport function isNumbersColumn(col: Column): col is INumbersColumn {\r\n  return isBoxPlotColumn(col) && typeof (<INumbersColumn>col).getNumbers === 'function';\r\n}\r\n\r\n/**\r\n * save number comparison\r\n * @param a\r\n * @param b\r\n * @param aMissing\r\n * @param bMissing\r\n * @return {number}\r\n */\r\nexport function numberCompare(a: number | null, b: number | null, aMissing = false, bMissing = false) {\r\n  aMissing = aMissing || a == null || isNaN(a);\r\n  bMissing = bMissing || b == null || isNaN(b);\r\n  if (aMissing) { //NaN are smaller\r\n    return bMissing ? 0 : FIRST_IS_NAN;\r\n  }\r\n  if (bMissing) {\r\n    return FIRST_IS_NAN * -1;\r\n  }\r\n  return a! - b!;\r\n}\r\n\r\nexport interface INumberFilter {\r\n  min: number;\r\n  max: number;\r\n  filterMissing: boolean;\r\n}\r\n\r\nexport function noNumberFilter() {\r\n  return ({min: -Infinity, max: Infinity, filterMissing: false});\r\n}\r\n\r\nexport function isEqualNumberFilter(a: INumberFilter, b: INumberFilter) {\r\n  return similar(a.min, b.min, 0.001) && similar(a.max, b.max, 0.001) && a.filterMissing === b.filterMissing;\r\n}\r\n\r\nexport function isNumberIncluded(filter: INumberFilter | null, value: number) {\r\n  if (!filter) {\r\n    return true;\r\n  }\r\n  if (isNaN(value)) {\r\n    return !filter.filterMissing;\r\n  }\r\n  return !((isFinite(filter.min) && value < filter.min) || (isFinite(filter.max) && value > filter.max));\r\n}\r\n\r\n/** @internal */\r\nexport function isDummyNumberFilter(filter: INumberFilter) {\r\n  return !filter.filterMissing && !isFinite(filter.min) && !isFinite(filter.max);\r\n}\r\n\r\n/** @internal */\r\nexport function restoreNumberFilter(v: INumberFilter): INumberFilter {\r\n  return {\r\n    min: v.min != null && isFinite(v.min) ? v.min : -Infinity,\r\n    max: v.max != null && isFinite(v.max) ? v.max : +Infinity,\r\n    filterMissing: v.filterMissing\r\n  };\r\n}\r\n","import {MIN_LABEL_WIDTH} from '../config';\r\nimport Column from '../model/Column';\r\nimport {IArrayColumn} from '../model/IArrayColumn';\r\nimport {hsl} from 'd3-color';\r\nimport {IDataRow} from '../model/interfaces';\r\n\r\n/**\r\n * utility function to sets attributes and styles in a nodes\r\n * @param node\r\n * @param attrs\r\n * @param styles\r\n * @param text\r\n * @return {T}\r\n * @internal\r\n */\r\nexport function attr<T extends (HTMLElement | SVGElement)>(node: T, attrs: {[key: string]: any} = {}, styles: {[key: string]: any} = {}, text?: string): T {\r\n  Object.keys(attrs).forEach((attr) => {\r\n    const v = String(attrs[attr]);\r\n    if (node.getAttribute(attr) !== v) {\r\n      node.setAttribute(attr, v);\r\n    }\r\n  });\r\n  Object.keys(styles).forEach((attr) => {\r\n    const v = styles[attr];\r\n    if ((<any>node).style.getPropertyValue(attr) !== v) {\r\n      (<any>node).style.setProperty(attr, v);\r\n    }\r\n  });\r\n  return setText(node, text);\r\n}\r\n\r\n/** @internal */\r\nexport function noop() {\r\n  // no op\r\n}\r\n\r\n/** @internal */\r\nexport const noRenderer = {\r\n  template: `<div></div>`,\r\n  update: noop,\r\n  render: noop\r\n};\r\n\r\n/** @internal */\r\nexport function setText<T extends Node>(node: T, text?: string): T {\r\n  if (text === undefined) {\r\n    return node;\r\n  }\r\n  //no performance boost if setting the text node directly\r\n  //const textNode = <Text>node.firstChild;\r\n  //if (textNode == null) {\r\n  //  node.appendChild(node.ownerDocument.createTextNode(text));\r\n  //} else {\r\n  //  textNode.data = text;\r\n  //}\r\n  if (node.textContent !== text) {\r\n    node.textContent = text;\r\n  }\r\n  return node;\r\n}\r\n\r\n/**\r\n * for each item matching the selector execute the callback\r\n * @param node\r\n * @param selector\r\n * @param callback\r\n * @internal\r\n */\r\nexport function forEach<T extends Element>(node: Element, selector: string, callback: (d: T, i: number) => void) {\r\n  (<T[]>Array.from(node.querySelectorAll(selector))).forEach(callback);\r\n}\r\n\r\n/** @internal */\r\nexport function forEachChild<T extends Element>(node: Element, callback: (d: T, i: number) => void) {\r\n  (<T[]>Array.from(node.children)).forEach(callback);\r\n}\r\n\r\n/**\r\n * matches the columns and the dom nodes representing them\r\n * @param {HTMLElement} node row\r\n * @param columns columns to check\r\n * @internal\r\n */\r\nexport function matchColumns(node: HTMLElement, columns: {column: Column, template: string, rendererId: string}[]) {\r\n  if (node.childElementCount === 0) {\r\n    // initial call fast method\r\n    node.innerHTML = columns.map((c) => c.template).join('');\r\n    const children = Array.from(node.children);\r\n    columns.forEach((col, i) => {\r\n      const cnode = <HTMLElement>children[i];\r\n      // set attribute for finding again\r\n      cnode.dataset.columnId = col.column.id;\r\n      // store current renderer\r\n      cnode.dataset.renderer = col.rendererId;\r\n    });\r\n    return;\r\n  }\r\n\r\n  function matches(c: {column: Column, rendererId: string}, i: number) {\r\n    //do both match?\r\n    const n = <HTMLElement>node.children[i];\r\n    return n != null && n.dataset.columnId === c.column.id && n.dataset.renderer === c.rendererId;\r\n  }\r\n\r\n  if (columns.every(matches)) {\r\n    return; //nothing to do\r\n  }\r\n\r\n  const idsAndRenderer = new Set(columns.map((c) => `${c.column.id}@${c.rendererId}`));\r\n  //remove all that are not existing anymore\r\n  forEachChild(node, (n: HTMLElement) => {\r\n    const id = n.dataset.columnId;\r\n    const renderer = n.dataset.renderer;\r\n    const idAndRenderer = `${id}@${renderer}`;\r\n    if (!idsAndRenderer.has(idAndRenderer)) {\r\n      node.removeChild(n);\r\n    }\r\n  });\r\n  columns.forEach((col) => {\r\n    let cnode = <HTMLElement>node.querySelector(`[data-column-id=\"${col.column.id}\"]`);\r\n    if (!cnode) {\r\n      node.insertAdjacentHTML('beforeend', col.template);\r\n      cnode = <HTMLElement>node.lastElementChild!;\r\n      cnode.dataset.columnId = col.column.id;\r\n      cnode.dataset.renderer = col.rendererId;\r\n    }\r\n    node.appendChild(cnode);\r\n  });\r\n}\r\n\r\n/** @internal */\r\nexport function wideEnough(col: IArrayColumn<any>, length: number = col.labels.length) {\r\n  const w = col.getWidth();\r\n  return w / length > MIN_LABEL_WIDTH; // at least 30 pixel\r\n}\r\n\r\n\r\n/**\r\n * Adapts the text color for a given background color\r\n * @param {string} bgColor as `#ff0000`\r\n * @returns {string} returns `black` or `white` for best contrast\r\n * @internal\r\n */\r\nexport function adaptTextColorToBgColor(bgColor: string): string {\r\n  return hsl(bgColor).l > 0.5 ? 'black' : 'white';\r\n}\r\n\r\n\r\n/**\r\n *\r\n * Adapts the text color for a given background color\r\n * @param {HTMLElement} node the node containing the text\r\n * @param {string} bgColor as `#ff0000`\r\n * @param {string} title the title to render\r\n * @param {number} width for which percentages of the cell this background applies (0..1)\r\n */\r\nexport function adaptDynamicColorToBgColor(node: HTMLElement, bgColor: string, title: string, width: number) {\r\n  const adapt = adaptTextColorToBgColor(bgColor);\r\n  if ((width <= 0.05 || adapt === 'black') || width > 0.9) { // almost empty or full\r\n    node.style.color = adapt === 'black' || width <= 0.05 ? null : adapt; // null = black\r\n    // node.classList.remove('lu-gradient-text');\r\n    // node.style.backgroundImage = null;\r\n    return;\r\n  }\r\n\r\n  node.style.color = null;\r\n  node.innerText = title;\r\n\r\n  console.assert(node.ownerDocument != null);\r\n  const span = node.ownerDocument!.createElement('span');\r\n  span.classList.add('lu-gradient-text');\r\n  span.style.color = adapt;\r\n  span.innerText = title;\r\n  node.appendChild(span);\r\n}\r\n\r\n\r\n\r\nexport const uniqueId: (prefix: string)=>string = (function() {\r\n  // side effect but just within the function itself, so good for the library\r\n  let idCounter = 0;\r\n  return (prefix: string) => `${prefix}${(idCounter++).toString(36)}`;\r\n})();\r\n\r\n\r\nconst NUM_EXAMPLE_VALUES = 5;\r\n\r\n/** @internal */\r\nexport function exampleText(col: Column, rows: IDataRow[]) {\r\n  const examples = <string[]>[];\r\n  for (const row of rows) {\r\n    if (col.isMissing(row)) {\r\n      continue;\r\n    }\r\n    const v = col.getLabel(row);\r\n    examples.push(v);\r\n    if (examples.length >= NUM_EXAMPLE_VALUES) {\r\n      break;\r\n    }\r\n  }\r\n  return `${examples.join(', ')}${examples.length < rows.length ? ', ...' : ''}`;\r\n}\r\n","export default function(specifier) {\n  var n = specifier.length / 6 | 0, colors = new Array(n), i = 0;\n  while (i < n) colors[i] = \"#\" + specifier.slice(i * 6, ++i * 6);\n  return colors;\n}\n","import {format} from 'd3-format';\nimport {equalArrays} from '../internal';\nimport {Category, toolbar, SortByDefault, dialogAddons} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IDataRow, IGroup, IGroupData} from './interfaces';\nimport {groupCompare} from './internal';\nimport {\n  default as INumberColumn, EAdvancedSortMethod, INumberDesc, INumberFilter, isEqualNumberFilter,\n  isNumberIncluded, noNumberFilter, numberCompare, isDummyNumberFilter, restoreNumberFilter\n} from './INumberColumn';\nimport {\n  createMappingFunction, IMapAbleColumn, IMappingFunction, restoreMapping,\n  ScaleMappingFunction\n} from './MappingFunction';\nimport {isMissingValue, isUnknown, missingGroup} from './missing';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {IColorMappingFunction, createColorMappingFunction, restoreColorMapping} from './ColorMappingFunction';\n\nexport {default as INumberColumn, isNumberColumn} from './INumberColumn';\n\n\nexport declare type INumberColumnDesc = INumberDesc & IValueColumnDesc<number>;\n\n\n/**\n * emitted when the mapping property changes\n * @asMemberOf NumberColumn\n * @event\n */\nexport declare function mappingChanged(previous: IMappingFunction, current: IMappingFunction): void;\n\n/**\n * emitted when the color mapping property changes\n * @asMemberOf NumberColumn\n * @event\n */\nexport declare function colorMappingChanged(previous: IColorMappingFunction, current: IColorMappingFunction): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf NumberColumn\n * @event\n */\nexport declare function filterChanged(previous: INumberFilter | null, current: INumberFilter | null): void;\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf NumberColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: EAdvancedSortMethod, current: EAdvancedSortMethod): void;\n\n/**\n * emitted when the grouping property changes\n * @asMemberOf NumberColumn\n * @event\n */\nexport declare function groupingChanged(previous: number[], current: number[]): void;\n\n/**\n * a number column mapped from an original input scale to an output range\n */\n@toolbar('groupBy', 'sortGroupBy', 'filterNumber', 'colorMapped', 'editMapping')\n@dialogAddons('sortGroup', 'sortNumber')\n@dialogAddons('group', 'groupNumber')\n@Category('number')\n@SortByDefault('descending')\nexport default class NumberColumn extends ValueColumn<number> implements INumberColumn, IMapAbleColumn {\n  static readonly EVENT_MAPPING_CHANGED = 'mappingChanged';\n  static readonly EVENT_COLOR_MAPPING_CHANGED = 'colorMappingChanged';\n  static readonly EVENT_FILTER_CHANGED = 'filterChanged';\n  static readonly EVENT_SORTMETHOD_CHANGED = 'sortMethodChanged';\n  static readonly EVENT_GROUPING_CHANGED = 'groupingChanged';\n\n  private readonly missingValue: number;\n\n  private mapping: IMappingFunction;\n  private colorMapping: IColorMappingFunction;\n  private original: IMappingFunction;\n\n  /**\n   * currently active filter\n   * @type {{min: number, max: number}}\n   * @private\n   */\n  private currentFilter: INumberFilter = noNumberFilter();\n\n  private numberFormat: (n: number) => string = format('.2f');\n\n  private currentGroupThresholds: number[] = [];\n  private groupSortMethod: EAdvancedSortMethod = EAdvancedSortMethod.median;\n\n  constructor(id: string, desc: INumberColumnDesc) {\n    super(id, desc);\n\n    this.mapping = restoreMapping(desc);\n    this.original = this.mapping.clone();\n    this.colorMapping = restoreColorMapping(desc);\n\n    if (desc.numberFormat) {\n      this.numberFormat = format(desc.numberFormat);\n    }\n    this.missingValue = desc.missingValue != null ? desc.missingValue : NaN;\n\n    this.setGroupRenderer('boxplot');\n    this.setDefaultSummaryRenderer('histogram');\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.map = this.mapping.dump();\n    r.colorMapping = this.colorMapping.dump();\n    r.filter = isDummyNumberFilter(this.currentFilter) ? null : this.currentFilter;\n    r.groupSortMethod = this.groupSortMethod;\n    if (this.currentGroupThresholds) {\n      r.stratifyThreshholds = this.currentGroupThresholds;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.map) {\n      this.mapping = createMappingFunction(dump.map);\n    } else if (dump.domain) {\n      this.mapping = new ScaleMappingFunction(dump.domain, 'linear', dump.range || [0, 1]);\n    }\n    if (dump.colorMapping) {\n      this.colorMapping = createColorMappingFunction(dump.colorMapping);\n    }\n    if (dump.groupSortMethod) {\n      this.groupSortMethod = dump.groupSortMethod;\n    }\n    if (dump.filter) {\n      this.currentFilter = restoreNumberFilter(dump.filter);\n    }\n    if (dump.stratifyThreshholds) {\n      this.currentGroupThresholds = dump.stratifyThresholds;\n    }\n    if (dump.numberFormat) {\n      this.numberFormat = format(dump.numberFormat);\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([NumberColumn.EVENT_MAPPING_CHANGED, NumberColumn.EVENT_COLOR_MAPPING_CHANGED, NumberColumn.EVENT_FILTER_CHANGED, NumberColumn.EVENT_SORTMETHOD_CHANGED, NumberColumn.EVENT_GROUPING_CHANGED]);\n  }\n\n  on(type: typeof NumberColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof NumberColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof NumberColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof NumberColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof NumberColumn.EVENT_GROUPING_CHANGED, listener: typeof groupingChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this;\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getLabel(row: IDataRow) {\n    if ((<any>this.desc).numberFormat) {\n      const raw = this.getRawValue(row);\n      //if a dedicated format and a number use the formatter in any case\n      if (isNaN(raw)) {\n        return 'NaN';\n      }\n      if (!isFinite(raw)) {\n        return raw.toString();\n      }\n      return this.numberFormat(raw);\n    }\n    const v = super.getValue(row);\n    //keep non number if it is not a number else convert using formatter\n    if (typeof v === 'number') {\n      return this.numberFormat(+v);\n    }\n    return String(v);\n  }\n\n  getRange() {\n    return this.mapping.getRange(this.numberFormat);\n  }\n\n  getRawValue(row: IDataRow, missingValue = this.missingValue) {\n    const v: any = super.getValue(row);\n    if (isMissingValue(v)) {\n      return missingValue;\n    }\n    return +v;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    return format === 'json' ? this.getRawValue(row) : super.getExportValue(row, format);\n  }\n\n  isMissing(row: IDataRow) {\n    return isMissingValue(super.getValue(row));\n  }\n\n  getValue(row: IDataRow) {\n    const v = this.getRawValue(row);\n    if (isNaN(v)) {\n      return v;\n    }\n    return this.mapping.apply(v);\n  }\n\n  getNumber(row: IDataRow) {\n    return this.getValue(row);\n  }\n\n  getRawNumber(row: IDataRow, missingValue = this.missingValue) {\n    return this.getRawValue(row, missingValue);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return numberCompare(this.getNumber(a), this.getNumber(b), this.isMissing(a), this.isMissing(b));\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData): number {\n    return groupCompare(a.rows, b.rows, this, <any>this.groupSortMethod);\n  }\n\n  getOriginalMapping() {\n    return this.original.clone();\n  }\n\n  getMapping() {\n    return this.mapping.clone();\n  }\n\n  setMapping(mapping: IMappingFunction) {\n    if (this.mapping.eq(mapping)) {\n      return;\n    }\n    this.fire([NumberColumn.EVENT_MAPPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], this.mapping.clone(), this.mapping = mapping);\n  }\n\n  getColor(row: IDataRow) {\n    const v = this.getNumber(row);\n    if (isNaN(v)) {\n      return Column.DEFAULT_COLOR;\n    }\n    return this.colorMapping.apply(v);\n  }\n\n  getColorMapping() {\n    return this.colorMapping.clone();\n  }\n\n  setColorMapping(mapping: IColorMappingFunction) {\n    if (this.colorMapping.eq(mapping)) {\n      return;\n    }\n    this.fire([NumberColumn.EVENT_COLOR_MAPPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], this.colorMapping.clone(), this.colorMapping = mapping);\n  }\n\n  isFiltered() {\n    return !isDummyNumberFilter(this.currentFilter);\n  }\n\n  getFilter(): INumberFilter {\n    return Object.assign({}, this.currentFilter);\n  }\n\n  setFilter(value: INumberFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    if (isEqualNumberFilter(value, this.currentFilter)) {\n      return;\n    }\n    const bak = this.getFilter();\n    this.currentFilter.min = isUnknown(value.min) ? -Infinity : value.min;\n    this.currentFilter.max = isUnknown(value.max) ? Infinity : value.max;\n    this.currentFilter.filterMissing = value.filterMissing;\n    this.fire([NumberColumn.EVENT_FILTER_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, this.getFilter());\n  }\n\n  /**\n   * filter the current row if any filter is set\n   * @param row\n   * @returns {boolean}\n   */\n  filter(row: IDataRow) {\n    return isNumberIncluded(this.currentFilter, this.getRawNumber(row, NaN));\n  }\n\n  getGroupThresholds() {\n    return this.currentGroupThresholds.slice();\n  }\n\n  setGroupThresholds(value: number[]) {\n    if (equalArrays(this.currentGroupThresholds, value)) {\n      return;\n    }\n    const bak = this.getGroupThresholds();\n    this.currentGroupThresholds = value.slice();\n    this.fire([NumberColumn.EVENT_GROUPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, value);\n  }\n\n\n  group(row: IDataRow): IGroup {\n    if (this.isMissing(row)) {\n      return missingGroup;\n    }\n\n    let threshold = this.currentGroupThresholds;\n    if (threshold.length === 0) {\n      // default threshold\n      const d = this.mapping.domain;\n      threshold = [(d[1] - d[0]) / 2];\n    }\n\n    const value = this.getRawNumber(row);\n    const treshholdIndex = threshold.findIndex((t) => value <= t);\n    // group by thresholds / bins\n    switch (treshholdIndex) {\n      case -1:\n        //bigger than the last threshold\n        return {\n          name: `${this.label} > ${threshold[threshold.length - 1]}`,\n          color: this.colorMapping.apply(1)\n        };\n      case 0:\n        //smallest\n        return {\n          name: `${this.label} <= ${threshold[0]}`,\n          color: this.colorMapping.apply(0)\n        };\n      default:\n        return {\n          name: `${threshold[treshholdIndex - 1]} <= ${this.label} <= ${threshold[treshholdIndex]}`,\n          color: this.colorMapping.apply(this.mapping.apply((threshold[treshholdIndex - 1] + threshold[treshholdIndex]) / 2))\n        };\n    }\n  }\n\n  getSortMethod() {\n    return this.groupSortMethod;\n  }\n\n  setSortMethod(sortMethod: EAdvancedSortMethod) {\n    if (this.groupSortMethod === sortMethod) {\n      return;\n    }\n    this.fire([NumberColumn.EVENT_SORTMETHOD_CHANGED], this.groupSortMethod, this.groupSortMethod = sortMethod);\n    // sort by me if not already sorted by me\n    if (!this.isGroupSortedByMe().asc) {\n      this.toggleMyGroupSorting();\n    }\n  }\n}\n","import {IGroup} from './interfaces';\r\n\r\n\r\nexport function isMissingValue(v: any): boolean {\r\n  return typeof(v) === 'undefined' || v == null || (typeof v === 'number' && isNaN(v)) || v === '' || v === 'NA' || v === 'NaN' || (typeof(v) === 'string' && (v.toLowerCase() === 'na') || (Array.isArray(v) && v.every((v) => isMissingValue(v))));\r\n}\r\n\r\nexport function isUnknown(v?: number | null) {\r\n  return v == null || v === undefined || isNaN(v);\r\n}\r\n\r\nexport const FIRST_IS_NAN = -1;\r\nexport const FIRST_IS_MISSING = 1;\r\n\r\n\r\nexport const missingGroup: IGroup = {\r\n  name: 'Missing values',\r\n  color: 'gray'\r\n};\r\n","import * as vars from 'raw-loader!./_vars.scss';\r\n\r\nconst styles = new Map<string, string>();\r\n{\r\n  const r = /^[$]([\\w]+): ([\\w #.()'\\/,-]+)( !default)?;/gmi;\r\n  const s = String(vars);\r\n\r\n  let m: RegExpMatchArray | null = s.match(r);\r\n  while (m != null) {\r\n    styles.set(m[1], m[2]);\r\n    m = s.match(r);\r\n  }\r\n}\r\n\r\nexport default function getStyle(key: string, defaultValue = '') {\r\n  if (key[0] === '$') {\r\n    key = key.slice(1);\r\n  }\r\n  if (styles.has(key)) {\r\n    return styles.get(key)!;\r\n  }\r\n  return defaultValue;\r\n}\r\n\r\n\r\nexport const COLUMN_PADDING = parseInt(getStyle('lu_engine_grip_gap', '5px'), 10);\r\n\r\nexport const DASH = {\r\n  width: parseInt(getStyle('lu_missing_dash_width', '3px'), 10),\r\n  height: parseInt(getStyle('lu_missing_dash_height', '10px'), 10),\r\n  color: getStyle('lu_missing_dash_color', 'gray')\r\n};\r\n\r\nexport const UPSET = {\r\n  circle: getStyle('lu_renderer_upset_circle_color'),\r\n  inactive: parseFloat(getStyle('lu_renderer_upset_inactive_opacity', '0.1')),\r\n  stroke: getStyle('lu_renderer_upset_stroke')\r\n};\r\n\r\nexport const DOT = {\r\n  color: getStyle('lu_renderer_dot_color', 'gray'),\r\n  size: parseInt(getStyle('lu_renderer_dot_size', '5px'), 10),\r\n  opacity: parseFloat(getStyle('lu_renderer_dot_opacity', '0.7'))\r\n};\r\n\r\nexport const BOX_PLOT = {\r\n  box: getStyle('lu_renderer_boxplot_box', '#e0e0e0'),\r\n  stroke: getStyle('lu_renderer_boxplot_stroke', 'black'),\r\n  sort: getStyle('lu_renderer_boxplot_sort_indicator', '#ffa500'),\r\n  outlier: getStyle('lu_renderer_boxplot_outlier', '#e0e0e0')\r\n};\r\n\r\nexport const AGGREGATE = {\r\n  width: parseInt(getStyle('lu_aggregate_square_bracket_width', '4px'), 10),\r\n  strokeWidth: parseInt(getStyle('lu_aggregate_square_bracket_stroke_width', '1px'), 10),\r\n  color: getStyle('lu_aggregate_square_bracket_stroke_color', '#000')\r\n};\r\n\r\nexport const SLOPEGRAPH_WIDTH = parseInt(getStyle('lu_slopw_width', '200px'), 10);\r\nexport const CANVAS_HEIGHT = 4;\r\n","import {ICategoricalStatistics, IStatistics} from '../internal/math';\r\nimport {ICategoricalColumn, IDataRow, IGroup, INumberColumn} from '../model';\r\nimport Column from '../model/Column';\r\nimport {IDataProvider} from '../provider/ADataProvider';\r\nimport DialogManager from '../ui/dialogs/DialogManager';\r\n\r\nexport interface IImposer {\r\n  color?(row: IDataRow | null, valueHint?: number): string | null;\r\n}\r\n\r\n\r\n/**\r\n * a cell renderer for rendering a cell of specific column\r\n */\r\nexport interface ICellRenderer {\r\n  /**\r\n   * template as a basis for the update\r\n   */\r\n  readonly template: string;\r\n\r\n  /**\r\n   * update a given node (create using the template) with the given data\r\n   * @param node the node to update\r\n   * @param d the data item\r\n   * @param i the order relative index\r\n   * @param group the group this row is part of\r\n   */\r\n  update(node: HTMLElement, d: IDataRow, i: number, group: IGroup): void;\r\n\r\n  render(ctx: CanvasRenderingContext2D, d: IDataRow, i: number, group: IGroup): void;\r\n}\r\n\r\n/**\r\n * a cell renderer for rendering a cell of specific column\r\n */\r\nexport interface IGroupCellRenderer {\r\n  /**\r\n   * template as a basis for the update\r\n   */\r\n  readonly template: string;\r\n\r\n  /**\r\n   * update a given node (create using the template) with the given data\r\n   * @param node the node to update\r\n   * @param group the group to render\r\n   * @param rows the data items\r\n   */\r\n  update(node: HTMLElement, group: IGroup, rows: IDataRow[]): void;\r\n}\r\n\r\nexport interface ISummaryRenderer {\r\n  /**\r\n   * template as a basis for the update\r\n   */\r\n  readonly template: string;\r\n\r\n  update(node: HTMLElement, hist: IStatistics | ICategoricalStatistics | null): void;\r\n}\r\n\r\n\r\n/**\r\n * context for rendering, wrapped as an object for easy extensibility\r\n */\r\nexport interface IRenderContext {\r\n  /**\r\n   * render a column\r\n   * @param col\r\n   */\r\n  renderer(col: Column, imposer?: IImposer): ICellRenderer;\r\n\r\n  /**\r\n   * render a column\r\n   * @param col\r\n   */\r\n  groupRenderer(col: Column, imposer?: IImposer): IGroupCellRenderer;\r\n\r\n  summaryRenderer(co: Column, interactive: boolean, imposer?: IImposer): ISummaryRenderer;\r\n\r\n  statsOf(col: (INumberColumn | ICategoricalColumn) & Column): ICategoricalStatistics | IStatistics | null;\r\n\r\n  /**\r\n   * prefix used for all generated id names\r\n   */\r\n  readonly idPrefix: string;\r\n\r\n  /**\r\n   * lookup custom options by key\r\n   * @param key key to lookup\r\n   * @param defaultValue default value\r\n   */\r\n  option<T>(key: string, defaultValue: T): T;\r\n\r\n  readonly totalNumberOfRows: number;\r\n\r\n  colWidth(col: Column): number;\r\n\r\n  readonly provider: IDataProvider;\r\n  readonly dialogManager: DialogManager;\r\n}\r\n\r\nexport enum ERenderMode {\r\n  CELL, GROUP, SUMMARY\r\n}\r\n\r\n\r\nexport interface ICellRendererFactory {\r\n  readonly title: string;\r\n  readonly groupTitle?: string;\r\n  readonly summaryTitle?: string;\r\n\r\n  canRender(col: Column, mode: ERenderMode): boolean;\r\n\r\n  create(col: Column, context: IRenderContext, hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer): ICellRenderer;\r\n\r\n  createGroup(col: Column, context: IRenderContext, hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer): IGroupCellRenderer;\r\n\r\n  createSummary(col: Column, context: IRenderContext, interactive: boolean, imposer?: IImposer): ISummaryRenderer;\r\n}\r\n\r\n\r\nexport default IRenderContext;\r\n","import {IDataRow} from '../model';\r\nimport Column from '../model/Column';\r\nimport {CANVAS_HEIGHT, DASH} from '../styles';\r\n\r\nexport function renderMissingValue(ctx: CanvasRenderingContext2D, width: number, height: number, x = 0, y = 0) {\r\n\r\n  const dashX = Math.max(0, x + (width - DASH.width) / 2); // center horizontally\r\n  const dashY = Math.max(0, y + (height - DASH.height) / 2); // center vertically\r\n  ctx.fillStyle = DASH.color;\r\n  ctx.fillRect(dashX, dashY, Math.min(width, DASH.width), Math.min(height, DASH.height));\r\n}\r\n\r\nexport function renderMissingDOM(node: HTMLElement, col: Column, d: IDataRow) {\r\n  const missing = col.isMissing(d);\r\n  node.classList.toggle('lu-missing', missing);\r\n  return missing;\r\n}\r\n\r\nexport function renderMissingCanvas(ctx: CanvasRenderingContext2D, col: Column, d: IDataRow, width: number, x = 0, y = 0) {\r\n  const missing = col.isMissing(d);\r\n  if (missing) {\r\n    renderMissingValue(ctx, width, CANVAS_HEIGHT, x, y);\r\n  }\r\n  return missing;\r\n}\r\n","import {equalArrays, fixCSS} from '../internal';\nimport AEventDispatcher, {suffix} from '../internal/AEventDispatcher';\nimport {isSortingAscByDefault} from './annotations';\nimport Column, {IColumnParent, IFlatColumn, visibilityChanged, dirtyValues, dirtyHeader, labelChanged, widthChanged, dirty} from './Column';\nimport {defaultGroup, IOrderedGroup} from './Group';\nimport {IDataRow, IGroup, IGroupData} from './interfaces';\nimport {joinGroups} from './internal';\nimport NumberColumn, {filterChanged} from './NumberColumn';\nimport CompositeColumn from './CompositeColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport interface ISortCriteria {\n  readonly col: Column;\n  readonly asc: boolean;\n}\n\n\n/**\n * emitted when a column has been added\n * @asMemberOf Ranking\n * @event\n */\nexport declare function addColumn(col: Column, index: number): void;\n\n/**\n * emitted when a column has been moved within this composite columm\n * @asMemberOf Ranking\n * @event\n */\nexport declare function moveColumn(col: Column, index: number, oldIndex: number): void;\n\n/**\n * emitted when a column has been removed\n * @asMemberOf Ranking\n * @event\n */\nexport declare function removeColumn(col: Column, index: number): void;\n/**\n * emitted when the sort criteria propery changes\n * @asMemberOf Ranking\n * @event\n */\nexport declare function sortCriteriaChanged(previous: ISortCriteria[], current: ISortCriteria[]): void;\n/**\n * emitted when the sort criteria propery changes\n * @asMemberOf Ranking\n * @event\n */\nexport declare function groupCriteriaChanged(previous: Column[], current: Column[]): void;\n/**\n * emitted when the sort criteria propery changes\n * @asMemberOf Ranking\n * @event\n */\nexport declare function groupSortCriteriaChanged(previous: ISortCriteria[], current: ISortCriteria[]): void;\n/**\n * emitted when the sort criteria propery changes\n * @asMemberOf Ranking\n * @event\n */\nexport declare function dirtyOrder(): void;\n/**\n * @asMemberOf Ranking\n * @event\n */\nexport declare function orderChanged(previous: number[], current: number[], previousGroups: IOrderedGroup[], currentGroups: IOrderedGroup[]): void;\n/**\n * @asMemberOf Ranking\n * @event\n */\nexport declare function groupsChanged(previous: number[], current: number[], previousGroups: IOrderedGroup[], currentGroups: IOrderedGroup[]): void;\n\n/**\n * a ranking\n */\nexport default class Ranking extends AEventDispatcher implements IColumnParent {\n  static readonly EVENT_WIDTH_CHANGED = Column.EVENT_WIDTH_CHANGED;\n  static readonly EVENT_FILTER_CHANGED = NumberColumn.EVENT_FILTER_CHANGED;\n  static readonly EVENT_LABEL_CHANGED = Column.EVENT_LABEL_CHANGED;\n  static readonly EVENT_ADD_COLUMN = CompositeColumn.EVENT_ADD_COLUMN;\n  static readonly EVENT_MOVE_COLUMN = CompositeColumn.EVENT_MOVE_COLUMN;\n  static readonly EVENT_REMOVE_COLUMN = CompositeColumn.EVENT_REMOVE_COLUMN;\n  static readonly EVENT_DIRTY = Column.EVENT_DIRTY;\n  static readonly EVENT_DIRTY_HEADER = Column.EVENT_DIRTY_HEADER;\n  static readonly EVENT_DIRTY_VALUES = Column.EVENT_DIRTY_VALUES;\n  static readonly EVENT_COLUMN_VISIBILITY_CHANGED = Column.EVENT_VISIBILITY_CHANGED;\n  static readonly EVENT_SORT_CRITERIA_CHANGED = 'sortCriteriaChanged';\n  static readonly EVENT_GROUP_CRITERIA_CHANGED = 'groupCriteriaChanged';\n  static readonly EVENT_GROUP_SORT_CRITERIA_CHANGED = 'groupSortCriteriaChanged';\n  static readonly EVENT_DIRTY_ORDER = 'dirtyOrder';\n  static readonly EVENT_ORDER_CHANGED = 'orderChanged';\n  static readonly EVENT_GROUPS_CHANGED = 'groupsChanged';\n\n\n  private label: string;\n  /**\n   * the list of sort criteria\n   * @type {Array}\n   */\n  private readonly sortCriteria: ISortCriteria[] = [];\n  private readonly groupSortCriteria: ISortCriteria[] = [];\n\n  private readonly groupColumns: Column[] = [];\n\n  /**\n   * columns of this ranking\n   * @type {Array}\n   * @private\n   */\n  private readonly columns: Column[] = [];\n\n  readonly comparator = (a: IDataRow, b: IDataRow) => {\n    if (this.sortCriteria.length === 0) {\n      return a.i - b.i;\n    }\n    for (const sort of this.sortCriteria) {\n      const r = sort.col!.compare(a, b);\n      if (r !== 0) {\n        return sort.asc ? r : -r;\n      }\n    }\n    return a.i - b.i; //to have a deterministic order\n  };\n\n  readonly groupComparator = (a: IGroupData, b: IGroupData) => {\n    if (this.groupSortCriteria.length === 0) {\n      return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n    }\n    for (const sort of this.groupSortCriteria) {\n      const r = sort.col!.groupCompare(a, b);\n      if (r !== 0) {\n        return sort.asc ? r : -r;\n      }\n    }\n    return a.name.localeCompare(b.name);\n  };\n\n  readonly grouper = (row: IDataRow): IGroup => {\n    const g = this.groupColumns;\n    switch (g.length) {\n      case 0:\n        return defaultGroup;\n      case 1:\n        return g[0].group(row);\n      default:\n        const groups = g.map((gi) => gi.group(row));\n        return joinGroups(groups);\n    }\n  };\n\n  readonly dirtyOrder = () => {\n    this.fire([Ranking.EVENT_DIRTY_ORDER, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], this.getSortCriteria(), this.getGroupSortCriteria(), this.getGroupCriteria());\n  };\n\n  /**\n   * the current ordering as an sorted array of indices\n   * @type {Array}\n   */\n  private groups: IOrderedGroup[] = [Object.assign({order: <number[]>[]}, defaultGroup)];\n\n  constructor(public id: string, private maxSortCriteria = 2, private maxGroupColumns = 1) {\n    super();\n    this.id = fixCSS(id);\n    this.label = `Ranking ${id.startsWith('rank') ? id.slice(4) : id}`;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([\n      Ranking.EVENT_WIDTH_CHANGED, Ranking.EVENT_FILTER_CHANGED,\n      Ranking.EVENT_LABEL_CHANGED, Ranking.EVENT_GROUPS_CHANGED,\n      Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_REMOVE_COLUMN, Ranking.EVENT_GROUP_CRITERIA_CHANGED, Ranking.EVENT_MOVE_COLUMN,\n      Ranking.EVENT_DIRTY, Ranking.EVENT_DIRTY_HEADER, Ranking.EVENT_DIRTY_VALUES,\n      Ranking.EVENT_GROUP_SORT_CRITERIA_CHANGED, Ranking.EVENT_COLUMN_VISIBILITY_CHANGED,\n      Ranking.EVENT_SORT_CRITERIA_CHANGED, Ranking.EVENT_DIRTY_ORDER, Ranking.EVENT_ORDER_CHANGED]);\n  }\n\n  on(type: typeof Ranking.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Ranking.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof Ranking.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Ranking.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof Ranking.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof Ranking.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Ranking.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Ranking.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Ranking.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Ranking.EVENT_COLUMN_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: typeof Ranking.EVENT_SORT_CRITERIA_CHANGED, listener: typeof sortCriteriaChanged | null): this;\n  on(type: typeof Ranking.EVENT_GROUP_CRITERIA_CHANGED, listener: typeof groupCriteriaChanged | null): this;\n  on(type: typeof Ranking.EVENT_GROUP_SORT_CRITERIA_CHANGED, listener: typeof groupSortCriteriaChanged | null): this;\n  on(type: typeof Ranking.EVENT_DIRTY_ORDER, listener: typeof dirtyOrder | null): this;\n  on(type: typeof Ranking.EVENT_ORDER_CHANGED, listener: typeof orderChanged | null): this;\n  on(type: typeof Ranking.EVENT_GROUPS_CHANGED, listener: typeof groupsChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  assignNewId(idGenerator: () => string) {\n    this.id = fixCSS(idGenerator());\n    this.columns.forEach((c) => c.assignNewId(idGenerator));\n  }\n\n  getLabel() {\n    return this.label;\n  }\n\n  setLabel(value: string) {\n    if (value === this.label) {\n      return;\n    }\n    this.fire(Ranking.EVENT_LABEL_CHANGED, this.label, this.label = value);\n  }\n\n  setOrder(order: number[]) {\n    this.setGroups([Object.assign({order}, defaultGroup)]);\n  }\n\n  setGroups(groups: IOrderedGroup[]) {\n    const old = this.getOrder();\n    const oldGroups = this.groups;\n    this.groups = groups;\n    this.fire([Ranking.EVENT_ORDER_CHANGED, Ranking.EVENT_GROUPS_CHANGED, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], old, this.getOrder(), oldGroups, groups);\n  }\n\n  getOrder() {\n    switch (this.groups.length) {\n      case 0:\n        return [];\n      case 1:\n        return this.groups[0].order;\n      default:\n        return (<number[]>[]).concat(...this.groups.map((g) => g.order));\n    }\n  }\n\n  getGroups() {\n    return this.groups.slice();\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r: any = {};\n    r.columns = this.columns.map((d) => d.dump(toDescRef));\n    r.sortCriteria = this.sortCriteria.map((s) => ({asc: s.asc, sortBy: s.col!.id}));\n    r.groupSortCriteria = this.groupSortCriteria.map((s) => ({asc: s.asc, sortBy: s.col!.id}));\n    r.groupColumns = this.groupColumns.map((d) => d.id);\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    this.clear();\n    dump.columns.map((child: any) => {\n      const c = factory(child);\n      if (c) {\n        this.push(c);\n      }\n    });\n    // compatibility case\n    if (dump.sortColumn && dump.sortColumn.sortBy) {\n      const help = this.columns.find((d) => d.id === dump.sortColumn.sortBy);\n      if (help) {\n        this.sortBy(help, dump.sortColumn.asc);\n      }\n    }\n    if (dump.groupColumns) {\n      const groupColumns = dump.groupColumns.map((id: string) => this.columns.find((d) => d.id === id));\n      this.groupBy(groupColumns);\n    }\n\n    const restoreSortCriteria = (dumped: any) => {\n      return dumped.map((s: { asc: boolean, sortBy: string }) => {\n        return {\n          asc: s.asc,\n          col: this.columns.find((d) => d.id === s.sortBy) || null\n        };\n      }).filter((s: any) => s.col);\n    };\n\n    if (dump.sortCriteria) {\n      this.setSortCriteria(restoreSortCriteria(dump.sortCriteria));\n    }\n\n    if (dump.groupSortCriteria) {\n      this.setGroupSortCriteria(restoreSortCriteria(dump.groupSortCriteria));\n    }\n  }\n\n  flatten(r: IFlatColumn[], offset: number, levelsToGo = 0, padding = 0) {\n    let acc = offset; // + this.getWidth() + padding;\n    if (levelsToGo > 0 || levelsToGo <= Column.FLAT_ALL_COLUMNS) {\n      this.columns.forEach((c) => {\n        if (c.getVisible() && levelsToGo <= Column.FLAT_ALL_COLUMNS) {\n          acc += c.flatten(r, acc, levelsToGo - 1, padding) + padding;\n        }\n      });\n    }\n    return acc - offset;\n  }\n\n  getPrimarySortCriteria(): ISortCriteria | null {\n    if (this.sortCriteria.length === 0) {\n      return null;\n    }\n    return this.sortCriteria[0];\n  }\n\n  getSortCriteria(): ISortCriteria[] {\n    return this.sortCriteria.map((d) => Object.assign({}, d));\n  }\n\n  getGroupSortCriteria(): ISortCriteria[] {\n    return this.groupSortCriteria.map((d) => Object.assign({}, d));\n  }\n\n  toggleSorting(col: Column) {\n    return this.setSortCriteria(this.toggleSortingLogic(col, this.sortCriteria));\n  }\n\n  private toggleSortingLogic(col: Column, sortCriteria: ISortCriteria[]) {\n    const newSort = sortCriteria.slice();\n    const current = newSort.findIndex((d) => d.col === col);\n    const defaultAsc = isSortingAscByDefault(col);\n\n    if (current < 0) {\n      newSort.splice(0, newSort.length, {col, asc: defaultAsc});\n    } else if (newSort[current].asc === defaultAsc) {\n      // asc -> desc, or desc -> asc\n      newSort.splice(current, 1, {col, asc: !defaultAsc});\n    } else {\n      // remove\n      newSort.splice(current, 1);\n    }\n    return newSort;\n  }\n\n  toggleGrouping(col: Column) {\n    const old = this.groupColumns.indexOf(col);\n    if (old >= 0) {\n      const newGroupings = this.groupColumns.slice();\n      newGroupings.splice(old, 1);\n      return this.setGroupCriteria(newGroupings);\n    }\n    return this.setGroupCriteria([col]);\n  }\n\n  getGroupCriteria() {\n    return this.groupColumns.slice();\n  }\n\n  /**\n   * replaces, moves, or remove the given column in the sorting hierarchy\n   * @param col {Column}\n   * @param priority {number} when priority < 0 remove the column only else replace at the given priority\n   */\n  sortBy(col: Column, ascending: boolean = false, priority: number = 0) {\n    if (col.findMyRanker() !== this) {\n      return false; //not one of mine\n    }\n    return this.setSortCriteria(this.hierarchyLogic(this.sortCriteria, this.sortCriteria.findIndex((d) => d.col === col), {col, asc: ascending}, priority));\n  }\n\n  /**\n   * replaces, moves, or remove the given column in the group sorting hierarchy\n   * @param col {Column}\n   * @param priority {number} when priority < 0 remove the column only else replace at the given priority\n   */\n  groupSortBy(col: Column, ascending: boolean = false, priority: number = 0) {\n    if (col.findMyRanker() !== this) {\n      return false; //not one of mine\n    }\n    return this.setGroupSortCriteria(this.hierarchyLogic(this.groupSortCriteria, this.groupSortCriteria.findIndex((d) => d.col === col), {col, asc: ascending}, priority));\n  }\n\n  private hierarchyLogic<T>(entries: T[], index: number, entry: T, priority: number) {\n    entries = entries.slice();\n    if (index >= 0) {\n      // move at the other position\n      entries.splice(index, 1);\n      if (priority >= 0) {\n        entries.splice(Math.min(priority, entries.length), 0, entry);\n      }\n    } else if (priority >= 0) {\n      entries[Math.min(priority, entries.length)] = entry;\n    }\n    return entries;\n  }\n\n  /**\n   * replaces, moves, or remove the given column in the grouping hierarchy\n   * @param col {Column}\n   * @param priority {number} when priority < 0 remove the column only else replace at the given priority\n   */\n  groupBy(col: Column, priority: number = 0): boolean {\n    if (col.findMyRanker() !== this) {\n      return false; //not one of mine\n    }\n    return this.setGroupCriteria(this.hierarchyLogic(this.groupColumns, this.groupColumns.indexOf(col), col, priority));\n  }\n\n  setSortCriteria(value: ISortCriteria | ISortCriteria[]) {\n    const values = Array.isArray(value) ? value.slice() : [value];\n    // trim\n    if (values.length > this.maxSortCriteria) {\n      values.splice(this.maxSortCriteria, values.length - this.maxSortCriteria);\n    }\n    const bak = this.sortCriteria.slice();\n\n    if (equalCriteria(values, bak)) {\n      return false;\n    }\n\n    // update listener\n    bak.forEach((d) => {\n      d.col.on(`${Column.EVENT_DIRTY_VALUES}.order`, null!);\n      d.col.on(`${NumberColumn.EVENT_SORTMETHOD_CHANGED}.order`, null!);\n    });\n\n    values.forEach((d) => {\n      d.col.on(`${Column.EVENT_DIRTY_VALUES}.order`, this.dirtyOrder);\n      d.col.on(`${NumberColumn.EVENT_SORTMETHOD_CHANGED}.order`, this.dirtyOrder);\n    });\n    this.sortCriteria.splice(0, this.sortCriteria.length, ...values.slice());\n    this.triggerResort(bak);\n    return true;\n  }\n\n  setGroupCriteria(column: Column[]|Column) {\n    let cols = Array.isArray(column) ? column : [column];\n\n    // trim\n    if (cols.length > this.maxGroupColumns) {\n      cols = cols.slice(0, this.maxGroupColumns);\n    }\n\n    if (equalArrays(this.groupColumns, cols)) {\n      return true; //same\n    }\n    this.groupColumns.forEach((groupColumn) => {\n      groupColumn.on(suffix('.group', Column.EVENT_DIRTY_VALUES, NumberColumn.EVENT_SORTMETHOD_CHANGED, NumberColumn.EVENT_GROUPING_CHANGED), null);\n    });\n\n    const bak = this.groupColumns.slice();\n    this.groupColumns.splice(0, this.groupColumns.length, ...cols);\n\n    this.groupColumns.forEach((groupColumn) => {\n      groupColumn.on(suffix('.group', Column.EVENT_DIRTY_VALUES, NumberColumn.EVENT_SORTMETHOD_CHANGED, NumberColumn.EVENT_GROUPING_CHANGED), this.dirtyOrder);\n    });\n\n    this.fire([Ranking.EVENT_GROUP_CRITERIA_CHANGED, Ranking.EVENT_DIRTY_ORDER, Ranking.EVENT_DIRTY_HEADER,\n      Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], bak, this.getGroupCriteria());\n    return true;\n  }\n\n  toggleGroupSorting(col: Column) {\n    return this.setGroupSortCriteria(this.toggleSortingLogic(col, this.groupSortCriteria));\n  }\n\n  setMaxSortCriteria(maxSortCriteria: number) {\n    const old = this.maxSortCriteria;\n    if (old === maxSortCriteria) {\n      return;\n    }\n    this.maxSortCriteria = maxSortCriteria;\n    if (old < maxSortCriteria || this.sortCriteria.length < maxSortCriteria) {\n      return;\n    }\n    // check if we have to slice\n    this.setSortCriteria(this.sortCriteria.slice(0, maxSortCriteria));\n  }\n\n  getMaxSortCriteria() {\n    return this.maxSortCriteria;\n  }\n\n  setMaxGroupColumns(maxGroupColumns: number) {\n    const old = this.maxGroupColumns;\n    if (old === maxGroupColumns) {\n      return;\n    }\n    this.maxGroupColumns = maxGroupColumns;\n    if (old < maxGroupColumns || this.groupColumns.length < maxGroupColumns) {\n      return;\n    }\n    // check if we have to slice\n    this.setGroupCriteria(this.groupColumns.slice(0, maxGroupColumns));\n  }\n\n  getMaxGroupColumns() {\n    return this.maxGroupColumns;\n  }\n\n  setGroupSortCriteria(value: ISortCriteria | ISortCriteria[]) {\n    const values = Array.isArray(value) ? value.slice() : [value];\n    // trim\n    if (values.length > this.maxSortCriteria) {\n      values.splice(this.maxSortCriteria, values.length - this.maxSortCriteria);\n    }\n\n    const bak = this.groupSortCriteria.slice();\n\n    if (equalCriteria(values, bak)) {\n      return false;\n    }\n\n    bak.forEach((d) => {\n      d.col.on(`${Column.EVENT_DIRTY_VALUES}.groupOrder`, null!);\n      d.col.on(`${NumberColumn.EVENT_SORTMETHOD_CHANGED}.groupOrder`, null!);\n    });\n\n    values.forEach((d) => {\n      d.col.on(`${Column.EVENT_DIRTY_VALUES}.groupOrder`, this.dirtyOrder);\n      d.col.on(`${NumberColumn.EVENT_SORTMETHOD_CHANGED}.groupOrder`, this.dirtyOrder);\n    });\n    this.groupSortCriteria.splice(0, this.groupSortCriteria.length, ...values.slice());\n    this.triggerGroupResort(bak);\n    return true;\n  }\n\n  private triggerGroupResort(bak: ISortCriteria | ISortCriteria[] | null) {\n    const sortCriterias = this.getGroupSortCriteria();\n    const bakMulti = Array.isArray(bak) ? bak : sortCriterias;\n    this.fire([Ranking.EVENT_GROUP_SORT_CRITERIA_CHANGED, Ranking.EVENT_DIRTY_ORDER, Ranking.EVENT_DIRTY_HEADER,\n      Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], bakMulti, sortCriterias);\n  }\n\n  private triggerResort(bak: ISortCriteria | ISortCriteria[] | null) {\n    const sortCriterias = this.getSortCriteria();\n    const bakMulti = Array.isArray(bak) ? bak : sortCriterias;\n    this.fire([Ranking.EVENT_SORT_CRITERIA_CHANGED, Ranking.EVENT_DIRTY_ORDER, Ranking.EVENT_DIRTY_HEADER,\n      Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], bakMulti, sortCriterias);\n  }\n\n  get children() {\n    return this.columns.slice();\n  }\n\n  get length() {\n    return this.columns.length;\n  }\n\n  insert(col: Column, index: number = this.columns.length) {\n    this.columns.splice(index, 0, col);\n    col.attach(this);\n    this.forward(col, ...suffix('.ranking', Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY, NumberColumn.EVENT_FILTER_CHANGED));\n    col.on(`${Ranking.EVENT_FILTER_CHANGED}.order`, this.dirtyOrder);\n\n    col.on(`${Column.EVENT_VISIBILITY_CHANGED}.ranking`, (oldValue, newValue) => this.fire([Ranking.EVENT_COLUMN_VISIBILITY_CHANGED, Ranking.EVENT_DIRTY_HEADER, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], col, oldValue, newValue));\n\n    this.fire([Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_DIRTY_HEADER, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], col, index);\n    return col;\n  }\n\n  move(col: Column, index: number = this.columns.length) {\n    if (col.parent !== this) {\n      // not a move operation!\n      console.error('invalid move operation: ', col);\n      return null;\n    }\n    const old = this.columns.indexOf(col);\n    if (index === old) {\n      // no move needed\n      return col;\n    }\n    //delete first\n    this.columns.splice(old, 1);\n    // adapt target index based on previous index, i.e shift by one\n    this.columns.splice(old < index ? index - 1 : index, 0, col);\n\n    this.fire([Ranking.EVENT_MOVE_COLUMN, Ranking.EVENT_DIRTY_HEADER, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], col, index, old);\n    return col;\n  }\n\n  moveAfter(col: Column, reference: Column) {\n    const i = this.columns.indexOf(reference);\n    if (i < 0) {\n      return null;\n    }\n    return this.move(col, i + 1);\n  }\n\n  get fqpath() {\n    return '';\n  }\n\n  findByPath(fqpath: string): Column {\n    let p: IColumnParent | Column = <any>this;\n    const indices = fqpath.split('@').map(Number).slice(1); //ignore the first entry = ranking\n    while (indices.length > 0) {\n      const i = indices.shift()!;\n      p = (<IColumnParent>p).at(i);\n    }\n    return <Column>p;\n  }\n\n  indexOf(col: Column) {\n    return this.columns.indexOf(col);\n  }\n\n  at(index: number) {\n    return this.columns[index];\n  }\n\n  insertAfter(col: Column, ref: Column) {\n    const i = this.columns.indexOf(ref);\n    if (i < 0) {\n      return null;\n    }\n    return this.insert(col, i + 1);\n  }\n\n  push(col: Column) {\n    return this.insert(col);\n  }\n\n  remove(col: Column) {\n    const i = this.columns.indexOf(col);\n    if (i < 0) {\n      return false;\n    }\n\n    this.unforward(col, ...suffix('.ranking', Column.EVENT_VISIBILITY_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY, NumberColumn.EVENT_FILTER_CHANGED));\n\n    const isSortCriteria = this.sortCriteria.findIndex((d) => d.col === col);\n    const sortCriteriaChanged = isSortCriteria >= 0;\n    if (sortCriteriaChanged) {\n      this.sortCriteria.splice(isSortCriteria, 1);\n    }\n\n    const isGroupSortCriteria = this.groupSortCriteria.findIndex((d) => d.col === col);\n    const groupSortCriteriaChanged = isGroupSortCriteria >= 0;\n    if (groupSortCriteriaChanged) {\n      this.groupSortCriteria.splice(isGroupSortCriteria, 1);\n    }\n\n    let newGrouping: Column[]|null = null;\n    const isGroupColumn = this.groupColumns.indexOf(col);\n    if (isGroupColumn >= 0) { // was my grouping criteria\n      newGrouping = this.groupColumns.slice();\n      newGrouping.splice(isGroupColumn, 1);\n    }\n\n    col.detach();\n    this.columns.splice(i, 1);\n\n    this.fire([Ranking.EVENT_REMOVE_COLUMN, Ranking.EVENT_DIRTY_HEADER, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], col, i);\n\n    if (newGrouping) {\n      this.setGroupCriteria(newGrouping);\n    } else if (sortCriteriaChanged) {\n      this.triggerResort(null);\n    } else if (groupSortCriteriaChanged) {\n      this.triggerGroupResort(null);\n    }\n\n    return true;\n  }\n\n  clear() {\n    if (this.columns.length === 0) {\n      return;\n    }\n    this.sortCriteria.splice(0, this.sortCriteria.length);\n    this.groupSortCriteria.splice(0, this.groupSortCriteria.length);\n\n    this.groupColumns.forEach((groupColumn) => {\n      groupColumn.on(`${Column.EVENT_DIRTY_VALUES}.group`, null);\n      groupColumn.on(`${NumberColumn.EVENT_SORTMETHOD_CHANGED}.group`, null);\n    });\n    this.groupColumns.splice(0, this.groupColumns.length);\n\n    this.columns.forEach((col) => {\n      this.unforward(col, ...suffix('.ranking', Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY, NumberColumn.EVENT_FILTER_CHANGED));\n      col.detach();\n    });\n    const removed = this.columns.splice(0, this.columns.length);\n    this.fire([Ranking.EVENT_REMOVE_COLUMN, Ranking.EVENT_DIRTY_HEADER, Ranking.EVENT_DIRTY_VALUES, Ranking.EVENT_DIRTY], removed);\n  }\n\n  get flatColumns(): Column[] {\n    const r: IFlatColumn[] = [];\n    this.flatten(r, 0, Column.FLAT_ALL_COLUMNS);\n    return r.map((d) => d.col);\n  }\n\n  find(idOrFilter: string | ((col: Column) => boolean)) {\n    const filter = typeof(idOrFilter) === 'string' ? (col: Column) => col.id === idOrFilter : idOrFilter;\n    const r = this.flatColumns;\n    for (const v of r) {\n      if (filter(v)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  isFiltered() {\n    return this.columns.some((d) => d.isFiltered());\n  }\n\n  filter(row: IDataRow) {\n    return this.columns.every((d) => d.filter(row));\n  }\n\n  findMyRanker() {\n    return this;\n  }\n\n  get fqid() {\n    return this.id;\n  }\n\n  /**\n   * marks the header, values, or both as dirty such that the values are reevaluated\n   * @param type specify in more detail what is dirty, by default whole column\n   */\n  markDirty(type: 'header' | 'values' | 'all' = 'all') {\n    switch (type) {\n      case 'header':\n        return this.fire([Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY]);\n      case 'values':\n        return this.fire([Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY]);\n      default:\n        return this.fire([Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY]);\n    }\n  }\n}\n\nfunction equalCriteria(a: ISortCriteria[], b: ISortCriteria[]) {\n  if (a.length !== b.length) {\n    return false;\n  }\n  return a.every((ai, i) => {\n    const bi = b[i];\n    return ai.col === bi.col && ai.asc === bi.asc;\n  });\n}\n","export default function(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","import ascending from \"./ascending\";\n\nexport default function(compare) {\n  if (compare.length === 1) compare = ascendingComparator(compare);\n  return {\n    left: function(a, x, lo, hi) {\n      if (lo == null) lo = 0;\n      if (hi == null) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (compare(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      }\n      return lo;\n    },\n    right: function(a, x, lo, hi) {\n      if (lo == null) lo = 0;\n      if (hi == null) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (compare(a[mid], x) > 0) hi = mid;\n        else lo = mid + 1;\n      }\n      return lo;\n    }\n  };\n}\n\nfunction ascendingComparator(f) {\n  return function(d, x) {\n    return ascending(f(d), x);\n  };\n}\n","import ascending from \"./ascending\";\nimport bisector from \"./bisector\";\n\nvar ascendingBisect = bisector(ascending);\nexport var bisectRight = ascendingBisect.right;\nexport var bisectLeft = ascendingBisect.left;\nexport default bisectRight;\n","import {pair} from \"./pairs\";\n\nexport default function(values0, values1, reduce) {\n  var n0 = values0.length,\n      n1 = values1.length,\n      values = new Array(n0 * n1),\n      i0,\n      i1,\n      i,\n      value0;\n\n  if (reduce == null) reduce = pair;\n\n  for (i0 = i = 0; i0 < n0; ++i0) {\n    for (value0 = values0[i0], i1 = 0; i1 < n1; ++i1, ++i) {\n      values[i] = reduce(value0, values1[i1]);\n    }\n  }\n\n  return values;\n}\n","export default function(x) {\n  return x === null ? NaN : +x;\n}\n","export default function(values, valueof) {\n  var n = values.length,\n      i = -1,\n      value,\n      min,\n      max;\n\n  if (valueof == null) {\n    while (++i < n) { // Find the first comparable value.\n      if ((value = values[i]) != null && value >= value) {\n        min = max = value;\n        while (++i < n) { // Compare the remaining values.\n          if ((value = values[i]) != null) {\n            if (min > value) min = value;\n            if (max < value) max = value;\n          }\n        }\n      }\n    }\n  }\n\n  else {\n    while (++i < n) { // Find the first comparable value.\n      if ((value = valueof(values[i], i, values)) != null && value >= value) {\n        min = max = value;\n        while (++i < n) { // Compare the remaining values.\n          if ((value = valueof(values[i], i, values)) != null) {\n            if (min > value) min = value;\n            if (max < value) max = value;\n          }\n        }\n      }\n    }\n  }\n\n  return [min, max];\n}\n","var array = Array.prototype;\n\nexport var slice = array.slice;\nexport var map = array.map;\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function(x) {\n  return x;\n}\n","export default function(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","var e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nexport default function(start, stop, count) {\n  var reverse,\n      i = -1,\n      n,\n      ticks,\n      step;\n\n  stop = +stop, start = +start, count = +count;\n  if (start === stop && count > 0) return [start];\n  if (reverse = stop < start) n = start, start = stop, stop = n;\n  if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) return [];\n\n  if (step > 0) {\n    start = Math.ceil(start / step);\n    stop = Math.floor(stop / step);\n    ticks = new Array(n = Math.ceil(stop - start + 1));\n    while (++i < n) ticks[i] = (start + i) * step;\n  } else {\n    start = Math.floor(start * step);\n    stop = Math.ceil(stop * step);\n    ticks = new Array(n = Math.ceil(start - stop + 1));\n    while (++i < n) ticks[i] = (start - i) / step;\n  }\n\n  if (reverse) ticks.reverse();\n\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  var step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log(step) / Math.LN10),\n      error = step / Math.pow(10, power);\n  return power >= 0\n      ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power)\n      : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n}\n\nexport function tickStep(start, stop, count) {\n  var step0 = Math.abs(stop - start) / Math.max(0, count),\n      step1 = Math.pow(10, Math.floor(Math.log(step0) / Math.LN10)),\n      error = step0 / step1;\n  if (error >= e10) step1 *= 10;\n  else if (error >= e5) step1 *= 5;\n  else if (error >= e2) step1 *= 2;\n  return stop < start ? -step1 : step1;\n}\n","export default function(values) {\n  return Math.ceil(Math.log(values.length) / Math.LN2) + 1;\n}\n","import {slice} from \"./array\";\nimport bisect from \"./bisect\";\nimport constant from \"./constant\";\nimport extent from \"./extent\";\nimport identity from \"./identity\";\nimport range from \"./range\";\nimport {tickStep} from \"./ticks\";\nimport sturges from \"./threshold/sturges\";\n\nexport default function() {\n  var value = identity,\n      domain = extent,\n      threshold = sturges;\n\n  function histogram(data) {\n    var i,\n        n = data.length,\n        x,\n        values = new Array(n);\n\n    for (i = 0; i < n; ++i) {\n      values[i] = value(data[i], i, data);\n    }\n\n    var xz = domain(values),\n        x0 = xz[0],\n        x1 = xz[1],\n        tz = threshold(values, x0, x1);\n\n    // Convert number of thresholds into uniform thresholds.\n    if (!Array.isArray(tz)) {\n      tz = tickStep(x0, x1, tz);\n      tz = range(Math.ceil(x0 / tz) * tz, x1, tz); // exclusive\n    }\n\n    // Remove any thresholds outside the domain.\n    var m = tz.length;\n    while (tz[0] <= x0) tz.shift(), --m;\n    while (tz[m - 1] > x1) tz.pop(), --m;\n\n    var bins = new Array(m + 1),\n        bin;\n\n    // Initialize bins.\n    for (i = 0; i <= m; ++i) {\n      bin = bins[i] = [];\n      bin.x0 = i > 0 ? tz[i - 1] : x0;\n      bin.x1 = i < m ? tz[i] : x1;\n    }\n\n    // Assign data to bins by value, ignoring any outside the domain.\n    for (i = 0; i < n; ++i) {\n      x = values[i];\n      if (x0 <= x && x <= x1) {\n        bins[bisect(tz, x, 0, m)].push(data[i]);\n      }\n    }\n\n    return bins;\n  }\n\n  histogram.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(_), histogram) : value;\n  };\n\n  histogram.domain = function(_) {\n    return arguments.length ? (domain = typeof _ === \"function\" ? _ : constant([_[0], _[1]]), histogram) : domain;\n  };\n\n  histogram.thresholds = function(_) {\n    return arguments.length ? (threshold = typeof _ === \"function\" ? _ : Array.isArray(_) ? constant(slice.call(_)) : constant(_), histogram) : threshold;\n  };\n\n  return histogram;\n}\n","import number from \"./number\";\n\nexport default function(values, p, valueof) {\n  if (valueof == null) valueof = number;\n  if (!(n = values.length)) return;\n  if ((p = +p) <= 0 || n < 2) return +valueof(values[0], 0, values);\n  if (p >= 1) return +valueof(values[n - 1], n - 1, values);\n  var n,\n      i = (n - 1) * p,\n      i0 = Math.floor(i),\n      value0 = +valueof(values[i0], i0, values),\n      value1 = +valueof(values[i0 + 1], i0 + 1, values);\n  return value0 + (value1 - value0) * (i - i0);\n}\n","export default function(values, valueof) {\n  var n = values.length,\n      i = -1,\n      value,\n      max;\n\n  if (valueof == null) {\n    while (++i < n) { // Find the first comparable value.\n      if ((value = values[i]) != null && value >= value) {\n        max = value;\n        while (++i < n) { // Compare the remaining values.\n          if ((value = values[i]) != null && value > max) {\n            max = value;\n          }\n        }\n      }\n    }\n  }\n\n  else {\n    while (++i < n) { // Find the first comparable value.\n      if ((value = valueof(values[i], i, values)) != null && value >= value) {\n        max = value;\n        while (++i < n) { // Compare the remaining values.\n          if ((value = valueof(values[i], i, values)) != null && value > max) {\n            max = value;\n          }\n        }\n      }\n    }\n  }\n\n  return max;\n}\n","import number from \"./number\";\n\nexport default function(values, valueof) {\n  var n = values.length,\n      m = n,\n      i = -1,\n      value,\n      sum = 0;\n\n  if (valueof == null) {\n    while (++i < n) {\n      if (!isNaN(value = number(values[i]))) sum += value;\n      else --m;\n    }\n  }\n\n  else {\n    while (++i < n) {\n      if (!isNaN(value = number(valueof(values[i], i, values)))) sum += value;\n      else --m;\n    }\n  }\n\n  if (m) return sum / m;\n}\n","import ascending from \"./ascending\";\nimport number from \"./number\";\nimport quantile from \"./quantile\";\n\nexport default function(values, valueof) {\n  var n = values.length,\n      i = -1,\n      value,\n      numbers = [];\n\n  if (valueof == null) {\n    while (++i < n) {\n      if (!isNaN(value = number(values[i]))) {\n        numbers.push(value);\n      }\n    }\n  }\n\n  else {\n    while (++i < n) {\n      if (!isNaN(value = number(valueof(values[i], i, values)))) {\n        numbers.push(value);\n      }\n    }\n  }\n\n  return quantile(numbers.sort(ascending), 0.5);\n}\n","export default function(values, valueof) {\n  var n = values.length,\n      i = -1,\n      value,\n      min;\n\n  if (valueof == null) {\n    while (++i < n) { // Find the first comparable value.\n      if ((value = values[i]) != null && value >= value) {\n        min = value;\n        while (++i < n) { // Compare the remaining values.\n          if ((value = values[i]) != null && min > value) {\n            min = value;\n          }\n        }\n      }\n    }\n  }\n\n  else {\n    while (++i < n) { // Find the first comparable value.\n      if ((value = valueof(values[i], i, values)) != null && value >= value) {\n        min = value;\n        while (++i < n) { // Compare the remaining values.\n          if ((value = valueof(values[i], i, values)) != null && min > value) {\n            min = value;\n          }\n        }\n      }\n    }\n  }\n\n  return min;\n}\n","export {default as bisect, bisectRight, bisectLeft} from \"./bisect\";\nexport {default as ascending} from \"./ascending\";\nexport {default as bisector} from \"./bisector\";\nexport {default as cross} from \"./cross\";\nexport {default as descending} from \"./descending\";\nexport {default as deviation} from \"./deviation\";\nexport {default as extent} from \"./extent\";\nexport {default as histogram} from \"./histogram\";\nexport {default as thresholdFreedmanDiaconis} from \"./threshold/freedmanDiaconis\";\nexport {default as thresholdScott} from \"./threshold/scott\";\nexport {default as thresholdSturges} from \"./threshold/sturges\";\nexport {default as max} from \"./max\";\nexport {default as mean} from \"./mean\";\nexport {default as median} from \"./median\";\nexport {default as merge} from \"./merge\";\nexport {default as min} from \"./min\";\nexport {default as pairs} from \"./pairs\";\nexport {default as permute} from \"./permute\";\nexport {default as quantile} from \"./quantile\";\nexport {default as range} from \"./range\";\nexport {default as scan} from \"./scan\";\nexport {default as shuffle} from \"./shuffle\";\nexport {default as sum} from \"./sum\";\nexport {default as ticks, tickIncrement, tickStep} from \"./ticks\";\nexport {default as transpose} from \"./transpose\";\nexport {default as variance} from \"./variance\";\nexport {default as zip} from \"./zip\";\n","var noop = {value: function() {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","import {dispatch, Dispatch} from 'd3-dispatch';\r\n\r\n/** @internal */\r\nexport function suffix(suffix: string, ...prefix: string[]) {\r\n  return prefix.map((p) => `${p}${suffix}`);\r\n}\r\n\r\nexport interface IEventContext {\r\n  /**\r\n   * who is sending this event\r\n   */\r\n  readonly source: AEventDispatcher;\r\n\r\n  readonly origin: AEventDispatcher;\r\n  /**\r\n   * the event type\r\n   */\r\n  readonly type: string;\r\n  /**\r\n   * in case of multi propagation the 'main' event type\r\n   */\r\n  readonly primaryType: string;\r\n  /**\r\n   * the arguments to the listener\r\n   */\r\n  readonly args: any[];\r\n}\r\n\r\nexport interface IEventListener {\r\n  (this: IEventContext, ...args: any[]): any;\r\n}\r\n\r\nexport interface IEventHandler {\r\n  on(type: string | string[], listener: IEventListener | null): this;\r\n}\r\n\r\ndeclare const __DEBUG__: boolean;\r\n\r\n/**\r\n * base class for event dispatching using d3 event mechanism\r\n */\r\nexport default class AEventDispatcher implements IEventHandler {\r\n  private readonly listeners: Dispatch<any>;\r\n  private readonly listenerEvents: Set<string>;\r\n  private readonly forwarder: (...args: any[]) => void;\r\n\r\n  constructor() {\r\n    const events = this.createEventList();\r\n    this.listenerEvents = new Set(events);\r\n    this.listeners = dispatch(...events);\r\n\r\n    const that = this;\r\n    this.forwarder = function (this: IEventContext, ...args: any[]) {\r\n      that.fireImpl(this.type, this.primaryType, this.origin, ...args);\r\n    };\r\n  }\r\n\r\n  on(type: string | string[], listener: IEventListener | null): this {\r\n    if (Array.isArray(type)) {\r\n      type.forEach((d) => {\r\n        if (this.listenerEvents.has(d.split('.')[0])) {\r\n          this.listenersChanged(d, Boolean(listener!));\r\n          this.listeners.on(d, listener!);\r\n        } else if (__DEBUG__ && !d.includes('.')) {\r\n           console.warn(this, 'invalid event type', d);\r\n        }\r\n      });\r\n    } else if (this.listenerEvents.has((<string>type).split('.')[0])) {\r\n      this.listenersChanged(<string>type, Boolean(listener!));\r\n      this.listeners.on(<string>type, listener!);\r\n    } else if (__DEBUG__ && !type.includes('.')) {\r\n      console.warn(this, 'invalid event type', type);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  protected listenersChanged(_type: string, _active: boolean) {\r\n    // hook\r\n  }\r\n\r\n  /**\r\n   * return the list of events to be able to dispatch\r\n   * @return {Array} by default no events\r\n   */\r\n  protected createEventList(): string[] {\r\n    return [];\r\n  }\r\n\r\n  protected fire(type: string | string[], ...args: any[]) {\r\n    const primaryType = Array.isArray(type) ? type[0] : type;\r\n    this.fireImpl(type, primaryType, this, ...args);\r\n  }\r\n\r\n  private fireImpl(type: string | string[], primaryType: string, origin: AEventDispatcher, ...args: any[]) {\r\n    const fireImpl = (t: string) => {\r\n      if (!this.listenerEvents.has(t)) {\r\n        if (__DEBUG__) {\r\n          console.warn(this, 'invalid event type', t);\r\n        }\r\n        return;\r\n      }\r\n      //local context per event, set a this argument\r\n      const context: IEventContext = {\r\n        source: this, //who is sending this event,\r\n        origin,\r\n        type: t, //the event type\r\n        primaryType, //in case of multi propagation the 'main' event type\r\n        args //the arguments to the listener\r\n      };\r\n      this.listeners.apply(t, context, args);\r\n    };\r\n    if (Array.isArray(type)) {\r\n      type.forEach(fireImpl.bind(this));\r\n    } else {\r\n      fireImpl(<string>type);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * forwards one or more events from a given dispatcher to the current one\r\n   * i.e. when one of the given events is fired in 'from' it will be forwarded to all my listeners\r\n   * @param {IEventHandler} from the event dispatcher to forward from\r\n   * @param {string[]} types the event types to forward\r\n   */\r\n  protected forward(from: IEventHandler, ...types: string[]) {\r\n    from.on(types, this.forwarder);\r\n  }\r\n\r\n  /**\r\n   * removes the forwarding declarations\r\n   * @param {IEventHandler} from the originated dispatcher\r\n   * @param {string[]} types event types to forward\r\n   */\r\n  protected unforward(from: IEventHandler, ...types: string[]) {\r\n    from.on(types, null);\r\n  }\r\n}\r\n","/**!\n * @fileOverview Kickass library to create and place poppers near their reference elements.\n * @version 1.15.0\n * @license\n * Copyright (c) 2016 Federico Zivolo and contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nvar isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nvar longerTimeoutBrowsers = ['Edge', 'Trident', 'Firefox'];\nvar timeoutDuration = 0;\nfor (var i = 0; i < longerTimeoutBrowsers.length; i += 1) {\n  if (isBrowser && navigator.userAgent.indexOf(longerTimeoutBrowsers[i]) >= 0) {\n    timeoutDuration = 1;\n    break;\n  }\n}\n\nfunction microtaskDebounce(fn) {\n  var called = false;\n  return function () {\n    if (called) {\n      return;\n    }\n    called = true;\n    window.Promise.resolve().then(function () {\n      called = false;\n      fn();\n    });\n  };\n}\n\nfunction taskDebounce(fn) {\n  var scheduled = false;\n  return function () {\n    if (!scheduled) {\n      scheduled = true;\n      setTimeout(function () {\n        scheduled = false;\n        fn();\n      }, timeoutDuration);\n    }\n  };\n}\n\nvar supportsMicroTasks = isBrowser && window.Promise;\n\n/**\n* Create a debounced version of a method, that's asynchronously deferred\n* but called in the minimum time possible.\n*\n* @method\n* @memberof Popper.Utils\n* @argument {Function} fn\n* @returns {Function}\n*/\nvar debounce = supportsMicroTasks ? microtaskDebounce : taskDebounce;\n\n/**\n * Check if the given variable is a function\n * @method\n * @memberof Popper.Utils\n * @argument {Any} functionToCheck - variable to check\n * @returns {Boolean} answer to: is a function?\n */\nfunction isFunction(functionToCheck) {\n  var getType = {};\n  return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';\n}\n\n/**\n * Get CSS computed property of the given element\n * @method\n * @memberof Popper.Utils\n * @argument {Eement} element\n * @argument {String} property\n */\nfunction getStyleComputedProperty(element, property) {\n  if (element.nodeType !== 1) {\n    return [];\n  }\n  // NOTE: 1 DOM access here\n  var window = element.ownerDocument.defaultView;\n  var css = window.getComputedStyle(element, null);\n  return property ? css[property] : css;\n}\n\n/**\n * Returns the parentNode or the host of the element\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @returns {Element} parent\n */\nfunction getParentNode(element) {\n  if (element.nodeName === 'HTML') {\n    return element;\n  }\n  return element.parentNode || element.host;\n}\n\n/**\n * Returns the scrolling parent of the given element\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @returns {Element} scroll parent\n */\nfunction getScrollParent(element) {\n  // Return body, `getScroll` will take care to get the correct `scrollTop` from it\n  if (!element) {\n    return document.body;\n  }\n\n  switch (element.nodeName) {\n    case 'HTML':\n    case 'BODY':\n      return element.ownerDocument.body;\n    case '#document':\n      return element.body;\n  }\n\n  // Firefox want us to check `-x` and `-y` variations as well\n\n  var _getStyleComputedProp = getStyleComputedProperty(element),\n      overflow = _getStyleComputedProp.overflow,\n      overflowX = _getStyleComputedProp.overflowX,\n      overflowY = _getStyleComputedProp.overflowY;\n\n  if (/(auto|scroll|overlay)/.test(overflow + overflowY + overflowX)) {\n    return element;\n  }\n\n  return getScrollParent(getParentNode(element));\n}\n\nvar isIE11 = isBrowser && !!(window.MSInputMethodContext && document.documentMode);\nvar isIE10 = isBrowser && /MSIE 10/.test(navigator.userAgent);\n\n/**\n * Determines if the browser is Internet Explorer\n * @method\n * @memberof Popper.Utils\n * @param {Number} version to check\n * @returns {Boolean} isIE\n */\nfunction isIE(version) {\n  if (version === 11) {\n    return isIE11;\n  }\n  if (version === 10) {\n    return isIE10;\n  }\n  return isIE11 || isIE10;\n}\n\n/**\n * Returns the offset parent of the given element\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @returns {Element} offset parent\n */\nfunction getOffsetParent(element) {\n  if (!element) {\n    return document.documentElement;\n  }\n\n  var noOffsetParent = isIE(10) ? document.body : null;\n\n  // NOTE: 1 DOM access here\n  var offsetParent = element.offsetParent || null;\n  // Skip hidden elements which don't have an offsetParent\n  while (offsetParent === noOffsetParent && element.nextElementSibling) {\n    offsetParent = (element = element.nextElementSibling).offsetParent;\n  }\n\n  var nodeName = offsetParent && offsetParent.nodeName;\n\n  if (!nodeName || nodeName === 'BODY' || nodeName === 'HTML') {\n    return element ? element.ownerDocument.documentElement : document.documentElement;\n  }\n\n  // .offsetParent will return the closest TH, TD or TABLE in case\n  // no offsetParent is present, I hate this job...\n  if (['TH', 'TD', 'TABLE'].indexOf(offsetParent.nodeName) !== -1 && getStyleComputedProperty(offsetParent, 'position') === 'static') {\n    return getOffsetParent(offsetParent);\n  }\n\n  return offsetParent;\n}\n\nfunction isOffsetContainer(element) {\n  var nodeName = element.nodeName;\n\n  if (nodeName === 'BODY') {\n    return false;\n  }\n  return nodeName === 'HTML' || getOffsetParent(element.firstElementChild) === element;\n}\n\n/**\n * Finds the root node (document, shadowDOM root) of the given element\n * @method\n * @memberof Popper.Utils\n * @argument {Element} node\n * @returns {Element} root node\n */\nfunction getRoot(node) {\n  if (node.parentNode !== null) {\n    return getRoot(node.parentNode);\n  }\n\n  return node;\n}\n\n/**\n * Finds the offset parent common to the two provided nodes\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element1\n * @argument {Element} element2\n * @returns {Element} common offset parent\n */\nfunction findCommonOffsetParent(element1, element2) {\n  // This check is needed to avoid errors in case one of the elements isn't defined for any reason\n  if (!element1 || !element1.nodeType || !element2 || !element2.nodeType) {\n    return document.documentElement;\n  }\n\n  // Here we make sure to give as \"start\" the element that comes first in the DOM\n  var order = element1.compareDocumentPosition(element2) & Node.DOCUMENT_POSITION_FOLLOWING;\n  var start = order ? element1 : element2;\n  var end = order ? element2 : element1;\n\n  // Get common ancestor container\n  var range = document.createRange();\n  range.setStart(start, 0);\n  range.setEnd(end, 0);\n  var commonAncestorContainer = range.commonAncestorContainer;\n\n  // Both nodes are inside #document\n\n  if (element1 !== commonAncestorContainer && element2 !== commonAncestorContainer || start.contains(end)) {\n    if (isOffsetContainer(commonAncestorContainer)) {\n      return commonAncestorContainer;\n    }\n\n    return getOffsetParent(commonAncestorContainer);\n  }\n\n  // one of the nodes is inside shadowDOM, find which one\n  var element1root = getRoot(element1);\n  if (element1root.host) {\n    return findCommonOffsetParent(element1root.host, element2);\n  } else {\n    return findCommonOffsetParent(element1, getRoot(element2).host);\n  }\n}\n\n/**\n * Gets the scroll value of the given element in the given side (top and left)\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @argument {String} side `top` or `left`\n * @returns {number} amount of scrolled pixels\n */\nfunction getScroll(element) {\n  var side = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'top';\n\n  var upperSide = side === 'top' ? 'scrollTop' : 'scrollLeft';\n  var nodeName = element.nodeName;\n\n  if (nodeName === 'BODY' || nodeName === 'HTML') {\n    var html = element.ownerDocument.documentElement;\n    var scrollingElement = element.ownerDocument.scrollingElement || html;\n    return scrollingElement[upperSide];\n  }\n\n  return element[upperSide];\n}\n\n/*\n * Sum or subtract the element scroll values (left and top) from a given rect object\n * @method\n * @memberof Popper.Utils\n * @param {Object} rect - Rect object you want to change\n * @param {HTMLElement} element - The element from the function reads the scroll values\n * @param {Boolean} subtract - set to true if you want to subtract the scroll values\n * @return {Object} rect - The modifier rect object\n */\nfunction includeScroll(rect, element) {\n  var subtract = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n  var scrollTop = getScroll(element, 'top');\n  var scrollLeft = getScroll(element, 'left');\n  var modifier = subtract ? -1 : 1;\n  rect.top += scrollTop * modifier;\n  rect.bottom += scrollTop * modifier;\n  rect.left += scrollLeft * modifier;\n  rect.right += scrollLeft * modifier;\n  return rect;\n}\n\n/*\n * Helper to detect borders of a given element\n * @method\n * @memberof Popper.Utils\n * @param {CSSStyleDeclaration} styles\n * Result of `getStyleComputedProperty` on the given element\n * @param {String} axis - `x` or `y`\n * @return {number} borders - The borders size of the given axis\n */\n\nfunction getBordersSize(styles, axis) {\n  var sideA = axis === 'x' ? 'Left' : 'Top';\n  var sideB = sideA === 'Left' ? 'Right' : 'Bottom';\n\n  return parseFloat(styles['border' + sideA + 'Width'], 10) + parseFloat(styles['border' + sideB + 'Width'], 10);\n}\n\nfunction getSize(axis, body, html, computedStyle) {\n  return Math.max(body['offset' + axis], body['scroll' + axis], html['client' + axis], html['offset' + axis], html['scroll' + axis], isIE(10) ? parseInt(html['offset' + axis]) + parseInt(computedStyle['margin' + (axis === 'Height' ? 'Top' : 'Left')]) + parseInt(computedStyle['margin' + (axis === 'Height' ? 'Bottom' : 'Right')]) : 0);\n}\n\nfunction getWindowSizes(document) {\n  var body = document.body;\n  var html = document.documentElement;\n  var computedStyle = isIE(10) && getComputedStyle(html);\n\n  return {\n    height: getSize('Height', body, html, computedStyle),\n    width: getSize('Width', body, html, computedStyle)\n  };\n}\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\nvar defineProperty = function (obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n/**\n * Given element offsets, generate an output similar to getBoundingClientRect\n * @method\n * @memberof Popper.Utils\n * @argument {Object} offsets\n * @returns {Object} ClientRect like output\n */\nfunction getClientRect(offsets) {\n  return _extends({}, offsets, {\n    right: offsets.left + offsets.width,\n    bottom: offsets.top + offsets.height\n  });\n}\n\n/**\n * Get bounding client rect of given element\n * @method\n * @memberof Popper.Utils\n * @param {HTMLElement} element\n * @return {Object} client rect\n */\nfunction getBoundingClientRect(element) {\n  var rect = {};\n\n  // IE10 10 FIX: Please, don't ask, the element isn't\n  // considered in DOM in some circumstances...\n  // This isn't reproducible in IE10 compatibility mode of IE11\n  try {\n    if (isIE(10)) {\n      rect = element.getBoundingClientRect();\n      var scrollTop = getScroll(element, 'top');\n      var scrollLeft = getScroll(element, 'left');\n      rect.top += scrollTop;\n      rect.left += scrollLeft;\n      rect.bottom += scrollTop;\n      rect.right += scrollLeft;\n    } else {\n      rect = element.getBoundingClientRect();\n    }\n  } catch (e) {}\n\n  var result = {\n    left: rect.left,\n    top: rect.top,\n    width: rect.right - rect.left,\n    height: rect.bottom - rect.top\n  };\n\n  // subtract scrollbar size from sizes\n  var sizes = element.nodeName === 'HTML' ? getWindowSizes(element.ownerDocument) : {};\n  var width = sizes.width || element.clientWidth || result.right - result.left;\n  var height = sizes.height || element.clientHeight || result.bottom - result.top;\n\n  var horizScrollbar = element.offsetWidth - width;\n  var vertScrollbar = element.offsetHeight - height;\n\n  // if an hypothetical scrollbar is detected, we must be sure it's not a `border`\n  // we make this check conditional for performance reasons\n  if (horizScrollbar || vertScrollbar) {\n    var styles = getStyleComputedProperty(element);\n    horizScrollbar -= getBordersSize(styles, 'x');\n    vertScrollbar -= getBordersSize(styles, 'y');\n\n    result.width -= horizScrollbar;\n    result.height -= vertScrollbar;\n  }\n\n  return getClientRect(result);\n}\n\nfunction getOffsetRectRelativeToArbitraryNode(children, parent) {\n  var fixedPosition = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n  var isIE10 = isIE(10);\n  var isHTML = parent.nodeName === 'HTML';\n  var childrenRect = getBoundingClientRect(children);\n  var parentRect = getBoundingClientRect(parent);\n  var scrollParent = getScrollParent(children);\n\n  var styles = getStyleComputedProperty(parent);\n  var borderTopWidth = parseFloat(styles.borderTopWidth, 10);\n  var borderLeftWidth = parseFloat(styles.borderLeftWidth, 10);\n\n  // In cases where the parent is fixed, we must ignore negative scroll in offset calc\n  if (fixedPosition && isHTML) {\n    parentRect.top = Math.max(parentRect.top, 0);\n    parentRect.left = Math.max(parentRect.left, 0);\n  }\n  var offsets = getClientRect({\n    top: childrenRect.top - parentRect.top - borderTopWidth,\n    left: childrenRect.left - parentRect.left - borderLeftWidth,\n    width: childrenRect.width,\n    height: childrenRect.height\n  });\n  offsets.marginTop = 0;\n  offsets.marginLeft = 0;\n\n  // Subtract margins of documentElement in case it's being used as parent\n  // we do this only on HTML because it's the only element that behaves\n  // differently when margins are applied to it. The margins are included in\n  // the box of the documentElement, in the other cases not.\n  if (!isIE10 && isHTML) {\n    var marginTop = parseFloat(styles.marginTop, 10);\n    var marginLeft = parseFloat(styles.marginLeft, 10);\n\n    offsets.top -= borderTopWidth - marginTop;\n    offsets.bottom -= borderTopWidth - marginTop;\n    offsets.left -= borderLeftWidth - marginLeft;\n    offsets.right -= borderLeftWidth - marginLeft;\n\n    // Attach marginTop and marginLeft because in some circumstances we may need them\n    offsets.marginTop = marginTop;\n    offsets.marginLeft = marginLeft;\n  }\n\n  if (isIE10 && !fixedPosition ? parent.contains(scrollParent) : parent === scrollParent && scrollParent.nodeName !== 'BODY') {\n    offsets = includeScroll(offsets, parent);\n  }\n\n  return offsets;\n}\n\nfunction getViewportOffsetRectRelativeToArtbitraryNode(element) {\n  var excludeScroll = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  var html = element.ownerDocument.documentElement;\n  var relativeOffset = getOffsetRectRelativeToArbitraryNode(element, html);\n  var width = Math.max(html.clientWidth, window.innerWidth || 0);\n  var height = Math.max(html.clientHeight, window.innerHeight || 0);\n\n  var scrollTop = !excludeScroll ? getScroll(html) : 0;\n  var scrollLeft = !excludeScroll ? getScroll(html, 'left') : 0;\n\n  var offset = {\n    top: scrollTop - relativeOffset.top + relativeOffset.marginTop,\n    left: scrollLeft - relativeOffset.left + relativeOffset.marginLeft,\n    width: width,\n    height: height\n  };\n\n  return getClientRect(offset);\n}\n\n/**\n * Check if the given element is fixed or is inside a fixed parent\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @argument {Element} customContainer\n * @returns {Boolean} answer to \"isFixed?\"\n */\nfunction isFixed(element) {\n  var nodeName = element.nodeName;\n  if (nodeName === 'BODY' || nodeName === 'HTML') {\n    return false;\n  }\n  if (getStyleComputedProperty(element, 'position') === 'fixed') {\n    return true;\n  }\n  var parentNode = getParentNode(element);\n  if (!parentNode) {\n    return false;\n  }\n  return isFixed(parentNode);\n}\n\n/**\n * Finds the first parent of an element that has a transformed property defined\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @returns {Element} first transformed parent or documentElement\n */\n\nfunction getFixedPositionOffsetParent(element) {\n  // This check is needed to avoid errors in case one of the elements isn't defined for any reason\n  if (!element || !element.parentElement || isIE()) {\n    return document.documentElement;\n  }\n  var el = element.parentElement;\n  while (el && getStyleComputedProperty(el, 'transform') === 'none') {\n    el = el.parentElement;\n  }\n  return el || document.documentElement;\n}\n\n/**\n * Computed the boundaries limits and return them\n * @method\n * @memberof Popper.Utils\n * @param {HTMLElement} popper\n * @param {HTMLElement} reference\n * @param {number} padding\n * @param {HTMLElement} boundariesElement - Element used to define the boundaries\n * @param {Boolean} fixedPosition - Is in fixed position mode\n * @returns {Object} Coordinates of the boundaries\n */\nfunction getBoundaries(popper, reference, padding, boundariesElement) {\n  var fixedPosition = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n  // NOTE: 1 DOM access here\n\n  var boundaries = { top: 0, left: 0 };\n  var offsetParent = fixedPosition ? getFixedPositionOffsetParent(popper) : findCommonOffsetParent(popper, reference);\n\n  // Handle viewport case\n  if (boundariesElement === 'viewport') {\n    boundaries = getViewportOffsetRectRelativeToArtbitraryNode(offsetParent, fixedPosition);\n  } else {\n    // Handle other cases based on DOM element used as boundaries\n    var boundariesNode = void 0;\n    if (boundariesElement === 'scrollParent') {\n      boundariesNode = getScrollParent(getParentNode(reference));\n      if (boundariesNode.nodeName === 'BODY') {\n        boundariesNode = popper.ownerDocument.documentElement;\n      }\n    } else if (boundariesElement === 'window') {\n      boundariesNode = popper.ownerDocument.documentElement;\n    } else {\n      boundariesNode = boundariesElement;\n    }\n\n    var offsets = getOffsetRectRelativeToArbitraryNode(boundariesNode, offsetParent, fixedPosition);\n\n    // In case of HTML, we need a different computation\n    if (boundariesNode.nodeName === 'HTML' && !isFixed(offsetParent)) {\n      var _getWindowSizes = getWindowSizes(popper.ownerDocument),\n          height = _getWindowSizes.height,\n          width = _getWindowSizes.width;\n\n      boundaries.top += offsets.top - offsets.marginTop;\n      boundaries.bottom = height + offsets.top;\n      boundaries.left += offsets.left - offsets.marginLeft;\n      boundaries.right = width + offsets.left;\n    } else {\n      // for all the other DOM elements, this one is good\n      boundaries = offsets;\n    }\n  }\n\n  // Add paddings\n  padding = padding || 0;\n  var isPaddingNumber = typeof padding === 'number';\n  boundaries.left += isPaddingNumber ? padding : padding.left || 0;\n  boundaries.top += isPaddingNumber ? padding : padding.top || 0;\n  boundaries.right -= isPaddingNumber ? padding : padding.right || 0;\n  boundaries.bottom -= isPaddingNumber ? padding : padding.bottom || 0;\n\n  return boundaries;\n}\n\nfunction getArea(_ref) {\n  var width = _ref.width,\n      height = _ref.height;\n\n  return width * height;\n}\n\n/**\n * Utility used to transform the `auto` placement to the placement with more\n * available space.\n * @method\n * @memberof Popper.Utils\n * @argument {Object} data - The data object generated by update method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction computeAutoPlacement(placement, refRect, popper, reference, boundariesElement) {\n  var padding = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n\n  if (placement.indexOf('auto') === -1) {\n    return placement;\n  }\n\n  var boundaries = getBoundaries(popper, reference, padding, boundariesElement);\n\n  var rects = {\n    top: {\n      width: boundaries.width,\n      height: refRect.top - boundaries.top\n    },\n    right: {\n      width: boundaries.right - refRect.right,\n      height: boundaries.height\n    },\n    bottom: {\n      width: boundaries.width,\n      height: boundaries.bottom - refRect.bottom\n    },\n    left: {\n      width: refRect.left - boundaries.left,\n      height: boundaries.height\n    }\n  };\n\n  var sortedAreas = Object.keys(rects).map(function (key) {\n    return _extends({\n      key: key\n    }, rects[key], {\n      area: getArea(rects[key])\n    });\n  }).sort(function (a, b) {\n    return b.area - a.area;\n  });\n\n  var filteredAreas = sortedAreas.filter(function (_ref2) {\n    var width = _ref2.width,\n        height = _ref2.height;\n    return width >= popper.clientWidth && height >= popper.clientHeight;\n  });\n\n  var computedPlacement = filteredAreas.length > 0 ? filteredAreas[0].key : sortedAreas[0].key;\n\n  var variation = placement.split('-')[1];\n\n  return computedPlacement + (variation ? '-' + variation : '');\n}\n\n/**\n * Get offsets to the reference element\n * @method\n * @memberof Popper.Utils\n * @param {Object} state\n * @param {Element} popper - the popper element\n * @param {Element} reference - the reference element (the popper will be relative to this)\n * @param {Element} fixedPosition - is in fixed position mode\n * @returns {Object} An object containing the offsets which will be applied to the popper\n */\nfunction getReferenceOffsets(state, popper, reference) {\n  var fixedPosition = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n  var commonOffsetParent = fixedPosition ? getFixedPositionOffsetParent(popper) : findCommonOffsetParent(popper, reference);\n  return getOffsetRectRelativeToArbitraryNode(reference, commonOffsetParent, fixedPosition);\n}\n\n/**\n * Get the outer sizes of the given element (offset size + margins)\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element\n * @returns {Object} object containing width and height properties\n */\nfunction getOuterSizes(element) {\n  var window = element.ownerDocument.defaultView;\n  var styles = window.getComputedStyle(element);\n  var x = parseFloat(styles.marginTop || 0) + parseFloat(styles.marginBottom || 0);\n  var y = parseFloat(styles.marginLeft || 0) + parseFloat(styles.marginRight || 0);\n  var result = {\n    width: element.offsetWidth + y,\n    height: element.offsetHeight + x\n  };\n  return result;\n}\n\n/**\n * Get the opposite placement of the given one\n * @method\n * @memberof Popper.Utils\n * @argument {String} placement\n * @returns {String} flipped placement\n */\nfunction getOppositePlacement(placement) {\n  var hash = { left: 'right', right: 'left', bottom: 'top', top: 'bottom' };\n  return placement.replace(/left|right|bottom|top/g, function (matched) {\n    return hash[matched];\n  });\n}\n\n/**\n * Get offsets to the popper\n * @method\n * @memberof Popper.Utils\n * @param {Object} position - CSS position the Popper will get applied\n * @param {HTMLElement} popper - the popper element\n * @param {Object} referenceOffsets - the reference offsets (the popper will be relative to this)\n * @param {String} placement - one of the valid placement options\n * @returns {Object} popperOffsets - An object containing the offsets which will be applied to the popper\n */\nfunction getPopperOffsets(popper, referenceOffsets, placement) {\n  placement = placement.split('-')[0];\n\n  // Get popper node sizes\n  var popperRect = getOuterSizes(popper);\n\n  // Add position, width and height to our offsets object\n  var popperOffsets = {\n    width: popperRect.width,\n    height: popperRect.height\n  };\n\n  // depending by the popper placement we have to compute its offsets slightly differently\n  var isHoriz = ['right', 'left'].indexOf(placement) !== -1;\n  var mainSide = isHoriz ? 'top' : 'left';\n  var secondarySide = isHoriz ? 'left' : 'top';\n  var measurement = isHoriz ? 'height' : 'width';\n  var secondaryMeasurement = !isHoriz ? 'height' : 'width';\n\n  popperOffsets[mainSide] = referenceOffsets[mainSide] + referenceOffsets[measurement] / 2 - popperRect[measurement] / 2;\n  if (placement === secondarySide) {\n    popperOffsets[secondarySide] = referenceOffsets[secondarySide] - popperRect[secondaryMeasurement];\n  } else {\n    popperOffsets[secondarySide] = referenceOffsets[getOppositePlacement(secondarySide)];\n  }\n\n  return popperOffsets;\n}\n\n/**\n * Mimics the `find` method of Array\n * @method\n * @memberof Popper.Utils\n * @argument {Array} arr\n * @argument prop\n * @argument value\n * @returns index or -1\n */\nfunction find(arr, check) {\n  // use native find if supported\n  if (Array.prototype.find) {\n    return arr.find(check);\n  }\n\n  // use `filter` to obtain the same behavior of `find`\n  return arr.filter(check)[0];\n}\n\n/**\n * Return the index of the matching object\n * @method\n * @memberof Popper.Utils\n * @argument {Array} arr\n * @argument prop\n * @argument value\n * @returns index or -1\n */\nfunction findIndex(arr, prop, value) {\n  // use native findIndex if supported\n  if (Array.prototype.findIndex) {\n    return arr.findIndex(function (cur) {\n      return cur[prop] === value;\n    });\n  }\n\n  // use `find` + `indexOf` if `findIndex` isn't supported\n  var match = find(arr, function (obj) {\n    return obj[prop] === value;\n  });\n  return arr.indexOf(match);\n}\n\n/**\n * Loop trough the list of modifiers and run them in order,\n * each of them will then edit the data object.\n * @method\n * @memberof Popper.Utils\n * @param {dataObject} data\n * @param {Array} modifiers\n * @param {String} ends - Optional modifier name used as stopper\n * @returns {dataObject}\n */\nfunction runModifiers(modifiers, data, ends) {\n  var modifiersToRun = ends === undefined ? modifiers : modifiers.slice(0, findIndex(modifiers, 'name', ends));\n\n  modifiersToRun.forEach(function (modifier) {\n    if (modifier['function']) {\n      // eslint-disable-line dot-notation\n      console.warn('`modifier.function` is deprecated, use `modifier.fn`!');\n    }\n    var fn = modifier['function'] || modifier.fn; // eslint-disable-line dot-notation\n    if (modifier.enabled && isFunction(fn)) {\n      // Add properties to offsets to make them a complete clientRect object\n      // we do this before each modifier to make sure the previous one doesn't\n      // mess with these values\n      data.offsets.popper = getClientRect(data.offsets.popper);\n      data.offsets.reference = getClientRect(data.offsets.reference);\n\n      data = fn(data, modifier);\n    }\n  });\n\n  return data;\n}\n\n/**\n * Updates the position of the popper, computing the new offsets and applying\n * the new style.<br />\n * Prefer `scheduleUpdate` over `update` because of performance reasons.\n * @method\n * @memberof Popper\n */\nfunction update() {\n  // if popper is destroyed, don't perform any further update\n  if (this.state.isDestroyed) {\n    return;\n  }\n\n  var data = {\n    instance: this,\n    styles: {},\n    arrowStyles: {},\n    attributes: {},\n    flipped: false,\n    offsets: {}\n  };\n\n  // compute reference element offsets\n  data.offsets.reference = getReferenceOffsets(this.state, this.popper, this.reference, this.options.positionFixed);\n\n  // compute auto placement, store placement inside the data object,\n  // modifiers will be able to edit `placement` if needed\n  // and refer to originalPlacement to know the original value\n  data.placement = computeAutoPlacement(this.options.placement, data.offsets.reference, this.popper, this.reference, this.options.modifiers.flip.boundariesElement, this.options.modifiers.flip.padding);\n\n  // store the computed placement inside `originalPlacement`\n  data.originalPlacement = data.placement;\n\n  data.positionFixed = this.options.positionFixed;\n\n  // compute the popper offsets\n  data.offsets.popper = getPopperOffsets(this.popper, data.offsets.reference, data.placement);\n\n  data.offsets.popper.position = this.options.positionFixed ? 'fixed' : 'absolute';\n\n  // run the modifiers\n  data = runModifiers(this.modifiers, data);\n\n  // the first `update` will call `onCreate` callback\n  // the other ones will call `onUpdate` callback\n  if (!this.state.isCreated) {\n    this.state.isCreated = true;\n    this.options.onCreate(data);\n  } else {\n    this.options.onUpdate(data);\n  }\n}\n\n/**\n * Helper used to know if the given modifier is enabled.\n * @method\n * @memberof Popper.Utils\n * @returns {Boolean}\n */\nfunction isModifierEnabled(modifiers, modifierName) {\n  return modifiers.some(function (_ref) {\n    var name = _ref.name,\n        enabled = _ref.enabled;\n    return enabled && name === modifierName;\n  });\n}\n\n/**\n * Get the prefixed supported property name\n * @method\n * @memberof Popper.Utils\n * @argument {String} property (camelCase)\n * @returns {String} prefixed property (camelCase or PascalCase, depending on the vendor prefix)\n */\nfunction getSupportedPropertyName(property) {\n  var prefixes = [false, 'ms', 'Webkit', 'Moz', 'O'];\n  var upperProp = property.charAt(0).toUpperCase() + property.slice(1);\n\n  for (var i = 0; i < prefixes.length; i++) {\n    var prefix = prefixes[i];\n    var toCheck = prefix ? '' + prefix + upperProp : property;\n    if (typeof document.body.style[toCheck] !== 'undefined') {\n      return toCheck;\n    }\n  }\n  return null;\n}\n\n/**\n * Destroys the popper.\n * @method\n * @memberof Popper\n */\nfunction destroy() {\n  this.state.isDestroyed = true;\n\n  // touch DOM only if `applyStyle` modifier is enabled\n  if (isModifierEnabled(this.modifiers, 'applyStyle')) {\n    this.popper.removeAttribute('x-placement');\n    this.popper.style.position = '';\n    this.popper.style.top = '';\n    this.popper.style.left = '';\n    this.popper.style.right = '';\n    this.popper.style.bottom = '';\n    this.popper.style.willChange = '';\n    this.popper.style[getSupportedPropertyName('transform')] = '';\n  }\n\n  this.disableEventListeners();\n\n  // remove the popper if user explicity asked for the deletion on destroy\n  // do not use `remove` because IE11 doesn't support it\n  if (this.options.removeOnDestroy) {\n    this.popper.parentNode.removeChild(this.popper);\n  }\n  return this;\n}\n\n/**\n * Get the window associated with the element\n * @argument {Element} element\n * @returns {Window}\n */\nfunction getWindow(element) {\n  var ownerDocument = element.ownerDocument;\n  return ownerDocument ? ownerDocument.defaultView : window;\n}\n\nfunction attachToScrollParents(scrollParent, event, callback, scrollParents) {\n  var isBody = scrollParent.nodeName === 'BODY';\n  var target = isBody ? scrollParent.ownerDocument.defaultView : scrollParent;\n  target.addEventListener(event, callback, { passive: true });\n\n  if (!isBody) {\n    attachToScrollParents(getScrollParent(target.parentNode), event, callback, scrollParents);\n  }\n  scrollParents.push(target);\n}\n\n/**\n * Setup needed event listeners used to update the popper position\n * @method\n * @memberof Popper.Utils\n * @private\n */\nfunction setupEventListeners(reference, options, state, updateBound) {\n  // Resize event listener on window\n  state.updateBound = updateBound;\n  getWindow(reference).addEventListener('resize', state.updateBound, { passive: true });\n\n  // Scroll event listener on scroll parents\n  var scrollElement = getScrollParent(reference);\n  attachToScrollParents(scrollElement, 'scroll', state.updateBound, state.scrollParents);\n  state.scrollElement = scrollElement;\n  state.eventsEnabled = true;\n\n  return state;\n}\n\n/**\n * It will add resize/scroll events and start recalculating\n * position of the popper element when they are triggered.\n * @method\n * @memberof Popper\n */\nfunction enableEventListeners() {\n  if (!this.state.eventsEnabled) {\n    this.state = setupEventListeners(this.reference, this.options, this.state, this.scheduleUpdate);\n  }\n}\n\n/**\n * Remove event listeners used to update the popper position\n * @method\n * @memberof Popper.Utils\n * @private\n */\nfunction removeEventListeners(reference, state) {\n  // Remove resize event listener on window\n  getWindow(reference).removeEventListener('resize', state.updateBound);\n\n  // Remove scroll event listener on scroll parents\n  state.scrollParents.forEach(function (target) {\n    target.removeEventListener('scroll', state.updateBound);\n  });\n\n  // Reset state\n  state.updateBound = null;\n  state.scrollParents = [];\n  state.scrollElement = null;\n  state.eventsEnabled = false;\n  return state;\n}\n\n/**\n * It will remove resize/scroll events and won't recalculate popper position\n * when they are triggered. It also won't trigger `onUpdate` callback anymore,\n * unless you call `update` method manually.\n * @method\n * @memberof Popper\n */\nfunction disableEventListeners() {\n  if (this.state.eventsEnabled) {\n    cancelAnimationFrame(this.scheduleUpdate);\n    this.state = removeEventListeners(this.reference, this.state);\n  }\n}\n\n/**\n * Tells if a given input is a number\n * @method\n * @memberof Popper.Utils\n * @param {*} input to check\n * @return {Boolean}\n */\nfunction isNumeric(n) {\n  return n !== '' && !isNaN(parseFloat(n)) && isFinite(n);\n}\n\n/**\n * Set the style to the given popper\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element - Element to apply the style to\n * @argument {Object} styles\n * Object with a list of properties and values which will be applied to the element\n */\nfunction setStyles(element, styles) {\n  Object.keys(styles).forEach(function (prop) {\n    var unit = '';\n    // add unit if the value is numeric and is one of the following\n    if (['width', 'height', 'top', 'right', 'bottom', 'left'].indexOf(prop) !== -1 && isNumeric(styles[prop])) {\n      unit = 'px';\n    }\n    element.style[prop] = styles[prop] + unit;\n  });\n}\n\n/**\n * Set the attributes to the given popper\n * @method\n * @memberof Popper.Utils\n * @argument {Element} element - Element to apply the attributes to\n * @argument {Object} styles\n * Object with a list of properties and values which will be applied to the element\n */\nfunction setAttributes(element, attributes) {\n  Object.keys(attributes).forEach(function (prop) {\n    var value = attributes[prop];\n    if (value !== false) {\n      element.setAttribute(prop, attributes[prop]);\n    } else {\n      element.removeAttribute(prop);\n    }\n  });\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by `update` method\n * @argument {Object} data.styles - List of style properties - values to apply to popper element\n * @argument {Object} data.attributes - List of attribute properties - values to apply to popper element\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The same data object\n */\nfunction applyStyle(data) {\n  // any property present in `data.styles` will be applied to the popper,\n  // in this way we can make the 3rd party modifiers add custom styles to it\n  // Be aware, modifiers could override the properties defined in the previous\n  // lines of this modifier!\n  setStyles(data.instance.popper, data.styles);\n\n  // any property present in `data.attributes` will be applied to the popper,\n  // they will be set as HTML attributes of the element\n  setAttributes(data.instance.popper, data.attributes);\n\n  // if arrowElement is defined and arrowStyles has some properties\n  if (data.arrowElement && Object.keys(data.arrowStyles).length) {\n    setStyles(data.arrowElement, data.arrowStyles);\n  }\n\n  return data;\n}\n\n/**\n * Set the x-placement attribute before everything else because it could be used\n * to add margins to the popper margins needs to be calculated to get the\n * correct popper offsets.\n * @method\n * @memberof Popper.modifiers\n * @param {HTMLElement} reference - The reference element used to position the popper\n * @param {HTMLElement} popper - The HTML element used as popper\n * @param {Object} options - Popper.js options\n */\nfunction applyStyleOnLoad(reference, popper, options, modifierOptions, state) {\n  // compute reference element offsets\n  var referenceOffsets = getReferenceOffsets(state, popper, reference, options.positionFixed);\n\n  // compute auto placement, store placement inside the data object,\n  // modifiers will be able to edit `placement` if needed\n  // and refer to originalPlacement to know the original value\n  var placement = computeAutoPlacement(options.placement, referenceOffsets, popper, reference, options.modifiers.flip.boundariesElement, options.modifiers.flip.padding);\n\n  popper.setAttribute('x-placement', placement);\n\n  // Apply `position` to popper before anything else because\n  // without the position applied we can't guarantee correct computations\n  setStyles(popper, { position: options.positionFixed ? 'fixed' : 'absolute' });\n\n  return options;\n}\n\n/**\n * @function\n * @memberof Popper.Utils\n * @argument {Object} data - The data object generated by `update` method\n * @argument {Boolean} shouldRound - If the offsets should be rounded at all\n * @returns {Object} The popper's position offsets rounded\n *\n * The tale of pixel-perfect positioning. It's still not 100% perfect, but as\n * good as it can be within reason.\n * Discussion here: https://github.com/FezVrasta/popper.js/pull/715\n *\n * Low DPI screens cause a popper to be blurry if not using full pixels (Safari\n * as well on High DPI screens).\n *\n * Firefox prefers no rounding for positioning and does not have blurriness on\n * high DPI screens.\n *\n * Only horizontal placement and left/right values need to be considered.\n */\nfunction getRoundedOffsets(data, shouldRound) {\n  var _data$offsets = data.offsets,\n      popper = _data$offsets.popper,\n      reference = _data$offsets.reference;\n  var round = Math.round,\n      floor = Math.floor;\n\n  var noRound = function noRound(v) {\n    return v;\n  };\n\n  var referenceWidth = round(reference.width);\n  var popperWidth = round(popper.width);\n\n  var isVertical = ['left', 'right'].indexOf(data.placement) !== -1;\n  var isVariation = data.placement.indexOf('-') !== -1;\n  var sameWidthParity = referenceWidth % 2 === popperWidth % 2;\n  var bothOddWidth = referenceWidth % 2 === 1 && popperWidth % 2 === 1;\n\n  var horizontalToInteger = !shouldRound ? noRound : isVertical || isVariation || sameWidthParity ? round : floor;\n  var verticalToInteger = !shouldRound ? noRound : round;\n\n  return {\n    left: horizontalToInteger(bothOddWidth && !isVariation && shouldRound ? popper.left - 1 : popper.left),\n    top: verticalToInteger(popper.top),\n    bottom: verticalToInteger(popper.bottom),\n    right: horizontalToInteger(popper.right)\n  };\n}\n\nvar isFirefox = isBrowser && /Firefox/i.test(navigator.userAgent);\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by `update` method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction computeStyle(data, options) {\n  var x = options.x,\n      y = options.y;\n  var popper = data.offsets.popper;\n\n  // Remove this legacy support in Popper.js v2\n\n  var legacyGpuAccelerationOption = find(data.instance.modifiers, function (modifier) {\n    return modifier.name === 'applyStyle';\n  }).gpuAcceleration;\n  if (legacyGpuAccelerationOption !== undefined) {\n    console.warn('WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!');\n  }\n  var gpuAcceleration = legacyGpuAccelerationOption !== undefined ? legacyGpuAccelerationOption : options.gpuAcceleration;\n\n  var offsetParent = getOffsetParent(data.instance.popper);\n  var offsetParentRect = getBoundingClientRect(offsetParent);\n\n  // Styles\n  var styles = {\n    position: popper.position\n  };\n\n  var offsets = getRoundedOffsets(data, window.devicePixelRatio < 2 || !isFirefox);\n\n  var sideA = x === 'bottom' ? 'top' : 'bottom';\n  var sideB = y === 'right' ? 'left' : 'right';\n\n  // if gpuAcceleration is set to `true` and transform is supported,\n  //  we use `translate3d` to apply the position to the popper we\n  // automatically use the supported prefixed version if needed\n  var prefixedProperty = getSupportedPropertyName('transform');\n\n  // now, let's make a step back and look at this code closely (wtf?)\n  // If the content of the popper grows once it's been positioned, it\n  // may happen that the popper gets misplaced because of the new content\n  // overflowing its reference element\n  // To avoid this problem, we provide two options (x and y), which allow\n  // the consumer to define the offset origin.\n  // If we position a popper on top of a reference element, we can set\n  // `x` to `top` to make the popper grow towards its top instead of\n  // its bottom.\n  var left = void 0,\n      top = void 0;\n  if (sideA === 'bottom') {\n    // when offsetParent is <html> the positioning is relative to the bottom of the screen (excluding the scrollbar)\n    // and not the bottom of the html element\n    if (offsetParent.nodeName === 'HTML') {\n      top = -offsetParent.clientHeight + offsets.bottom;\n    } else {\n      top = -offsetParentRect.height + offsets.bottom;\n    }\n  } else {\n    top = offsets.top;\n  }\n  if (sideB === 'right') {\n    if (offsetParent.nodeName === 'HTML') {\n      left = -offsetParent.clientWidth + offsets.right;\n    } else {\n      left = -offsetParentRect.width + offsets.right;\n    }\n  } else {\n    left = offsets.left;\n  }\n  if (gpuAcceleration && prefixedProperty) {\n    styles[prefixedProperty] = 'translate3d(' + left + 'px, ' + top + 'px, 0)';\n    styles[sideA] = 0;\n    styles[sideB] = 0;\n    styles.willChange = 'transform';\n  } else {\n    // othwerise, we use the standard `top`, `left`, `bottom` and `right` properties\n    var invertTop = sideA === 'bottom' ? -1 : 1;\n    var invertLeft = sideB === 'right' ? -1 : 1;\n    styles[sideA] = top * invertTop;\n    styles[sideB] = left * invertLeft;\n    styles.willChange = sideA + ', ' + sideB;\n  }\n\n  // Attributes\n  var attributes = {\n    'x-placement': data.placement\n  };\n\n  // Update `data` attributes, styles and arrowStyles\n  data.attributes = _extends({}, attributes, data.attributes);\n  data.styles = _extends({}, styles, data.styles);\n  data.arrowStyles = _extends({}, data.offsets.arrow, data.arrowStyles);\n\n  return data;\n}\n\n/**\n * Helper used to know if the given modifier depends from another one.<br />\n * It checks if the needed modifier is listed and enabled.\n * @method\n * @memberof Popper.Utils\n * @param {Array} modifiers - list of modifiers\n * @param {String} requestingName - name of requesting modifier\n * @param {String} requestedName - name of requested modifier\n * @returns {Boolean}\n */\nfunction isModifierRequired(modifiers, requestingName, requestedName) {\n  var requesting = find(modifiers, function (_ref) {\n    var name = _ref.name;\n    return name === requestingName;\n  });\n\n  var isRequired = !!requesting && modifiers.some(function (modifier) {\n    return modifier.name === requestedName && modifier.enabled && modifier.order < requesting.order;\n  });\n\n  if (!isRequired) {\n    var _requesting = '`' + requestingName + '`';\n    var requested = '`' + requestedName + '`';\n    console.warn(requested + ' modifier is required by ' + _requesting + ' modifier in order to work, be sure to include it before ' + _requesting + '!');\n  }\n  return isRequired;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by update method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction arrow(data, options) {\n  var _data$offsets$arrow;\n\n  // arrow depends on keepTogether in order to work\n  if (!isModifierRequired(data.instance.modifiers, 'arrow', 'keepTogether')) {\n    return data;\n  }\n\n  var arrowElement = options.element;\n\n  // if arrowElement is a string, suppose it's a CSS selector\n  if (typeof arrowElement === 'string') {\n    arrowElement = data.instance.popper.querySelector(arrowElement);\n\n    // if arrowElement is not found, don't run the modifier\n    if (!arrowElement) {\n      return data;\n    }\n  } else {\n    // if the arrowElement isn't a query selector we must check that the\n    // provided DOM node is child of its popper node\n    if (!data.instance.popper.contains(arrowElement)) {\n      console.warn('WARNING: `arrow.element` must be child of its popper element!');\n      return data;\n    }\n  }\n\n  var placement = data.placement.split('-')[0];\n  var _data$offsets = data.offsets,\n      popper = _data$offsets.popper,\n      reference = _data$offsets.reference;\n\n  var isVertical = ['left', 'right'].indexOf(placement) !== -1;\n\n  var len = isVertical ? 'height' : 'width';\n  var sideCapitalized = isVertical ? 'Top' : 'Left';\n  var side = sideCapitalized.toLowerCase();\n  var altSide = isVertical ? 'left' : 'top';\n  var opSide = isVertical ? 'bottom' : 'right';\n  var arrowElementSize = getOuterSizes(arrowElement)[len];\n\n  //\n  // extends keepTogether behavior making sure the popper and its\n  // reference have enough pixels in conjunction\n  //\n\n  // top/left side\n  if (reference[opSide] - arrowElementSize < popper[side]) {\n    data.offsets.popper[side] -= popper[side] - (reference[opSide] - arrowElementSize);\n  }\n  // bottom/right side\n  if (reference[side] + arrowElementSize > popper[opSide]) {\n    data.offsets.popper[side] += reference[side] + arrowElementSize - popper[opSide];\n  }\n  data.offsets.popper = getClientRect(data.offsets.popper);\n\n  // compute center of the popper\n  var center = reference[side] + reference[len] / 2 - arrowElementSize / 2;\n\n  // Compute the sideValue using the updated popper offsets\n  // take popper margin in account because we don't have this info available\n  var css = getStyleComputedProperty(data.instance.popper);\n  var popperMarginSide = parseFloat(css['margin' + sideCapitalized], 10);\n  var popperBorderSide = parseFloat(css['border' + sideCapitalized + 'Width'], 10);\n  var sideValue = center - data.offsets.popper[side] - popperMarginSide - popperBorderSide;\n\n  // prevent arrowElement from being placed not contiguously to its popper\n  sideValue = Math.max(Math.min(popper[len] - arrowElementSize, sideValue), 0);\n\n  data.arrowElement = arrowElement;\n  data.offsets.arrow = (_data$offsets$arrow = {}, defineProperty(_data$offsets$arrow, side, Math.round(sideValue)), defineProperty(_data$offsets$arrow, altSide, ''), _data$offsets$arrow);\n\n  return data;\n}\n\n/**\n * Get the opposite placement variation of the given one\n * @method\n * @memberof Popper.Utils\n * @argument {String} placement variation\n * @returns {String} flipped placement variation\n */\nfunction getOppositeVariation(variation) {\n  if (variation === 'end') {\n    return 'start';\n  } else if (variation === 'start') {\n    return 'end';\n  }\n  return variation;\n}\n\n/**\n * List of accepted placements to use as values of the `placement` option.<br />\n * Valid placements are:\n * - `auto`\n * - `top`\n * - `right`\n * - `bottom`\n * - `left`\n *\n * Each placement can have a variation from this list:\n * - `-start`\n * - `-end`\n *\n * Variations are interpreted easily if you think of them as the left to right\n * written languages. Horizontally (`top` and `bottom`), `start` is left and `end`\n * is right.<br />\n * Vertically (`left` and `right`), `start` is top and `end` is bottom.\n *\n * Some valid examples are:\n * - `top-end` (on top of reference, right aligned)\n * - `right-start` (on right of reference, top aligned)\n * - `bottom` (on bottom, centered)\n * - `auto-end` (on the side with more space available, alignment depends by placement)\n *\n * @static\n * @type {Array}\n * @enum {String}\n * @readonly\n * @method placements\n * @memberof Popper\n */\nvar placements = ['auto-start', 'auto', 'auto-end', 'top-start', 'top', 'top-end', 'right-start', 'right', 'right-end', 'bottom-end', 'bottom', 'bottom-start', 'left-end', 'left', 'left-start'];\n\n// Get rid of `auto` `auto-start` and `auto-end`\nvar validPlacements = placements.slice(3);\n\n/**\n * Given an initial placement, returns all the subsequent placements\n * clockwise (or counter-clockwise).\n *\n * @method\n * @memberof Popper.Utils\n * @argument {String} placement - A valid placement (it accepts variations)\n * @argument {Boolean} counter - Set to true to walk the placements counterclockwise\n * @returns {Array} placements including their variations\n */\nfunction clockwise(placement) {\n  var counter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  var index = validPlacements.indexOf(placement);\n  var arr = validPlacements.slice(index + 1).concat(validPlacements.slice(0, index));\n  return counter ? arr.reverse() : arr;\n}\n\nvar BEHAVIORS = {\n  FLIP: 'flip',\n  CLOCKWISE: 'clockwise',\n  COUNTERCLOCKWISE: 'counterclockwise'\n};\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by update method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction flip(data, options) {\n  // if `inner` modifier is enabled, we can't use the `flip` modifier\n  if (isModifierEnabled(data.instance.modifiers, 'inner')) {\n    return data;\n  }\n\n  if (data.flipped && data.placement === data.originalPlacement) {\n    // seems like flip is trying to loop, probably there's not enough space on any of the flippable sides\n    return data;\n  }\n\n  var boundaries = getBoundaries(data.instance.popper, data.instance.reference, options.padding, options.boundariesElement, data.positionFixed);\n\n  var placement = data.placement.split('-')[0];\n  var placementOpposite = getOppositePlacement(placement);\n  var variation = data.placement.split('-')[1] || '';\n\n  var flipOrder = [];\n\n  switch (options.behavior) {\n    case BEHAVIORS.FLIP:\n      flipOrder = [placement, placementOpposite];\n      break;\n    case BEHAVIORS.CLOCKWISE:\n      flipOrder = clockwise(placement);\n      break;\n    case BEHAVIORS.COUNTERCLOCKWISE:\n      flipOrder = clockwise(placement, true);\n      break;\n    default:\n      flipOrder = options.behavior;\n  }\n\n  flipOrder.forEach(function (step, index) {\n    if (placement !== step || flipOrder.length === index + 1) {\n      return data;\n    }\n\n    placement = data.placement.split('-')[0];\n    placementOpposite = getOppositePlacement(placement);\n\n    var popperOffsets = data.offsets.popper;\n    var refOffsets = data.offsets.reference;\n\n    // using floor because the reference offsets may contain decimals we are not going to consider here\n    var floor = Math.floor;\n    var overlapsRef = placement === 'left' && floor(popperOffsets.right) > floor(refOffsets.left) || placement === 'right' && floor(popperOffsets.left) < floor(refOffsets.right) || placement === 'top' && floor(popperOffsets.bottom) > floor(refOffsets.top) || placement === 'bottom' && floor(popperOffsets.top) < floor(refOffsets.bottom);\n\n    var overflowsLeft = floor(popperOffsets.left) < floor(boundaries.left);\n    var overflowsRight = floor(popperOffsets.right) > floor(boundaries.right);\n    var overflowsTop = floor(popperOffsets.top) < floor(boundaries.top);\n    var overflowsBottom = floor(popperOffsets.bottom) > floor(boundaries.bottom);\n\n    var overflowsBoundaries = placement === 'left' && overflowsLeft || placement === 'right' && overflowsRight || placement === 'top' && overflowsTop || placement === 'bottom' && overflowsBottom;\n\n    // flip the variation if required\n    var isVertical = ['top', 'bottom'].indexOf(placement) !== -1;\n\n    // flips variation if reference element overflows boundaries\n    var flippedVariationByRef = !!options.flipVariations && (isVertical && variation === 'start' && overflowsLeft || isVertical && variation === 'end' && overflowsRight || !isVertical && variation === 'start' && overflowsTop || !isVertical && variation === 'end' && overflowsBottom);\n\n    // flips variation if popper content overflows boundaries\n    var flippedVariationByContent = !!options.flipVariationsByContent && (isVertical && variation === 'start' && overflowsRight || isVertical && variation === 'end' && overflowsLeft || !isVertical && variation === 'start' && overflowsBottom || !isVertical && variation === 'end' && overflowsTop);\n\n    var flippedVariation = flippedVariationByRef || flippedVariationByContent;\n\n    if (overlapsRef || overflowsBoundaries || flippedVariation) {\n      // this boolean to detect any flip loop\n      data.flipped = true;\n\n      if (overlapsRef || overflowsBoundaries) {\n        placement = flipOrder[index + 1];\n      }\n\n      if (flippedVariation) {\n        variation = getOppositeVariation(variation);\n      }\n\n      data.placement = placement + (variation ? '-' + variation : '');\n\n      // this object contains `position`, we want to preserve it along with\n      // any additional property we may add in the future\n      data.offsets.popper = _extends({}, data.offsets.popper, getPopperOffsets(data.instance.popper, data.offsets.reference, data.placement));\n\n      data = runModifiers(data.instance.modifiers, data, 'flip');\n    }\n  });\n  return data;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by update method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction keepTogether(data) {\n  var _data$offsets = data.offsets,\n      popper = _data$offsets.popper,\n      reference = _data$offsets.reference;\n\n  var placement = data.placement.split('-')[0];\n  var floor = Math.floor;\n  var isVertical = ['top', 'bottom'].indexOf(placement) !== -1;\n  var side = isVertical ? 'right' : 'bottom';\n  var opSide = isVertical ? 'left' : 'top';\n  var measurement = isVertical ? 'width' : 'height';\n\n  if (popper[side] < floor(reference[opSide])) {\n    data.offsets.popper[opSide] = floor(reference[opSide]) - popper[measurement];\n  }\n  if (popper[opSide] > floor(reference[side])) {\n    data.offsets.popper[opSide] = floor(reference[side]);\n  }\n\n  return data;\n}\n\n/**\n * Converts a string containing value + unit into a px value number\n * @function\n * @memberof {modifiers~offset}\n * @private\n * @argument {String} str - Value + unit string\n * @argument {String} measurement - `height` or `width`\n * @argument {Object} popperOffsets\n * @argument {Object} referenceOffsets\n * @returns {Number|String}\n * Value in pixels, or original string if no values were extracted\n */\nfunction toValue(str, measurement, popperOffsets, referenceOffsets) {\n  // separate value from unit\n  var split = str.match(/((?:\\-|\\+)?\\d*\\.?\\d*)(.*)/);\n  var value = +split[1];\n  var unit = split[2];\n\n  // If it's not a number it's an operator, I guess\n  if (!value) {\n    return str;\n  }\n\n  if (unit.indexOf('%') === 0) {\n    var element = void 0;\n    switch (unit) {\n      case '%p':\n        element = popperOffsets;\n        break;\n      case '%':\n      case '%r':\n      default:\n        element = referenceOffsets;\n    }\n\n    var rect = getClientRect(element);\n    return rect[measurement] / 100 * value;\n  } else if (unit === 'vh' || unit === 'vw') {\n    // if is a vh or vw, we calculate the size based on the viewport\n    var size = void 0;\n    if (unit === 'vh') {\n      size = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n    } else {\n      size = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n    }\n    return size / 100 * value;\n  } else {\n    // if is an explicit pixel unit, we get rid of the unit and keep the value\n    // if is an implicit unit, it's px, and we return just the value\n    return value;\n  }\n}\n\n/**\n * Parse an `offset` string to extrapolate `x` and `y` numeric offsets.\n * @function\n * @memberof {modifiers~offset}\n * @private\n * @argument {String} offset\n * @argument {Object} popperOffsets\n * @argument {Object} referenceOffsets\n * @argument {String} basePlacement\n * @returns {Array} a two cells array with x and y offsets in numbers\n */\nfunction parseOffset(offset, popperOffsets, referenceOffsets, basePlacement) {\n  var offsets = [0, 0];\n\n  // Use height if placement is left or right and index is 0 otherwise use width\n  // in this way the first offset will use an axis and the second one\n  // will use the other one\n  var useHeight = ['right', 'left'].indexOf(basePlacement) !== -1;\n\n  // Split the offset string to obtain a list of values and operands\n  // The regex addresses values with the plus or minus sign in front (+10, -20, etc)\n  var fragments = offset.split(/(\\+|\\-)/).map(function (frag) {\n    return frag.trim();\n  });\n\n  // Detect if the offset string contains a pair of values or a single one\n  // they could be separated by comma or space\n  var divider = fragments.indexOf(find(fragments, function (frag) {\n    return frag.search(/,|\\s/) !== -1;\n  }));\n\n  if (fragments[divider] && fragments[divider].indexOf(',') === -1) {\n    console.warn('Offsets separated by white space(s) are deprecated, use a comma (,) instead.');\n  }\n\n  // If divider is found, we divide the list of values and operands to divide\n  // them by ofset X and Y.\n  var splitRegex = /\\s*,\\s*|\\s+/;\n  var ops = divider !== -1 ? [fragments.slice(0, divider).concat([fragments[divider].split(splitRegex)[0]]), [fragments[divider].split(splitRegex)[1]].concat(fragments.slice(divider + 1))] : [fragments];\n\n  // Convert the values with units to absolute pixels to allow our computations\n  ops = ops.map(function (op, index) {\n    // Most of the units rely on the orientation of the popper\n    var measurement = (index === 1 ? !useHeight : useHeight) ? 'height' : 'width';\n    var mergeWithPrevious = false;\n    return op\n    // This aggregates any `+` or `-` sign that aren't considered operators\n    // e.g.: 10 + +5 => [10, +, +5]\n    .reduce(function (a, b) {\n      if (a[a.length - 1] === '' && ['+', '-'].indexOf(b) !== -1) {\n        a[a.length - 1] = b;\n        mergeWithPrevious = true;\n        return a;\n      } else if (mergeWithPrevious) {\n        a[a.length - 1] += b;\n        mergeWithPrevious = false;\n        return a;\n      } else {\n        return a.concat(b);\n      }\n    }, [])\n    // Here we convert the string values into number values (in px)\n    .map(function (str) {\n      return toValue(str, measurement, popperOffsets, referenceOffsets);\n    });\n  });\n\n  // Loop trough the offsets arrays and execute the operations\n  ops.forEach(function (op, index) {\n    op.forEach(function (frag, index2) {\n      if (isNumeric(frag)) {\n        offsets[index] += frag * (op[index2 - 1] === '-' ? -1 : 1);\n      }\n    });\n  });\n  return offsets;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by update method\n * @argument {Object} options - Modifiers configuration and options\n * @argument {Number|String} options.offset=0\n * The offset value as described in the modifier description\n * @returns {Object} The data object, properly modified\n */\nfunction offset(data, _ref) {\n  var offset = _ref.offset;\n  var placement = data.placement,\n      _data$offsets = data.offsets,\n      popper = _data$offsets.popper,\n      reference = _data$offsets.reference;\n\n  var basePlacement = placement.split('-')[0];\n\n  var offsets = void 0;\n  if (isNumeric(+offset)) {\n    offsets = [+offset, 0];\n  } else {\n    offsets = parseOffset(offset, popper, reference, basePlacement);\n  }\n\n  if (basePlacement === 'left') {\n    popper.top += offsets[0];\n    popper.left -= offsets[1];\n  } else if (basePlacement === 'right') {\n    popper.top += offsets[0];\n    popper.left += offsets[1];\n  } else if (basePlacement === 'top') {\n    popper.left += offsets[0];\n    popper.top -= offsets[1];\n  } else if (basePlacement === 'bottom') {\n    popper.left += offsets[0];\n    popper.top += offsets[1];\n  }\n\n  data.popper = popper;\n  return data;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by `update` method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction preventOverflow(data, options) {\n  var boundariesElement = options.boundariesElement || getOffsetParent(data.instance.popper);\n\n  // If offsetParent is the reference element, we really want to\n  // go one step up and use the next offsetParent as reference to\n  // avoid to make this modifier completely useless and look like broken\n  if (data.instance.reference === boundariesElement) {\n    boundariesElement = getOffsetParent(boundariesElement);\n  }\n\n  // NOTE: DOM access here\n  // resets the popper's position so that the document size can be calculated excluding\n  // the size of the popper element itself\n  var transformProp = getSupportedPropertyName('transform');\n  var popperStyles = data.instance.popper.style; // assignment to help minification\n  var top = popperStyles.top,\n      left = popperStyles.left,\n      transform = popperStyles[transformProp];\n\n  popperStyles.top = '';\n  popperStyles.left = '';\n  popperStyles[transformProp] = '';\n\n  var boundaries = getBoundaries(data.instance.popper, data.instance.reference, options.padding, boundariesElement, data.positionFixed);\n\n  // NOTE: DOM access here\n  // restores the original style properties after the offsets have been computed\n  popperStyles.top = top;\n  popperStyles.left = left;\n  popperStyles[transformProp] = transform;\n\n  options.boundaries = boundaries;\n\n  var order = options.priority;\n  var popper = data.offsets.popper;\n\n  var check = {\n    primary: function primary(placement) {\n      var value = popper[placement];\n      if (popper[placement] < boundaries[placement] && !options.escapeWithReference) {\n        value = Math.max(popper[placement], boundaries[placement]);\n      }\n      return defineProperty({}, placement, value);\n    },\n    secondary: function secondary(placement) {\n      var mainSide = placement === 'right' ? 'left' : 'top';\n      var value = popper[mainSide];\n      if (popper[placement] > boundaries[placement] && !options.escapeWithReference) {\n        value = Math.min(popper[mainSide], boundaries[placement] - (placement === 'right' ? popper.width : popper.height));\n      }\n      return defineProperty({}, mainSide, value);\n    }\n  };\n\n  order.forEach(function (placement) {\n    var side = ['left', 'top'].indexOf(placement) !== -1 ? 'primary' : 'secondary';\n    popper = _extends({}, popper, check[side](placement));\n  });\n\n  data.offsets.popper = popper;\n\n  return data;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by `update` method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction shift(data) {\n  var placement = data.placement;\n  var basePlacement = placement.split('-')[0];\n  var shiftvariation = placement.split('-')[1];\n\n  // if shift shiftvariation is specified, run the modifier\n  if (shiftvariation) {\n    var _data$offsets = data.offsets,\n        reference = _data$offsets.reference,\n        popper = _data$offsets.popper;\n\n    var isVertical = ['bottom', 'top'].indexOf(basePlacement) !== -1;\n    var side = isVertical ? 'left' : 'top';\n    var measurement = isVertical ? 'width' : 'height';\n\n    var shiftOffsets = {\n      start: defineProperty({}, side, reference[side]),\n      end: defineProperty({}, side, reference[side] + reference[measurement] - popper[measurement])\n    };\n\n    data.offsets.popper = _extends({}, popper, shiftOffsets[shiftvariation]);\n  }\n\n  return data;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by update method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction hide(data) {\n  if (!isModifierRequired(data.instance.modifiers, 'hide', 'preventOverflow')) {\n    return data;\n  }\n\n  var refRect = data.offsets.reference;\n  var bound = find(data.instance.modifiers, function (modifier) {\n    return modifier.name === 'preventOverflow';\n  }).boundaries;\n\n  if (refRect.bottom < bound.top || refRect.left > bound.right || refRect.top > bound.bottom || refRect.right < bound.left) {\n    // Avoid unnecessary DOM access if visibility hasn't changed\n    if (data.hide === true) {\n      return data;\n    }\n\n    data.hide = true;\n    data.attributes['x-out-of-boundaries'] = '';\n  } else {\n    // Avoid unnecessary DOM access if visibility hasn't changed\n    if (data.hide === false) {\n      return data;\n    }\n\n    data.hide = false;\n    data.attributes['x-out-of-boundaries'] = false;\n  }\n\n  return data;\n}\n\n/**\n * @function\n * @memberof Modifiers\n * @argument {Object} data - The data object generated by `update` method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {Object} The data object, properly modified\n */\nfunction inner(data) {\n  var placement = data.placement;\n  var basePlacement = placement.split('-')[0];\n  var _data$offsets = data.offsets,\n      popper = _data$offsets.popper,\n      reference = _data$offsets.reference;\n\n  var isHoriz = ['left', 'right'].indexOf(basePlacement) !== -1;\n\n  var subtractLength = ['top', 'left'].indexOf(basePlacement) === -1;\n\n  popper[isHoriz ? 'left' : 'top'] = reference[basePlacement] - (subtractLength ? popper[isHoriz ? 'width' : 'height'] : 0);\n\n  data.placement = getOppositePlacement(placement);\n  data.offsets.popper = getClientRect(popper);\n\n  return data;\n}\n\n/**\n * Modifier function, each modifier can have a function of this type assigned\n * to its `fn` property.<br />\n * These functions will be called on each update, this means that you must\n * make sure they are performant enough to avoid performance bottlenecks.\n *\n * @function ModifierFn\n * @argument {dataObject} data - The data object generated by `update` method\n * @argument {Object} options - Modifiers configuration and options\n * @returns {dataObject} The data object, properly modified\n */\n\n/**\n * Modifiers are plugins used to alter the behavior of your poppers.<br />\n * Popper.js uses a set of 9 modifiers to provide all the basic functionalities\n * needed by the library.\n *\n * Usually you don't want to override the `order`, `fn` and `onLoad` props.\n * All the other properties are configurations that could be tweaked.\n * @namespace modifiers\n */\nvar modifiers = {\n  /**\n   * Modifier used to shift the popper on the start or end of its reference\n   * element.<br />\n   * It will read the variation of the `placement` property.<br />\n   * It can be one either `-end` or `-start`.\n   * @memberof modifiers\n   * @inner\n   */\n  shift: {\n    /** @prop {number} order=100 - Index used to define the order of execution */\n    order: 100,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: shift\n  },\n\n  /**\n   * The `offset` modifier can shift your popper on both its axis.\n   *\n   * It accepts the following units:\n   * - `px` or unit-less, interpreted as pixels\n   * - `%` or `%r`, percentage relative to the length of the reference element\n   * - `%p`, percentage relative to the length of the popper element\n   * - `vw`, CSS viewport width unit\n   * - `vh`, CSS viewport height unit\n   *\n   * For length is intended the main axis relative to the placement of the popper.<br />\n   * This means that if the placement is `top` or `bottom`, the length will be the\n   * `width`. In case of `left` or `right`, it will be the `height`.\n   *\n   * You can provide a single value (as `Number` or `String`), or a pair of values\n   * as `String` divided by a comma or one (or more) white spaces.<br />\n   * The latter is a deprecated method because it leads to confusion and will be\n   * removed in v2.<br />\n   * Additionally, it accepts additions and subtractions between different units.\n   * Note that multiplications and divisions aren't supported.\n   *\n   * Valid examples are:\n   * ```\n   * 10\n   * '10%'\n   * '10, 10'\n   * '10%, 10'\n   * '10 + 10%'\n   * '10 - 5vh + 3%'\n   * '-10px + 5vh, 5px - 6%'\n   * ```\n   * > **NB**: If you desire to apply offsets to your poppers in a way that may make them overlap\n   * > with their reference element, unfortunately, you will have to disable the `flip` modifier.\n   * > You can read more on this at this [issue](https://github.com/FezVrasta/popper.js/issues/373).\n   *\n   * @memberof modifiers\n   * @inner\n   */\n  offset: {\n    /** @prop {number} order=200 - Index used to define the order of execution */\n    order: 200,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: offset,\n    /** @prop {Number|String} offset=0\n     * The offset value as described in the modifier description\n     */\n    offset: 0\n  },\n\n  /**\n   * Modifier used to prevent the popper from being positioned outside the boundary.\n   *\n   * A scenario exists where the reference itself is not within the boundaries.<br />\n   * We can say it has \"escaped the boundaries\"  or just \"escaped\".<br />\n   * In this case we need to decide whether the popper should either:\n   *\n   * - detach from the reference and remain \"trapped\" in the boundaries, or\n   * - if it should ignore the boundary and \"escape with its reference\"\n   *\n   * When `escapeWithReference` is set to`true` and reference is completely\n   * outside its boundaries, the popper will overflow (or completely leave)\n   * the boundaries in order to remain attached to the edge of the reference.\n   *\n   * @memberof modifiers\n   * @inner\n   */\n  preventOverflow: {\n    /** @prop {number} order=300 - Index used to define the order of execution */\n    order: 300,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: preventOverflow,\n    /**\n     * @prop {Array} [priority=['left','right','top','bottom']]\n     * Popper will try to prevent overflow following these priorities by default,\n     * then, it could overflow on the left and on top of the `boundariesElement`\n     */\n    priority: ['left', 'right', 'top', 'bottom'],\n    /**\n     * @prop {number} padding=5\n     * Amount of pixel used to define a minimum distance between the boundaries\n     * and the popper. This makes sure the popper always has a little padding\n     * between the edges of its container\n     */\n    padding: 5,\n    /**\n     * @prop {String|HTMLElement} boundariesElement='scrollParent'\n     * Boundaries used by the modifier. Can be `scrollParent`, `window`,\n     * `viewport` or any DOM element.\n     */\n    boundariesElement: 'scrollParent'\n  },\n\n  /**\n   * Modifier used to make sure the reference and its popper stay near each other\n   * without leaving any gap between the two. Especially useful when the arrow is\n   * enabled and you want to ensure that it points to its reference element.\n   * It cares only about the first axis. You can still have poppers with margin\n   * between the popper and its reference element.\n   * @memberof modifiers\n   * @inner\n   */\n  keepTogether: {\n    /** @prop {number} order=400 - Index used to define the order of execution */\n    order: 400,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: keepTogether\n  },\n\n  /**\n   * This modifier is used to move the `arrowElement` of the popper to make\n   * sure it is positioned between the reference element and its popper element.\n   * It will read the outer size of the `arrowElement` node to detect how many\n   * pixels of conjunction are needed.\n   *\n   * It has no effect if no `arrowElement` is provided.\n   * @memberof modifiers\n   * @inner\n   */\n  arrow: {\n    /** @prop {number} order=500 - Index used to define the order of execution */\n    order: 500,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: arrow,\n    /** @prop {String|HTMLElement} element='[x-arrow]' - Selector or node used as arrow */\n    element: '[x-arrow]'\n  },\n\n  /**\n   * Modifier used to flip the popper's placement when it starts to overlap its\n   * reference element.\n   *\n   * Requires the `preventOverflow` modifier before it in order to work.\n   *\n   * **NOTE:** this modifier will interrupt the current update cycle and will\n   * restart it if it detects the need to flip the placement.\n   * @memberof modifiers\n   * @inner\n   */\n  flip: {\n    /** @prop {number} order=600 - Index used to define the order of execution */\n    order: 600,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: flip,\n    /**\n     * @prop {String|Array} behavior='flip'\n     * The behavior used to change the popper's placement. It can be one of\n     * `flip`, `clockwise`, `counterclockwise` or an array with a list of valid\n     * placements (with optional variations)\n     */\n    behavior: 'flip',\n    /**\n     * @prop {number} padding=5\n     * The popper will flip if it hits the edges of the `boundariesElement`\n     */\n    padding: 5,\n    /**\n     * @prop {String|HTMLElement} boundariesElement='viewport'\n     * The element which will define the boundaries of the popper position.\n     * The popper will never be placed outside of the defined boundaries\n     * (except if `keepTogether` is enabled)\n     */\n    boundariesElement: 'viewport',\n    /**\n     * @prop {Boolean} flipVariations=false\n     * The popper will switch placement variation between `-start` and `-end` when\n     * the reference element overlaps its boundaries.\n     *\n     * The original placement should have a set variation.\n     */\n    flipVariations: false,\n    /**\n     * @prop {Boolean} flipVariationsByContent=false\n     * The popper will switch placement variation between `-start` and `-end` when\n     * the popper element overlaps its reference boundaries.\n     *\n     * The original placement should have a set variation.\n     */\n    flipVariationsByContent: false\n  },\n\n  /**\n   * Modifier used to make the popper flow toward the inner of the reference element.\n   * By default, when this modifier is disabled, the popper will be placed outside\n   * the reference element.\n   * @memberof modifiers\n   * @inner\n   */\n  inner: {\n    /** @prop {number} order=700 - Index used to define the order of execution */\n    order: 700,\n    /** @prop {Boolean} enabled=false - Whether the modifier is enabled or not */\n    enabled: false,\n    /** @prop {ModifierFn} */\n    fn: inner\n  },\n\n  /**\n   * Modifier used to hide the popper when its reference element is outside of the\n   * popper boundaries. It will set a `x-out-of-boundaries` attribute which can\n   * be used to hide with a CSS selector the popper when its reference is\n   * out of boundaries.\n   *\n   * Requires the `preventOverflow` modifier before it in order to work.\n   * @memberof modifiers\n   * @inner\n   */\n  hide: {\n    /** @prop {number} order=800 - Index used to define the order of execution */\n    order: 800,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: hide\n  },\n\n  /**\n   * Computes the style that will be applied to the popper element to gets\n   * properly positioned.\n   *\n   * Note that this modifier will not touch the DOM, it just prepares the styles\n   * so that `applyStyle` modifier can apply it. This separation is useful\n   * in case you need to replace `applyStyle` with a custom implementation.\n   *\n   * This modifier has `850` as `order` value to maintain backward compatibility\n   * with previous versions of Popper.js. Expect the modifiers ordering method\n   * to change in future major versions of the library.\n   *\n   * @memberof modifiers\n   * @inner\n   */\n  computeStyle: {\n    /** @prop {number} order=850 - Index used to define the order of execution */\n    order: 850,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: computeStyle,\n    /**\n     * @prop {Boolean} gpuAcceleration=true\n     * If true, it uses the CSS 3D transformation to position the popper.\n     * Otherwise, it will use the `top` and `left` properties\n     */\n    gpuAcceleration: true,\n    /**\n     * @prop {string} [x='bottom']\n     * Where to anchor the X axis (`bottom` or `top`). AKA X offset origin.\n     * Change this if your popper should grow in a direction different from `bottom`\n     */\n    x: 'bottom',\n    /**\n     * @prop {string} [x='left']\n     * Where to anchor the Y axis (`left` or `right`). AKA Y offset origin.\n     * Change this if your popper should grow in a direction different from `right`\n     */\n    y: 'right'\n  },\n\n  /**\n   * Applies the computed styles to the popper element.\n   *\n   * All the DOM manipulations are limited to this modifier. This is useful in case\n   * you want to integrate Popper.js inside a framework or view library and you\n   * want to delegate all the DOM manipulations to it.\n   *\n   * Note that if you disable this modifier, you must make sure the popper element\n   * has its position set to `absolute` before Popper.js can do its work!\n   *\n   * Just disable this modifier and define your own to achieve the desired effect.\n   *\n   * @memberof modifiers\n   * @inner\n   */\n  applyStyle: {\n    /** @prop {number} order=900 - Index used to define the order of execution */\n    order: 900,\n    /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */\n    enabled: true,\n    /** @prop {ModifierFn} */\n    fn: applyStyle,\n    /** @prop {Function} */\n    onLoad: applyStyleOnLoad,\n    /**\n     * @deprecated since version 1.10.0, the property moved to `computeStyle` modifier\n     * @prop {Boolean} gpuAcceleration=true\n     * If true, it uses the CSS 3D transformation to position the popper.\n     * Otherwise, it will use the `top` and `left` properties\n     */\n    gpuAcceleration: undefined\n  }\n};\n\n/**\n * The `dataObject` is an object containing all the information used by Popper.js.\n * This object is passed to modifiers and to the `onCreate` and `onUpdate` callbacks.\n * @name dataObject\n * @property {Object} data.instance The Popper.js instance\n * @property {String} data.placement Placement applied to popper\n * @property {String} data.originalPlacement Placement originally defined on init\n * @property {Boolean} data.flipped True if popper has been flipped by flip modifier\n * @property {Boolean} data.hide True if the reference element is out of boundaries, useful to know when to hide the popper\n * @property {HTMLElement} data.arrowElement Node used as arrow by arrow modifier\n * @property {Object} data.styles Any CSS property defined here will be applied to the popper. It expects the JavaScript nomenclature (eg. `marginBottom`)\n * @property {Object} data.arrowStyles Any CSS property defined here will be applied to the popper arrow. It expects the JavaScript nomenclature (eg. `marginBottom`)\n * @property {Object} data.boundaries Offsets of the popper boundaries\n * @property {Object} data.offsets The measurements of popper, reference and arrow elements\n * @property {Object} data.offsets.popper `top`, `left`, `width`, `height` values\n * @property {Object} data.offsets.reference `top`, `left`, `width`, `height` values\n * @property {Object} data.offsets.arrow] `top` and `left` offsets, only one of them will be different from 0\n */\n\n/**\n * Default options provided to Popper.js constructor.<br />\n * These can be overridden using the `options` argument of Popper.js.<br />\n * To override an option, simply pass an object with the same\n * structure of the `options` object, as the 3rd argument. For example:\n * ```\n * new Popper(ref, pop, {\n *   modifiers: {\n *     preventOverflow: { enabled: false }\n *   }\n * })\n * ```\n * @type {Object}\n * @static\n * @memberof Popper\n */\nvar Defaults = {\n  /**\n   * Popper's placement.\n   * @prop {Popper.placements} placement='bottom'\n   */\n  placement: 'bottom',\n\n  /**\n   * Set this to true if you want popper to position it self in 'fixed' mode\n   * @prop {Boolean} positionFixed=false\n   */\n  positionFixed: false,\n\n  /**\n   * Whether events (resize, scroll) are initially enabled.\n   * @prop {Boolean} eventsEnabled=true\n   */\n  eventsEnabled: true,\n\n  /**\n   * Set to true if you want to automatically remove the popper when\n   * you call the `destroy` method.\n   * @prop {Boolean} removeOnDestroy=false\n   */\n  removeOnDestroy: false,\n\n  /**\n   * Callback called when the popper is created.<br />\n   * By default, it is set to no-op.<br />\n   * Access Popper.js instance with `data.instance`.\n   * @prop {onCreate}\n   */\n  onCreate: function onCreate() {},\n\n  /**\n   * Callback called when the popper is updated. This callback is not called\n   * on the initialization/creation of the popper, but only on subsequent\n   * updates.<br />\n   * By default, it is set to no-op.<br />\n   * Access Popper.js instance with `data.instance`.\n   * @prop {onUpdate}\n   */\n  onUpdate: function onUpdate() {},\n\n  /**\n   * List of modifiers used to modify the offsets before they are applied to the popper.\n   * They provide most of the functionalities of Popper.js.\n   * @prop {modifiers}\n   */\n  modifiers: modifiers\n};\n\n/**\n * @callback onCreate\n * @param {dataObject} data\n */\n\n/**\n * @callback onUpdate\n * @param {dataObject} data\n */\n\n// Utils\n// Methods\nvar Popper = function () {\n  /**\n   * Creates a new Popper.js instance.\n   * @class Popper\n   * @param {Element|referenceObject} reference - The reference element used to position the popper\n   * @param {Element} popper - The HTML / XML element used as the popper\n   * @param {Object} options - Your custom options to override the ones defined in [Defaults](#defaults)\n   * @return {Object} instance - The generated Popper.js instance\n   */\n  function Popper(reference, popper) {\n    var _this = this;\n\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    classCallCheck(this, Popper);\n\n    this.scheduleUpdate = function () {\n      return requestAnimationFrame(_this.update);\n    };\n\n    // make update() debounced, so that it only runs at most once-per-tick\n    this.update = debounce(this.update.bind(this));\n\n    // with {} we create a new object with the options inside it\n    this.options = _extends({}, Popper.Defaults, options);\n\n    // init state\n    this.state = {\n      isDestroyed: false,\n      isCreated: false,\n      scrollParents: []\n    };\n\n    // get reference and popper elements (allow jQuery wrappers)\n    this.reference = reference && reference.jquery ? reference[0] : reference;\n    this.popper = popper && popper.jquery ? popper[0] : popper;\n\n    // Deep merge modifiers options\n    this.options.modifiers = {};\n    Object.keys(_extends({}, Popper.Defaults.modifiers, options.modifiers)).forEach(function (name) {\n      _this.options.modifiers[name] = _extends({}, Popper.Defaults.modifiers[name] || {}, options.modifiers ? options.modifiers[name] : {});\n    });\n\n    // Refactoring modifiers' list (Object => Array)\n    this.modifiers = Object.keys(this.options.modifiers).map(function (name) {\n      return _extends({\n        name: name\n      }, _this.options.modifiers[name]);\n    })\n    // sort the modifiers by order\n    .sort(function (a, b) {\n      return a.order - b.order;\n    });\n\n    // modifiers have the ability to execute arbitrary code when Popper.js get inited\n    // such code is executed in the same order of its modifier\n    // they could add new properties to their options configuration\n    // BE AWARE: don't add options to `options.modifiers.name` but to `modifierOptions`!\n    this.modifiers.forEach(function (modifierOptions) {\n      if (modifierOptions.enabled && isFunction(modifierOptions.onLoad)) {\n        modifierOptions.onLoad(_this.reference, _this.popper, _this.options, modifierOptions, _this.state);\n      }\n    });\n\n    // fire the first update to position the popper in the right place\n    this.update();\n\n    var eventsEnabled = this.options.eventsEnabled;\n    if (eventsEnabled) {\n      // setup event listeners, they will take care of update the position in specific situations\n      this.enableEventListeners();\n    }\n\n    this.state.eventsEnabled = eventsEnabled;\n  }\n\n  // We can't use class properties because they don't get listed in the\n  // class prototype and break stuff like Sinon stubs\n\n\n  createClass(Popper, [{\n    key: 'update',\n    value: function update$$1() {\n      return update.call(this);\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy$$1() {\n      return destroy.call(this);\n    }\n  }, {\n    key: 'enableEventListeners',\n    value: function enableEventListeners$$1() {\n      return enableEventListeners.call(this);\n    }\n  }, {\n    key: 'disableEventListeners',\n    value: function disableEventListeners$$1() {\n      return disableEventListeners.call(this);\n    }\n\n    /**\n     * Schedules an update. It will run on the next UI update available.\n     * @method scheduleUpdate\n     * @memberof Popper\n     */\n\n\n    /**\n     * Collection of utilities useful when writing custom modifiers.\n     * Starting from version 1.7, this method is available only if you\n     * include `popper-utils.js` before `popper.js`.\n     *\n     * **DEPRECATION**: This way to access PopperUtils is deprecated\n     * and will be removed in v2! Use the PopperUtils module directly instead.\n     * Due to the high instability of the methods contained in Utils, we can't\n     * guarantee them to follow semver. Use them at your own risk!\n     * @static\n     * @private\n     * @type {Object}\n     * @deprecated since version 1.8\n     * @member Utils\n     * @memberof Popper\n     */\n\n  }]);\n  return Popper;\n}();\n\n/**\n * The `referenceObject` is an object that provides an interface compatible with Popper.js\n * and lets you use it as replacement of a real DOM node.<br />\n * You can use this method to position a popper relatively to a set of coordinates\n * in case you don't have a DOM node to use as reference.\n *\n * ```\n * new Popper(referenceObject, popperNode);\n * ```\n *\n * NB: This feature isn't supported in Internet Explorer 10.\n * @name referenceObject\n * @property {Function} data.getBoundingClientRect\n * A function that returns a set of coordinates compatible with the native `getBoundingClientRect` method.\n * @property {number} data.clientWidth\n * An ES6 getter that will return the width of the virtual reference element.\n * @property {number} data.clientHeight\n * An ES6 getter that will return the height of the virtual reference element.\n */\n\n\nPopper.Utils = (typeof window !== 'undefined' ? window : global).PopperUtils;\nPopper.placements = placements;\nPopper.Defaults = Defaults;\n\nexport default Popper;\n//# sourceMappingURL=popper.js.map\n","import Popper from 'popper.js';\r\nimport DialogManager from './DialogManager';\r\nimport merge from '../../internal/merge';\r\n\r\nexport interface IDialogOptions {\r\n  title: string;\r\n  fullDialog: boolean;\r\n  resetPossible: boolean;\r\n\r\n  // popper options\r\n  placement?: Popper.Placement;\r\n  eventsEnabled?: boolean;\r\n  modifiers?: Popper.Modifiers;\r\n  toggleDialog: boolean;\r\n}\r\n\r\nexport interface IDialogContext {\r\n  attachment: HTMLElement;\r\n  level: number;\r\n  manager: DialogManager;\r\n  idPrefix: string;\r\n}\r\n\r\nabstract class ADialog {\r\n\r\n  private readonly options: Readonly<IDialogOptions> = {\r\n    title: '',\r\n    fullDialog: false,\r\n    resetPossible: true,\r\n    placement: 'bottom-start',\r\n    toggleDialog: true,\r\n    modifiers: {\r\n    }\r\n  };\r\n\r\n  readonly node: HTMLFormElement;\r\n  private popper: Popper | null = null;\r\n\r\n  constructor(protected readonly dialog: Readonly<IDialogContext>, options: Partial<IDialogOptions> = {}) {\r\n    Object.assign(this.options, options);\r\n    console.assert(dialog.attachment.ownerDocument != null);\r\n    this.node = dialog.attachment.ownerDocument!.createElement('form');\r\n    this.node.classList.add('lu-dialog');\r\n  }\r\n\r\n  get attachment() {\r\n    return this.dialog.attachment;\r\n  }\r\n\r\n  get level() {\r\n    return this.dialog.level;\r\n  }\r\n\r\n  protected abstract build(node: HTMLElement): boolean | void;\r\n\r\n  equals(that: ADialog) {\r\n    return this.dialog.level === that.dialog.level && this.dialog.attachment === that.dialog.attachment;\r\n  }\r\n\r\n  open() {\r\n    if (this.options.toggleDialog && this.dialog.manager.removeLike(this)) {\r\n      return;\r\n    }\r\n    if (this.build(this.node) === false) {\r\n      return;\r\n    }\r\n    const parent = <HTMLElement>this.attachment.closest('.lu')!;\r\n\r\n    if (this.options.title) {\r\n      this.node.insertAdjacentHTML('afterbegin', `<strong>${this.options.title}</strong>`);\r\n    }\r\n    if (this.options.fullDialog) {\r\n      this.node.insertAdjacentHTML('beforeend', `<div>\r\n        <button type=\"submit\" title=\"Apply\"></button>\r\n        <button type=\"button\" title=\"Cancel\"></button>\r\n        <button type=\"reset\" title=\"Reset to default values\" ${!this.options.resetPossible ? 'style=\"visibility: hidden\"': ''}></button>\r\n      </div>`);\r\n    }\r\n\r\n    parent.appendChild(this.node);\r\n    this.popper = new Popper(this.attachment, this.node, merge({\r\n      modifiers: {\r\n        preventOverflow: {\r\n          boundariesElement: parent\r\n        }\r\n      }\r\n    }, this.options));\r\n\r\n    const auto = this.find<HTMLInputElement>('input[autofocus]');\r\n    if (auto) {\r\n      // delay such that it works\r\n      self.setTimeout(() => auto.focus());\r\n    }\r\n\r\n    const reset = this.find<HTMLButtonElement>('button[type=reset]');\r\n    if (reset) {\r\n      reset.onclick = (evt) => {\r\n        evt.stopPropagation();\r\n        evt.preventDefault();\r\n        this.reset();\r\n      };\r\n    }\r\n    this.node.onsubmit = (evt) => {\r\n      evt.stopPropagation();\r\n      evt.preventDefault();\r\n      if (!this.node.checkValidity()) {\r\n        return false;\r\n      }\r\n      if (this.submit()) {\r\n        this.destroy();\r\n      }\r\n      return false;\r\n    };\r\n    const cancel = this.find<HTMLButtonElement>('button[title=Cancel]');\r\n    if (cancel) {\r\n      cancel.onclick = (evt) => {\r\n        evt.stopPropagation();\r\n        evt.preventDefault();\r\n        this.destroy();\r\n      };\r\n    }\r\n\r\n    this.dialog.manager.push(this);\r\n  }\r\n\r\n  protected find<T extends HTMLElement>(selector: string): T {\r\n    return <T>this.node.querySelector(selector);\r\n  }\r\n\r\n  protected findInput(selector: string) {\r\n    return this.find<HTMLInputElement>(selector);\r\n  }\r\n\r\n  protected forEach<M extends Element, T>(selector: string, callback: (d: M, i: number) => T): T[] {\r\n    return (<M[]>Array.from(this.node.querySelectorAll(selector))).map(callback);\r\n  }\r\n\r\n  protected reset() {\r\n    // hook\r\n  }\r\n\r\n  protected submit(): boolean {\r\n    // hook\r\n    return true;\r\n  }\r\n\r\n  destroy() {\r\n    this.dialog.manager.remove(this);\r\n    if (this.popper) {\r\n      this.popper.destroy();\r\n    }\r\n    this.node.remove();\r\n  }\r\n}\r\n\r\nexport default ADialog;\r\n","var t0 = new Date,\n    t1 = new Date;\n\nexport default function newInterval(floori, offseti, count, field) {\n\n  function interval(date) {\n    return floori(date = new Date(+date)), date;\n  }\n\n  interval.floor = interval;\n\n  interval.ceil = function(date) {\n    return floori(date = new Date(date - 1)), offseti(date, 1), floori(date), date;\n  };\n\n  interval.round = function(date) {\n    var d0 = interval(date),\n        d1 = interval.ceil(date);\n    return date - d0 < d1 - date ? d0 : d1;\n  };\n\n  interval.offset = function(date, step) {\n    return offseti(date = new Date(+date), step == null ? 1 : Math.floor(step)), date;\n  };\n\n  interval.range = function(start, stop, step) {\n    var range = [], previous;\n    start = interval.ceil(start);\n    step = step == null ? 1 : Math.floor(step);\n    if (!(start < stop) || !(step > 0)) return range; // also handles Invalid Date\n    do range.push(previous = new Date(+start)), offseti(start, step), floori(start);\n    while (previous < start && start < stop);\n    return range;\n  };\n\n  interval.filter = function(test) {\n    return newInterval(function(date) {\n      if (date >= date) while (floori(date), !test(date)) date.setTime(date - 1);\n    }, function(date, step) {\n      if (date >= date) {\n        if (step < 0) while (++step <= 0) {\n          while (offseti(date, -1), !test(date)) {} // eslint-disable-line no-empty\n        } else while (--step >= 0) {\n          while (offseti(date, +1), !test(date)) {} // eslint-disable-line no-empty\n        }\n      }\n    });\n  };\n\n  if (count) {\n    interval.count = function(start, end) {\n      t0.setTime(+start), t1.setTime(+end);\n      floori(t0), floori(t1);\n      return Math.floor(count(t0, t1));\n    };\n\n    interval.every = function(step) {\n      step = Math.floor(step);\n      return !isFinite(step) || !(step > 0) ? null\n          : !(step > 1) ? interval\n          : interval.filter(field\n              ? function(d) { return field(d) % step === 0; }\n              : function(d) { return interval.count(0, d) % step === 0; });\n    };\n  }\n\n  return interval;\n}\n","import interval from \"./interval\";\n\nvar millisecond = interval(function() {\n  // noop\n}, function(date, step) {\n  date.setTime(+date + step);\n}, function(start, end) {\n  return end - start;\n});\n\n// An optimized implementation for this simple case.\nmillisecond.every = function(k) {\n  k = Math.floor(k);\n  if (!isFinite(k) || !(k > 0)) return null;\n  if (!(k > 1)) return millisecond;\n  return interval(function(date) {\n    date.setTime(Math.floor(date / k) * k);\n  }, function(date, step) {\n    date.setTime(+date + step * k);\n  }, function(start, end) {\n    return (end - start) / k;\n  });\n};\n\nexport default millisecond;\nexport var milliseconds = millisecond.range;\n","export var durationSecond = 1e3;\nexport var durationMinute = 6e4;\nexport var durationHour = 36e5;\nexport var durationDay = 864e5;\nexport var durationWeek = 6048e5;\n","import interval from \"./interval\";\nimport {durationSecond} from \"./duration\";\n\nvar second = interval(function(date) {\n  date.setTime(date - date.getMilliseconds());\n}, function(date, step) {\n  date.setTime(+date + step * durationSecond);\n}, function(start, end) {\n  return (end - start) / durationSecond;\n}, function(date) {\n  return date.getUTCSeconds();\n});\n\nexport default second;\nexport var seconds = second.range;\n","import interval from \"./interval\";\nimport {durationMinute, durationSecond} from \"./duration\";\n\nvar minute = interval(function(date) {\n  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond);\n}, function(date, step) {\n  date.setTime(+date + step * durationMinute);\n}, function(start, end) {\n  return (end - start) / durationMinute;\n}, function(date) {\n  return date.getMinutes();\n});\n\nexport default minute;\nexport var minutes = minute.range;\n","import interval from \"./interval\";\nimport {durationHour, durationMinute, durationSecond} from \"./duration\";\n\nvar hour = interval(function(date) {\n  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond - date.getMinutes() * durationMinute);\n}, function(date, step) {\n  date.setTime(+date + step * durationHour);\n}, function(start, end) {\n  return (end - start) / durationHour;\n}, function(date) {\n  return date.getHours();\n});\n\nexport default hour;\nexport var hours = hour.range;\n","import interval from \"./interval\";\nimport {durationDay, durationMinute} from \"./duration\";\n\nvar day = interval(function(date) {\n  date.setHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setDate(date.getDate() + step);\n}, function(start, end) {\n  return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationDay;\n}, function(date) {\n  return date.getDate() - 1;\n});\n\nexport default day;\nexport var days = day.range;\n","import interval from \"./interval\";\nimport {durationMinute, durationWeek} from \"./duration\";\n\nfunction weekday(i) {\n  return interval(function(date) {\n    date.setDate(date.getDate() - (date.getDay() + 7 - i) % 7);\n    date.setHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setDate(date.getDate() + step * 7);\n  }, function(start, end) {\n    return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationWeek;\n  });\n}\n\nexport var sunday = weekday(0);\nexport var monday = weekday(1);\nexport var tuesday = weekday(2);\nexport var wednesday = weekday(3);\nexport var thursday = weekday(4);\nexport var friday = weekday(5);\nexport var saturday = weekday(6);\n\nexport var sundays = sunday.range;\nexport var mondays = monday.range;\nexport var tuesdays = tuesday.range;\nexport var wednesdays = wednesday.range;\nexport var thursdays = thursday.range;\nexport var fridays = friday.range;\nexport var saturdays = saturday.range;\n","import interval from \"./interval\";\n\nvar month = interval(function(date) {\n  date.setDate(1);\n  date.setHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setMonth(date.getMonth() + step);\n}, function(start, end) {\n  return end.getMonth() - start.getMonth() + (end.getFullYear() - start.getFullYear()) * 12;\n}, function(date) {\n  return date.getMonth();\n});\n\nexport default month;\nexport var months = month.range;\n","import interval from \"./interval\";\n\nvar year = interval(function(date) {\n  date.setMonth(0, 1);\n  date.setHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setFullYear(date.getFullYear() + step);\n}, function(start, end) {\n  return end.getFullYear() - start.getFullYear();\n}, function(date) {\n  return date.getFullYear();\n});\n\n// An optimized implementation for this simple case.\nyear.every = function(k) {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : interval(function(date) {\n    date.setFullYear(Math.floor(date.getFullYear() / k) * k);\n    date.setMonth(0, 1);\n    date.setHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setFullYear(date.getFullYear() + step * k);\n  });\n};\n\nexport default year;\nexport var years = year.range;\n","import interval from \"./interval\";\nimport {durationMinute} from \"./duration\";\n\nvar utcMinute = interval(function(date) {\n  date.setUTCSeconds(0, 0);\n}, function(date, step) {\n  date.setTime(+date + step * durationMinute);\n}, function(start, end) {\n  return (end - start) / durationMinute;\n}, function(date) {\n  return date.getUTCMinutes();\n});\n\nexport default utcMinute;\nexport var utcMinutes = utcMinute.range;\n","import interval from \"./interval\";\nimport {durationHour} from \"./duration\";\n\nvar utcHour = interval(function(date) {\n  date.setUTCMinutes(0, 0, 0);\n}, function(date, step) {\n  date.setTime(+date + step * durationHour);\n}, function(start, end) {\n  return (end - start) / durationHour;\n}, function(date) {\n  return date.getUTCHours();\n});\n\nexport default utcHour;\nexport var utcHours = utcHour.range;\n","import interval from \"./interval\";\nimport {durationDay} from \"./duration\";\n\nvar utcDay = interval(function(date) {\n  date.setUTCHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setUTCDate(date.getUTCDate() + step);\n}, function(start, end) {\n  return (end - start) / durationDay;\n}, function(date) {\n  return date.getUTCDate() - 1;\n});\n\nexport default utcDay;\nexport var utcDays = utcDay.range;\n","import interval from \"./interval\";\nimport {durationWeek} from \"./duration\";\n\nfunction utcWeekday(i) {\n  return interval(function(date) {\n    date.setUTCDate(date.getUTCDate() - (date.getUTCDay() + 7 - i) % 7);\n    date.setUTCHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setUTCDate(date.getUTCDate() + step * 7);\n  }, function(start, end) {\n    return (end - start) / durationWeek;\n  });\n}\n\nexport var utcSunday = utcWeekday(0);\nexport var utcMonday = utcWeekday(1);\nexport var utcTuesday = utcWeekday(2);\nexport var utcWednesday = utcWeekday(3);\nexport var utcThursday = utcWeekday(4);\nexport var utcFriday = utcWeekday(5);\nexport var utcSaturday = utcWeekday(6);\n\nexport var utcSundays = utcSunday.range;\nexport var utcMondays = utcMonday.range;\nexport var utcTuesdays = utcTuesday.range;\nexport var utcWednesdays = utcWednesday.range;\nexport var utcThursdays = utcThursday.range;\nexport var utcFridays = utcFriday.range;\nexport var utcSaturdays = utcSaturday.range;\n","import interval from \"./interval\";\n\nvar utcMonth = interval(function(date) {\n  date.setUTCDate(1);\n  date.setUTCHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setUTCMonth(date.getUTCMonth() + step);\n}, function(start, end) {\n  return end.getUTCMonth() - start.getUTCMonth() + (end.getUTCFullYear() - start.getUTCFullYear()) * 12;\n}, function(date) {\n  return date.getUTCMonth();\n});\n\nexport default utcMonth;\nexport var utcMonths = utcMonth.range;\n","import interval from \"./interval\";\n\nvar utcYear = interval(function(date) {\n  date.setUTCMonth(0, 1);\n  date.setUTCHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setUTCFullYear(date.getUTCFullYear() + step);\n}, function(start, end) {\n  return end.getUTCFullYear() - start.getUTCFullYear();\n}, function(date) {\n  return date.getUTCFullYear();\n});\n\n// An optimized implementation for this simple case.\nutcYear.every = function(k) {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : interval(function(date) {\n    date.setUTCFullYear(Math.floor(date.getUTCFullYear() / k) * k);\n    date.setUTCMonth(0, 1);\n    date.setUTCHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setUTCFullYear(date.getUTCFullYear() + step * k);\n  });\n};\n\nexport default utcYear;\nexport var utcYears = utcYear.range;\n","export {\n  default as timeInterval\n} from \"./interval\";\n\nexport {\n  default as timeMillisecond,\n  milliseconds as timeMilliseconds,\n  default as utcMillisecond,\n  milliseconds as utcMilliseconds\n} from \"./millisecond\";\n\nexport {\n  default as timeSecond,\n  seconds as timeSeconds,\n  default as utcSecond,\n  seconds as utcSeconds\n} from \"./second\";\n\nexport {\n  default as timeMinute,\n  minutes as timeMinutes\n} from \"./minute\";\n\nexport {\n  default as timeHour,\n  hours as timeHours\n} from \"./hour\";\n\nexport {\n  default as timeDay,\n  days as timeDays\n} from \"./day\";\n\nexport {\n  sunday as timeWeek,\n  sundays as timeWeeks,\n  sunday as timeSunday,\n  sundays as timeSundays,\n  monday as timeMonday,\n  mondays as timeMondays,\n  tuesday as timeTuesday,\n  tuesdays as timeTuesdays,\n  wednesday as timeWednesday,\n  wednesdays as timeWednesdays,\n  thursday as timeThursday,\n  thursdays as timeThursdays,\n  friday as timeFriday,\n  fridays as timeFridays,\n  saturday as timeSaturday,\n  saturdays as timeSaturdays\n} from \"./week\";\n\nexport {\n  default as timeMonth,\n  months as timeMonths\n} from \"./month\";\n\nexport {\n  default as timeYear,\n  years as timeYears\n} from \"./year\";\n\nexport {\n  default as utcMinute,\n  utcMinutes as utcMinutes\n} from \"./utcMinute\";\n\nexport {\n  default as utcHour,\n  utcHours as utcHours\n} from \"./utcHour\";\n\nexport {\n  default as utcDay,\n  utcDays as utcDays\n} from \"./utcDay\";\n\nexport {\n  utcSunday as utcWeek,\n  utcSundays as utcWeeks,\n  utcSunday as utcSunday,\n  utcSundays as utcSundays,\n  utcMonday as utcMonday,\n  utcMondays as utcMondays,\n  utcTuesday as utcTuesday,\n  utcTuesdays as utcTuesdays,\n  utcWednesday as utcWednesday,\n  utcWednesdays as utcWednesdays,\n  utcThursday as utcThursday,\n  utcThursdays as utcThursdays,\n  utcFriday as utcFriday,\n  utcFridays as utcFridays,\n  utcSaturday as utcSaturday,\n  utcSaturdays as utcSaturdays\n} from \"./utcWeek\";\n\nexport {\n  default as utcMonth,\n  utcMonths as utcMonths\n} from \"./utcMonth\";\n\nexport {\n  default as utcYear,\n  utcYears as utcYears\n} from \"./utcYear\";\n","import {ascending, histogram, mean, median, quantile} from 'd3-array';\r\nimport {ICategory, isMissingValue} from '../model';\r\nimport {IMappingFunction} from '../model/MappingFunction';\r\n\r\nexport interface INumberBin {\r\n  x0: number;\r\n  x1: number;\r\n  length: number;\r\n}\r\n\r\nexport interface IBoxPlotData {\r\n  readonly min: number;\r\n  readonly max: number;\r\n  readonly median: number;\r\n  readonly q1: number;\r\n  readonly q3: number;\r\n  readonly outlier?: number[];\r\n  readonly whiskerLow?: number;\r\n  readonly whiskerHigh?: number;\r\n}\r\n\r\nexport interface IAdvancedBoxPlotData extends IBoxPlotData {\r\n  readonly mean: number;\r\n}\r\n\r\nexport interface IStatistics extends IAdvancedBoxPlotData {\r\n  readonly count: number;\r\n  readonly maxBin: number;\r\n  readonly hist: INumberBin[];\r\n  readonly missing: number;\r\n}\r\n\r\nexport interface ICategoricalBin {\r\n  cat: string;\r\n  y: number;\r\n}\r\n\r\nexport interface ICategoricalStatistics {\r\n  readonly maxBin: number;\r\n  readonly hist: ICategoricalBin[];\r\n  readonly missing: number;\r\n}\r\n\r\n/**\r\n * @internal\r\n * @param {number} length\r\n * @returns {number}\r\n */\r\nexport function getNumberOfBins(length: number) {\r\n  // as by default used in d3 the Sturges' formula\r\n  return Math.ceil(Math.log(length) / Math.LN2) + 1;\r\n}\r\n\r\n\r\n/**\r\n * helper class to lazily compute box plotdata out of a given number array\r\n * @internal\r\n */\r\nexport class LazyBoxPlotData implements IStatistics {\r\n  private readonly values: number[];\r\n\r\n  readonly missing: number;\r\n\r\n  constructor(values: number[], private readonly scale?: Readonly<IMappingFunction>, private readonly histGen?: (data: number[]) => INumberBin[]) {\r\n    // filter out NaN\r\n    this.values = values.filter((d) => !isMissingValue(d));\r\n    this.missing = values.length - this.values.length;\r\n  }\r\n\r\n  get count() {\r\n    return this.values.length + this.missing;\r\n  }\r\n\r\n  /**\r\n   * lazy compute sorted array\r\n   * @returns {number[]}\r\n   */\r\n  @cached()\r\n  private get sorted(): number[] {\r\n    return this.values.slice().sort(ascending);\r\n  }\r\n\r\n  @cached()\r\n  private get sortedMapped(): number[] {\r\n    return this.scale ? this.sorted.map((v) => this.scale!.apply(v)) : this.sorted;\r\n  }\r\n\r\n  private map(v: number | undefined) {\r\n    return this.scale && v != null ? this.scale.apply(v!) : v!;\r\n  }\r\n\r\n  @cached()\r\n  get hist() {\r\n    if (!this.histGen) {\r\n      return [];\r\n    }\r\n    return this.histGen(this.values);\r\n  }\r\n\r\n  @cached()\r\n  get maxBin() {\r\n    return Math.max(...this.hist.map((d) => d.length));\r\n  }\r\n\r\n  @cached()\r\n  get min() {\r\n    return this.map(Math.min(...this.values));\r\n  }\r\n\r\n  @cached()\r\n  get max() {\r\n    return this.map(Math.max(...this.values));\r\n  }\r\n\r\n  @cached()\r\n  get median() {\r\n    return this.map(median(this.sorted));\r\n  }\r\n\r\n  @cached()\r\n  get q1() {\r\n    return this.map(quantile(this.sorted, 0.25));\r\n  }\r\n\r\n  @cached()\r\n  get q3() {\r\n    return this.map(quantile(this.sorted, 0.75));\r\n  }\r\n\r\n  @cached()\r\n  get mean() {\r\n    return this.map(mean(this.values));\r\n  }\r\n\r\n  @cached()\r\n  get whiskerLow() {\r\n    const q1 = this.q1;\r\n    const q3 = this.q3;\r\n    const iqr = q3 - q1;\r\n    const left = q1 - 1.5 * iqr;\r\n    // look for the closests value which is bigger than the computed left\r\n    let whiskerLow = left;\r\n    for (const v of this.sortedMapped) {\r\n      if (left < v) {\r\n        whiskerLow = v;\r\n        break;\r\n      }\r\n    }\r\n    return whiskerLow;\r\n  }\r\n\r\n  @cached()\r\n  get whiskerHigh() {\r\n    const q1 = this.q1;\r\n    const q3 = this.q3;\r\n    const iqr = q3 - q1;\r\n    const right = q3 + 1.5 * iqr;\r\n    // look for the closests value which is smaller than the computed right\r\n    let whiskerHigh = right;\r\n    for (const v of this.sortedMapped.slice().reverse()) {\r\n      if (v < right) {\r\n        whiskerHigh = v;\r\n        break;\r\n      }\r\n    }\r\n    return whiskerHigh;\r\n\r\n  }\r\n\r\n  @cached()\r\n  get outlier() {\r\n    const left = this.whiskerLow;\r\n    const right = this.whiskerHigh;\r\n    return this.sortedMapped.filter((v) => (v < left || v > right) && !isMissingValue(v));\r\n  }\r\n}\r\n\r\n/**\r\n * cache the value in a hidden __ variable\r\n * @internal\r\n */\r\nfunction cached() {\r\n  return function (_target: any, propertyKey: string, descriptor: PropertyDescriptor) {\r\n    const getter = descriptor.get!;\r\n    const cacheKey = `__${propertyKey}`;\r\n    descriptor.get = function (this: any) {\r\n      if (this.hasOwnProperty(cacheKey)) {\r\n        return this[cacheKey];\r\n      }\r\n      const value = getter.call(this);\r\n      this[cacheKey] = value;\r\n      return value;\r\n    };\r\n    return descriptor;\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * computes the simple statistics of an array using d3 histogram\r\n * @param arr the data array\r\n * @param acc accessor function\r\n * @param missing accessor if the value is missing\r\n * @param range the total value range\r\n * @param bins the number of bins\r\n * @returns {{min: number, max: number, count: number, hist: histogram.Bin<number>[]}}\r\n * @internal\r\n */\r\nexport function computeStats<T>(arr: T[], acc: (row: T) => number, missing: (row: T) => boolean, range?: [number, number], bins?: number): IStatistics {\r\n  if (arr.length === 0) {\r\n    return {\r\n      min: NaN,\r\n      max: NaN,\r\n      mean: NaN,\r\n      q1: NaN,\r\n      q3: NaN,\r\n      outlier: [],\r\n      median: NaN,\r\n      count: 0,\r\n      maxBin: 0,\r\n      hist: [],\r\n      missing: 0\r\n    };\r\n  }\r\n\r\n  const hist = histogram();\r\n  if (range) {\r\n    hist.domain(range);\r\n  }\r\n  if (bins) {\r\n    hist.thresholds(bins);\r\n  } else {\r\n    hist.thresholds(getNumberOfBins(arr.length));\r\n  }\r\n\r\n  const values = arr.map((v) => missing(v) ? NaN : acc(v));\r\n\r\n  return new LazyBoxPlotData(values, undefined, <(data: number[]) => INumberBin[]>hist);\r\n}\r\n\r\n\r\n/**\r\n * computes a categorical histogram\r\n * @param arr the data array\r\n * @param acc the accessor\r\n * @param categories the list of known categories\r\n * @returns {{hist: {cat: string, y: number}[]}}\r\n * @internal\r\n */\r\nexport function computeHist<T>(arr: T[], acc: (row: T) => ICategory | null, categories: ICategory[]): ICategoricalStatistics {\r\n  const m = new Map<string, number>();\r\n  let missingCount = 0;\r\n  categories.forEach((cat) => m.set(cat.name, 0));\r\n\r\n  arr.forEach((a) => {\r\n    const v = acc(a);\r\n    if (v == null) {\r\n      missingCount += 1;\r\n      return;\r\n    }\r\n    m.set(v.name, (m.get(v.name) || 0) + 1);\r\n  });\r\n  const entries: { cat: string; y: number }[] = [];\r\n  m.forEach((v, k) => entries.push({cat: k, y: v}));\r\n  return {\r\n    maxBin: Math.max(...entries.map((d) => d.y)),\r\n    hist: entries,\r\n    missing: missingCount\r\n  };\r\n}\r\n\r\n/**\r\n * round to the given commas similar to d3.round\r\n * @param {number} v\r\n * @param {number} precision\r\n * @returns {number}\r\n * @internal\r\n */\r\nexport function round(v: number, precision: number = 0) {\r\n  if (precision === 0) {\r\n    return Math.round(v);\r\n  }\r\n  const scale = Math.pow(10, precision);\r\n  return Math.round(v * scale) / scale;\r\n}\r\n\r\n/**\r\n * compares two number whether they are similar up to delta\r\n * @param {number} a first numbre\r\n * @param {number} b second number\r\n * @param {number} delta\r\n * @returns {boolean} a and b are similar\r\n * @internal\r\n */\r\nexport function similar(a: number, b: number, delta = 0.5) {\r\n  if (a === b) {\r\n    return true;\r\n  }\r\n  return Math.abs(a - b) < delta;\r\n}\r\n","import {scaleLinear, scaleLog, scalePow, scaleSqrt} from 'd3-scale';\r\nimport {similar} from '../internal';\r\nimport Column from './Column';\r\nimport INumberColumn, {INumberFilter} from './INumberColumn';\r\nimport {IColorMappingFunction} from './ColorMappingFunction';\r\n\r\n/**\r\n * interface of a d3 scale\r\n */\r\nexport interface IScale {\r\n  (v: number): number;\r\n\r\n  invert(r: number): number;\r\n\r\n  domain(): number[];\r\n\r\n  domain(domain: number[]): this;\r\n\r\n  range(): number[];\r\n\r\n  range(range: number[]): this;\r\n}\r\n\r\nexport interface IMappingFunction {\r\n  //new(domain: number[]);\r\n\r\n  apply(v: number): number;\r\n\r\n  dump(): any;\r\n\r\n  restore(dump: any): void;\r\n\r\n  domain: number[];\r\n\r\n  clone(): IMappingFunction;\r\n\r\n  eq(other: IMappingFunction): boolean;\r\n\r\n  getRange(formatter: (v: number) => string): [string, string];\r\n\r\n}\r\n\r\n\r\nfunction toScale(type = 'linear'): IScale {\r\n  switch (type) {\r\n    case 'log':\r\n      return scaleLog().clamp(true);\r\n    case 'sqrt':\r\n      return scaleSqrt().clamp(true);\r\n    case 'pow1.1':\r\n      return scalePow().exponent(1.1).clamp(true);\r\n    case 'pow2':\r\n      return scalePow().exponent(2).clamp(true);\r\n    case 'pow3':\r\n      return scalePow().exponent(3).clamp(true);\r\n    default:\r\n      return scaleLinear().clamp(true);\r\n  }\r\n}\r\n\r\n\r\nexport interface IMapAbleColumn extends INumberColumn {\r\n  getOriginalMapping(): IMappingFunction;\r\n\r\n  getMapping(): IMappingFunction;\r\n\r\n  setMapping(mapping: IMappingFunction): void;\r\n\r\n  getColorMapping(): IColorMappingFunction;\r\n\r\n  setColorMapping(mapping: IColorMappingFunction): void;\r\n\r\n  getFilter(): INumberFilter;\r\n\r\n  setFilter(value?: INumberFilter): void;\r\n\r\n  getRange(): [string, string];\r\n}\r\n\r\nexport function isMapAbleColumn(col: Column): col is IMapAbleColumn {\r\n  return typeof (<IMapAbleColumn>col).getMapping === 'function';\r\n}\r\n\r\nfunction isSame(a: number[], b: number[]) {\r\n  if (a.length !== b.length) {\r\n    return false;\r\n  }\r\n  return a.every((ai, i) => similar(ai, b[i], 0.0001));\r\n}\r\n\r\n\r\nfunction fixDomain(domain: number[], type: string) {\r\n  if (type === 'log' && domain[0] === 0) {\r\n    domain[0] = 0.0000001; //0 is bad\r\n  }\r\n  return domain;\r\n}\r\n\r\n/**\r\n * a mapping function based on a d3 scale (linear, sqrt, log)\r\n */\r\nexport class ScaleMappingFunction implements IMappingFunction {\r\n  private s: IScale;\r\n\r\n  constructor(domain: number[] = [0, 1], private type = 'linear', range: number[] = [0, 1]) {\r\n\r\n    this.s = toScale(type).domain(fixDomain(domain, this.type)).range(range);\r\n  }\r\n\r\n  get domain() {\r\n    return this.s.domain();\r\n  }\r\n\r\n  set domain(domain: number[]) {\r\n    this.s.domain(fixDomain(domain, this.type));\r\n  }\r\n\r\n  get range() {\r\n    return this.s.range();\r\n  }\r\n\r\n  set range(range: number[]) {\r\n    this.s.range(range);\r\n  }\r\n\r\n  getRange(format: (v: number) => string): [string, string] {\r\n    return [format(this.invert(0)), format(this.invert(1))];\r\n  }\r\n\r\n  apply(v: number): number {\r\n    return this.s(v);\r\n  }\r\n\r\n  invert(r: number) {\r\n    return this.s.invert(r);\r\n  }\r\n\r\n  get scaleType() {\r\n    return this.type;\r\n  }\r\n\r\n  dump(): any {\r\n    return {\r\n      type: this.type,\r\n      domain: this.domain,\r\n      range: this.range\r\n    };\r\n  }\r\n\r\n  eq(other: IMappingFunction): boolean {\r\n    if (!(other instanceof ScaleMappingFunction)) {\r\n      return false;\r\n    }\r\n    const that = <ScaleMappingFunction>other;\r\n    return that.type === this.type && isSame(this.domain, that.domain) && isSame(this.range, that.range);\r\n  }\r\n\r\n  restore(dump: any) {\r\n    this.type = dump.type;\r\n    this.s = toScale(dump.type).domain(dump.domain).range(dump.range);\r\n  }\r\n\r\n  clone() {\r\n    return new ScaleMappingFunction(this.domain, this.type, this.range);\r\n  }\r\n}\r\n\r\n/**\r\n * a mapping function based on a custom user function using 'value' as the current value\r\n */\r\nexport class ScriptMappingFunction implements IMappingFunction {\r\n  private f: Function;\r\n\r\n  constructor(public domain: number[] = [0, 1], private _code: string = 'return this.linear(value,this.value_min,this.value_max);') {\r\n    this.f = new Function('value', _code);\r\n  }\r\n\r\n  get code() {\r\n    return this._code;\r\n  }\r\n\r\n  set code(code: string) {\r\n    if (this._code === code) {\r\n      return;\r\n    }\r\n    this._code = code;\r\n    this.f = new Function('value', code);\r\n  }\r\n\r\n  getRange(): [string, string] {\r\n    return ['?', '?'];\r\n  }\r\n\r\n  apply(v: number): number {\r\n    const min = this.domain[0],\r\n      max = this.domain[this.domain.length - 1];\r\n    const r = this.f.call({\r\n      value_min: min,\r\n      value_max: max,\r\n      value_range: max - min,\r\n      value_domain: this.domain.slice(),\r\n      linear: (v: number, mi: number, ma: number) => (v - mi) / (ma - mi)\r\n    }, v);\r\n\r\n    if (typeof r === 'number') {\r\n      return Math.max(Math.min(r, 1), 0);\r\n    }\r\n    return NaN;\r\n  }\r\n\r\n  dump(): any {\r\n    return {\r\n      type: 'script',\r\n      code: this.code,\r\n      domain: this.domain\r\n    };\r\n  }\r\n\r\n  eq(other: IMappingFunction): boolean {\r\n    if (!(other instanceof ScriptMappingFunction)) {\r\n      return false;\r\n    }\r\n    const that = <ScriptMappingFunction>other;\r\n    return that.code === this.code;\r\n  }\r\n\r\n  restore(dump: any) {\r\n    this.code = dump.code;\r\n    this.domain = dump.domain;\r\n  }\r\n\r\n  clone() {\r\n    return new ScriptMappingFunction(this.domain, this.code);\r\n  }\r\n}\r\n\r\nexport interface IMapAbleDesc {\r\n  /**\r\n   * dump of mapping function\r\n   */\r\n  map?: any;\r\n  /**\r\n   * either map or domain should be available\r\n   */\r\n  domain?: [number, number];\r\n  /**\r\n   * @default [0,1]\r\n   */\r\n  range?: [number, number];\r\n\r\n  /**\r\n   * @deprecated use colorMapping instead\r\n   */\r\n  color?: string;\r\n  colorMapping?: string | ((v: number)=>string) | any;\r\n}\r\n\r\nexport function createMappingFunction(dump: any): IMappingFunction {\r\n  if (dump.type === 'script') {\r\n    const s = new ScriptMappingFunction();\r\n    s.restore(dump);\r\n    return s;\r\n  }\r\n  const l = new ScaleMappingFunction();\r\n  l.restore(dump);\r\n  return l;\r\n}\r\n\r\nexport function restoreMapping(desc: IMapAbleDesc): IMappingFunction {\r\n  if (desc.map) {\r\n    return createMappingFunction(desc.map);\r\n  }\r\n  if (desc.domain) {\r\n    return new ScaleMappingFunction(desc.domain, 'linear', desc.range || [0, 1]);\r\n  }\r\n  return new ScaleMappingFunction([0, 1], 'linear', [0, 1]);\r\n}\r\n","import {ICategoricalStatistics, IStatistics} from '../internal';\nimport AEventDispatcher, {suffix} from '../internal/AEventDispatcher';\nimport debounce from '../internal/debounce';\nimport OrderedSet from '../internal/OrderedSet';\nimport {\n  Column, createActionDesc, createAggregateDesc, createGroupDesc, createRankDesc, createSelectionDesc,\n  createStackDesc, ICategoricalColumn, IColumnDesc, IDataRow, IGroup, INumberColumn, IOrderedGroup,\n  ISelectionColumnDesc, IValueColumnDesc, models\n} from '../model';\nimport {dirty, dirtyHeader, dirtyValues} from '../model/Column';\nimport AggregateGroupColumn, {IAggregateGroupColumnDesc} from '../model/AggregateGroupColumn';\nimport {toGroupID, unifyParents} from '../model/internal';\nimport RankColumn from '../model/RankColumn';\nimport Ranking, {orderChanged, addColumn, removeColumn} from '../model/Ranking';\nimport StackColumn from '../model/StackColumn';\nimport {exportRanking, IExportOptions} from './utils';\nimport {isSupportType} from '../model/annotations';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport {IExportOptions} from './utils';\n\nexport interface IStatsBuilder {\n  stats(col: INumberColumn): Promise<IStatistics> | IStatistics;\n\n  hist(col: ICategoricalColumn): Promise<ICategoricalStatistics> | ICategoricalStatistics;\n}\n\nexport interface IDataProviderOptions {\n  columnTypes: { [columnType: string]: typeof Column };\n\n  /**\n   * allow multiple selected rows\n   * default: true\n   */\n  multiSelection: boolean;\n}\n\nexport interface IDataProvider extends AEventDispatcher {\n  readonly columnTypes: { [columnType: string]: typeof Column };\n\n  getTotalNumberOfRows(): number;\n\n  takeSnapshot(col: Column): void;\n\n  selectAllOf(ranking: Ranking): void;\n\n  getSelection(): number[];\n\n  setSelection(dataIndices: number[]): void;\n\n  toggleSelection(i: number, additional?: boolean): boolean;\n\n  isSelected(i: number): boolean;\n\n  removeRanking(ranking: Ranking): void;\n\n  ensureOneRanking(): void;\n\n  find(id: string): Column | null;\n\n  clone(col: Column): Column;\n\n  create(desc: IColumnDesc): Column | null;\n\n  toDescRef(desc: IColumnDesc): any;\n\n  fromDescRef(ref: any): IColumnDesc;\n\n  mappingSample(col: Column): Promise<number[]> | number[];\n\n  searchAndJump(search: string | RegExp, col: Column): void;\n\n  getRankings(): Ranking[];\n\n  getFirstRanking(): Ranking | null;\n  getLastRanking(): Ranking;\n\n  getColumns(): IColumnDesc[];\n\n  isAggregated(ranking: Ranking, group: IGroup): boolean;\n\n  aggregateAllOf(ranking: Ranking, aggregateAll: boolean): void;\n}\n\n/**\n * emitted when the selection changes\n * @asMemberOf ADataProvider\n * @param dataIndices the selected data indices\n * @event\n */\nexport declare function selectionChanged(dataIndices: number[]): void;\n/**\n * @asMemberOf ADataProvider\n * @event\n */\nexport declare function addRanking(ranking: Ranking, index: number): void;\n/**\n * @asMemberOf ADataProvider\n * @param ranking if null all rankings are removed else just the specific one\n * @event\n */\nexport declare function removeRanking(ranking: Ranking | null, index: number): void;\n/**\n * emitted when the selection changes\n * @asMemberOf ADataProvider\n * @param dataIndices the selected data indices\n * @event\n */\nexport declare function orderchanged(dataIndices: number[]): void;\n/**\n * @asMemberOf ADataProvider\n * @event\n */\nexport declare function addDesc(desc: IColumnDesc): void;\n/**\n * @asMemberOf ADataProvider\n * @event\n */\nexport declare function clearDesc(): void;\n/**\n * emitted when the selection changes\n * @asMemberOf ADataProvider\n * @param dataIndices the selected data indices\n * @event\n */\nexport declare function jumpToNearest(dataIndices: number[]): void;\n/**\n * @asMemberOf ADataProvider\n * @event\n */\nexport declare function aggregate(ranking: Ranking, group: IGroup|IGroup[], value: boolean): void;\n\n/**\n * a basic data provider holding the data and rankings\n */\nabstract class ADataProvider extends AEventDispatcher implements IDataProvider {\n  static readonly EVENT_SELECTION_CHANGED = 'selectionChanged';\n  static readonly EVENT_ADD_COLUMN = Ranking.EVENT_ADD_COLUMN;\n  static readonly EVENT_REMOVE_COLUMN = Ranking.EVENT_REMOVE_COLUMN;\n  static readonly EVENT_ADD_RANKING = 'addRanking';\n  static readonly EVENT_REMOVE_RANKING = 'removeRanking';\n  static readonly EVENT_DIRTY = Ranking.EVENT_DIRTY;\n  static readonly EVENT_DIRTY_HEADER = Ranking.EVENT_DIRTY_HEADER;\n  static readonly EVENT_DIRTY_VALUES = Ranking.EVENT_DIRTY_VALUES;\n  static readonly EVENT_ORDER_CHANGED = Ranking.EVENT_ORDER_CHANGED;\n  static readonly EVENT_ADD_DESC = 'addDesc';\n  static readonly EVENT_CLEAR_DESC = 'clearDesc';\n  static readonly EVENT_JUMP_TO_NEAREST = 'jumpToNearest';\n  static readonly EVENT_GROUP_AGGREGATION_CHANGED = AggregateGroupColumn.EVENT_AGGREGATE;\n\n  /**\n   * all rankings\n   * @type {Array}\n   * @private\n   */\n  private rankings: Ranking[] = [];\n  /**\n   * the current selected indices\n   * @type {OrderedSet}\n   */\n  private readonly selection = new OrderedSet<number>();\n\n  //ranking.id@group.name\n  private aggregations = new Set<string>();\n\n  private uid = 0;\n\n  /**\n   * lookup map of a column type to its column implementation\n   */\n  readonly columnTypes: { [columnType: string]: typeof Column };\n\n  protected readonly multiSelections: boolean;\n\n  constructor(options: Partial<IDataProviderOptions> = {}) {\n    super();\n    this.columnTypes = Object.assign(models(), options.columnTypes || {});\n    this.multiSelections = options.multiSelection !== false;\n  }\n\n  /**\n   * events:\n   *  * column changes: addColumn, removeColumn\n   *  * ranking changes: addRanking, removeRanking\n   *  * dirty: dirty, dirtyHeder, dirtyValues\n   *  * selectionChanged\n   * @returns {string[]}\n   */\n  protected createEventList() {\n    return super.createEventList().concat([\n      ADataProvider.EVENT_ADD_COLUMN, ADataProvider.EVENT_REMOVE_COLUMN,\n      ADataProvider.EVENT_ADD_RANKING, ADataProvider.EVENT_REMOVE_RANKING,\n      ADataProvider.EVENT_DIRTY, ADataProvider.EVENT_DIRTY_HEADER, ADataProvider.EVENT_DIRTY_VALUES,\n      ADataProvider.EVENT_ORDER_CHANGED, ADataProvider.EVENT_SELECTION_CHANGED,\n      ADataProvider.EVENT_ADD_DESC, ADataProvider.EVENT_CLEAR_DESC,\n      ADataProvider.EVENT_JUMP_TO_NEAREST, ADataProvider.EVENT_GROUP_AGGREGATION_CHANGED]);\n  }\n\n  on(type: typeof ADataProvider.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof ADataProvider.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof ADataProvider.EVENT_ADD_RANKING, listener: typeof addRanking | null): this;\n  on(type: typeof ADataProvider.EVENT_REMOVE_RANKING, listener: typeof removeRanking | null): this;\n  on(type: typeof ADataProvider.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof ADataProvider.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof ADataProvider.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof ADataProvider.EVENT_ORDER_CHANGED, listener: typeof orderChanged | null): this;\n  on(type: typeof ADataProvider.EVENT_ADD_DESC, listener: typeof addDesc | null): this;\n  on(type: typeof ADataProvider.EVENT_CLEAR_DESC, listener: typeof clearDesc | null): this;\n  on(type: typeof ADataProvider.EVENT_JUMP_TO_NEAREST, listener: typeof jumpToNearest | null): this;\n  on(type: typeof ADataProvider.EVENT_GROUP_AGGREGATION_CHANGED, listener: typeof aggregate | null): this;\n  on(type: typeof ADataProvider.EVENT_SELECTION_CHANGED, listener: typeof selectionChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  abstract getTotalNumberOfRows(): number;\n\n  /**\n   * returns a list of all known column descriptions\n   * @returns {Array}\n   */\n  abstract getColumns(): IColumnDesc[];\n\n  /**\n   * adds a new ranking\n   * @param existing an optional existing ranking to clone\n   * @return the new ranking\n   */\n  pushRanking(existing?: Ranking): Ranking {\n    const r = this.cloneRanking(existing);\n\n    this.insertRanking(r);\n    return r;\n  }\n\n  takeSnapshot(col: Column): Ranking {\n    const r = this.cloneRanking();\n    const ranking = col.findMyRanker();\n    // by convention copy all support types and the first string column\n    let hasString = col.desc.type === 'string';\n    let hasColumn = false;\n    const toClone = !ranking ? [col] : ranking.children.filter((c) => {\n      if (c === col) {\n        hasColumn = false;\n        return true;\n      }\n      if (!hasString && c.desc.type === 'string') {\n        hasString = true;\n        return true;\n      }\n      return isSupportType(c);\n    });\n\n    if (!hasColumn) {\n      // maybe a nested one thus not in the top level\n      toClone.push(col);\n    }\n\n    toClone.forEach((c) => {\n      const clone = this.clone(c);\n      r.push(clone);\n      if (c === col) {\n        clone.sortByMe();\n      }\n    });\n    this.insertRanking(r);\n    return r;\n  }\n\n  insertRanking(r: Ranking, index = this.rankings.length) {\n    this.rankings.splice(index, 0, r);\n    this.forward(r, ...suffix('.provider', Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_REMOVE_COLUMN,\n      Ranking.EVENT_DIRTY, Ranking.EVENT_DIRTY_HEADER,\n      Ranking.EVENT_ORDER_CHANGED, Ranking.EVENT_DIRTY_VALUES));\n    const that = this;\n    //delayed reordering per ranking\n    r.on(`${Ranking.EVENT_DIRTY_ORDER}.provider`, debounce(function (this: { source: Ranking }) {\n      that.triggerReorder(this.source);\n    }, 100));\n    this.fire([ADataProvider.EVENT_ADD_RANKING, ADataProvider.EVENT_DIRTY_HEADER, ADataProvider.EVENT_DIRTY_VALUES, ADataProvider.EVENT_DIRTY], r, index);\n    this.triggerReorder(r);\n  }\n\n  protected triggerReorder(ranking: Ranking) {\n    Promise.resolve(this.sort(ranking)).then((order) => {\n      unifyParents(order);\n      ranking.setGroups(order);\n    });\n  }\n\n  /**\n   * removes a ranking from this data provider\n   * @param ranking\n   * @returns {boolean}\n   */\n  removeRanking(ranking: Ranking) {\n    const i = this.rankings.indexOf(ranking);\n    if (i < 0) {\n      return false;\n    }\n    this.unforward(ranking, ...suffix('.provider', Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_REMOVE_COLUMN,\n      Ranking.EVENT_DIRTY, Ranking.EVENT_DIRTY_HEADER,\n      Ranking.EVENT_ORDER_CHANGED, Ranking.EVENT_DIRTY_VALUES));\n    this.rankings.splice(i, 1);\n    ranking.on(`${Ranking.EVENT_DIRTY_ORDER}.provider`, null);\n    this.cleanUpRanking(ranking);\n    this.fire([ADataProvider.EVENT_REMOVE_RANKING, ADataProvider.EVENT_DIRTY_HEADER, ADataProvider.EVENT_DIRTY_VALUES, ADataProvider.EVENT_DIRTY], ranking, i);\n    return true;\n  }\n\n  /**\n   * removes all rankings\n   */\n  clearRankings() {\n    this.rankings.forEach((ranking) => {\n      this.unforward(ranking, ...suffix('.provider', Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_REMOVE_COLUMN,\n        Ranking.EVENT_DIRTY, Ranking.EVENT_DIRTY_HEADER,\n        Ranking.EVENT_ORDER_CHANGED, Ranking.EVENT_DIRTY_VALUES));\n      ranking.on(`${Ranking.EVENT_DIRTY_ORDER}.provider`, null);\n      this.cleanUpRanking(ranking);\n    });\n    this.rankings = [];\n    this.fire([ADataProvider.EVENT_REMOVE_RANKING, ADataProvider.EVENT_DIRTY_HEADER, ADataProvider.EVENT_DIRTY_VALUES, ADataProvider.EVENT_DIRTY], null, -1);\n  }\n\n  /**\n   * returns a list of all current rankings\n   * @returns {Ranking[]}\n   */\n  getRankings() {\n    return this.rankings.slice();\n  }\n\n  /**\n   * returns the last ranking for quicker access\n   * @returns {Ranking}\n   */\n  getFirstRanking() {\n    return this.rankings[0] || null;\n  }\n\n  /**\n   * returns the last ranking for quicker access\n   * @returns {Ranking}\n   */\n  getLastRanking() {\n    return this.rankings[this.rankings.length - 1];\n  }\n\n  ensureOneRanking() {\n    if (this.rankings.length === 0) {\n      const r = this.pushRanking();\n      this.push(r, createRankDesc());\n    }\n  }\n\n  /**\n   * hook method for cleaning up a ranking\n   * @param _ranking\n   */\n  cleanUpRanking(_ranking: Ranking) {\n    //nothing to do\n  }\n\n  /**\n   * abstract method for cloning a ranking\n   * @param existing\n   * @returns {null}\n   */\n  abstract cloneRanking(existing?: Ranking): Ranking;\n\n  /**\n   * adds a column to a ranking described by its column description\n   * @param ranking the ranking to add the column to\n   * @param desc the description of the column\n   * @return {Column} the newly created column or null\n   */\n  push(ranking: Ranking, desc: IColumnDesc): Column | null {\n    const r = this.create(desc);\n    if (r) {\n      ranking.push(r);\n      return r;\n    }\n    return null;\n  }\n\n  /**\n   * adds a column to a ranking described by its column description\n   * @param ranking the ranking to add the column to\n   * @param index the position to insert the column\n   * @param desc the description of the column\n   * @return {Column} the newly created column or null\n   */\n  insert(ranking: Ranking, index: number, desc: IColumnDesc) {\n    const r = this.create(desc);\n    if (r) {\n      ranking.insert(r, index);\n      return r;\n    }\n    return null;\n  }\n\n  /**\n   * creates a new unique id for a column\n   * @returns {string}\n   */\n  private nextId() {\n    return `col${this.uid++}`;\n  }\n\n  protected abstract rankAccessor(row: IDataRow, id: string, desc: IColumnDesc, ranking: Ranking): number;\n\n  private fixDesc(desc: IColumnDesc) {\n    //hacks for provider dependent descriptors\n    if (desc.type === 'rank') {\n      (<IValueColumnDesc<number>>desc).accessor = this.rankAccessor.bind(this);\n    } else if (desc.type === 'selection') {\n      (<ISelectionColumnDesc>desc).accessor = (row: IDataRow) => this.isSelected(row.i);\n      (<ISelectionColumnDesc>desc).setter = (row: IDataRow, value: boolean) => value ? this.select(row.i) : this.deselect(row.i);\n      (<ISelectionColumnDesc>desc).setterAll = (rows: IDataRow[], value: boolean) => value ? this.selectAll(rows.map((d) => d.i)) : this.deselectAll(rows.map((d) => d.i));\n    } else if (desc.type === 'aggregate') {\n      (<IAggregateGroupColumnDesc>desc).isAggregated = (ranking: Ranking, group: IGroup) => this.isAggregated(ranking, group);\n      (<IAggregateGroupColumnDesc>desc).setAggregated = (ranking: Ranking, group: IGroup, value: boolean) => this.setAggregated(ranking, group, value);\n    }\n  }\n\n  /**\n   * creates an internal column model out of the given column description\n   * @param desc\n   * @returns {Column} the new column or null if it can't be created\n   */\n  create(desc: IColumnDesc): Column | null {\n    this.fixDesc(desc);\n    //find by type and instantiate\n    const type = this.columnTypes[desc.type];\n    if (type) {\n      return new type(this.nextId(), desc);\n    }\n    return null;\n  }\n\n  /**\n   * clones a column by dumping and restoring\n   * @param col\n   * @returns {Column}\n   */\n  clone(col: Column) {\n    const dump = this.dumpColumn(col);\n    return this.restoreColumn(dump);\n  }\n\n  /**\n   * restores a column from a dump\n   * @param dump\n   * @returns {Column}\n   */\n  restoreColumn(dump: any): Column {\n    const create = (d: any) => {\n      const desc = this.fromDescRef(d.desc);\n      const type = this.columnTypes[desc.type];\n      this.fixDesc(desc);\n      const c = new type('', desc);\n      c.restore(d, create);\n      c.assignNewId(this.nextId.bind(this));\n      return c;\n    };\n    return create(dump);\n  }\n\n  /**\n   * finds a column in all rankings returning the first match\n   * @param idOrFilter by id or by a filter function\n   * @returns {Column}\n   */\n  find(idOrFilter: string | ((col: Column) => boolean)): Column | null {\n    //convert to function\n    const filter = typeof(idOrFilter) === 'string' ? (col: Column) => col.id === idOrFilter : idOrFilter;\n\n    for (const ranking of this.rankings) {\n      const r = ranking.find(filter);\n      if (r) {\n        return r;\n      }\n    }\n    return null;\n  }\n\n\n  /**\n   * dumps this whole provider including selection and the rankings\n   * @returns {{uid: number, selection: number[], rankings: *[]}}\n   */\n  dump(): any {\n    return {\n      uid: this.uid,\n      selection: this.getSelection(),\n      aggregations: Array.from(this.aggregations),\n      rankings: this.rankings.map((r) => r.dump(this.toDescRef))\n    };\n  }\n\n  /**\n   * dumps a specific column\n   */\n  dumpColumn(col: Column) {\n    return col.dump(this.toDescRef);\n  }\n\n  /**\n   * for better dumping describe reference, by default just return the description\n   */\n  toDescRef(desc: any): any {\n    return desc;\n  }\n\n  /**\n   * inverse operation of toDescRef\n   */\n  fromDescRef(descRef: any): any {\n    return descRef;\n  }\n\n  private createHelper = (d: any) => {\n    //factory method for restoring a column\n    const desc = this.fromDescRef(d.desc);\n    let c = null;\n    if (desc && desc.type) {\n      this.fixDesc(d.desc);\n      const type = this.columnTypes[desc.type];\n      c = new type(d.id, desc);\n      c.restore(d, this.createHelper);\n    }\n    return c;\n  };\n\n  restoreRanking(dump: any) {\n    const ranking = this.cloneRanking();\n    ranking.restore(dump, this.createHelper);\n    //if no rank column add one\n    if (!ranking.children.some((d) => d instanceof RankColumn)) {\n      ranking.insert(this.create(createRankDesc())!, 0);\n    }\n    const idGenerator = this.nextId.bind(this);\n    ranking.children.forEach((c) => c.assignNewId(idGenerator));\n\n    return ranking;\n  }\n\n  restore(dump: any) {\n    //clean old\n    this.clearRankings();\n\n    //restore selection\n    this.uid = dump.uid || 0;\n    if (dump.selection) {\n      dump.selection.forEach((s: number) => this.selection.add(s));\n    }\n    if (dump.aggregations) {\n      this.aggregations.clear();\n      dump.aggregations.forEach((a: string) => this.aggregations.add(a));\n    }\n\n\n    //restore rankings\n    if (dump.rankings) {\n      dump.rankings.forEach((r: any) => {\n        const ranking = this.cloneRanking();\n        ranking.restore(r, this.createHelper);\n        //if no rank column add one\n        if (!ranking.children.some((d) => d instanceof RankColumn)) {\n          ranking.insert(this.create(createRankDesc())!, 0);\n        }\n        this.insertRanking(ranking);\n      });\n    }\n    if (dump.layout) { //we have the old format try to create it\n      Object.keys(dump.layout).forEach((key) => {\n        this.deriveRanking(dump.layout[key]);\n      });\n    }\n    //assign new ids\n    const idGenerator = this.nextId.bind(this);\n    this.rankings.forEach((r) => {\n      r.children.forEach((c) => c.assignNewId(idGenerator));\n    });\n  }\n\n  abstract findDesc(ref: string): IColumnDesc | null;\n\n  abstract deriveDefault(addSupporType?: boolean): Ranking;\n\n  /**\n   * derives a ranking from an old layout bundle format\n   * @param bundle\n   */\n  private deriveRanking(bundle: any[]) {\n    const ranking = this.cloneRanking();\n    ranking.clear();\n    const toCol = (column: any) => {\n      switch (column.type) {\n        case 'rank':\n          return this.create(createRankDesc());\n        case 'selection':\n          return this.create(createSelectionDesc());\n        case 'group':\n          return this.create(createGroupDesc());\n        case 'aggregate':\n          return this.create(createAggregateDesc());\n        case 'actions':\n          const actions = this.create(createActionDesc(column.label || 'actions'))!;\n          actions.restore(column, this.createHelper);\n          return actions;\n        case 'stacked':\n          //create a stacked one\n          const stacked = <StackColumn>this.create(createStackDesc(column.label || 'Combined'))!;\n          (column.children || []).forEach((col: any) => {\n            const c = toCol(col);\n            if (c) {\n              stacked.push(c);\n            }\n          });\n          return stacked;\n        default: {\n          const desc = this.findDesc(column.column);\n          if (desc) {\n            const r = this.create(desc);\n            column.label = column.label || desc.label || (<any>desc).column;\n            if (r) {\n              r.restore(column, this.createHelper);\n            }\n            return r;\n          }\n          return null;\n        }\n      }\n    };\n    bundle.forEach((column) => {\n      const col = toCol(column);\n      if (col) {\n        ranking.push(col);\n      }\n    });\n    //if no rank column add one\n    if (!ranking.children.some((d) => d instanceof RankColumn)) {\n      ranking.insert(this.create(createRankDesc())!, 0);\n    }\n    this.insertRanking(ranking);\n    return ranking;\n  }\n\n  isAggregated(ranking: Ranking, group: IGroup) {\n    let g: IGroup | undefined | null = group;\n    while (g) {\n      const key = `${ranking.id}@${toGroupID(g)}`;\n      if (this.aggregations.has(key)) {\n        // propagate to leaf\n        this.aggregations.add(`${ranking.id}@${toGroupID(group)}`);\n        return true;\n      }\n      g = g.parent;\n    }\n    return false;\n  }\n\n  private unaggregateParents(ranking: Ranking, group: IGroup) {\n    let g: IGroup | undefined | null = group.parent;\n    while (g) {\n      this.aggregations.delete(`${ranking.id}@${toGroupID(g)}`);\n      g = g.parent;\n    }\n  }\n\n  setAggregated(ranking: Ranking, group: IGroup, value: boolean) {\n    this.unaggregateParents(ranking, group);\n    const key = `${ranking.id}@${toGroupID(group)}`;\n    const current = this.isAggregated(ranking, group);\n    if (current === value) {\n      return;\n    }\n    if (value) {\n      this.aggregations.add(key);\n    } else {\n      this.aggregations.delete(key);\n    }\n    this.fire([ADataProvider.EVENT_GROUP_AGGREGATION_CHANGED, ADataProvider.EVENT_DIRTY_VALUES, ADataProvider.EVENT_DIRTY], ranking, group, value);\n  }\n\n  aggregateAllOf(ranking: Ranking, aggregateAll: boolean) {\n    const groups = ranking.getGroups();\n    groups.forEach((group) => {\n      this.unaggregateParents(ranking, group);\n      const current = this.isAggregated(ranking, group);\n      if (current === aggregateAll) {\n        return;\n      }\n      const key = `${ranking.id}@${toGroupID(group)}`;\n      if (aggregateAll) {\n        this.aggregations.add(key);\n      } else {\n        this.aggregations.delete(key);\n      }\n    });\n    this.fire([ADataProvider.EVENT_GROUP_AGGREGATION_CHANGED, ADataProvider.EVENT_DIRTY_VALUES, ADataProvider.EVENT_DIRTY], ranking, groups, aggregateAll);\n  }\n\n  /**\n   * sorts the given ranking and eventually return a ordering of the data items\n   * @param ranking\n   * @return {Promise<any>}\n   */\n  abstract sort(ranking: Ranking): Promise<IOrderedGroup[]> | IOrderedGroup[];\n\n  /**\n   * returns a view in the order of the given indices\n   * @param indices\n   * @return {Promise<any>}\n   */\n  abstract view(indices: number[]): Promise<any[]> | any[];\n\n  abstract fetch(orders: number[][]): (Promise<IDataRow> | IDataRow)[][];\n\n  /**\n   * returns a data sample used for the mapping editor\n   * @param col\n   * @return {Promise<any>}\n   */\n  abstract mappingSample(col: Column): Promise<number[]> | number[];\n\n  /**\n   * helper for computing statistics\n   * @param indices\n   * @returns {{stats: (function(INumberColumn): *), hist: (function(ICategoricalColumn): *)}}\n   */\n  abstract stats(indices: number[]): IStatsBuilder;\n\n  /**\n   * is the given row selected\n   * @param index\n   * @return {boolean}\n   */\n  isSelected(index: number) {\n    return this.selection.has(index);\n  }\n\n  /**\n   * also select the given row\n   * @param index\n   */\n  select(index: number) {\n    if (this.selection.has(index)) {\n      return; //no change\n    }\n    if (!this.multiSelections && this.selection.size > 0) {\n      this.selection.clear();\n    }\n    this.selection.add(index);\n    this.fire(ADataProvider.EVENT_SELECTION_CHANGED, this.getSelection());\n  }\n\n  /**\n   * hook for selecting elements matching the given arguments\n   * @param search\n   * @param col\n   */\n  abstract searchAndJump(search: string | RegExp, col: Column): void;\n\n  jumpToNearest(indices: number[]) {\n    if (indices.length === 0) {\n      return;\n    }\n    this.fire(ADataProvider.EVENT_JUMP_TO_NEAREST, indices);\n  }\n\n  /**\n   * also select all the given rows\n   * @param indices\n   */\n  selectAll(indices: number[]) {\n    if (indices.every((i) => this.selection.has(i))) {\n      return; //no change\n    }\n    if (!this.multiSelections) {\n      this.selection.clear();\n      indices = indices.slice(0, 1); //just the first one\n    }\n    indices.forEach((index) => {\n      this.selection.add(index);\n    });\n    this.fire(ADataProvider.EVENT_SELECTION_CHANGED, this.getSelection());\n  }\n\n  selectAllOf(ranking: Ranking) {\n    this.setSelection(ranking.getOrder());\n  }\n\n  /**\n   * set the selection to the given rows\n   * @param indices\n   */\n  setSelection(indices: number[]) {\n    if (indices.length === 0) {\n      return this.clearSelection();\n    }\n    if (this.selection.size === indices.length && indices.every((i) => this.selection.has(i))) {\n      return; //no change\n    }\n    this.selection.clear();\n    this.selectAll(indices);\n  }\n\n  /**\n   * toggles the selection of the given data index\n   * @param index\n   * @param additional just this element or all\n   * @returns {boolean} whether the index is currently selected\n   */\n  toggleSelection(index: number, additional = false) {\n    if (this.isSelected(index)) {\n      if (additional) {\n        this.deselect(index);\n      } else {\n        this.clearSelection();\n      }\n      return false;\n    }\n    if (additional) {\n      this.select(index);\n    } else {\n      this.setSelection([index]);\n    }\n    return true;\n  }\n\n  /**\n   * deselect the given row\n   * @param index\n   */\n  deselect(index: number) {\n    if (!this.selection.has(index)) {\n      return; //no change\n    }\n    this.selection.delete(index);\n    this.fire(ADataProvider.EVENT_SELECTION_CHANGED, this.getSelection());\n  }\n\n  /**\n   * also select all the given rows\n   * @param indices\n   */\n  deselectAll(indices: number[]) {\n    if (indices.every((i) => !this.selection.has(i))) {\n      return; //no change\n    }\n    indices.forEach((index) => {\n      this.selection.delete(index);\n    });\n    this.fire(ADataProvider.EVENT_SELECTION_CHANGED, this.getSelection());\n  }\n\n  /**\n   * returns a promise containing the selected rows\n   * @return {Promise<any[]>}\n   */\n  selectedRows(): Promise<any[]> | any[] {\n    if (this.selection.size === 0) {\n      return [];\n    }\n    return this.view(this.getSelection());\n  }\n\n  /**\n   * returns the currently selected indices\n   * @returns {Array}\n   */\n  getSelection() {\n    return Array.from(this.selection);\n  }\n\n  /**\n   * clears the selection\n   */\n  clearSelection() {\n    if (this.selection.size === 0) {\n      return; //no change\n    }\n    this.selection.clear();\n    this.fire(ADataProvider.EVENT_SELECTION_CHANGED, [], false);\n  }\n\n  /**\n   * utility to export a ranking to a table with the given separator\n   * @param ranking\n   * @param options\n   * @returns {Promise<string>}\n   */\n  exportTable(ranking: Ranking, options: Partial<IExportOptions> = {}) {\n    return Promise.resolve(this.view(ranking.getOrder())).then((data) => exportRanking(ranking, data, options));\n  }\n}\n\nexport default ADataProvider;\n","import {Category, toolbar} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {\n  compareCategory, groupCompareCategory,\n  ICategoricalColumn, ICategoricalColumnDesc, ICategoricalFilter, ICategory,\n  isEqualCategoricalFilter, isCategoryIncluded, toCategories, toCategory,\n} from './ICategoricalColumn';\nimport {IDataRow, IGroup, IGroupData} from './interfaces';\nimport {missingGroup} from './missing';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n/**\n * emitted when the filter property changes\n * @asMemberOf CategoricalColumn\n * @event\n */\nexport declare function filterChanged(previous: ICategoricalFilter | null, current: ICategoricalFilter | null): void;\n\n/**\n * column for categorical values\n */\n@toolbar('group', 'groupBy', 'sortGroupBy', 'filterCategorical')\n@Category('categorical')\nexport default class CategoricalColumn extends ValueColumn<string> implements ICategoricalColumn {\n  static readonly EVENT_FILTER_CHANGED = 'filterChanged';\n\n  readonly categories: ICategory[];\n\n  private readonly missingCategory: ICategory | null;\n\n  private readonly lookup = new Map<string, Readonly<ICategory>>();\n  /**\n   * set of categories to show\n   * @type {null}\n   * @private\n   */\n  private currentFilter: ICategoricalFilter | null = null;\n\n  constructor(id: string, desc: Readonly<ICategoricalColumnDesc>) {\n    super(id, desc);\n    this.categories = toCategories(desc);\n    this.missingCategory = desc.missingCategory ? toCategory(desc.missingCategory, NaN) : null;\n    this.categories.forEach((d) => this.lookup.set(d.name, d));\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([CategoricalColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof CategoricalColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    const v = this.getCategory(row);\n    return v ? v.name : null;\n  }\n\n  getCategory(row: IDataRow) {\n    const v = super.getValue(row);\n    if (!v) {\n      return this.missingCategory;\n    }\n    const vs = String(v);\n    return this.lookup.has(vs) ? this.lookup.get(vs)! : this.missingCategory;\n  }\n\n  get dataLength() {\n    return this.categories.length;\n  }\n\n  get labels() {\n    return this.categories.map((d) => d.label);\n  }\n\n  getLabel(row: IDataRow) {\n    const v = this.getCategory(row);\n    return v ? v.label : '';\n  }\n\n  getColor(row: IDataRow) {\n    const v = this.getCategory(row);\n    return v ? v.color : Column.DEFAULT_COLOR;\n  }\n\n  getValues(row: IDataRow) {\n    const v = this.getCategory(row);\n    return this.categories.map((d) => d === v);\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getValues(row).map(String);\n  }\n\n  getMap(row: IDataRow) {\n    const cats = this.categories;\n    return this.getValues(row).map((value, i) => ({key: cats[i].label, value}));\n  }\n\n  getMapLabel(row: IDataRow) {\n    const cats = this.categories;\n    return this.getLabels(row).map((value, i) => ({key: cats[i].label, value}));\n  }\n\n  getSet(row: IDataRow) {\n    const cat = this.getCategory(row);\n    const r = new Set<ICategory>();\n    if (cat && cat !== this.missingCategory) {\n      r.add(cat);\n    }\n    return r;\n  }\n\n  isMissing(row: IDataRow) {\n    return this.getCategory(row) === this.missingCategory;\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.filter = this.currentFilter;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (!('filter' in dump)) {\n      this.currentFilter = null;\n      return;\n    }\n    const bak = dump.filter;\n    if (typeof bak === 'string' || Array.isArray(bak)) {\n      this.currentFilter = {filter: bak, filterMissing: false};\n    } else {\n      this.currentFilter = bak;\n    }\n  }\n\n  isFiltered() {\n    return this.currentFilter != null;\n  }\n\n  filter(row: IDataRow): boolean {\n    return isCategoryIncluded(this.currentFilter, this.getCategory(row));\n  }\n\n  getFilter() {\n    return this.currentFilter == null ? null : Object.assign({}, this.currentFilter);\n  }\n\n  setFilter(filter: ICategoricalFilter | null) {\n    if (isEqualCategoricalFilter(this.currentFilter, filter)) {\n      return;\n    }\n    this.fire([CategoricalColumn.EVENT_FILTER_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.currentFilter, this.currentFilter = filter);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return compareCategory(this.getCategory(a), this.getCategory(b));\n  }\n\n  group(row: IDataRow): IGroup {\n    const cat = this.getCategory(row);\n    if (!cat) {\n      return missingGroup;\n    }\n    return {name: cat.label, color: cat.color};\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData): number {\n    return groupCompareCategory(a.rows, b.rows, this);\n  }\n\n  getGroupRenderer() {\n    const current = super.getGroupRenderer();\n    if (current === this.desc.type && this.isGroupedBy() >= 0) {\n      // still the default and the stratification criteria\n      return 'catdistributionbar';\n    }\n    return current;\n  }\n}\n","import {Category, toolbar, dialogAddons} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IDataRow, IGroup} from './interfaces';\nimport {FIRST_IS_MISSING, missingGroup} from './missing';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {equal} from '../internal';\nimport {defaultGroup} from './Group';\n\nexport enum EAlignment {\n  left = 'left',\n  center = 'center',\n  right = 'right'\n}\n\nexport interface IStringDesc {\n  /**\n   * column alignment: left, center, right\n   * @default left\n   */\n  alignment?: EAlignment;\n\n  /**\n   * escape html tags\n   */\n  escape?: boolean;\n}\n\n\nexport declare type IStringColumnDesc = IStringDesc & IValueColumnDesc<string>;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf StringColumn\n * @event\n */\nexport declare function filterChanged(previous: string | RegExp | null, current: string | RegExp | null): void;\n\n\n/**\n * emitted when the grouping property changes\n * @asMemberOf StringColumn\n * @event\n */\nexport declare function groupingChanged(previous: (RegExp | string)[][], current: (RegExp | string)[][]): void;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('search', 'groupBy', 'filterString')\n@dialogAddons('group', 'groupString')\n@Category('string')\nexport default class StringColumn extends ValueColumn<string> {\n  static readonly EVENT_FILTER_CHANGED = 'filterChanged';\n  static readonly EVENT_GROUPING_CHANGED = 'groupingChanged';\n\n  //magic key for filtering missing ones\n  static readonly FILTER_MISSING = '__FILTER_MISSING';\n  private currentFilter: string | RegExp | null = null;\n\n  readonly alignment: EAlignment;\n  readonly escape: boolean;\n\n  private currentGroupCriteria: (RegExp | string)[] = [];\n\n  constructor(id: string, desc: Readonly<IStringColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(200); //by default 200\n    this.alignment = <any>desc.alignment || EAlignment.left;\n    this.escape = desc.escape !== false;\n  }\n\n\n  protected createEventList() {\n    return super.createEventList().concat([StringColumn.EVENT_GROUPING_CHANGED, StringColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof StringColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof StringColumn.EVENT_GROUPING_CHANGED, listener: typeof groupingChanged | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    const v: any = super.getValue(row);\n    return v == null ? '' : String(v);\n  }\n\n  getLabel(row: IDataRow) {\n    return this.getValue(row) || '';\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    if (this.currentFilter instanceof RegExp) {\n      r.filter = `REGEX:${(<RegExp>this.currentFilter).source}`;\n    } else {\n      r.filter = this.currentFilter;\n    }\n    if (this.currentGroupCriteria) {\n      r.groupCriteria = this.currentGroupCriteria.map((d) => typeof d === 'string' ? d : `REGEX:${d.source}`);\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.filter && (<string>dump.filter).startsWith('REGEX:')) {\n      this.currentFilter = new RegExp(dump.filter.slice(6), 'gm');\n    } else {\n      this.currentFilter = dump.filter || null;\n    }\n    if (dump.groupCriteria) {\n      this.currentGroupCriteria = dump.groupCriteria.map((d: string) => d.startsWith('REGEX:') ? new RegExp(d.slice(6), 'gm') : d);\n    }\n  }\n\n  isFiltered() {\n    return this.currentFilter != null;\n  }\n\n  filter(row: IDataRow) {\n    if (!this.isFiltered()) {\n      return true;\n    }\n    const r = this.getLabel(row);\n    const filter = this.currentFilter;\n\n    if (filter === StringColumn.FILTER_MISSING) { //filter empty\n      return r != null && r.trim() !== '';\n    }\n    if (typeof filter === 'string' && filter.length > 0) {\n      return r !== '' && r.toLowerCase().indexOf(filter.toLowerCase()) >= 0;\n    }\n    if (filter instanceof RegExp) {\n      return r !== '' && filter.test(r);\n    }\n    return true;\n  }\n\n  getFilter() {\n    return this.currentFilter;\n  }\n\n  setFilter(filter: string | RegExp | null) {\n    if (filter === '') {\n      filter = null;\n    }\n    if (this.currentFilter === filter) {\n      return;\n    }\n    this.fire([StringColumn.EVENT_FILTER_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.currentFilter, this.currentFilter = filter);\n  }\n\n  getGroupCriteria() {\n    return this.currentGroupCriteria.slice();\n  }\n\n  setGroupCriteria(value: (string | RegExp)[]) {\n    if (equal(this.currentGroupCriteria, value)) {\n      return;\n    }\n    const bak = this.getGroupCriteria();\n    this.currentGroupCriteria = value.slice();\n    this.fire([StringColumn.EVENT_GROUPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, value);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    const aValue = this.getLabel(a);\n    const bValue = this.getLabel(b);\n    if (aValue === '') {\n      return bValue === '' ? 0 : FIRST_IS_MISSING; //same = 0\n    }\n    if (bValue === '') {\n      return -FIRST_IS_MISSING;\n    }\n    return aValue.toLowerCase().localeCompare(bValue.toLowerCase());\n  }\n\n  group(row: IDataRow): IGroup {\n    if (this.isMissing(row)) {\n      return missingGroup;\n    }\n\n    if (this.currentGroupCriteria.length === 0) {\n      return defaultGroup;\n    }\n    const value = this.getLabel(row);\n\n    if (!value) {\n      return defaultGroup;\n    }\n\n    for (const criteria of this.currentGroupCriteria) {\n      if (!((criteria instanceof RegExp && criteria.test(value)) || (typeof criteria === 'string' && value.startsWith(criteria)))) {\n        continue;\n      }\n      return {\n        name: typeof criteria === 'string' ? criteria : criteria.source,\n        color: defaultGroup.color\n      };\n    }\n    return defaultGroup;\n  }\n}\n\n","import ArrayColumn, {IArrayColumnDesc} from './ArrayColumn';\r\nimport {ISetColumn, toCategory} from './ICategoricalColumn';\r\nimport {IDataRow} from './interfaces';\r\nimport {FIRST_IS_MISSING} from './missing';\r\n\r\nexport declare type IBooleansColumnDesc = IArrayColumnDesc<boolean>;\r\n\r\nexport default class BooleansColumn extends ArrayColumn<boolean> implements ISetColumn {\r\n  constructor(id: string, desc: Readonly<IBooleansColumnDesc>) {\r\n    super(id, desc);\r\n    this.setDefaultRenderer('upset');\r\n  }\r\n\r\n  get categories() {\r\n    return this.labels.map((d, i) => toCategory(d, i));\r\n  }\r\n\r\n  getSet(row: IDataRow) {\r\n    const vs = this.getValues(row);\r\n    return new Set(this.categories.filter((_, i) => vs[i]));\r\n  }\r\n\r\n  compare(a: IDataRow, b: IDataRow) {\r\n    const aVal = this.getValue(a);\r\n    const bVal = this.getValue(b);\r\n    if (aVal == null) {\r\n      return bVal == null ? 0 : FIRST_IS_MISSING;\r\n    }\r\n    if (bVal == null) {\r\n      return -FIRST_IS_MISSING;\r\n    }\r\n\r\n    const aCat = aVal.filter((x) => x).length;\r\n    const bCat = bVal.filter((x) => x).length;\r\n    return (aCat - bCat);\r\n  }\r\n}\r\n","import {ICategoricalDesc, ICategory, toCategories, toCategory} from './ICategoricalColumn';\r\nimport {IDataRow} from './interfaces';\r\nimport MapColumn, {IMapColumnDesc} from './MapColumn';\r\n\r\nexport declare type ICategoricalMapColumnDesc = ICategoricalDesc & IMapColumnDesc<string | null>;\r\n\r\nexport default class CategoricalMapColumn extends MapColumn<string | null> {\r\n  readonly categories: ICategory[];\r\n\r\n  private readonly missingCategory: ICategory | null;\r\n\r\n  private readonly lookup = new Map<string, Readonly<ICategory>>();\r\n\r\n  constructor(id: string, desc: Readonly<ICategoricalMapColumnDesc>) {\r\n    super(id, desc);\r\n    this.categories = toCategories(desc);\r\n    this.missingCategory = desc.missingCategory ? toCategory(desc.missingCategory, NaN) : null;\r\n    this.categories.forEach((d) => this.lookup.set(d.name, d));\r\n  }\r\n\r\n\r\n  private parseValue(v: any) {\r\n    if (!v) {\r\n      return this.missingCategory;\r\n    }\r\n    const vs = String(v);\r\n    return this.lookup.has(vs) ? this.lookup.get(vs)! : this.missingCategory;\r\n  }\r\n\r\n  getCategories(row: IDataRow) {\r\n    return super.getValue(row).map(({key, value}) => ({\r\n      key,\r\n      value: this.parseValue(value)\r\n    }));\r\n  }\r\n\r\n  getValue(row: IDataRow) {\r\n    return this.getCategories(row).map(({key, value}) => ({\r\n      key,\r\n      value: value ? value.name : null\r\n    }));\r\n  }\r\n\r\n  getLabels(row: IDataRow) {\r\n    return this.getCategories(row).map(({key, value}) => ({\r\n      key,\r\n      value: value ? value.label : ''\r\n    }));\r\n  }\r\n}\r\n","import ArrayColumn, {IArrayColumnDesc} from './ArrayColumn';\r\nimport {ICategoricalDesc, ICategory, toCategories, toCategory} from './ICategoricalColumn';\r\nimport {IDataRow} from './interfaces';\r\n\r\nexport declare type ICategoricalsColumnDesc = ICategoricalDesc & IArrayColumnDesc<string | null>;\r\n\r\n/**\r\n * a string column with optional alignment\r\n */\r\nexport default class CategoricalsColumn extends ArrayColumn<string | null> {\r\n  readonly categories: ICategory[];\r\n\r\n  private readonly missingCategory: ICategory | null;\r\n\r\n  private readonly lookup = new Map<string, Readonly<ICategory>>();\r\n\r\n  constructor(id: string, desc: Readonly<ICategoricalsColumnDesc>) {\r\n    super(id, desc);\r\n    this.categories = toCategories(desc);\r\n    this.missingCategory = desc.missingCategory ? toCategory(desc.missingCategory, NaN) : null;\r\n    this.categories.forEach((d) => this.lookup.set(d.name, d));\r\n  }\r\n\r\n  getCategories(row: IDataRow) {\r\n    return super.getValues(row).map((v) => {\r\n      if (!v) {\r\n        return this.missingCategory;\r\n      }\r\n      const vs = String(v);\r\n      return this.lookup.has(vs) ? this.lookup.get(vs)! : this.missingCategory;\r\n    });\r\n  }\r\n\r\n  getSet(row: IDataRow) {\r\n    const r = new Set(this.getCategories(row));\r\n    r.delete(this.missingCategory);\r\n    return r;\r\n  }\r\n\r\n  getValues(row: IDataRow) {\r\n    return this.getCategories(row).map((v) => v ? v.name : null);\r\n  }\r\n\r\n  getLabels(row: IDataRow) {\r\n    return this.getCategories(row).map((v) => v ? v.label : '');\r\n  }\r\n}\r\n","import {timeFormat, timeParse} from 'd3-time-format';\nimport {IDateColumn, IDateFilter, noDateFilter, restoreDateFilter, isDummyDateFilter} from './IDateColumn';\nimport {IKeyValue} from './IArrayColumn';\nimport {IDataRow} from './interfaces';\nimport MapColumn, {IMapColumnDesc} from './MapColumn';\nimport {isMissingValue} from './missing';\nimport DatesColumn, {EDateSort, IDatesDesc} from './DatesColumn';\nimport DateColumn from './DateColumn';\nimport {dialogAddons, toolbar} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport declare type IDateMapColumnDesc = IDatesDesc & IMapColumnDesc<Date | null>;\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf DatesMapColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: EDateSort, current: EDateSort): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf DatesMapColumn\n * @event\n */\nexport declare function filterChanged(previous: IDateFilter | null, current: IDateFilter | null): void;\n\n\n@toolbar('filterDate')\n@dialogAddons('sort', 'sortDates')\nexport default class DatesMapColumn extends MapColumn<Date | null> implements IDateColumn {\n  static readonly EVENT_SORTMETHOD_CHANGED = DatesColumn.EVENT_SORTMETHOD_CHANGED;\n  static readonly EVENT_FILTER_CHANGED = DateColumn.EVENT_FILTER_CHANGED;\n\n  private readonly format: (date: Date) => string;\n  private readonly parse: (date: string) => Date | null;\n  private sort: EDateSort;\n  private currentFilter: IDateFilter = noDateFilter();\n\n  constructor(id: string, desc: Readonly<IDateMapColumnDesc>) {\n    super(id, desc);\n    this.format = timeFormat(desc.dateFormat || '%x');\n    this.parse = desc.dateParse ? timeParse(desc.dateParse) : timeParse(desc.dateFormat || '%x');\n    this.sort = desc.sort || EDateSort.median;\n    this.setDefaultRenderer('default');\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([DatesMapColumn.EVENT_SORTMETHOD_CHANGED, DatesMapColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof DatesMapColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof DatesMapColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  private parseValue(v: any) {\n    if (isMissingValue(v)) {\n      return null;\n    }\n    if (v instanceof Date) {\n      return v;\n    }\n    return this.parse(String(v));\n  }\n\n  getValue(row: IDataRow) {\n    return super.getValue(row).map(({key, value}) => ({\n      key,\n      value: this.parseValue(value)\n    }));\n  }\n\n  getLabels(row: IDataRow): IKeyValue<string>[] {\n    return this.getValue(row).map(({key, value}) => ({\n      key,\n      value: (value instanceof Date) ? this.format(value) : ''\n    }));\n  }\n\n  getDates(row: IDataRow): (Date | null)[] {\n    return this.getValue(row).map((v) => v.value);\n  }\n\n  getDate(row: IDataRow) {\n    return DatesColumn.prototype.getDate.call(this, row);\n  }\n\n  getSortMethod() {\n    return this.sort;\n  }\n\n  setSortMethod(sort: EDateSort) {\n    return DatesColumn.prototype.setSortMethod.call(this, sort);\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.sortMethod = this.getSortMethod();\n    r.filter = !isDummyDateFilter(this.currentFilter) ? this.currentFilter : null;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.sortMethod) {\n      this.sort = dump.sortMethod;\n    }\n    if (dump.filter) {\n      this.currentFilter = restoreDateFilter(dump.filter);\n    }\n  }\n\n  isFiltered() {\n    return DateColumn.prototype.isFiltered.call(this);\n  }\n\n  getFilter(): IDateFilter {\n    return DateColumn.prototype.getFilter.call(this);\n  }\n\n  setFilter(value: IDateFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    DateColumn.prototype.setFilter.call(this, value);\n  }\n\n  filter(row: IDataRow) {\n    return DateColumn.prototype.filter.call(this, row);\n  }\n}\n","import {LazyBoxPlotData} from '../internal';\nimport {toolbar, SortByDefault, dialogAddons} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IKeyValue} from './IArrayColumn';\nimport {IDataRow} from './interfaces';\nimport {\n  compareBoxPlot, DEFAULT_FORMATTER, EAdvancedSortMethod, getBoxPlotNumber, IAdvancedBoxPlotColumn, INumberDesc,\n  INumberFilter, noNumberFilter, isDummyNumberFilter, restoreNumberFilter\n} from './INumberColumn';\nimport {default as MapColumn, IMapColumnDesc} from './MapColumn';\nimport {createMappingFunction, IMappingFunction, restoreMapping, ScaleMappingFunction} from './MappingFunction';\nimport {isMissingValue} from './missing';\nimport NumberColumn, {colorMappingChanged} from './NumberColumn';\nimport {IAdvancedBoxPlotData} from '../internal/math';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {IColorMappingFunction, restoreColorMapping, createColorMappingFunction} from './ColorMappingFunction';\n\n\nexport interface INumberMapDesc extends INumberDesc {\n  readonly sort?: EAdvancedSortMethod;\n}\n\nexport declare type INumberMapColumnDesc = INumberMapDesc & IMapColumnDesc<number>;\n\n/**\n * emitted when the mapping property changes\n * @asMemberOf NumberMapColumn\n * @event\n */\nexport declare function mappingChanged(previous: IMappingFunction, current: IMappingFunction): void;\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf NumberMapColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: EAdvancedSortMethod, current: EAdvancedSortMethod): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf NumberMapColumn\n * @event\n */\nexport declare function filterChanged(previous: INumberFilter | null, current: INumberFilter | null): void;\n\n@toolbar('filterNumber', 'colorMapped', 'editMapping')\n@dialogAddons('sort', 'sortNumbers')\n@SortByDefault('descending')\nexport default class NumberMapColumn extends MapColumn<number> implements IAdvancedBoxPlotColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumberColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_COLOR_MAPPING_CHANGED = NumberColumn.EVENT_COLOR_MAPPING_CHANGED;\n  static readonly EVENT_SORTMETHOD_CHANGED = NumberColumn.EVENT_SORTMETHOD_CHANGED;\n  static readonly EVENT_FILTER_CHANGED = NumberColumn.EVENT_FILTER_CHANGED;\n\n  private sort: EAdvancedSortMethod;\n  private mapping: IMappingFunction;\n  private original: IMappingFunction;\n  private colorMapping: IColorMappingFunction;\n  /**\n   * currently active filter\n   * @type {{min: number, max: number}}\n   * @private\n   */\n  private currentFilter: INumberFilter = noNumberFilter();\n\n  constructor(id: string, desc: Readonly<INumberMapColumnDesc>) {\n    super(id, desc);\n    this.mapping = restoreMapping(desc);\n    this.original = this.mapping.clone();\n    this.colorMapping = restoreColorMapping(desc);\n    this.sort = desc.sort || EAdvancedSortMethod.median;\n    this.setDefaultRenderer('mapbars');\n  }\n\n  compare(a: IDataRow, b: IDataRow): number {\n    return compareBoxPlot(this, a, b);\n  }\n\n  getBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null {\n    const data = this.getRawValue(row);\n    if (data == null) {\n      return null;\n    }\n    return new LazyBoxPlotData(data.map((d) => d.value), this.mapping);\n  }\n\n  getRange() {\n    return this.mapping.getRange(DEFAULT_FORMATTER);\n  }\n\n  getRawBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null {\n    const data = this.getRawValue(row);\n    if (data == null) {\n      return null;\n    }\n    return new LazyBoxPlotData(data.map((d) => d.value));\n  }\n\n  getNumber(row: IDataRow): number {\n    return getBoxPlotNumber(this, row, 'normalized');\n  }\n\n  getRawNumber(row: IDataRow): number {\n    return getBoxPlotNumber(this, row, 'raw');\n  }\n\n  getValue(row: IDataRow) {\n    const values = this.getRawValue(row);\n    return values.map(({key, value}) => ({key, value: isMissingValue(value) ? NaN : this.mapping.apply(value)}));\n  }\n\n  getRawValue(row: IDataRow): IKeyValue<number>[] {\n    const r = super.getValue(row);\n    return r == null ? [] : r;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    return format === 'json' ? this.getRawValue(row) : super.getExportValue(row, format);\n  }\n\n  getLabels(row: IDataRow) {\n    const v = this.getValue(row);\n    return v.map(({key, value}) => ({key, value: DEFAULT_FORMATTER(value)}));\n  }\n\n  getSortMethod() {\n    return this.sort;\n  }\n\n  setSortMethod(sort: EAdvancedSortMethod) {\n    if (this.sort === sort) {\n      return;\n    }\n    this.fire([NumberMapColumn.EVENT_SORTMETHOD_CHANGED], this.sort, this.sort = sort);\n    // sort by me if not already sorted by me\n    if (!this.isSortedByMe().asc) {\n      this.sortByMe();\n    }\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.sortMethod = this.getSortMethod();\n    r.filter = !isDummyNumberFilter(this.currentFilter) ? this.currentFilter : null;\n    r.map = this.mapping.dump();\n    r.colorMapping = this.colorMapping.dump();\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.sortMethod) {\n      this.sort = dump.sortMethod;\n    }\n    if (dump.filter) {\n      this.currentFilter = restoreNumberFilter(dump.filter);\n    }\n    if (dump.map) {\n      this.mapping = createMappingFunction(dump.map);\n    } else if (dump.domain) {\n      this.mapping = new ScaleMappingFunction(dump.domain, 'linear', dump.range || [0, 1]);\n    }\n    if (dump.colorMapping) {\n      this.colorMapping = createColorMappingFunction(dump.colorMapping);\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([NumberMapColumn.EVENT_COLOR_MAPPING_CHANGED, NumberMapColumn.EVENT_MAPPING_CHANGED, NumberMapColumn.EVENT_SORTMETHOD_CHANGED, NumberMapColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof NumberMapColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof NumberMapColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof NumberMapColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof NumberMapColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getOriginalMapping() {\n    return this.original.clone();\n  }\n\n  getMapping() {\n    return this.mapping.clone();\n  }\n\n  setMapping(mapping: IMappingFunction) {\n    if (this.mapping.eq(mapping)) {\n      return;\n    }\n    this.fire([NumberMapColumn.EVENT_MAPPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.mapping.clone(), this.mapping = mapping);\n  }\n\n  getColor(row: IDataRow) {\n    return NumberColumn.prototype.getColor.call(this, row);\n  }\n\n  getColorMapping() {\n    return this.colorMapping.clone();\n  }\n\n  setColorMapping(mapping: IColorMappingFunction) {\n    if (this.colorMapping.eq(mapping)) {\n      return;\n    }\n    this.fire([NumberMapColumn.EVENT_COLOR_MAPPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.colorMapping.clone(), this.colorMapping = mapping);\n  }\n\n  isFiltered() {\n    return NumberColumn.prototype.isFiltered.call(this);\n  }\n\n  getFilter(): INumberFilter {\n    return NumberColumn.prototype.getFilter.call(this);\n  }\n\n  setFilter(value: INumberFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    NumberColumn.prototype.setFilter.call(this, value);\n  }\n\n  filter(row: IDataRow) {\n    return NumberColumn.prototype.filter.call(this, row);\n  }\n}\n\n","import {Category, toolbar} from './annotations';\nimport CategoricalColumn from './CategoricalColumn';\nimport Column, {labelChanged, metaDataChanged, dirty, widthChanged, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IArrayColumn} from './IArrayColumn';\nimport {ICategoricalDesc, ICategoricalFilter, ICategory, isCategoryIncluded, toCategories} from './ICategoricalColumn';\nimport {IDataRow} from './interfaces';\nimport {FIRST_IS_MISSING} from './missing';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport interface ISetDesc extends ICategoricalDesc {\n  separator?: string;\n}\n\nexport declare type ISetColumnDesc = ISetDesc & IValueColumnDesc<string[]>;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf SetColumn\n * @event\n */\nexport declare function filterChanged(previous: ICategoricalFilter | null, current: ICategoricalFilter | null): void;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('filterCategorical')\n@Category('categorical')\nexport default class SetColumn extends ValueColumn<string[]> implements IArrayColumn<boolean> {\n  static readonly EVENT_FILTER_CHANGED = CategoricalColumn.EVENT_FILTER_CHANGED;\n\n  readonly categories: ICategory[];\n\n  private readonly separator: RegExp;\n\n  private readonly lookup = new Map<string, Readonly<ICategory>>();\n  /**\n   * set of categories to show\n   * @type {null}\n   * @private\n   */\n  private currentFilter: ICategoricalFilter | null = null;\n\n  constructor(id: string, desc: Readonly<ISetColumnDesc>) {\n    super(id, desc);\n    this.separator = new RegExp(desc.separator || ';');\n    this.categories = toCategories(desc);\n    this.categories.forEach((d) => this.lookup.set(d.name, d));\n    this.setDefaultRenderer('upset');\n    this.setDefaultGroupRenderer('upset');\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([SetColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof SetColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  get labels() {\n    return this.categories.map((d) => d.label);\n  }\n\n  get dataLength() {\n    return this.categories.length;\n  }\n\n  getValue(row: IDataRow): string[] {\n    return this.getCategories(row).map((d) => d.name);\n  }\n\n  getLabel(row: IDataRow) {\n    return `(${this.getCategories(row).map((d) => d.label).join(',')})`;\n  }\n\n  private normalize(v: any) {\n    if (typeof v === 'string') {\n      return v.split(this.separator).map((s) => s.trim());\n    }\n    if (Array.isArray(v)) {\n      return v.map((v) => String(v).trim());\n    }\n    if (v instanceof Set) {\n      return Array.from(v).map(String);\n    }\n    return [];\n  }\n\n  getSet(row: IDataRow) {\n    const sv = this.normalize(super.getValue(row));\n    const r = new Set<ICategory>();\n    sv.forEach((n) => {\n      const cat = this.lookup.get(n);\n      if (cat) {\n        r.add(cat);\n      }\n    });\n    return r;\n  }\n\n  getCategories(row: IDataRow) {\n    return Array.from(this.getSet(row)).sort((a, b) => a.value === b.value ? a.label.localeCompare(b.label) : a.value - b.value);\n  }\n\n  isMissing(row: IDataRow) {\n    const s = this.getSet(row);\n    return s.size === 0;\n  }\n\n  getValues(row: IDataRow) {\n    const s = new Set(this.getSet(row));\n    return this.categories.map((d) => s.has(d));\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getValues(row).map(String);\n  }\n\n  getMap(row: IDataRow) {\n    return this.getCategories(row).map((d) => ({key: d.label, value: true}));\n  }\n\n  getMapLabel(row: IDataRow) {\n    return this.getCategories(row).map((d) => ({key: d.label, value: 'true'}));\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.filter = this.currentFilter;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (!('filter' in dump)) {\n      this.currentFilter = null;\n      return;\n    }\n    const bak = dump.filter;\n    if (typeof bak === 'string' || Array.isArray(bak)) {\n      this.currentFilter = {filter: bak, filterMissing: false};\n    } else {\n      this.currentFilter = bak;\n    }\n  }\n\n  isFiltered() {\n    return this.currentFilter != null;\n  }\n\n  filter(row: IDataRow): boolean {\n    if (!this.currentFilter) {\n      return true;\n    }\n    return Array.from(this.getSet(row)).some((s) => isCategoryIncluded(this.currentFilter, s));\n  }\n\n  getFilter() {\n    return CategoricalColumn.prototype.getFilter.call(this);\n  }\n\n  setFilter(filter: ICategoricalFilter | null) {\n    return CategoricalColumn.prototype.setFilter.call(this, filter);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    const av = this.getSet(a);\n    const bv = this.getSet(b);\n    if (av.size === 0) {\n      return bv.size === 0 ? 0 : FIRST_IS_MISSING;\n    }\n    if (bv.size === 0) {\n      return -FIRST_IS_MISSING;\n    }\n    if (av.size !== bv.size) {\n      return av.size - bv.size;\n    }\n    // first one having a category wins\n    for (const cat of this.categories) {\n      if (av.has(cat)) {\n        return -1;\n      }\n      if (bv.has(cat)) {\n        return +1;\n      }\n    }\n    return 0;\n  }\n}\n","import {toolbar} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IDataRow} from './interfaces';\nimport MapColumn, {IMapColumnDesc} from './MapColumn';\nimport {EAlignment, IStringDesc} from './StringColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport declare type IStringMapColumnDesc = IStringDesc & IMapColumnDesc<string>;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('search')\nexport default class StringMapColumn extends MapColumn<string> {\n  readonly alignment: EAlignment;\n  readonly escape: boolean;\n\n  constructor(id: string, desc: Readonly<IStringMapColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(200); //by default 200\n    this.alignment = <any>desc.alignment || EAlignment.left;\n    this.escape = desc.escape !== false;\n    this.setDefaultRenderer('map');\n  }\n\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    return super.getValue(row).map(({key, value}) => ({\n      key,\n      value: value == null ? '' : String(value)\n    }));\n  }\n}\n","import {toolbar} from './annotations';\nimport ArrayColumn, {IArrayColumnDesc, spliceChanged} from './ArrayColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IDataRow} from './interfaces';\nimport {EAlignment, IStringDesc} from './StringColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport declare type IStringsColumnDesc = IStringDesc & IArrayColumnDesc<string>;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('search')\nexport default class StringsColumn extends ArrayColumn<string> {\n  readonly alignment: EAlignment;\n  readonly escape: boolean;\n\n  constructor(id: string, desc: Readonly<IStringsColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(200); //by default 200\n    this.alignment = <any>desc.alignment || EAlignment.left;\n    this.escape = desc.escape !== false;\n  }\n\n  on(type: typeof ArrayColumn.EVENT_SPLICE_CHANGED, listener: typeof spliceChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValues(row: IDataRow) {\n    return super.getValues(row).map((v) => {\n      return v == null ? '' : String(v);\n    });\n  }\n}\n","import {toolbar} from './annotations';\nimport ArrayColumn, {IArrayColumnDesc, spliceChanged} from './ArrayColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IDataRow} from './interfaces';\nimport {patternFunction} from './internal';\nimport {EAlignment} from './StringColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport LinkColumn, {ILink, ILinkDesc, patternChanged} from './LinkColumn';\n\nexport declare type ILinksColumnDesc = ILinkDesc & IArrayColumnDesc<string | ILink>;\n\n@toolbar('search', 'editPattern')\nexport default class LinksColumn extends ArrayColumn<string | ILink> {\n  static readonly EVENT_PATTERN_CHANGED = LinkColumn.EVENT_PATTERN_CHANGED;\n\n  readonly alignment: EAlignment;\n  readonly escape: boolean;\n  private pattern: string;\n  private patternFunction: Function | null = null;\n  readonly patternTemplates: string[];\n\n  constructor(id: string, desc: Readonly<ILinksColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(200); //by default 200\n    this.alignment = <any>desc.alignment || EAlignment.left;\n    this.escape = desc.escape !== false;\n    this.pattern = desc.pattern || '';\n    this.patternTemplates = desc.patternTemplates || [];\n  }\n\n  setPattern(pattern: string) {\n    return LinkColumn.prototype.setPattern.call(this, pattern);\n  }\n\n  getPattern() {\n    return this.pattern;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([LinksColumn.EVENT_PATTERN_CHANGED]);\n  }\n\n  on(type: typeof LinksColumn.EVENT_PATTERN_CHANGED, listener: typeof patternChanged | null): this;\n  on(type: typeof ArrayColumn.EVENT_SPLICE_CHANGED, listener: typeof spliceChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValues(row: IDataRow) {\n    return this.getLinks(row).map((d) => d ? d.href : '');\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getLinks(row).map((d) => d ? d.alt : '');\n  }\n\n  private transformValue(v: any, row: IDataRow, i: number) {\n    if (v == null || v === '') {\n      return null;\n    }\n    if (typeof v === 'string') {\n      if (!this.pattern) {\n        return {\n          alt: v,\n          href: v\n        };\n      }\n      if (!this.patternFunction) {\n        this.patternFunction = patternFunction(this.pattern, 'item', 'index');\n      }\n      return {\n        alt: v,\n        href: this.patternFunction.call(this, v, row.v, i)\n      };\n    }\n    return v;\n  }\n\n  getLinks(row: IDataRow): ILink[] {\n    return super.getValues(row).map((v, i) => {\n      return this.transformValue(v, row, i);\n    });\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    if (this.pattern !== (<any>this.desc).pattern) {\n      r.pattern = this.pattern;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    if (dump.pattern) {\n      this.pattern = dump.pattern;\n    }\n    super.restore(dump, factory);\n  }\n}\n","import Column, {IColumnDesc} from './Column';\r\n\r\n/**\r\n * a default column with no values\r\n */\r\nexport default class DummyColumn extends Column {\r\n\r\n  constructor(id: string, desc: Readonly<IColumnDesc>) {\r\n    super(id, desc);\r\n  }\r\n\r\n  getLabel() {\r\n    return '';\r\n  }\r\n\r\n  getValue() {\r\n    return '';\r\n  }\r\n\r\n  compare() {\r\n    return 0; //can't compare\r\n  }\r\n}\r\n","import ActionColumn from './ActionColumn';\r\nimport AggregateGroupColumn from './AggregateGroupColumn';\r\nimport AnnotateColumn from './AnnotateColumn';\r\nimport BooleanColumn from './BooleanColumn';\r\nimport BooleansColumn from './BooleansColumn';\r\nimport BoxPlotColumn from './BoxPlotColumn';\r\nimport CategoricalColumn from './CategoricalColumn';\r\nimport CategoricalMapColumn from './CategoricalMapColumn';\r\nimport CategoricalsColumn from './CategoricalsColumn';\r\nimport Column from './Column';\r\nimport DateColumn from './DateColumn';\r\nimport DatesColumn from './DatesColumn';\r\nimport DatesMapColumn from './DatesMapColumn';\r\nimport GroupColumn from './GroupColumn';\r\nimport HierarchyColumn from './HierarchyColumn';\r\nimport ImpositionCompositeColumn from './ImpositionCompositeColumn';\r\nimport ImpositionCompositesColumn from './ImpositionCompositesColumn';\r\nimport NestedColumn from './NestedColumn';\r\nimport NumberColumn from './NumberColumn';\r\nimport NumberMapColumn from './NumberMapColumn';\r\nimport NumbersColumn from './NumbersColumn';\r\nimport OrdinalColumn from './OrdinalColumn';\r\nimport RankColumn from './RankColumn';\r\nimport ReduceColumn from './ReduceColumn';\r\nimport ScriptColumn from './ScriptColumn';\r\nimport SelectionColumn from './SelectionColumn';\r\nimport SetColumn from './SetColumn';\r\nimport StackColumn from './StackColumn';\r\nimport StringColumn from './StringColumn';\r\nimport StringMapColumn from './StringMapColumn';\r\nimport StringsColumn from './StringsColumn';\r\nimport ValueColumn, {IValueColumnDesc} from './ValueColumn';\r\nimport ImpositionBoxPlotColumn from './ImpositionBoxPlotColumn';\r\nimport LinkColumn from './LinkColumn';\r\nimport LinkMapColumn from './LinkMapColumn';\r\nimport LinksColumn from './LinksColumn';\r\n\r\nexport {isSupportType, Category, SupportType, SortByDefault, Categories, toolbar, dialogAddons, categoryOfDesc, categoryOf, IColumnCategory} from './annotations';\r\nexport {isMissingValue, isUnknown, FIRST_IS_NAN, FIRST_IS_MISSING, missingGroup} from './missing';\r\nexport * from './Group';\r\nexport * from './interfaces';\r\nexport * from './ICategoricalColumn';\r\nexport * from './INumberColumn';\r\nexport * from './IDateColumn';\r\nexport * from './IArrayColumn';\r\nexport * from './MappingFunction';\r\n\r\nexport {default as ActionColumn} from './ActionColumn';\r\nexport * from './ActionColumn';\r\nexport {default as AggregateGroupColumn, createAggregateDesc, IAggregateGroupColumnDesc} from './AggregateGroupColumn';\r\nexport {default as AnnotateColumn} from './AnnotateColumn';\r\nexport {default as ArrayColumn, IArrayColumnDesc, IArrayDesc, ISplicer} from './ArrayColumn';\r\nexport {default as BooleanColumn, IBooleanColumnDesc, IBooleanDesc} from './BooleanColumn';\r\nexport * from './BooleansColumn';\r\nexport {default as BooleansColumn} from './BooleansColumn';\r\nexport {default as BoxPlotColumn, IBoxPlotColumnDesc, IBoxPlotDesc} from './BoxPlotColumn';\r\nexport {default as CategoricalColumn} from './CategoricalColumn';\r\nexport * from './CategoricalMapColumn';\r\nexport {default as CategoricalMapColumn} from './CategoricalMapColumn';\r\nexport * from './CategoricalsColumn';\r\nexport {default as CategoricalsColumn} from './CategoricalsColumn';\r\nexport {default, default as Column, IFlatColumn, IColumnParent, IColumnMetaData, IColumnDesc} from './Column';\r\nexport {default as CompositeColumn, isMultiLevelColumn, IMultiLevelColumn} from './CompositeColumn';\r\nexport * from './CompositeNumberColumn';\r\nexport {default as CompositeNumberColumn} from './CompositeNumberColumn';\r\nexport {default as DateColumn, IDateColumnDesc} from './DateColumn';\r\nexport {default as DatesMapColumn, IDateMapColumnDesc} from './DatesMapColumn';\r\nexport {default as DatesColumn, IDatesDesc, IDatesColumnDesc} from './DatesColumn';\r\nexport * from './DummyColumn';\r\nexport {default as DummyColumn} from './DummyColumn';\r\nexport {default as GroupColumn, createGroupDesc, EGroupSortMethod} from './GroupColumn';\r\nexport {default as HierarchyColumn, ICategoryNode, IPartialCategoryNode, IHierarchyColumnDesc, IHierarchyDesc, ICategoryInternalNode, ICutOffNode, resolveInnerNodes, isHierarchical, deriveHierarchy} from './HierarchyColumn';\r\nexport * from './ImpositionBoxPlotColumn';\r\nexport {default as ImpositionBoxPlotColumn} from './ImpositionBoxPlotColumn';\r\nexport * from './ImpositionCompositeColumn';\r\nexport {default as ImpositionCompositeColumn} from './ImpositionCompositeColumn';\r\nexport * from './ImpositionCompositesColumn';\r\nexport {default as ImpositionCompositesColumn} from './ImpositionCompositesColumn';\r\nexport * from './MapColumn';\r\nexport {default as MapColumn} from './MapColumn';\r\nexport {default as MultiLevelCompositeColumn} from './MultiLevelCompositeColumn';\r\nexport * from './NestedColumn';\r\nexport {default as NestedColumn} from './NestedColumn';\r\nexport {default as NumberColumn, INumberColumnDesc, INumberColumn, isNumberColumn} from './NumberColumn';\r\nexport {default as NumberMapColumn, INumberMapDesc, INumberMapColumnDesc} from './NumberMapColumn';\r\nexport {default as NumbersColumn, INumbersDesc, INumbersColumnDesc} from './NumbersColumn';\r\nexport {default as OrdinalColumn, ICategoricalNumberColumnDesc} from './OrdinalColumn';\r\nexport * from './RankColumn';\r\nexport {default as RankColumn} from './RankColumn';\r\nexport {default as Ranking, ISortCriteria} from './Ranking';\r\nexport {default as ReduceColumn, createReduceDesc, IReduceDesc, IReduceColumnDesc} from './ReduceColumn';\r\nexport {default as ScriptColumn, createScriptDesc, IScriptDesc, IScriptColumnDesc} from './ScriptColumn';\r\nexport {default as SelectionColumn, createSelectionDesc, ISelectionColumnDesc} from './SelectionColumn';\r\nexport {default as SetColumn, ISetColumnDesc, ISetDesc} from './SetColumn';\r\nexport {default as StackColumn, createStackDesc} from './StackColumn';\r\nexport {default as StringColumn, EAlignment, IStringDesc, IStringColumnDesc} from './StringColumn';\r\nexport * from './StringMapColumn';\r\nexport {default as StringMapColumn} from './StringMapColumn';\r\nexport * from './StringsColumn';\r\nexport {default as StringsColumn} from './StringsColumn';\r\nexport {default as ValueColumn, IValueColumnDesc} from './ValueColumn';\r\nexport {default as LinkColumn, ILinkDesc, ILinkColumnDesc, ILink} from './LinkColumn';\r\nexport * from './LinkMapColumn';\r\nexport {default as LinkMapColumn} from './LinkMapColumn';\r\nexport * from './LinksColumn';\r\nexport {default as LinksColumn} from './LinksColumn';\r\n\r\n/**\r\n * defines a new column type\r\n * @param name\r\n * @param functions\r\n * @returns {CustomColumn}\r\n */\r\nexport function defineColumn<T>(name: string, functions: any = {}): typeof Column {\r\n  class CustomColumn extends ValueColumn<T> {\r\n    constructor(id: string, desc: IValueColumnDesc<T>) {\r\n      super(id, desc);\r\n      if (typeof (this.init) === 'function') {\r\n        this.init.apply(this, [].slice.apply(arguments));\r\n      }\r\n    }\r\n\r\n    init() {\r\n      // dummy\r\n    }\r\n  }\r\n\r\n  CustomColumn.prototype.toString = () => name;\r\n  CustomColumn.prototype = Object.assign(CustomColumn.prototype, functions);\r\n\r\n  return CustomColumn;\r\n}\r\n\r\n\r\n/**\r\n * a map of all known column types\r\n */\r\nexport function models() {\r\n  return {\r\n    actions: ActionColumn,\r\n    aggregate: AggregateGroupColumn,\r\n    annotate: AnnotateColumn,\r\n    boolean: BooleanColumn,\r\n    booleans: BooleansColumn,\r\n    boxplot: BoxPlotColumn,\r\n    categorical: CategoricalColumn,\r\n    categoricalMap: CategoricalMapColumn,\r\n    categoricals: CategoricalsColumn,\r\n    date: DateColumn,\r\n    dateMap: DatesMapColumn,\r\n    dates: DatesColumn,\r\n    group: GroupColumn,\r\n    hierarchy: HierarchyColumn,\r\n    imposition: ImpositionCompositeColumn,\r\n    impositionBoxPlot: ImpositionBoxPlotColumn,\r\n    impositions: ImpositionCompositesColumn,\r\n    reduce: ReduceColumn,\r\n    nested: NestedColumn,\r\n    number: NumberColumn,\r\n    numbers: NumbersColumn,\r\n    numberMap: NumberMapColumn,\r\n    ordinal: OrdinalColumn,\r\n    rank: RankColumn,\r\n    script: ScriptColumn,\r\n    selection: SelectionColumn,\r\n    set: SetColumn,\r\n    stack: StackColumn,\r\n    string: StringColumn,\r\n    stringMap: StringMapColumn,\r\n    strings: StringsColumn,\r\n    link: LinkColumn,\r\n    linkMap: LinkMapColumn,\r\n    links: LinksColumn\r\n  };\r\n}\r\n","import Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IColumnDesc, IDataRow} from './interfaces';\nimport Ranking from './Ranking';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n\nexport interface IValueColumnDesc<T> extends IColumnDesc {\n  /**\n   * is the data lazy loaded and not yet available\n   * @default false\n   */\n  lazyLoaded?: boolean;\n\n  /**\n   * value accessor of this column\n   * @param row the current row\n   * @param id the id of this column\n   * @param desc the description of this column\n   * @param ranking the ranking of this column\n   */\n  accessor?(row: IDataRow, id: string, desc: any, ranking: Ranking | null): T;\n}\n\n/**\n * emitted when the data of this column has been loaded\n * @asMemberOf ValueColumn\n * @event\n */\nexport declare function dataLoaded(previous: boolean, current: boolean): void;\n\n/**\n * a column having an accessor to get the cell value\n */\nexport default class ValueColumn<T> extends Column {\n  static readonly EVENT_DATA_LOADED = 'dataLoaded';\n\n  static readonly RENDERER_LOADING = 'loading';\n\n  private readonly accessor: (row: IDataRow, id: string, desc: any, ranking: Ranking | null) => T;\n\n  /**\n   * is the data available\n   * @type {boolean}\n   */\n  private loaded: boolean;\n\n  constructor(id: string, desc: Readonly<IValueColumnDesc<T>>) {\n    super(id, desc);\n    //find accessor\n    this.accessor = desc.accessor! || (() => null);\n    this.loaded = desc.lazyLoaded !== true;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ValueColumn.EVENT_DATA_LOADED]);\n  }\n\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n\n  getLabel(row: IDataRow) {\n    if (!this.isLoaded()) {\n      return '';\n    }\n    return String(this.getValue(row));\n  }\n\n  getRaw(row: IDataRow) {\n    if (!this.isLoaded()) {\n      return null;\n    }\n    return this.accessor(row, this.id, this.desc, this.findMyRanker());\n  }\n\n  getValue(row: IDataRow) {\n    return this.getRaw(row);\n  }\n\n  isLoaded() {\n    return this.loaded;\n  }\n\n  setLoaded(loaded: boolean) {\n    if (this.loaded === loaded) {\n      return;\n    }\n    this.fire([ValueColumn.EVENT_DATA_LOADED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.loaded, this.loaded = loaded);\n  }\n\n  getRenderer(): string {\n    if (!this.isLoaded()) {\n      return ValueColumn.RENDERER_LOADING;\n    }\n    return super.getRenderer();\n  }\n\n  /**\n   * patch the dump such that the loaded attribute is defined (for lazy loading columns)\n   * @param toDescRef\n   * @returns {any}\n   */\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.loaded = this.loaded;\n\n    if (!this.loaded && r.rendererType === ValueColumn.RENDERER_LOADING) {\n      delete r.rendererType;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    if (dump.loaded !== undefined) {\n      this.loaded = dump.loaded;\n    }\n    super.restore(dump, factory);\n  }\n}\n","import {\n  timeDay,\n  timeSunday,\n  timeMonday,\n  timeThursday,\n  timeYear,\n  utcDay,\n  utcSunday,\n  utcMonday,\n  utcThursday,\n  utcYear\n} from \"d3-time\";\n\nfunction localDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(-1, d.m, d.d, d.H, d.M, d.S, d.L);\n    date.setFullYear(d.y);\n    return date;\n  }\n  return new Date(d.y, d.m, d.d, d.H, d.M, d.S, d.L);\n}\n\nfunction utcDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(Date.UTC(-1, d.m, d.d, d.H, d.M, d.S, d.L));\n    date.setUTCFullYear(d.y);\n    return date;\n  }\n  return new Date(Date.UTC(d.y, d.m, d.d, d.H, d.M, d.S, d.L));\n}\n\nfunction newYear(y) {\n  return {y: y, m: 0, d: 1, H: 0, M: 0, S: 0, L: 0};\n}\n\nexport default function formatLocale(locale) {\n  var locale_dateTime = locale.dateTime,\n      locale_date = locale.date,\n      locale_time = locale.time,\n      locale_periods = locale.periods,\n      locale_weekdays = locale.days,\n      locale_shortWeekdays = locale.shortDays,\n      locale_months = locale.months,\n      locale_shortMonths = locale.shortMonths;\n\n  var periodRe = formatRe(locale_periods),\n      periodLookup = formatLookup(locale_periods),\n      weekdayRe = formatRe(locale_weekdays),\n      weekdayLookup = formatLookup(locale_weekdays),\n      shortWeekdayRe = formatRe(locale_shortWeekdays),\n      shortWeekdayLookup = formatLookup(locale_shortWeekdays),\n      monthRe = formatRe(locale_months),\n      monthLookup = formatLookup(locale_months),\n      shortMonthRe = formatRe(locale_shortMonths),\n      shortMonthLookup = formatLookup(locale_shortMonths);\n\n  var formats = {\n    \"a\": formatShortWeekday,\n    \"A\": formatWeekday,\n    \"b\": formatShortMonth,\n    \"B\": formatMonth,\n    \"c\": null,\n    \"d\": formatDayOfMonth,\n    \"e\": formatDayOfMonth,\n    \"f\": formatMicroseconds,\n    \"H\": formatHour24,\n    \"I\": formatHour12,\n    \"j\": formatDayOfYear,\n    \"L\": formatMilliseconds,\n    \"m\": formatMonthNumber,\n    \"M\": formatMinutes,\n    \"p\": formatPeriod,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatSeconds,\n    \"u\": formatWeekdayNumberMonday,\n    \"U\": formatWeekNumberSunday,\n    \"V\": formatWeekNumberISO,\n    \"w\": formatWeekdayNumberSunday,\n    \"W\": formatWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatYear,\n    \"Y\": formatFullYear,\n    \"Z\": formatZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var utcFormats = {\n    \"a\": formatUTCShortWeekday,\n    \"A\": formatUTCWeekday,\n    \"b\": formatUTCShortMonth,\n    \"B\": formatUTCMonth,\n    \"c\": null,\n    \"d\": formatUTCDayOfMonth,\n    \"e\": formatUTCDayOfMonth,\n    \"f\": formatUTCMicroseconds,\n    \"H\": formatUTCHour24,\n    \"I\": formatUTCHour12,\n    \"j\": formatUTCDayOfYear,\n    \"L\": formatUTCMilliseconds,\n    \"m\": formatUTCMonthNumber,\n    \"M\": formatUTCMinutes,\n    \"p\": formatUTCPeriod,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatUTCSeconds,\n    \"u\": formatUTCWeekdayNumberMonday,\n    \"U\": formatUTCWeekNumberSunday,\n    \"V\": formatUTCWeekNumberISO,\n    \"w\": formatUTCWeekdayNumberSunday,\n    \"W\": formatUTCWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatUTCYear,\n    \"Y\": formatUTCFullYear,\n    \"Z\": formatUTCZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var parses = {\n    \"a\": parseShortWeekday,\n    \"A\": parseWeekday,\n    \"b\": parseShortMonth,\n    \"B\": parseMonth,\n    \"c\": parseLocaleDateTime,\n    \"d\": parseDayOfMonth,\n    \"e\": parseDayOfMonth,\n    \"f\": parseMicroseconds,\n    \"H\": parseHour24,\n    \"I\": parseHour24,\n    \"j\": parseDayOfYear,\n    \"L\": parseMilliseconds,\n    \"m\": parseMonthNumber,\n    \"M\": parseMinutes,\n    \"p\": parsePeriod,\n    \"Q\": parseUnixTimestamp,\n    \"s\": parseUnixTimestampSeconds,\n    \"S\": parseSeconds,\n    \"u\": parseWeekdayNumberMonday,\n    \"U\": parseWeekNumberSunday,\n    \"V\": parseWeekNumberISO,\n    \"w\": parseWeekdayNumberSunday,\n    \"W\": parseWeekNumberMonday,\n    \"x\": parseLocaleDate,\n    \"X\": parseLocaleTime,\n    \"y\": parseYear,\n    \"Y\": parseFullYear,\n    \"Z\": parseZone,\n    \"%\": parseLiteralPercent\n  };\n\n  // These recursive directive definitions must be deferred.\n  formats.x = newFormat(locale_date, formats);\n  formats.X = newFormat(locale_time, formats);\n  formats.c = newFormat(locale_dateTime, formats);\n  utcFormats.x = newFormat(locale_date, utcFormats);\n  utcFormats.X = newFormat(locale_time, utcFormats);\n  utcFormats.c = newFormat(locale_dateTime, utcFormats);\n\n  function newFormat(specifier, formats) {\n    return function(date) {\n      var string = [],\n          i = -1,\n          j = 0,\n          n = specifier.length,\n          c,\n          pad,\n          format;\n\n      if (!(date instanceof Date)) date = new Date(+date);\n\n      while (++i < n) {\n        if (specifier.charCodeAt(i) === 37) {\n          string.push(specifier.slice(j, i));\n          if ((pad = pads[c = specifier.charAt(++i)]) != null) c = specifier.charAt(++i);\n          else pad = c === \"e\" ? \" \" : \"0\";\n          if (format = formats[c]) c = format(date, pad);\n          string.push(c);\n          j = i + 1;\n        }\n      }\n\n      string.push(specifier.slice(j, i));\n      return string.join(\"\");\n    };\n  }\n\n  function newParse(specifier, newDate) {\n    return function(string) {\n      var d = newYear(1900),\n          i = parseSpecifier(d, specifier, string += \"\", 0),\n          week, day;\n      if (i != string.length) return null;\n\n      // If a UNIX timestamp is specified, return it.\n      if (\"Q\" in d) return new Date(d.Q);\n\n      // The am-pm flag is 0 for AM, and 1 for PM.\n      if (\"p\" in d) d.H = d.H % 12 + d.p * 12;\n\n      // Convert day-of-week and week-of-year to day-of-year.\n      if (\"V\" in d) {\n        if (d.V < 1 || d.V > 53) return null;\n        if (!(\"w\" in d)) d.w = 1;\n        if (\"Z\" in d) {\n          week = utcDate(newYear(d.y)), day = week.getUTCDay();\n          week = day > 4 || day === 0 ? utcMonday.ceil(week) : utcMonday(week);\n          week = utcDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getUTCFullYear();\n          d.m = week.getUTCMonth();\n          d.d = week.getUTCDate() + (d.w + 6) % 7;\n        } else {\n          week = newDate(newYear(d.y)), day = week.getDay();\n          week = day > 4 || day === 0 ? timeMonday.ceil(week) : timeMonday(week);\n          week = timeDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getFullYear();\n          d.m = week.getMonth();\n          d.d = week.getDate() + (d.w + 6) % 7;\n        }\n      } else if (\"W\" in d || \"U\" in d) {\n        if (!(\"w\" in d)) d.w = \"u\" in d ? d.u % 7 : \"W\" in d ? 1 : 0;\n        day = \"Z\" in d ? utcDate(newYear(d.y)).getUTCDay() : newDate(newYear(d.y)).getDay();\n        d.m = 0;\n        d.d = \"W\" in d ? (d.w + 6) % 7 + d.W * 7 - (day + 5) % 7 : d.w + d.U * 7 - (day + 6) % 7;\n      }\n\n      // If a time zone is specified, all fields are interpreted as UTC and then\n      // offset according to the specified time zone.\n      if (\"Z\" in d) {\n        d.H += d.Z / 100 | 0;\n        d.M += d.Z % 100;\n        return utcDate(d);\n      }\n\n      // Otherwise, all fields are in local time.\n      return newDate(d);\n    };\n  }\n\n  function parseSpecifier(d, specifier, string, j) {\n    var i = 0,\n        n = specifier.length,\n        m = string.length,\n        c,\n        parse;\n\n    while (i < n) {\n      if (j >= m) return -1;\n      c = specifier.charCodeAt(i++);\n      if (c === 37) {\n        c = specifier.charAt(i++);\n        parse = parses[c in pads ? specifier.charAt(i++) : c];\n        if (!parse || ((j = parse(d, string, j)) < 0)) return -1;\n      } else if (c != string.charCodeAt(j++)) {\n        return -1;\n      }\n    }\n\n    return j;\n  }\n\n  function parsePeriod(d, string, i) {\n    var n = periodRe.exec(string.slice(i));\n    return n ? (d.p = periodLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseShortWeekday(d, string, i) {\n    var n = shortWeekdayRe.exec(string.slice(i));\n    return n ? (d.w = shortWeekdayLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseWeekday(d, string, i) {\n    var n = weekdayRe.exec(string.slice(i));\n    return n ? (d.w = weekdayLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseShortMonth(d, string, i) {\n    var n = shortMonthRe.exec(string.slice(i));\n    return n ? (d.m = shortMonthLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseMonth(d, string, i) {\n    var n = monthRe.exec(string.slice(i));\n    return n ? (d.m = monthLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseLocaleDateTime(d, string, i) {\n    return parseSpecifier(d, locale_dateTime, string, i);\n  }\n\n  function parseLocaleDate(d, string, i) {\n    return parseSpecifier(d, locale_date, string, i);\n  }\n\n  function parseLocaleTime(d, string, i) {\n    return parseSpecifier(d, locale_time, string, i);\n  }\n\n  function formatShortWeekday(d) {\n    return locale_shortWeekdays[d.getDay()];\n  }\n\n  function formatWeekday(d) {\n    return locale_weekdays[d.getDay()];\n  }\n\n  function formatShortMonth(d) {\n    return locale_shortMonths[d.getMonth()];\n  }\n\n  function formatMonth(d) {\n    return locale_months[d.getMonth()];\n  }\n\n  function formatPeriod(d) {\n    return locale_periods[+(d.getHours() >= 12)];\n  }\n\n  function formatUTCShortWeekday(d) {\n    return locale_shortWeekdays[d.getUTCDay()];\n  }\n\n  function formatUTCWeekday(d) {\n    return locale_weekdays[d.getUTCDay()];\n  }\n\n  function formatUTCShortMonth(d) {\n    return locale_shortMonths[d.getUTCMonth()];\n  }\n\n  function formatUTCMonth(d) {\n    return locale_months[d.getUTCMonth()];\n  }\n\n  function formatUTCPeriod(d) {\n    return locale_periods[+(d.getUTCHours() >= 12)];\n  }\n\n  return {\n    format: function(specifier) {\n      var f = newFormat(specifier += \"\", formats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    parse: function(specifier) {\n      var p = newParse(specifier += \"\", localDate);\n      p.toString = function() { return specifier; };\n      return p;\n    },\n    utcFormat: function(specifier) {\n      var f = newFormat(specifier += \"\", utcFormats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    utcParse: function(specifier) {\n      var p = newParse(specifier, utcDate);\n      p.toString = function() { return specifier; };\n      return p;\n    }\n  };\n}\n\nvar pads = {\"-\": \"\", \"_\": \" \", \"0\": \"0\"},\n    numberRe = /^\\s*\\d+/, // note: ignores next directive\n    percentRe = /^%/,\n    requoteRe = /[\\\\^$*+?|[\\]().{}]/g;\n\nfunction pad(value, fill, width) {\n  var sign = value < 0 ? \"-\" : \"\",\n      string = (sign ? -value : value) + \"\",\n      length = string.length;\n  return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);\n}\n\nfunction requote(s) {\n  return s.replace(requoteRe, \"\\\\$&\");\n}\n\nfunction formatRe(names) {\n  return new RegExp(\"^(?:\" + names.map(requote).join(\"|\") + \")\", \"i\");\n}\n\nfunction formatLookup(names) {\n  var map = {}, i = -1, n = names.length;\n  while (++i < n) map[names[i].toLowerCase()] = i;\n  return map;\n}\n\nfunction parseWeekdayNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.w = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekdayNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.u = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.U = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberISO(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.V = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.W = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseFullYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 4));\n  return n ? (d.y = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.y = +n[0] + (+n[0] > 68 ? 1900 : 2000), i + n[0].length) : -1;\n}\n\nfunction parseZone(d, string, i) {\n  var n = /^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(string.slice(i, i + 6));\n  return n ? (d.Z = n[1] ? 0 : -(n[2] + (n[3] || \"00\")), i + n[0].length) : -1;\n}\n\nfunction parseMonthNumber(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.m = n[0] - 1, i + n[0].length) : -1;\n}\n\nfunction parseDayOfMonth(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseDayOfYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.m = 0, d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseHour24(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.H = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMinutes(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.M = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.S = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMilliseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.L = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMicroseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 6));\n  return n ? (d.L = Math.floor(n[0] / 1000), i + n[0].length) : -1;\n}\n\nfunction parseLiteralPercent(d, string, i) {\n  var n = percentRe.exec(string.slice(i, i + 1));\n  return n ? i + n[0].length : -1;\n}\n\nfunction parseUnixTimestamp(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.Q = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseUnixTimestampSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.Q = (+n[0]) * 1000, i + n[0].length) : -1;\n}\n\nfunction formatDayOfMonth(d, p) {\n  return pad(d.getDate(), p, 2);\n}\n\nfunction formatHour24(d, p) {\n  return pad(d.getHours(), p, 2);\n}\n\nfunction formatHour12(d, p) {\n  return pad(d.getHours() % 12 || 12, p, 2);\n}\n\nfunction formatDayOfYear(d, p) {\n  return pad(1 + timeDay.count(timeYear(d), d), p, 3);\n}\n\nfunction formatMilliseconds(d, p) {\n  return pad(d.getMilliseconds(), p, 3);\n}\n\nfunction formatMicroseconds(d, p) {\n  return formatMilliseconds(d, p) + \"000\";\n}\n\nfunction formatMonthNumber(d, p) {\n  return pad(d.getMonth() + 1, p, 2);\n}\n\nfunction formatMinutes(d, p) {\n  return pad(d.getMinutes(), p, 2);\n}\n\nfunction formatSeconds(d, p) {\n  return pad(d.getSeconds(), p, 2);\n}\n\nfunction formatWeekdayNumberMonday(d) {\n  var day = d.getDay();\n  return day === 0 ? 7 : day;\n}\n\nfunction formatWeekNumberSunday(d, p) {\n  return pad(timeSunday.count(timeYear(d), d), p, 2);\n}\n\nfunction formatWeekNumberISO(d, p) {\n  var day = d.getDay();\n  d = (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);\n  return pad(timeThursday.count(timeYear(d), d) + (timeYear(d).getDay() === 4), p, 2);\n}\n\nfunction formatWeekdayNumberSunday(d) {\n  return d.getDay();\n}\n\nfunction formatWeekNumberMonday(d, p) {\n  return pad(timeMonday.count(timeYear(d), d), p, 2);\n}\n\nfunction formatYear(d, p) {\n  return pad(d.getFullYear() % 100, p, 2);\n}\n\nfunction formatFullYear(d, p) {\n  return pad(d.getFullYear() % 10000, p, 4);\n}\n\nfunction formatZone(d) {\n  var z = d.getTimezoneOffset();\n  return (z > 0 ? \"-\" : (z *= -1, \"+\"))\n      + pad(z / 60 | 0, \"0\", 2)\n      + pad(z % 60, \"0\", 2);\n}\n\nfunction formatUTCDayOfMonth(d, p) {\n  return pad(d.getUTCDate(), p, 2);\n}\n\nfunction formatUTCHour24(d, p) {\n  return pad(d.getUTCHours(), p, 2);\n}\n\nfunction formatUTCHour12(d, p) {\n  return pad(d.getUTCHours() % 12 || 12, p, 2);\n}\n\nfunction formatUTCDayOfYear(d, p) {\n  return pad(1 + utcDay.count(utcYear(d), d), p, 3);\n}\n\nfunction formatUTCMilliseconds(d, p) {\n  return pad(d.getUTCMilliseconds(), p, 3);\n}\n\nfunction formatUTCMicroseconds(d, p) {\n  return formatUTCMilliseconds(d, p) + \"000\";\n}\n\nfunction formatUTCMonthNumber(d, p) {\n  return pad(d.getUTCMonth() + 1, p, 2);\n}\n\nfunction formatUTCMinutes(d, p) {\n  return pad(d.getUTCMinutes(), p, 2);\n}\n\nfunction formatUTCSeconds(d, p) {\n  return pad(d.getUTCSeconds(), p, 2);\n}\n\nfunction formatUTCWeekdayNumberMonday(d) {\n  var dow = d.getUTCDay();\n  return dow === 0 ? 7 : dow;\n}\n\nfunction formatUTCWeekNumberSunday(d, p) {\n  return pad(utcSunday.count(utcYear(d), d), p, 2);\n}\n\nfunction formatUTCWeekNumberISO(d, p) {\n  var day = d.getUTCDay();\n  d = (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);\n  return pad(utcThursday.count(utcYear(d), d) + (utcYear(d).getUTCDay() === 4), p, 2);\n}\n\nfunction formatUTCWeekdayNumberSunday(d) {\n  return d.getUTCDay();\n}\n\nfunction formatUTCWeekNumberMonday(d, p) {\n  return pad(utcMonday.count(utcYear(d), d), p, 2);\n}\n\nfunction formatUTCYear(d, p) {\n  return pad(d.getUTCFullYear() % 100, p, 2);\n}\n\nfunction formatUTCFullYear(d, p) {\n  return pad(d.getUTCFullYear() % 10000, p, 4);\n}\n\nfunction formatUTCZone() {\n  return \"+0000\";\n}\n\nfunction formatLiteralPercent() {\n  return \"%\";\n}\n\nfunction formatUnixTimestamp(d) {\n  return +d;\n}\n\nfunction formatUnixTimestampSeconds(d) {\n  return Math.floor(+d / 1000);\n}\n","import formatLocale from \"./locale\";\n\nvar locale;\nexport var timeFormat;\nexport var timeParse;\nexport var utcFormat;\nexport var utcParse;\n\ndefaultLocale({\n  dateTime: \"%x, %X\",\n  date: \"%-m/%-d/%Y\",\n  time: \"%-I:%M:%S %p\",\n  periods: [\"AM\", \"PM\"],\n  days: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n  shortDays: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  months: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n  shortMonths: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  timeFormat = locale.format;\n  timeParse = locale.parse;\n  utcFormat = locale.utcFormat;\n  utcParse = locale.utcParse;\n  return locale;\n}\n","import {utcFormat} from \"./defaultLocale\";\n\nexport var isoSpecifier = \"%Y-%m-%dT%H:%M:%S.%LZ\";\n\nfunction formatIsoNative(date) {\n  return date.toISOString();\n}\n\nvar formatIso = Date.prototype.toISOString\n    ? formatIsoNative\n    : utcFormat(isoSpecifier);\n\nexport default formatIso;\n","import {isoSpecifier} from \"./isoFormat\";\nimport {utcParse} from \"./defaultLocale\";\n\nfunction parseIsoNative(string) {\n  var date = new Date(string);\n  return isNaN(date) ? null : date;\n}\n\nvar parseIso = +new Date(\"2000-01-01T00:00:00.000Z\")\n    ? parseIsoNative\n    : utcParse(isoSpecifier);\n\nexport default parseIso;\n","export {default as timeFormatDefaultLocale, timeFormat, timeParse, utcFormat, utcParse} from \"./defaultLocale\";\nexport {default as timeFormatLocale} from \"./locale\";\nexport {default as isoFormat} from \"./isoFormat\";\nexport {default as isoParse} from \"./isoParse\";\n","import Column from './Column';\r\nimport {IArrayColumn, isArrayColumn} from './IArrayColumn';\r\nimport {IColumnDesc, IDataRow} from './interfaces';\r\nimport {colorPool} from './internal';\r\nimport {FIRST_IS_MISSING} from './missing';\r\nimport {IValueColumnDesc} from './ValueColumn';\r\n\r\nexport interface ICategoricalDesc {\r\n  categories: (string | Partial<ICategory>)[];\r\n  missingCategory: (string | Partial<ICategory>);\r\n}\r\n\r\nexport declare type ICategoricalColumnDesc = IValueColumnDesc<string> & ICategoricalDesc;\r\n\r\nexport interface ISetColumn extends IArrayColumn<boolean> {\r\n  readonly categories: ICategory[];\r\n\r\n  getSet(row: IDataRow): Set<ICategory>;\r\n}\r\n\r\nexport function isSetColumn(col: Column): col is ISetColumn {\r\n  return isArrayColumn(col) && Array.isArray((<ISetColumn>col).categories);\r\n}\r\n\r\nexport interface ICategoricalColumn extends ISetColumn {\r\n  getCategory(row: IDataRow): ICategory | null;\r\n}\r\n\r\nexport interface ICategory {\r\n  readonly name: string;\r\n\r\n  /**\r\n   * optional label of this category (the one to render)\r\n   */\r\n  readonly label: string;\r\n  /**\r\n   * category color\r\n   * @default next in d3 color 10 range\r\n   */\r\n  readonly color: string;\r\n\r\n  value: number;\r\n}\r\n\r\n/** @internal */\r\nexport function toCategory(cat: (string | Partial<ICategory>), value: number, nextColor: () => string = () => Column.DEFAULT_COLOR) {\r\n  if (typeof cat === 'string') {\r\n    //just the category value\r\n    return {name: cat, label: cat, color: nextColor(), value};\r\n  }\r\n  const name = cat.name == null ? String(cat.value) : cat.name;\r\n  return {\r\n    name,\r\n    label: cat.label || name,\r\n    color: cat.color || nextColor(),\r\n    value: cat.value != null ? cat.value : value\r\n  };\r\n}\r\n\r\nexport function compareCategory(a: ICategory | null, b: ICategory | null) {\r\n  const aNull = a == null || isNaN(a.value);\r\n  const bNull = b == null || isNaN(b.value);\r\n  if (aNull || a == null) {\r\n    return bNull ? 0 : FIRST_IS_MISSING;\r\n  }\r\n  if (bNull || b == null) {\r\n    return -FIRST_IS_MISSING;\r\n  }\r\n  if (a.value === b.value) {\r\n    return a.label.toLowerCase().localeCompare(b.label.toLowerCase());\r\n  }\r\n  return a.value - b.value;\r\n}\r\n\r\nfunction findMostFrequent(rows: IDataRow[], col: ICategoricalColumn): {cat: ICategory | null, count: number} {\r\n  const hist = new Map<ICategory | null, number>();\r\n\r\n  for (const row of rows) {\r\n    const cat = col.getCategory(row);\r\n    hist.set(cat, (hist.get(cat) || 0) + 1);\r\n  }\r\n\r\n  if (hist.size === 0) {\r\n    return {\r\n      cat: null,\r\n      count: 0\r\n    };\r\n  }\r\n  let topCat: ICategory | null = null;\r\n  let topCount = 0;\r\n  hist.forEach((count, cat) => {\r\n    if (count > topCount) {\r\n      topCat = cat;\r\n      topCount = count;\r\n    }\r\n  });\r\n  return {\r\n    cat: topCat,\r\n    count: topCount\r\n  };\r\n}\r\n\r\n/**\r\n * sort group by most frequent category or if same without count desc\r\n */\r\nexport function groupCompareCategory(a: IDataRow[], b: IDataRow[], col: ICategoricalColumn) {\r\n  if (a.length === 0) {\r\n    return b.length === 0 ? 0 : FIRST_IS_MISSING;\r\n  }\r\n  if (b.length === 0) {\r\n    return -FIRST_IS_MISSING;\r\n  }\r\n\r\n  const aMostFrequent = findMostFrequent(a, col);\r\n  const bMostFrequent = findMostFrequent(b, col);\r\n\r\n  if (aMostFrequent.cat === null) {\r\n    return bMostFrequent.cat === null ? 0 : FIRST_IS_MISSING;\r\n  }\r\n  if (bMostFrequent.cat === null) {\r\n    return -FIRST_IS_MISSING;\r\n  }\r\n\r\n  if (aMostFrequent.cat === bMostFrequent.cat) {\r\n    return bMostFrequent.count - aMostFrequent.count; // by count desc\r\n  }\r\n  return aMostFrequent.cat.value - bMostFrequent.cat.value;\r\n}\r\n\r\nexport function toCategories(desc: ICategoricalDesc) {\r\n  if (!desc.categories) {\r\n    return [];\r\n  }\r\n  const nextColor = colorPool();\r\n  const l = desc.categories.length - 1;\r\n  const cats = desc.categories.map((cat, i) => toCategory(cat, i / l, nextColor));\r\n  return cats.sort(compareCategory);\r\n}\r\n\r\n/**\r\n * checks whether the given column or description is a categorical column, i.e. the value is a list of categories\r\n * @param col\r\n * @returns {boolean}\r\n */\r\nexport function isCategoricalColumn(col: Column): col is ICategoricalColumn;\r\nexport function isCategoricalColumn(col: IColumnDesc): col is ICategoricalColumnDesc & IColumnDesc;\r\nexport function isCategoricalColumn(col: Column | IColumnDesc) {\r\n  return (col instanceof Column && typeof (<ICategoricalColumn>col).getCategory === 'function' || (!(col instanceof Column) && (<IColumnDesc>col).type.match(/(categorical|ordinal|hierarchy)/) != null));\r\n}\r\n\r\nexport interface ICategoricalFilter {\r\n  filter: string[] | string | RegExp;\r\n  filterMissing: boolean;\r\n}\r\n\r\nfunction isEmptyFilter(f: ICategoricalFilter | null) {\r\n  return f == null || (!f.filterMissing && (f.filter == null || f.filter === ''));\r\n}\r\n\r\nexport function isEqualCategoricalFilter(a: ICategoricalFilter | null, b: ICategoricalFilter | null) {\r\n  if (a === b) {\r\n    return true;\r\n  }\r\n  if (a == null || b == null) {\r\n    return isEmptyFilter(a) === isEmptyFilter(b);\r\n  }\r\n  if (a.filterMissing !== b.filterMissing || (typeof a.filter !== typeof b.filter)) {\r\n    return false;\r\n  }\r\n  if (Array.isArray(a.filter)) {\r\n    return arrayEquals(<string[]>a.filter, <string[]>b.filter);\r\n  }\r\n  return String(a.filter) === String(b.filter);\r\n}\r\n\r\nfunction arrayEquals<T>(a: T[], b: T[]) {\r\n  const al = a != null ? a.length : 0;\r\n  const bl = b != null ? b.length : 0;\r\n  if (al !== bl) {\r\n    return false;\r\n  }\r\n  if (al === 0) {\r\n    return true;\r\n  }\r\n  return a.every((ai, i) => ai === b[i]);\r\n}\r\n\r\nexport function isCategoryIncluded(filter: ICategoricalFilter | null, category: ICategory | null) {\r\n  if (filter == null) {\r\n    return true;\r\n  }\r\n  if (category == null || isNaN(category.value)) {\r\n    return !filter.filterMissing;\r\n  }\r\n  const filterObj = filter.filter;\r\n  if (Array.isArray(filterObj)) { //array mode\r\n    return filterObj.includes(category.name);\r\n  }\r\n  if (typeof filterObj === 'string' && filterObj.length > 0) { //search mode\r\n    return category.name.toLowerCase().includes(filterObj.toLowerCase());\r\n  }\r\n  if (filterObj instanceof RegExp) { //regex match mode\r\n    return filterObj.test(category.name);\r\n  }\r\n  return true;\r\n}\r\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex3 = /^#([0-9a-f]{3})$/,\n    reHex6 = /^#([0-9a-f]{6})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy: function(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex3.exec(format)) ? (m = parseInt(m[1], 16), new Rgb((m >> 8 & 0xf) | (m >> 4 & 0x0f0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1)) // #f00\n      : (m = reHex6.exec(format)) ? rgbn(parseInt(m[1], 16)) // #ff0000\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n}\n\nfunction rgb_formatRgb() {\n  var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n  return (a === 1 ? \"rgb(\" : \"rgba(\")\n      + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n      + (a === 1 ? \")\" : \", \" + a + \")\");\n}\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"hsl(\" : \"hsla(\")\n        + (this.h || 0) + \", \"\n        + (this.s || 0) * 100 + \"%, \"\n        + (this.l || 0) * 100 + \"%\"\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export var deg2rad = Math.PI / 180;\nexport var rad2deg = 180 / Math.PI;\n","import define, {extend} from \"./define\";\nimport {Color, rgbConvert, Rgb} from \"./color\";\nimport {deg2rad, rad2deg} from \"./math\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nvar K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter: function(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker: function(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb: function() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * rad2deg;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * deg2rad;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter: function(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker: function(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb: function() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","import define, {extend} from \"./define\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color\";\nimport {deg2rad, rad2deg} from \"./math\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * rad2deg - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * deg2rad,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","export {default as color, rgb, hsl} from \"./color\";\nexport {default as lab, hcl, lch, gray} from \"./lab\";\nexport {default as cubehelix} from \"./cubehelix\";\n","import {suffix, IEventListener} from '../internal/AEventDispatcher';\nimport Column, {IColumnParent, IFlatColumn, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {Category, toolbar} from './annotations';\nimport {IDataRow} from './interfaces';\nimport {isNumberColumn} from './INumberColumn';\nimport ValueColumn from './ValueColumn';\n\nexport function isMultiLevelColumn(col: Column): col is IMultiLevelColumn {\n  return typeof ((<IMultiLevelColumn>col).getCollapsed) === 'function';\n}\n\n/**\n * emitted when the filter property changes\n * @asMemberOf CompositeColumn\n * @event\n */\nexport declare function filterChanged(previous: any | null, current: any | null): void;\n\n/**\n * emitted when a column has been added\n * @asMemberOf CompositeColumn\n * @event\n */\nexport declare function addColumn(col: Column, index: number): void;\n\n/**\n * emitted when a column has been moved within this composite columm\n * @asMemberOf CompositeColumn\n * @event\n */\nexport declare function moveColumn(col: Column, index: number, oldIndex: number): void;\n\n/**\n * emitted when a column has been removed\n * @asMemberOf CompositeColumn\n * @event\n */\nexport declare function removeColumn(col: Column, index: number): void;\n\n/**\n * implementation of a combine column, standard operations how to select\n */\n@toolbar('compositeContained', 'splitCombined')\n@Category('composite')\nexport default class CompositeColumn extends Column implements IColumnParent {\n  static readonly EVENT_FILTER_CHANGED = 'filterChanged';\n  static readonly EVENT_ADD_COLUMN = 'addColumn';\n  static readonly EVENT_MOVE_COLUMN = 'moveColumn';\n  static readonly EVENT_REMOVE_COLUMN = 'removeColumn';\n\n  protected readonly _children: Column[] = [];\n\n  protected createEventList() {\n    return super.createEventList().concat([CompositeColumn.EVENT_FILTER_CHANGED, CompositeColumn.EVENT_ADD_COLUMN, CompositeColumn.EVENT_MOVE_COLUMN, CompositeColumn.EVENT_REMOVE_COLUMN]);\n  }\n\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  assignNewId(idGenerator: () => string) {\n    super.assignNewId(idGenerator);\n    this._children.forEach((c) => c.assignNewId(idGenerator));\n  }\n\n  get children() {\n    return this._children.slice();\n  }\n\n  get length() {\n    return this._children.length;\n  }\n\n  flatten(r: IFlatColumn[], offset: number, levelsToGo = 0, padding = 0) {\n    let w = 0;\n    //no more levels or just this one\n    if (levelsToGo === 0 || levelsToGo <= Column.FLAT_ALL_COLUMNS) {\n      w = this.getWidth();\n      r.push({col: this, offset, width: w});\n      if (levelsToGo === 0) {\n        return w;\n      }\n    }\n    //push children\n    this._children.forEach((c) => {\n      if (c.isVisible() && levelsToGo <= Column.FLAT_ALL_COLUMNS) {\n        c.flatten(r, offset, levelsToGo - 1, padding);\n      }\n    });\n    return w;\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.children = this._children.map((d) => d.dump(toDescRef));\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    dump.children.map((child: any) => {\n      const c = factory(child);\n      if (c) {\n        this.push(c);\n      }\n    });\n    super.restore(dump, factory);\n  }\n\n  /**\n   * inserts a column at a the given position\n   * @param col\n   * @param index\n   * @returns {any}\n   */\n  insert(col: Column, index: number): Column | null {\n    if (!isNumberColumn(col) && this.canJustAddNumbers) { //indicator it is a number type\n      return null;\n    }\n    this._children.splice(index, 0, col);\n    //listen and propagate events\n    return this.insertImpl(col, index);\n  }\n\n  move(col: Column, index: number): Column | null {\n    if (col.parent !== this) { //not moving\n      return null;\n    }\n    const old = this._children.indexOf(col);\n    if (index === old) {\n      // no move needed\n      return col;\n    }\n    //delete first\n    this._children.splice(old, 1);\n    // adapt target index based on previous index, i.e shift by one\n    this._children.splice(old < index ? index - 1 : index, 0, col);\n    //listen and propagate events\n    return this.moveImpl(col, index, old);\n  }\n\n  protected insertImpl(col: Column, index: number) {\n    col.attach(this);\n    this.forward(col, ...suffix('.combine', Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY, CompositeColumn.EVENT_FILTER_CHANGED, Column.EVENT_RENDERER_TYPE_CHANGED, Column.EVENT_GROUP_RENDERER_TYPE_CHANGED));\n    this.fire([CompositeColumn.EVENT_ADD_COLUMN, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], col, index);\n    return col;\n  }\n\n  protected moveImpl(col: Column, index: number, oldIndex: number) {\n    this.fire([CompositeColumn.EVENT_MOVE_COLUMN, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY, Column.EVENT_RENDERER_TYPE_CHANGED, Column.EVENT_GROUP_RENDERER_TYPE_CHANGED], col, index, oldIndex);\n    return col;\n  }\n\n  push(col: Column) {\n    return this.insert(col, this._children.length);\n  }\n\n  at(index: number) {\n    return this._children[index];\n  }\n\n  indexOf(col: Column) {\n    return this._children.indexOf(col);\n  }\n\n  insertAfter(col: Column, ref: Column) {\n    const i = this.indexOf(ref);\n    if (i < 0) {\n      return null;\n    }\n    return this.insert(col, i + 1);\n  }\n\n  moveAfter(col: Column, ref: Column) {\n    const i = this.indexOf(ref);\n    if (i < 0) {\n      return null;\n    }\n    return this.move(col, i + 1);\n  }\n\n\n  remove(col: Column) {\n    const i = this._children.indexOf(col);\n    if (i < 0) {\n      return false;\n    }\n    this._children.splice(i, 1); //remove and deregister listeners\n    return this.removeImpl(col, i);\n  }\n\n  protected removeImpl(col: Column, index: number) {\n    col.detach();\n    this.unforward(col, ...suffix('.combine', Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY, CompositeColumn.EVENT_FILTER_CHANGED));\n    this.fire([CompositeColumn.EVENT_REMOVE_COLUMN, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], col, index);\n    return true;\n  }\n\n  isFiltered() {\n    return this._children.some((d) => d.isFiltered());\n  }\n\n  filter(row: IDataRow) {\n    return this._children.every((d) => d.filter(row));\n  }\n\n  isLoaded(): boolean {\n    return this._children.every((c) => !(c instanceof ValueColumn || c instanceof CompositeColumn) || (<ValueColumn<any> | CompositeColumn>c).isLoaded());\n  }\n\n  get canJustAddNumbers() {\n    return false;\n  }\n}\n\nexport interface IMultiLevelColumn extends CompositeColumn {\n  getCollapsed(): boolean;\n\n  setCollapsed(value: boolean): void;\n}\n","import {LazyBoxPlotData} from '../internal';\r\nimport {IOrderedGroup} from './Group';\r\nimport {IDataRow, IGroup, IGroupParent} from './interfaces';\r\nimport INumberColumn, {numberCompare} from './INumberColumn';\r\n\r\n\r\n/** @internal */\r\nexport function patternFunction(pattern: string, ...args: string[]) {\r\n  return new Function('value', ...args, `\r\n  const escapedValue = encodeURIComponent(String(value));\r\n  return \\`${pattern}\\`;\r\n `);\r\n}\r\n\r\n\r\n/** @internal */\r\nexport function joinGroups(groups: IGroup[]): IGroup {\r\n  console.assert(groups.length > 0);\r\n  if (groups.length === 1) {\r\n    return groups[0];\r\n  }\r\n  // create a chain\r\n  const parents: IGroupParent[] = groups.map((g) => Object.assign({subGroups: []}, g));\r\n  parents.slice(1).forEach((g, i) => {\r\n    g.parent = parents[i];\r\n    parents[i].subGroups.push(g);\r\n  });\r\n  const g = {\r\n    name: parents.map((d) => d.name).join('  '),\r\n    color: parents[0].color,\r\n    parent: parents[parents.length - 1]\r\n  };\r\n  g.parent.subGroups.push(g);\r\n  return g;\r\n}\r\n\r\n/** @internal */\r\nexport function toGroupID(group: IGroup) {\r\n  return group.name;\r\n}\r\n\r\n/** @internal */\r\nexport function unifyParents<T extends IOrderedGroup>(groups: T[]) {\r\n  if (groups.length <= 1) {\r\n    return;\r\n  }\r\n  const lookup = new Map<string, IGroupParent>();\r\n\r\n  const resolve = (g: IGroupParent): { g: IGroupParent, id: string } => {\r\n    let id = g.name;\r\n    if (g.parent) {\r\n      const parent = resolve(g.parent);\r\n      g.parent = parent.g;\r\n      id = `${parent.id}.$[id}`;\r\n    }\r\n    // ensure there is only one instance per id (i.e. share common parents\r\n    if (lookup.has(id)) {\r\n      return {g: lookup.get(id)!, id};\r\n    }\r\n    if (g.parent) {\r\n      g.parent.subGroups.push(g);\r\n    }\r\n    g.subGroups = []; // clear old children\r\n    lookup.set(id, g);\r\n    return {g, id};\r\n  };\r\n  // resolve just parents\r\n  groups.forEach((g) => {\r\n    if (g.parent) {\r\n      g.parent = resolve(g.parent).g;\r\n      g.parent.subGroups.push(g);\r\n    }\r\n  });\r\n}\r\n\r\n// based on https://github.com/d3/d3-scale-chromatic#d3-scale-chromatic\r\nconst schemeCategory10 = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'];\r\nconst set3 = ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'];\r\nconst colors = schemeCategory10.concat(set3);\r\n\r\n/** @internal */\r\nexport function colorPool() {\r\n  let act = 0;\r\n  return () => colors[(act++) % colors.length];\r\n}\r\n\r\n\r\n/** @internal */\r\nexport function medianIndex(rows: IDataRow[], col: INumberColumn): number {\r\n  //return the median row\r\n  const data = rows.map((r, i) => ({i, v: col.getNumber(r), m: col.isMissing(r)}));\r\n  const sorted = data.filter((r) => !r.m).sort((a, b) => numberCompare(a.v, b.v));\r\n  const index = sorted[Math.floor(sorted.length / 2.0)];\r\n  if (index === undefined) {\r\n    return 0; //error case\r\n  }\r\n  return index.i;\r\n}\r\n\r\n/** @internal */\r\nexport function groupCompare(a: IDataRow[], b: IDataRow[], col: INumberColumn, sortMethod: keyof LazyBoxPlotData) {\r\n  const va = new LazyBoxPlotData(a.map((row) => col.getNumber(row)));\r\n  const vb = new LazyBoxPlotData(b.map((row) => col.getNumber(row)));\r\n\r\n  return numberCompare(<number>va[sortMethod], <number>vb[sortMethod]);\r\n}\r\n\r\n\r\n","import {interpolateRgbBasis} from \"d3-interpolate\";\n\nexport default function(scheme) {\n  return interpolateRgbBasis(scheme[scheme.length - 1]);\n}\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"deebf79ecae13182bd\",\n  \"eff3ffbdd7e76baed62171b5\",\n  \"eff3ffbdd7e76baed63182bd08519c\",\n  \"eff3ffc6dbef9ecae16baed63182bd08519c\",\n  \"eff3ffc6dbef9ecae16baed64292c62171b5084594\",\n  \"f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594\",\n  \"f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"e5f5e0a1d99b31a354\",\n  \"edf8e9bae4b374c476238b45\",\n  \"edf8e9bae4b374c47631a354006d2c\",\n  \"edf8e9c7e9c0a1d99b74c47631a354006d2c\",\n  \"edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32\",\n  \"f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32\",\n  \"f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"f0f0f0bdbdbd636363\",\n  \"f7f7f7cccccc969696525252\",\n  \"f7f7f7cccccc969696636363252525\",\n  \"f7f7f7d9d9d9bdbdbd969696636363252525\",\n  \"f7f7f7d9d9d9bdbdbd969696737373525252252525\",\n  \"fffffff0f0f0d9d9d9bdbdbd969696737373525252252525\",\n  \"fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fee6cefdae6be6550d\",\n  \"feeddefdbe85fd8d3cd94701\",\n  \"feeddefdbe85fd8d3ce6550da63603\",\n  \"feeddefdd0a2fdae6bfd8d3ce6550da63603\",\n  \"feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04\",\n  \"fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04\",\n  \"fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"efedf5bcbddc756bb1\",\n  \"f2f0f7cbc9e29e9ac86a51a3\",\n  \"f2f0f7cbc9e29e9ac8756bb154278f\",\n  \"f2f0f7dadaebbcbddc9e9ac8756bb154278f\",\n  \"f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486\",\n  \"fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486\",\n  \"fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fee0d2fc9272de2d26\",\n  \"fee5d9fcae91fb6a4acb181d\",\n  \"fee5d9fcae91fb6a4ade2d26a50f15\",\n  \"fee5d9fcbba1fc9272fb6a4ade2d26a50f15\",\n  \"fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d\",\n  \"fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d\",\n  \"fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d\"\n).map(colors);\n\nexport default ramp(scheme);\n","import {cubehelix} from \"d3-color\";\nimport {interpolateCubehelixLong} from \"d3-interpolate\";\n\nexport var warm = interpolateCubehelixLong(cubehelix(-100, 0.75, 0.35), cubehelix(80, 1.50, 0.8));\n\nexport var cool = interpolateCubehelixLong(cubehelix(260, 0.75, 0.35), cubehelix(80, 1.50, 0.8));\n\nvar c = cubehelix();\n\nexport default function(t) {\n  if (t < 0 || t > 1) t -= Math.floor(t);\n  var ts = Math.abs(t - 0.5);\n  c.h = 360 * t - 100;\n  c.s = 1.5 - 1.5 * ts;\n  c.l = 0.8 - 0.9 * ts;\n  return c + \"\";\n}\n","import {cubehelix} from \"d3-color\";\nimport {interpolateCubehelixLong} from \"d3-interpolate\";\n\nexport default interpolateCubehelixLong(cubehelix(300, 0.5, 0.0), cubehelix(-240, 0.5, 1.0));\n","import colors from \"../colors.js\";\n\nfunction ramp(range) {\n  var n = range.length;\n  return function(t) {\n    return range[Math.max(0, Math.min(n - 1, Math.floor(t * n)))];\n  };\n}\n\nexport default ramp(colors(\"44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725\"));\n\nexport var magma = ramp(colors(\"00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf\"));\n\nexport var inferno = ramp(colors(\"00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4\"));\n\nexport var plasma = ramp(colors(\"0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921\"));\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"ffeda0feb24cf03b20\",\n  \"ffffb2fecc5cfd8d3ce31a1c\",\n  \"ffffb2fecc5cfd8d3cf03b20bd0026\",\n  \"ffffb2fed976feb24cfd8d3cf03b20bd0026\",\n  \"ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026\",\n  \"ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026\",\n  \"ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fff7bcfec44fd95f0e\",\n  \"ffffd4fed98efe9929cc4c02\",\n  \"ffffd4fed98efe9929d95f0e993404\",\n  \"ffffd4fee391fec44ffe9929d95f0e993404\",\n  \"ffffd4fee391fec44ffe9929ec7014cc4c028c2d04\",\n  \"ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04\",\n  \"ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"e5f5f999d8c92ca25f\",\n  \"edf8fbb2e2e266c2a4238b45\",\n  \"edf8fbb2e2e266c2a42ca25f006d2c\",\n  \"edf8fbccece699d8c966c2a42ca25f006d2c\",\n  \"edf8fbccece699d8c966c2a441ae76238b45005824\",\n  \"f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824\",\n  \"f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"e0ecf49ebcda8856a7\",\n  \"edf8fbb3cde38c96c688419d\",\n  \"edf8fbb3cde38c96c68856a7810f7c\",\n  \"edf8fbbfd3e69ebcda8c96c68856a7810f7c\",\n  \"edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b\",\n  \"f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b\",\n  \"f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"e0f3dba8ddb543a2ca\",\n  \"f0f9e8bae4bc7bccc42b8cbe\",\n  \"f0f9e8bae4bc7bccc443a2ca0868ac\",\n  \"f0f9e8ccebc5a8ddb57bccc443a2ca0868ac\",\n  \"f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e\",\n  \"f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e\",\n  \"f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fee8c8fdbb84e34a33\",\n  \"fef0d9fdcc8afc8d59d7301f\",\n  \"fef0d9fdcc8afc8d59e34a33b30000\",\n  \"fef0d9fdd49efdbb84fc8d59e34a33b30000\",\n  \"fef0d9fdd49efdbb84fc8d59ef6548d7301f990000\",\n  \"fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000\",\n  \"fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"ece2f0a6bddb1c9099\",\n  \"f6eff7bdc9e167a9cf02818a\",\n  \"f6eff7bdc9e167a9cf1c9099016c59\",\n  \"f6eff7d0d1e6a6bddb67a9cf1c9099016c59\",\n  \"f6eff7d0d1e6a6bddb67a9cf3690c002818a016450\",\n  \"fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450\",\n  \"fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"ece7f2a6bddb2b8cbe\",\n  \"f1eef6bdc9e174a9cf0570b0\",\n  \"f1eef6bdc9e174a9cf2b8cbe045a8d\",\n  \"f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d\",\n  \"f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b\",\n  \"fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b\",\n  \"fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"e7e1efc994c7dd1c77\",\n  \"f1eef6d7b5d8df65b0ce1256\",\n  \"f1eef6d7b5d8df65b0dd1c77980043\",\n  \"f1eef6d4b9dac994c7df65b0dd1c77980043\",\n  \"f1eef6d4b9dac994c7df65b0e7298ace125691003f\",\n  \"f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f\",\n  \"f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fde0ddfa9fb5c51b8a\",\n  \"feebe2fbb4b9f768a1ae017e\",\n  \"feebe2fbb4b9f768a1c51b8a7a0177\",\n  \"feebe2fcc5c0fa9fb5f768a1c51b8a7a0177\",\n  \"feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177\",\n  \"fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177\",\n  \"fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"edf8b17fcdbb2c7fb8\",\n  \"ffffcca1dab441b6c4225ea8\",\n  \"ffffcca1dab441b6c42c7fb8253494\",\n  \"ffffccc7e9b47fcdbb41b6c42c7fb8253494\",\n  \"ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84\",\n  \"ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84\",\n  \"ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"f7fcb9addd8e31a354\",\n  \"ffffccc2e69978c679238443\",\n  \"ffffccc2e69978c67931a354006837\",\n  \"ffffccd9f0a3addd8e78c67931a354006837\",\n  \"ffffccd9f0a3addd8e78c67941ab5d238443005a32\",\n  \"ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32\",\n  \"ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"d8b365f5f5f55ab4ac\",\n  \"a6611adfc27d80cdc1018571\",\n  \"a6611adfc27df5f5f580cdc1018571\",\n  \"8c510ad8b365f6e8c3c7eae55ab4ac01665e\",\n  \"8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e\",\n  \"8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e\",\n  \"8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e\",\n  \"5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30\",\n  \"5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"af8dc3f7f7f77fbf7b\",\n  \"7b3294c2a5cfa6dba0008837\",\n  \"7b3294c2a5cff7f7f7a6dba0008837\",\n  \"762a83af8dc3e7d4e8d9f0d37fbf7b1b7837\",\n  \"762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837\",\n  \"762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837\",\n  \"762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837\",\n  \"40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b\",\n  \"40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"e9a3c9f7f7f7a1d76a\",\n  \"d01c8bf1b6dab8e1864dac26\",\n  \"d01c8bf1b6daf7f7f7b8e1864dac26\",\n  \"c51b7de9a3c9fde0efe6f5d0a1d76a4d9221\",\n  \"c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221\",\n  \"c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221\",\n  \"c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221\",\n  \"8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419\",\n  \"8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"998ec3f7f7f7f1a340\",\n  \"5e3c99b2abd2fdb863e66101\",\n  \"5e3c99b2abd2f7f7f7fdb863e66101\",\n  \"542788998ec3d8daebfee0b6f1a340b35806\",\n  \"542788998ec3d8daebf7f7f7fee0b6f1a340b35806\",\n  \"5427888073acb2abd2d8daebfee0b6fdb863e08214b35806\",\n  \"5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806\",\n  \"2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08\",\n  \"2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"ef8a62f7f7f767a9cf\",\n  \"ca0020f4a58292c5de0571b0\",\n  \"ca0020f4a582f7f7f792c5de0571b0\",\n  \"b2182bef8a62fddbc7d1e5f067a9cf2166ac\",\n  \"b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac\",\n  \"b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac\",\n  \"b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac\",\n  \"67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061\",\n  \"67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"ef8a62ffffff999999\",\n  \"ca0020f4a582bababa404040\",\n  \"ca0020f4a582ffffffbababa404040\",\n  \"b2182bef8a62fddbc7e0e0e09999994d4d4d\",\n  \"b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d\",\n  \"b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d\",\n  \"b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d\",\n  \"67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a\",\n  \"67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fc8d59ffffbf91bfdb\",\n  \"d7191cfdae61abd9e92c7bb6\",\n  \"d7191cfdae61ffffbfabd9e92c7bb6\",\n  \"d73027fc8d59fee090e0f3f891bfdb4575b4\",\n  \"d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4\",\n  \"d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4\",\n  \"d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4\",\n  \"a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695\",\n  \"a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fc8d59ffffbf91cf60\",\n  \"d7191cfdae61a6d96a1a9641\",\n  \"d7191cfdae61ffffbfa6d96a1a9641\",\n  \"d73027fc8d59fee08bd9ef8b91cf601a9850\",\n  \"d73027fc8d59fee08bffffbfd9ef8b91cf601a9850\",\n  \"d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850\",\n  \"d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850\",\n  \"a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837\",\n  \"a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837\"\n).map(colors);\n\nexport default ramp(scheme);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fc8d59ffffbf99d594\",\n  \"d7191cfdae61abdda42b83ba\",\n  \"d7191cfdae61ffffbfabdda42b83ba\",\n  \"d53e4ffc8d59fee08be6f59899d5943288bd\",\n  \"d53e4ffc8d59fee08bffffbfe6f59899d5943288bd\",\n  \"d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd\",\n  \"d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd\",\n  \"9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2\",\n  \"9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2\"\n).map(colors);\n\nexport default ramp(scheme);\n","import {interpolateBlues, interpolateGreens, interpolateGreys, interpolateOranges, interpolatePurples, interpolateReds, interpolateCool, interpolateCubehelixDefault, interpolateWarm, interpolatePlasma, interpolateMagma, interpolateViridis, interpolateInferno, interpolateYlOrRd, interpolateYlOrBr, interpolateBuGn, interpolateBuPu, interpolateGnBu, interpolateOrRd, interpolatePuBuGn, interpolatePuBu, interpolatePuRd, interpolateRdPu, interpolateYlGnBu, interpolateYlGn, interpolateRainbow, interpolateBrBG, interpolatePRGn, interpolatePiYG, interpolatePuOr, interpolateRdBu, interpolateRdGy, interpolateRdYlBu, interpolateRdYlGn, interpolateSpectral} from 'd3-scale-chromatic';\r\nimport {IMapAbleDesc} from './MappingFunction';\r\nimport Column from './Column';\r\nimport {equal} from '../internal/utils';\r\nimport {scaleLinear} from 'd3-scale';\r\n\r\nexport interface IColorMappingFunctionBase {\r\n  apply(v: number): string;\r\n\r\n  dump(): any;\r\n\r\n  clone(): IColorMappingFunction;\r\n\r\n  eq(other: IColorMappingFunction): boolean;\r\n}\r\n\r\nexport interface IInterpolateColorMappingFunction extends IColorMappingFunctionBase {\r\n  type: 'sequential'|'divergent';\r\n  name: string;\r\n}\r\n\r\nexport interface IQuantizedColorMappingFunction extends IColorMappingFunctionBase {\r\n  type: 'quantized';\r\n  base: IColorMappingFunction;\r\n  steps: number;\r\n}\r\n\r\nexport interface ISolidColorMappingFunction extends IColorMappingFunctionBase {\r\n  type: 'solid';\r\n  color: string;\r\n}\r\n\r\nexport interface ICustomColorMappingFunction extends IColorMappingFunctionBase {\r\n  type: 'custom';\r\n  entries: {value: number, color: string}[];\r\n}\r\n\r\nexport declare type IColorMappingFunction = ISolidColorMappingFunction | ICustomColorMappingFunction | IQuantizedColorMappingFunction | IInterpolateColorMappingFunction;\r\n\r\nexport class InterpolatingColorFunction implements IInterpolateColorMappingFunction {\r\n  constructor(public readonly name: string, public readonly type: 'sequential'|'divergent', public readonly apply: (v: number)=>string) {\r\n\r\n  }\r\n\r\n  dump() {\r\n    return this.name;\r\n  }\r\n\r\n  clone() {\r\n    return this; // no clone needed since not parameterized\r\n  }\r\n\r\n  eq(other: IColorMappingFunction): boolean {\r\n    return other === this;\r\n  }\r\n}\r\n\r\nexport class SolidColorFunction implements ISolidColorMappingFunction {\r\n  constructor(public readonly color: string) {\r\n\r\n  }\r\n\r\n  get type(): 'solid' {\r\n    return 'solid';\r\n  }\r\n\r\n  apply() {\r\n    return this.color;\r\n  }\r\n\r\n  dump() {\r\n    return this.color;\r\n  }\r\n\r\n  clone() {\r\n    return this; // no clone needed since not parameterized\r\n  }\r\n\r\n  eq(other: IColorMappingFunction): boolean {\r\n    return other instanceof SolidColorFunction && other.color === this.color;\r\n  }\r\n}\r\n\r\nexport class QuantizedColorFunction implements IQuantizedColorMappingFunction {\r\n  constructor(public readonly base: IColorMappingFunction, public readonly steps: number) {\r\n\r\n  }\r\n\r\n  get type(): 'quantized' {\r\n    return 'quantized';\r\n  }\r\n\r\n  apply(v: number) {\r\n    return this.base.apply(quantize(v, this.steps));\r\n  }\r\n\r\n  dump() {\r\n    return {\r\n      base: this.base.dump(),\r\n      steps: this.steps\r\n    };\r\n  }\r\n\r\n  clone(): QuantizedColorFunction {\r\n    return this; // no clone needed since not parameterized\r\n  }\r\n\r\n  eq(other: IColorMappingFunction): boolean {\r\n    return other instanceof QuantizedColorFunction && other.base.eq(this.base) && other.steps === this.steps;\r\n  }\r\n}\r\n\r\nexport class CustomColorMappingFunction implements ICustomColorMappingFunction {\r\n  private readonly scale = scaleLinear<string>();\r\n\r\n  constructor(public readonly entries: {value: number, color: string}[]) {\r\n    this.scale\r\n      .domain(entries.map((d) => d.value))\r\n      .range(entries.map((d) => d.color))\r\n      .clamp(true);\r\n  }\r\n\r\n  get type(): 'custom' {\r\n    return 'custom';\r\n  }\r\n\r\n  apply(v: number) {\r\n    return this.scale(v);\r\n  }\r\n\r\n  dump() {\r\n    return this.entries;\r\n  }\r\n\r\n  clone() {\r\n    return new CustomColorMappingFunction(this.entries);\r\n  }\r\n\r\n  eq(other: IColorMappingFunction): boolean {\r\n    return other instanceof CustomColorMappingFunction && equal(this.entries, other.entries);\r\n  }\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function quantize(v: number, steps: number) {\r\n  const perStep = 1 / steps;\r\n  if (v <= perStep) {\r\n    return 0;\r\n  }\r\n  if (v >= (1 - perStep)) {\r\n    return 1;\r\n  }\r\n  for (let acc = 0; acc < 1; acc += perStep) {\r\n    if (v < acc) {\r\n      return acc - perStep / 2; // center\r\n    }\r\n  }\r\n  return v;\r\n}\r\n\r\nconst cache = new Map<string, SolidColorFunction>();\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function asColorFunction(color: string) {\r\n  if (cache.has(color)) {\r\n    return cache.get(color)!;\r\n  }\r\n  const s = new SolidColorFunction(color);\r\n  cache.set(color, s);\r\n  return s;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const DEFAULT_COLOR_FUNCTION = asColorFunction(Column.DEFAULT_COLOR);\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const sequentialColors: InterpolatingColorFunction[] = [];\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const divergentColors: InterpolatingColorFunction[] = [];\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const lookupInterpolatingColor = new Map<string, InterpolatingColorFunction>();\r\n\r\n{\r\n  const sequential: { [key: string]: (v: number)=>string } = {\r\n    interpolateBlues,\r\n    interpolateGreens,\r\n    interpolateGreys,\r\n    interpolateOranges,\r\n    interpolatePurples,\r\n    interpolateReds,\r\n    interpolateCool,\r\n    interpolateCubehelixDefault,\r\n    interpolateWarm,\r\n    interpolatePlasma,\r\n    interpolateMagma,\r\n    interpolateViridis,\r\n    interpolateInferno,\r\n    interpolateYlOrRd,\r\n    interpolateYlOrBr,\r\n    interpolateBuGn,\r\n    interpolateBuPu,\r\n    interpolateGnBu,\r\n    interpolateOrRd,\r\n    interpolatePuBuGn,\r\n    interpolatePuBu,\r\n    interpolatePuRd,\r\n    interpolateRdPu,\r\n    interpolateYlGnBu,\r\n    interpolateYlGn,\r\n    interpolateRainbow\r\n  };\r\n  const divergent: { [key: string]: (v: number)=>string } = {\r\n    interpolateBrBG,\r\n    interpolatePRGn,\r\n    interpolatePiYG,\r\n    interpolatePuOr,\r\n    interpolateRdBu,\r\n    interpolateRdGy,\r\n    interpolateRdYlBu,\r\n    interpolateRdYlGn,\r\n    interpolateSpectral\r\n  };\r\n  for (const key of Object.keys(sequential)) {\r\n    sequentialColors.push(new InterpolatingColorFunction(key, 'sequential', sequential[key]));\r\n  }\r\n  for (const key of Object.keys(divergent)) {\r\n    divergentColors.push(new InterpolatingColorFunction(key, 'divergent', divergent[key]));\r\n  }\r\n\r\n  for (const col of sequentialColors) {\r\n    lookupInterpolatingColor.set(col.name, col);\r\n  }\r\n  for (const col of divergentColors) {\r\n    lookupInterpolatingColor.set(col.name, col);\r\n  }\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function createColorMappingFunction(dump: any): IColorMappingFunction {\r\n  if (!dump) {\r\n    return DEFAULT_COLOR_FUNCTION;\r\n  }\r\n  if (typeof dump === 'string') {\r\n    const s = lookupInterpolatingColor.get(dump);\r\n    if (s) {\r\n      return s;\r\n    }\r\n    return asColorFunction(dump);\r\n  }\r\n  if (typeof dump === 'function') {\r\n    return new InterpolatingColorFunction('custom', 'sequential', dump);\r\n  }\r\n  if (dump.base && dump.steps) {\r\n    return new QuantizedColorFunction(createColorMappingFunction(dump.base), dump.steps);\r\n  }\r\n  if (Array.isArray(dump)) {\r\n    return new CustomColorMappingFunction(dump);\r\n  }\r\n  return DEFAULT_COLOR_FUNCTION;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function restoreColorMapping(desc: IMapAbleDesc): IColorMappingFunction {\r\n  if(desc.color) {\r\n    console.warn('The property `color` in the column description is deprecated and will not work in an upcoming LineUp release. Use the property `colorMapping` instead.');\r\n    return createColorMappingFunction(desc.color);\r\n  }\r\n  if (desc.colorMapping) {\r\n    return createColorMappingFunction(desc.colorMapping);\r\n  }\r\n  return DEFAULT_COLOR_FUNCTION;\r\n}\r\n","import {LazyBoxPlotData} from '../internal';\nimport {toolbar, SortByDefault, dialogAddons} from './annotations';\nimport ArrayColumn, {IArrayColumnDesc, IArrayDesc, spliceChanged} from './ArrayColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IDataRow} from './interfaces';\nimport {\n  compareBoxPlot, DEFAULT_FORMATTER, EAdvancedSortMethod, getBoxPlotNumber, INumberFilter, INumbersColumn,\n  noNumberFilter, isDummyNumberFilter, restoreNumberFilter\n} from './INumberColumn';\nimport {\n  createMappingFunction, IMapAbleDesc, IMappingFunction, restoreMapping,\n  ScaleMappingFunction\n} from './MappingFunction';\nimport {isMissingValue} from './missing';\nimport NumberColumn, {colorMappingChanged} from './NumberColumn';\nimport {IAdvancedBoxPlotData} from '../internal/math';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {IColorMappingFunction, restoreColorMapping, createColorMappingFunction} from './ColorMappingFunction';\n\n\nexport interface INumbersDesc extends IArrayDesc, IMapAbleDesc {\n  readonly sort?: EAdvancedSortMethod;\n}\n\nexport declare type INumbersColumnDesc = INumbersDesc & IArrayColumnDesc<number>;\n\n/**\n * emitted when the mapping property changes\n * @asMemberOf NumbersColumn\n * @event\n */\nexport declare function mappingChanged(previous: IMappingFunction, current: IMappingFunction): void;\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf NumbersColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: EAdvancedSortMethod, current: EAdvancedSortMethod): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf NumbersColumn\n * @event\n */\nexport declare function filterChanged(previous: INumberFilter | null, current: INumberFilter | null): void;\n\n@toolbar('filterNumber', 'colorMapped', 'editMapping')\n@dialogAddons('sort', 'sortNumbers')\n@SortByDefault('descending')\nexport default class NumbersColumn extends ArrayColumn<number> implements INumbersColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumberColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_COLOR_MAPPING_CHANGED = NumberColumn.EVENT_COLOR_MAPPING_CHANGED;\n  static readonly EVENT_SORTMETHOD_CHANGED = NumberColumn.EVENT_SORTMETHOD_CHANGED;\n  static readonly EVENT_FILTER_CHANGED = NumberColumn.EVENT_FILTER_CHANGED;\n\n\n  static readonly CENTER = 0;\n\n  private sort: EAdvancedSortMethod;\n  private mapping: IMappingFunction;\n  private original: IMappingFunction;\n  private colorMapping: IColorMappingFunction;\n  /**\n   * currently active filter\n   * @type {{min: number, max: number}}\n   * @private\n   */\n  private currentFilter: INumberFilter = noNumberFilter();\n\n  constructor(id: string, desc: Readonly<INumbersColumnDesc>) {\n    super(id, desc);\n    this.mapping = restoreMapping(desc);\n    this.original = this.mapping.clone();\n    this.colorMapping = restoreColorMapping(desc);\n\n    this.sort = desc.sort || EAdvancedSortMethod.median;\n\n    // better initialize the default with based on the data length\n    if (this.dataLength) {\n      this.setDefaultWidth(Math.min(Math.max(100, this.dataLength! * 10), 500));\n    }\n    this.setDefaultRenderer('heatmap');\n    this.setDefaultGroupRenderer('heatmap');\n    this.setDefaultSummaryRenderer('histogram');\n  }\n\n  compare(a: IDataRow, b: IDataRow): number {\n    return compareBoxPlot(this, a, b);\n  }\n\n  getRawNumbers(row: IDataRow) {\n    return this.getRawValue(row);\n  }\n\n  getBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null {\n    const data = this.getRawValue(row);\n    if (data == null) {\n      return null;\n    }\n    return new LazyBoxPlotData(data, this.mapping);\n  }\n\n  getRange() {\n    return this.mapping.getRange(DEFAULT_FORMATTER);\n  }\n\n  getRawBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null {\n    const data = this.getRawValue(row);\n    if (data == null) {\n      return null;\n    }\n    return new LazyBoxPlotData(data);\n  }\n\n  getNumbers(row: IDataRow) {\n    return this.getValue(row);\n  }\n\n  getNumber(row: IDataRow): number {\n    return getBoxPlotNumber(this, row, 'normalized');\n  }\n\n  getRawNumber(row: IDataRow): number {\n    return getBoxPlotNumber(this, row, 'raw');\n  }\n\n  getValue(row: IDataRow) {\n    const values = this.getRawValue(row);\n    return values.map((d) => isMissingValue(d) ? NaN : this.mapping.apply(d));\n  }\n\n  getRawValue(row: IDataRow) {\n    const r = super.getValue(row);\n    return r == null ? [] : r;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    return format === 'json' ? this.getRawValue(row) : super.getExportValue(row, format);\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getValue(row).map(DEFAULT_FORMATTER);\n  }\n\n  getSortMethod() {\n    return this.sort;\n  }\n\n  setSortMethod(sort: EAdvancedSortMethod) {\n    if (this.sort === sort) {\n      return;\n    }\n    this.fire([NumbersColumn.EVENT_SORTMETHOD_CHANGED], this.sort, this.sort = sort);\n    // sort by me if not already sorted by me\n    if (!this.isSortedByMe().asc) {\n      this.sortByMe();\n    }\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.sortMethod = this.getSortMethod();\n    r.filter = !isDummyNumberFilter(this.currentFilter) ? this.currentFilter : null;\n    r.map = this.mapping.dump();\n    r.colorMapping = this.colorMapping.dump();\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.sortMethod) {\n      this.sort = dump.sortMethod;\n    }\n    if (dump.filter) {\n      this.currentFilter = restoreNumberFilter(dump.filter);\n    }\n    if (dump.map) {\n      this.mapping = createMappingFunction(dump.map);\n    } else if (dump.domain) {\n      this.mapping = new ScaleMappingFunction(dump.domain, 'linear', dump.range || [0, 1]);\n    }\n    if (dump.colorMapping) {\n      this.colorMapping = createColorMappingFunction(dump.colorMapping);\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([NumbersColumn.EVENT_COLOR_MAPPING_CHANGED, NumbersColumn.EVENT_MAPPING_CHANGED, NumbersColumn.EVENT_SORTMETHOD_CHANGED, NumbersColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof NumbersColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof NumbersColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof NumbersColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof NumbersColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ArrayColumn.EVENT_SPLICE_CHANGED, listener: typeof spliceChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getOriginalMapping() {\n    return this.original.clone();\n  }\n\n  getMapping() {\n    return this.mapping.clone();\n  }\n\n  setMapping(mapping: IMappingFunction) {\n    if (this.mapping.eq(mapping)) {\n      return;\n    }\n    this.fire([NumbersColumn.EVENT_MAPPING_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.mapping.clone(), this.mapping = mapping);\n  }\n\n  getColor(row: IDataRow) {\n    return NumberColumn.prototype.getColor.call(this, row);\n  }\n\n  getColorMapping() {\n    return this.colorMapping.clone();\n  }\n\n  setColorMapping(mapping: IColorMappingFunction) {\n    if (this.colorMapping.eq(mapping)) {\n      return;\n    }\n    this.fire([NumbersColumn.EVENT_COLOR_MAPPING_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.colorMapping.clone(), this.colorMapping = mapping);\n  }\n\n  isFiltered() {\n    return NumberColumn.prototype.isFiltered.call(this);\n  }\n\n  getFilter(): INumberFilter {\n    return NumberColumn.prototype.getFilter.call(this);\n  }\n\n  setFilter(value: INumberFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    NumberColumn.prototype.setFilter.call(this, value);\n  }\n\n  filter(row: IDataRow) {\n    return NumberColumn.prototype.filter.call(this, row);\n  }\n}\n\n","import {uniqueId} from './dialogs/utils';\r\n\r\n/** @internal */\r\nexport const filterMissingText = 'Filter rows containing missing values';\r\n\r\n/** @internal */\r\nexport function filterMissingMarkup(bakMissing: boolean, idPrefix: string) {\r\n  const id = uniqueId(idPrefix);\r\n  return `<div class=\"lu-checkbox\"><input type=\"checkbox\" ${bakMissing ? 'checked=\"checked\"' : ''} id=\"${id}\"><label for=\"${id}\" class=\"lu-filter-missing\">${filterMissingText}</label></div>`;\r\n}\r\n\r\n/** @internal */\r\nexport function filterMissingNumberMarkup(bakMissing: boolean, count: number, idPrefix: string) {\r\n  const id = uniqueId(idPrefix);\r\n  return `<div class=\"lu-checkbox\"><input type=\"checkbox\" ${bakMissing ? 'checked=\"checked\"' : ''} ${count === 0 ? 'disabled' : ''} id=\"${id}\"><label for=\"${id}\" class=\"lu-filter-missing\" ${count === 0 ? 'class=\"lu-disabled\"' : ''}>Filter ${count} missing value rows</label></div>`;\r\n}\r\n\r\nexport function findFilterMissing(node: HTMLElement) {\r\n  return <HTMLInputElement>(<HTMLElement>node.querySelector('.lu-filter-missing')).previousElementSibling;\r\n}\r\n\r\n/** @internal */\r\nexport function updateFilterMissingNumberMarkup(element: HTMLElement, count: number) {\r\n  const checked = element.querySelector('input')!;\r\n  checked.disabled = (count === 0 && !checked.checked); // disable checkbox only if there are no missing values and the checkbox is unchecked (i.e., assumes that the checkbox is unchecked at the beginning)\r\n  element.lastElementChild!.classList.toggle('lu-disabled', checked.disabled);\r\n  element.lastElementChild!.textContent = `Filter ${count} missing value rows`;\r\n}\r\n","/*! lineupengine - v1.1.2 - 2018\n* https://sgratzl.github.io/lineupengine/\n* Copyright (c) 2018 Samuel Gratzl; Licensed MIT*/\n!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.lineupengine=e():t.lineupengine=e()}(window,function(){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=2)}([,function(t,e){},function(t,e,i){\"use strict\";i.r(e);\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function n(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var r=Symbol(\"aborted\");function s(t){return{then:function(e){var i,o=null,n=function(){return null===o},s=new Promise(function(t){return o=t}),a=t.then(function(t){return n()?r:Promise.resolve(e(t)).then(function(t){return n()?r:t})}),l=Promise.race([s,a]);return(i={abort:function(){null!==o&&(o(r),o=null)},then:l.then.bind(l),catch:l.catch.bind(l)})[Symbol.toStringTag]=l[Symbol.toStringTag],i}}}function a(t){return void 0!==t&&null!==t&&t&&\"function\"==typeof t.then&&\"function\"==typeof t.abort}var l,h=function(){function t(t,e){var i=this;this.context=t,this.key=e,this.cache=[],this.lastFilled=0,this.key2index=new Map,this.context.exceptions.forEach(function(t){i.cache[t.index]=t.y,i.key2index.set(e(t.index),t.index)})}return t.prototype.findValidStart=function(t){for(var e=t-1;e>=0;--e)if(void 0!==this.cache[e])return e;return-1},t.prototype.posByKey=function(t){if(this.key2index.has(t)){var e=this.key2index.get(t);return{index:e,pos:this.pos(e)}}return this.fillCacheTillKey(t)},t.prototype.pos=function(t){if(0===this.context.exceptions.length)return t*this.context.defaultRowHeight;var e=this.cache[t];if(void 0!==e)return e;var i=this.findValidStart(t);return i<0?this.fillCache(0,t,0):this.fillCache(i+1,t,this.cache[i]+this.heightOf(i)),this.cache[t]},t.prototype.fillCache=function(t,e,i,o){if(e<=this.lastFilled){if(!o)return;for(var n=t;n<=e;++n)o(n,this.key(n),this.cache[n])}else{var r=i;for(n=t;n<=e;++n){this.cache[n]=r;var s=this.key(n);this.key2index.set(s,n),o&&o(n,s,r),r+=this.heightOf(n)}}},t.prototype.heightOf=function(t){var e=this.context.exceptionsLookup;return e.has(t)?e.get(t):this.context.defaultRowHeight},t.prototype.exceptionHeightOf=function(t,e){void 0===e&&(e=!1);var i=this.context.padding(t),o=this.context.exceptionsLookup;return o.has(t)?o.get(t)-i:e?this.context.defaultRowHeight-i:null},t.prototype.padding=function(t){return this.context.padding(t)},t.prototype.fillCacheTillKey=function(t){for(var e=0,i=this.lastFilled;i<this.context.numberOfRows;++i,++this.lastFilled){var o=this.cache[i];if(void 0===o){var n=this.key(i);if(this.cache[i]=e,this.key2index.set(n,i),n===t)return{index:i,pos:e};e+=this.heightOf(i)}else e=o+this.heightOf(i)}return{index:-1,pos:-1}},t.prototype.positions=function(t,e,i,o){this.fillCache(t,e,i,o)},t}();!function(t){t[t.UPDATE=0]=\"UPDATE\",t[t.UPDATE_CREATE=1]=\"UPDATE_CREATE\",t[t.UPDATE_REMOVE=2]=\"UPDATE_REMOVE\",t[t.SHOW=3]=\"SHOW\",t[t.HIDE=4]=\"HIDE\"}(l||(l={}));var c=1;function u(t,e,i){var o=t.previous,n=t.mode,r=t.nodeY,s=t.current,a=null==o.height?e:o.height,h=null==s.height?i:s.height;return n===l.UPDATE&&Math.abs(o.y-r)<=c&&Math.abs(a-h)<=c}var d,f=[{delay:0,apply:function(t){var e=t.mode,i=t.previous,o=t.nodeY,n=t.current,r=t.node;r.dataset.animation=l[e].toLowerCase(),r.style.transform=\"translate(0, \"+(i.y-o)+\"px)\",e===l.SHOW?r.style.height=null!==n.height?n.height+\"px\":null:r.style.height=i.height+\"px\",r.style.opacity=e===l.SHOW?\"0\":e===l.HIDE?\"1\":null}},{delay:10,apply:function(t){var e=t.mode,i=t.current,o=t.nodeY,n=t.node;n.style.transform=e===l.HIDE||e===l.UPDATE_REMOVE?\"translate(0, \"+(i.y-o)+\"px)\":null,e!==l.HIDE&&(n.style.height=null!==i.height?i.height+\"px\":null),n.style.opacity=e===l.SHOW?\"1\":e===l.HIDE?\"0\":null}},{delay:1100,apply:function(t){var e=t.node;delete e.dataset.animation,e.style.opacity=null,e.style.transform=null}}],p=function(){function t(t,e,i){this.index=t,this.y=e,this.height=i}return Object.defineProperty(t.prototype,\"y2\",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),t}();function m(t,e,i){return void 0===i&&(i=0),{exceptions:[],exceptionsLookup:{keys:function(){return[].values()},get:function(){return e},has:function(){return!1},size:0},totalHeight:t*(e+=i),numberOfRows:t,defaultRowHeight:e,padding:function(){return i}}}function y(t,e,i){void 0===e&&(e=NaN),void 0===i&&(i=0);var o=new Map,n=[],r=\"function\"==typeof i?i:function(){return i};isNaN(e)&&(e=function(t){var e=new Map;if(t.forEach(function(t){e.set(t,(e.get(t)||0)+1)}),0===e.size)return 20;var i=Array.from(e).sort(function(t,e){return t[1]!==e[1]?e[1]-t[1]:t[0]-e[0]}),o=i[0][0];return 0===o?i.length>1?i[1][0]:20:o}(t)),e+=r(-1);var s=-1,a=0,l=0,h=0;return t.forEach(function(t,i){if(t+=r(i),l+=t,h++,t!==e){o.set(i,t);var c=(i-s-1)*e;s=i;var u=a+c;a=u+t,n.push(new p(i,u,t))}}),{exceptionsLookup:o,exceptions:n,totalHeight:l,defaultRowHeight:e,numberOfRows:h,padding:r}}function v(t,e,i,o,n,r){void 0===i&&(i=2),void 0===o&&(o=10*e),void 0===n&&(n=.2),void 0===r&&(r=Date.now());var s=r,a=function(){var t=1e4*Math.sin(s++);return t-Math.floor(t)};return y({forEach:function(r){for(var s=0;s<t;++s)r(a()<n?i+Math.round(a()*(o-i)):e,s)}},e)}function g(t,e,i,o,n){if(0===n)return{first:0,last:-1,firstRowPos:0,endPos:0};if(1===n)return{first:0,last:0,firstRowPos:0,endPos:0===o.length?i:o[0].y2};var r=t,s=r+e;function a(t,e){return Math.min(n-1,e+Math.max(0,Math.floor(t/i)))}function l(t,e,o){void 0===o&&(o=!1);var l=s-t,h=a(r-t,e),c=a(l,e),u=t+(h-e)*i,d=t+(c+1-e)*i;return console.assert(!o||!(u>r||d<s&&c<n-1),\"error\",o,u,d,r,s,e,t),{first:h,last:c,firstRowPos:u,endPos:d}}var h=l(0,0,!0);if(0===o.length)return h;if(h.last<o[0].index)return h;if(h.last===o[0].index&&o[0].height>i)return Object.assign(h,{endPos:o[0].y2});var c=o[o.length-1];if(r>=c.y){var u=l(c.y2,c.index+1);return r<c.y2?Object.assign(u,{first:c.index,firstRowPos:c.y}):u}for(var d=[],f=o[0],p=0,m=o;p<m.length;p++){var y=m[p],v=y.y,g=y.y2;if(v>=s)break;g<=r?f=y:d.push(y)}if(0===d.length)return l(f.y2,f.index+1);var b=d[0],x=d[d.length-1],w=Math.max(0,b.index-Math.max(0,Math.ceil((b.y-r)/i))),C=x.index;s>=x.y2&&(C=a(s-x.y2,x.index+1));var R=b.y-(b.index-w)*i,O=x.y2+(C-x.index)*i;return console.assert(R<=r&&(O>=s||C===n-1),\"error\",R,O,r,s,b,x),{first:w,last:C,firstRowPos:R,endPos:O}}function b(t,e){var i=t.length,o=e.length;if(0===i)return{added:e,removed:[],common:0};if(0===o)return{added:[],removed:t,common:0};if(i===o)return{added:[],removed:[],common:i};var n=t.slice(Math.min(o,i));return{added:e.slice(Math.min(o,i)),removed:n,common:i-n.length}}function x(t,e,i){for(var o=0===t.length?0:t[t.length-1]+1,n=[],r=[],s=t.length-1;s>=0;--s){if(!(t[s]>=i))break;r.push(t.pop())}for(s=o;s<i;++s)e[s].frozen&&(n.push(s),t.push(s));return{target:t,added:n,removed:r}}!function(t){t[t.NONE=0]=\"NONE\",t[t.ALL=1]=\"ALL\",t[t.SOME=2]=\"SOME\",t[t.SOME_BOTTOM=3]=\"SOME_BOTTOM\",t[t.SOME_TOP=4]=\"SOME_TOP\"}(d||(d={}));var w=\"animation\",C=function(){function t(t){var e=this;this.node=t,this.handlers=new Map,this.animationWaiting=!1,this.immediateTimeout=-1,this.timersWaiting=new Set,this.prevs=new Map,t.addEventListener(\"scroll\",function(){e.handle(\"sync\"),e.handleAnimation(),e.handleImmediate(),e.handleTimeouts()},{passive:!0})}return t.prototype.has=function(t){return this.handlers.has(t)&&this.handlers.get(t).length>0},t.prototype.handle=function(t){var e=this.handlers.get(t)||[];if(e&&!(e.length<=0)){var i=this.asInfo();if(this.prevs.has(t)){var o=this.prevs.get(t);if(Math.abs(i.left-o.left)+Math.abs(i.top-o.top)<4)return}this.prevs.set(t,i);for(var n=0,r=e;n<r.length;n++){(0,r[n])(i)}}},t.prototype.handleAnimation=function(){var t=this;!this.animationWaiting&&this.has(\"animation\")&&(this.animationWaiting=!0,requestAnimationFrame(function(){t.animationWaiting&&(t.animationWaiting=!1,t.handle(\"animation\"))}))},t.prototype.handleImmediate=function(){var t=this;this.immediateTimeout>=0||!this.has(\"immediate\")||(this.immediateTimeout=self.setImmediate(function(){t.immediateTimeout<0||(t.immediateTimeout=-1,t.handle(\"immediate\"))}))},t.prototype.handleTimeouts=function(){var t=this,e=Array.from(this.handlers.keys()).filter(function(e){return\"number\"==typeof e&&!t.timersWaiting.has(e)});if(0!==e.length)for(var i=function(e){o.timersWaiting.add(e),self.setTimeout(function(){t.timersWaiting.delete(e),t.handle(e)},e)},o=this,n=0,r=e;n<r.length;n++){i(r[n])}},t.prototype.asInfo=function(){return{left:this.node.scrollLeft,top:this.node.scrollTop,width:this.node.clientWidth,height:this.node.clientHeight}},t.prototype.push=function(t,e){\"immediate\"===t&&\"function\"!=typeof self.setImmediate&&(t=0),this.handlers.has(t)?this.handlers.get(t).push(e):this.handlers.set(t,[e])},t.prototype.remove=function(t){return Array.from(this.handlers.values()).some(function(e){var i=e.indexOf(t);return i>=0&&e.splice(i,1),i>=0})},t}();function R(t,e,i){t.__le_scroller__||(t.__le_scroller__=new C(t));var o=t.__le_scroller__;return o.push(e,i),o.asInfo()}var O=function(){function t(t,e){void 0===e&&(e={});var i=this;this.body=t,this.pool=[],this.loadingPool=[],this.loading=new Map,this.visible={first:0,forcedFirst:0,last:-1,forcedLast:-1},this.visibleFirstRowPos=0,this.scrollListener=null,this.abortAnimation=function(){},this.options={async:w,minScrollDelta:10,mixins:[],scrollingHint:!1,batchSize:5},this.adapter=this.createAdapter(),Object.assign(this.options,e),this.mixins=this.options.mixins.map(function(t){return new t(i.adapter)}),this.fragment=t.ownerDocument.createDocumentFragment()}return t.prototype.addMixin=function(t,e){this.mixins.push(new t(this.adapter,e))},t.prototype.createAdapter=function(){var t=this,e={visible:this.visible,addAtBeginning:this.addAtBeginning.bind(this),addAtBottom:this.addAtBottom.bind(this),removeFromBeginning:this.removeFromBeginning.bind(this),removeFromBottom:this.removeFromBottom.bind(this),updateOffset:this.updateOffset.bind(this),scroller:this.bodyScroller};return Object.defineProperties(e,{visibleFirstRowPos:{get:function(){return t.visibleFirstRowPos},enumerable:!0},context:{get:function(){return t.context},enumerable:!0}}),e},Object.defineProperty(t.prototype,\"bodyScroller\",{get:function(){return this.body.parentElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"bodySizer\",{get:function(){var t=this.bodyScroller,e=Array.from(t.children).find(function(t){return\"footer\"===t.tagName.toLowerCase()});if(e)return e;var i=t.ownerDocument.createElement(\"footer\");return t.insertBefore(i,t.firstChild),i},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this,e=this.bodyScroller,i=R(e,this.options.async,this.scrollListener=function(o){if(!(Math.abs(i.top-o.top)<t.options.minScrollDelta&&Math.abs(i.height-o.height)<t.options.minScrollDelta)){var n=o.top>i.top;i=o,t.onScrolledVertically(o.top,o.height,n),t.options.scrollingHint&&e.classList.remove(\"le-scrolling\")}});this.options.scrollingHint&&R(e,\"animation\",function(){return e.classList.add(\"le-scrolling\")}),this.recreate()},t.prototype.destroy=function(){!function(t,e){t.__le_scroller__&&t.__le_scroller__.remove(e)}(this.bodyScroller,this.scrollListener),this.body.remove()},t.cleanUp=function(t){t.style.height&&(t.style.height=null)},t.prototype.select=function(t){var e,i;return this.pool.length>0?(e=this.pool.pop(),i=this.updateRow(e,t)):this.loadingPool.length>0?((e=this.loadingPool.pop()).classList.remove(\"loading\"),i=this.createRow(e,t)):(e=this.body.ownerDocument.createElement(\"div\"),i=this.createRow(e,t)),e.dataset.index=String(t),{item:e,result:i}},t.prototype.selectProxy=function(){var t;return this.loadingPool.length>0?t=this.loadingPool.pop():(t=this.body.ownerDocument.createElement(\"div\")).classList.add(\"loading\"),t},t.prototype.recycle=function(e){(t.cleanUp(e),this.loading.has(e))?this.loading.get(e).abort():this.pool.push(e)},t.prototype.proxy=function(e,i){var o=this;if(!a(i))return e;var n=i,s=e,l=this.selectProxy();return l.dataset.index=s.dataset.index,l.style.height=s.style.height,this.loading.set(l,n),n.then(function(e){e===r?(t.cleanUp(s),o.pool.push(s)):o.body.replaceChild(s,l),o.loading.delete(l),t.cleanUp(l),o.loadingPool.push(l)}),l},t.prototype.create=function(t){var e=this.select(t),i=e.item,o=e.result,n=this.context,r=n.exceptionsLookup,s=n.padding;return r.has(t)&&(i.style.height=r.get(t)-s(t)+\"px\"),this.proxy(i,o)},t.prototype.removeAll=function(){var t=this,e=Array.from(this.body.children);this.body.innerHTML=\"\",e.forEach(function(e){t.recycle(e)})},t.prototype.update=function(){var t=this,e=this.visible.first,i=this.fragment,o=Array.from(this.body.children);this.body.innerHTML=\"\",o.forEach(function(o,n){if(!t.loading.has(o)){var r=t.updateRow(o,n+e);i.appendChild(t.proxy(o,r))}}),this.body.appendChild(i)},t.prototype.forEachRow=function(t,e){var i=this;void 0===e&&(e=!1);var o=Array.from(this.body.children),n=this.fragment;e||(this.body.innerHTML=\"\"),o.forEach(function(o,r){o.classList.contains(\"loading\")||\"update_remove\"===o.dataset.animation||\"hide\"===o.dataset.animation||t(o,r+i.visible.first),e||n.appendChild(o)}),e||this.body.appendChild(n)},t.prototype.removeFromBeginning=function(t,e){return this.remove(t,e,!0)},t.prototype.removeFromBottom=function(t,e){return this.remove(t,e,!1)},t.prototype.remove=function(t,e,i){if(!(e<t))for(var o=t;o<=e;++o){var n=i?this.body.firstChild:this.body.lastChild;n.remove(),this.recycle(n)}},t.prototype.addAtBeginning=function(t,e){if(!(e<t))if(t!==e){for(var i=this.fragment,o=t;o<=e;++o)i.appendChild(this.create(o));this.body.insertBefore(i,this.body.firstChild)}else this.body.insertBefore(this.create(t),this.body.firstChild)},t.prototype.addAtBottom=function(t,e){if(!(e<t))if(t!==e){for(var i=this.fragment,o=t;o<=e;++o)i.appendChild(this.create(o));this.body.appendChild(i)}else this.body.appendChild(this.create(t))},t.prototype.updateOffset=function(t){this.visibleFirstRowPos=t,this.body.classList.toggle(\"odd\",this.visible.first%2==1),this.updateSizer(t)},t.prototype.updateSizer=function(t){var e=this.context.totalHeight;this.body.style.transform=\"translate(0, \"+t.toFixed(0)+\"px)\",this.bodySizer.style.transform=\"translate(0, \"+Math.max(0,e-1).toFixed(0)+\"px)\"},t.prototype.recreate=function(t){return this.abortAnimation(),t?this.recreateAnimated(t):this.recreatePure()},t.prototype.recreatePure=function(){var t=this.context,e=this.bodyScroller;this.updateOffset(0),this.removeAll(),this.clearPool();var i=g(e.scrollTop,e.clientHeight,t.defaultRowHeight,t.exceptions,t.numberOfRows),o=i.first,n=i.last,r=i.firstRowPos;this.visible.first=this.visible.forcedFirst=o,this.visible.last=this.visible.forcedLast=n,o<0?this.updateOffset(0):(this.addAtBottom(o,n),this.updateOffset(r))},t.prototype.recreateAnimated=function(t){var e=this,i=new Map,o=new h(t.previous,t.previousKey),n=new h(this.context,t.currentKey),r=g(this.bodyScroller.scrollTop,this.bodyScroller.clientHeight,n.context.defaultRowHeight,n.context.exceptions,n.context.numberOfRows),s=Array.from(this.body.children),a=Object.assign({},this.visible);this.body.innerHTML=\"\",o.positions(a.first,Math.min(a.last,a.first+s.length),this.visibleFirstRowPos,function(t,e,o){var n=s[t];n&&i.set(e,{n:n,pos:o,i:t})}),this.visible.first=this.visible.forcedFirst=r.first,this.visible.last=this.visible.forcedLast=r.last;var c=this.fragment,u=[],d=r.firstRowPos;n.positions(r.first,r.last,r.firstRowPos,function(t,r,s){var a,h,f=l.UPDATE;if(i.has(r)){var p=i.get(r);i.delete(r),p.n.dataset.index=String(t),a=e.proxy(p.n,e.updateRow(p.n,t)),h={index:p.i,y:p.pos,height:o.exceptionHeightOf(p.i,!0)}}else{var m=o.posByKey(r);a=e.create(t),f=m.index<0?l.SHOW:l.UPDATE_CREATE,h={index:m.index,y:m.pos>=0?m.pos:s,height:m.index<0?n.exceptionHeightOf(t,!0):o.exceptionHeightOf(m.index,!0)}}u.push({node:a,key:r,mode:f,previous:h,nodeY:d,nodeYCurrentHeight:s,current:{index:t,y:s,height:n.exceptionHeightOf(t)}}),a.style.transform=\"translate(0, \"+(d-s)+\"px)\",d+=h.height+(h.index<0?n.padding(t):o.padding(h.index)),c.appendChild(a)});var p=r.endPos;i.forEach(function(t,e){var i=n.posByKey(e),r=i.pos>=0?i.pos:t.pos,s=t.n;s.style.transform=\"translate(0, \"+(t.pos-d)+\"px)\",c.appendChild(s);var a=o.exceptionHeightOf(t.i,!0);u.push({node:t.n,key:e,mode:i.index<0?l.HIDE:l.UPDATE_REMOVE,previous:{index:t.i,y:t.pos,height:a},nodeY:d,nodeYCurrentHeight:p,current:{index:i.index,y:r,height:i.index<0?null:n.exceptionHeightOf(i.index)}}),p+=i.index<0?n.context.defaultRowHeight:n.exceptionHeightOf(i.index,!0)+n.padding(i.index),d+=a+o.padding(t.i)}),this.updateOffset(r.firstRowPos),this.animate(u,t.phases||f,o,n,c)},t.prototype.animate=function(t,e,i,o,n){var r=this;if(t.length<=0)this.body.appendChild(n);else{for(var s=-1,a=0,h=function(e,n){void 0===n&&(n=t),n.forEach(function(t){return e.apply(t,i,o)})},c=function(){if(console.assert(t[0].node.offsetTop>=0,\"dummy log for forcing dom update\"),h(e[a++]),a<e.length){var i=e[a];s=self.setTimeout(c,i.delay)}else{var o=r.body.classList;Array.from(o).forEach(function(t){t.startsWith(\"le-\")&&t.endsWith(\"-animation\")&&o.remove(t)}),t.forEach(function(t){var e=t.node,i=t.mode;i!==l.UPDATE_REMOVE&&i!==l.HIDE||(e.remove(),e.style.transform=null,r.recycle(e))}),r.abortAnimation=function(){},s=-1}};0===e[a].delay;)h(e[a++]);var d=this.body;this.body.appendChild(n);var f=[];t=t.filter(function(t){return!u(t,i.context.defaultRowHeight,o.context.defaultRowHeight)||(f.push(t),!1)}),f.length>0&&e.slice(a).forEach(function(t){return h(t,f)}),0!==t.length&&(d.classList.add(\"le-row-animation\"),new Set(t.map(function(t){return t.mode})).forEach(function(t){d.classList.add(\"le-\"+l[t].toLowerCase().split(\"_\")[0]+\"-animation\")}),this.abortAnimation=function(){s<=0||(clearTimeout(s),s=-1,a=e.length-1,c())},s=self.setTimeout(c,e[a].delay))}},t.prototype.clearPool=function(){this.pool.splice(0,this.pool.length)},t.prototype.revalidate=function(){var t=this.bodyScroller;this.onScrolledVertically(t.scrollTop,t.clientHeight,!0),this.updateOffset(this.visibleFirstRowPos)},t.prototype.onScrolledVertically=function(t,e,i){var o=this.onScrolledImpl(t,e);return this.mixins.forEach(function(t){return t.onScrolled(i,o)}),o},t.prototype.shiftLast=function(t,e){if(e>=this.options.batchSize)return t;var i=this.context.numberOfRows;return Math.min(i-1,t+(this.options.batchSize-e))},t.prototype.shiftFirst=function(t,e,i){if(i>=this.options.batchSize||t<=0)return{first:t,firstRowPos:e};for(var o=Math.max(0,t-(this.options.batchSize-i)),n=this.context,r=n.exceptionsLookup,s=n.defaultRowHeight,a=e,l=o;l<t;++l)r.has(l)?a-=r.get(l):a-=s;return{first:o,firstRowPos:a}},t.prototype.onScrolledImpl=function(t,e){var i=this.context,o=g(t,e,i.defaultRowHeight,i.exceptions,i.numberOfRows),n=o.first,r=o.last,s=o.firstRowPos,a=this.visible;if(a.forcedFirst=n,a.forcedLast=r,n-a.first>=0&&r-a.last<=0)return d.NONE;var l=d.SOME;if(n>a.last||r<a.first)this.removeAll(),this.addAtBottom(n,r),l=d.ALL;else if(n<a.first){a.last-(r+1)>=this.options.batchSize?this.removeFromBottom(r+1,a.last):r=a.last;var h=this.shiftFirst(n,s,a.first-1-n);n=h.first,s=h.firstRowPos,this.addAtBeginning(n,a.first-1),l=d.SOME_TOP}else{n-1-a.first>=this.options.batchSize?this.removeFromBeginning(a.first,n-1):(n=a.first,s=this.visibleFirstRowPos),r=this.shiftLast(r,r-a.last+1),this.addAtBottom(a.last+1,r),l=d.SOME_BOTTOM}return a.first=n,a.last=r,this.updateOffset(s),l},t}(),S=O,E=function(){function t(t){this.rules=new Map,this.node=t.ownerDocument.createElement(\"style\"),t.appendChild(this.node)}return t.prototype.destroy=function(){this.node.remove()},t.prototype.updateRules=function(){this.node.innerHTML=Array.from(this.rules.values()).join(\"\\n\")},t.prototype.addRule=function(t,e,i){return void 0===i&&(i=!0),this.rules.set(t,e),i&&this.updateRules(),t},t.prototype.updateRule=function(t,e,i){return void 0===i&&(i=!0),this.rules.set(t,e),i&&this.updateRules(),t},t.prototype.deleteRule=function(t,e){void 0===e&&(e=!0),this.rules.get(t)&&e&&this.updateRules()},Object.defineProperty(t.prototype,\"ruleNames\",{get:function(){return Array.from(this.rules.keys())},enumerable:!0,configurable:!0}),t}(),P=\"\\n  <header>\\n    <article></article>\\n  </header>\\n  <main>\\n    <footer>&nbsp;</footer>\\n    <article></article>\\n  </main>\";function H(t){return t.innerHTML=P,t}function A(t,e){t.dataset.id=e.id}var M=function(t){function e(e,i){var o=t.call(this,e)||this;o.id=i;var n=e.querySelector(\"header\"),r=e.querySelector(\"main\");return self.setTimeout(function(){var t=function(t){var e=t.ownerDocument.body;e.insertAdjacentHTML(\"beforeend\",'\\n    <div class=\"lineup-engine-scrollbar-tester\"><div></div></div>\\n  ');var i=e.lastElementChild,o=i.offsetWidth-i.clientWidth,n=i.offsetHeight-i.clientHeight;return i.remove(),{width:o,height:n}}(e).width;o.updateRule(\"__scollBarFix2\",o.hashedId+\" > header > article:last-of-type {\\n        border-right: \"+t+\"px solid transparent;\\n      }\")},20),R(r,\"animation\",function(t){var i=n.scrollLeft,o=t.left;i!==o&&(n.scrollLeft=o),e.classList.toggle(\"le-shifted\",t.left>0)}),o}return n(e,t),Object.defineProperty(e.prototype,\"hashedId\",{get:function(){return this.id.startsWith(\"#\")?this.id:\"#\"+this.id},enumerable:!0,configurable:!0}),e.prototype.update=function(t,e,i,o,n){void 0===n&&(n=\"px\");var r=void 0!==o?this.tableIds(o,!0):{header:this.id+\" > header > article\",body:this.id+\" > main > article\"};this.updateRule(\"__heightsRule\"+r.body,r.body+\" > div {\\n      height: \"+t+\"px;\\n    }\",!1),this.updateColumns(e,r,i,n),this.updateRules()},e.prototype.remove=function(t){var e=this.tableIds(t,!0);this.deleteRule(\"__heightsRule\"+e.body,!1),this.deleteRule(\"__widthRule\"+e.body,!1);for(var i=\"__col\"+e.body+\"_\",o=this.ruleNames.reduce(function(t,e){return t+(e.startsWith(i)?1:0)},0),n=0;n<o;++n)this.deleteRule(\"\"+i+n,!1);this.updateRules()},e.prototype.tableIds=function(t,e){void 0===e&&(e=!1);var i=this.id.startsWith(\"#\")?this.id.slice(1):this.id;return{header:(e?\"#\":\"\")+i+\"_H\"+t,body:(e?\"#\":\"\")+i+\"_B\"+t}},e.prototype.updateColumns=function(t,e,i,o){var n=this;void 0===o&&(o=\"px\");var r=\"__col\"+e.body+\"_\",s=this.ruleNames.reduce(function(t,e){return t+(e.startsWith(r)?1:0)},0),a=0,l=0;t.forEach(function(t){var s=e.body+' > div > [data-id=\"'+t.id+'\"], '+e.header+' [data-id=\"'+t.id+'\"] {\\n        width: '+t.width+o+\";\\n        \"+(t.frozen?\"left: \"+a+\"px;\":\"\")+\"\\n      }\";if(0!==i&&t.frozen){var h=e.body+' > div > [data-id=\"'+t.id+'\"] {\\n          width: '+t.width+o+\";\\n          left: \"+(a+i)+\"px;\\n        }\";s=e.header+' [data-id=\"'+t.id+'\"] {\\n          width: '+t.width+o+\";\\n          left: \"+a+\"px;\\n        }\",n.updateRule(\"\"+r+l++,h,!1)}t.frozen&&(a+=t.width),n.updateRule(\"\"+r+l++,s,!1)});for(var h=l-1;h<s;++h)this.deleteRule(\"\"+r+h,!1)},e}(E);var F=function(){function t(t,e,i){for(var o=[],n=3;n<arguments.length;n++)o[n-3]=arguments[n];var r=this;this.header=t,this.style=e,this.tableId=i,this.cellPool=[],this.visibleColumns={frozen:[],first:0,forcedFirst:0,last:-1,forcedLast:-1},this.visibleFirstColumnPos=0,this.columnAdapter=this.createColumnAdapter(),this.columnMixins=o.map(function(t){return new t(r.columnAdapter)}),this.columnFragment=t.ownerDocument.createDocumentFragment()}return t.prototype.leftShift=function(){var t=this.context,e=this.visibleColumns.frozen.reduce(function(e,i){return e+t.columns[i].width+t.column.padding(i)},0);return this.visibleFirstColumnPos-e},Object.defineProperty(t.prototype,\"headerScroller\",{get:function(){return this.header.parentElement},enumerable:!0,configurable:!0}),t.prototype.addColumnMixin=function(t,e){this.columnMixins.push(new t(this.columnAdapter,e))},t.prototype.createColumnAdapter=function(){var t=this,e={visible:this.visibleColumns,addAtBeginning:this.addColumnAtStart.bind(this),addAtBottom:this.addColumnAtEnd.bind(this),removeFromBeginning:this.removeColumnFromStart.bind(this),removeFromBottom:this.removeColumnFromEnd.bind(this),updateOffset:this.updateColumnOffset.bind(this),scroller:this.headerScroller,syncFrozen:this.syncFrozen.bind(this)};return Object.defineProperties(e,{visibleFirstRowPos:{get:function(){return t.visibleFirstColumnPos},enumerable:!0},context:{get:function(){return t.context.column},enumerable:!0}}),e},t.prototype.init=function(){var t=this,e=this.context;this.style.update(e.defaultRowHeight-e.padding(-1),e.columns,0,this.tableId),e.columns.forEach(function(){t.cellPool.push([])})},t.prototype.onScrolledHorizontally=function(t,e,i){var o=this.onScrolledHorizontallyImpl(t,e);return this.columnMixins.forEach(function(t){return t.onScrolled(i,o)}),o},t.prototype.removeColumnFromStart=function(t,e,i){var o=this;void 0===i&&(i=this.visibleColumns.frozen.length),this.forEachRow(function(n){o.removeCellFromStart(n,t,e,i)})},t.prototype.removeCellFromStart=function(t,e,i,o){for(var n=e;n<=i;++n){var r=0===o?t.firstElementChild:t.children[o];r.remove(),this.recycleCell(r,n)}},t.prototype.removeColumnFromEnd=function(t,e){var i=this;this.forEachRow(function(o){i.removeCellFromEnd(o,t,e)})},t.prototype.removeCellFromEnd=function(t,e,i){for(var o=i;o>=e;--o){var n=t.lastElementChild;n.remove(),this.recycleCell(n,o)}},t.prototype.removeFrozenCells=function(t,e,i){for(var o=0,n=e;o<n.length;o++){var r=n[o],s=t.children[i];s.remove(),this.recycleCell(s,r)}},t.prototype.removeFrozenColumns=function(t,e){var i=this;this.forEachRow(function(o){i.removeFrozenCells(o,t,e)})},t.prototype.removeAllColumns=function(t){var e=this;this.forEachRow(function(i){e.removeAllCells(i,t)})},t.prototype.removeAllCells=function(t,e,i){var o=this;void 0===i&&(i=this.visibleColumns.first);var n=Array.from(t.children),r=this.visibleColumns.frozen;if(t.innerHTML=\"\",e||0===r.length)for(var s=0,a=r;s<a.length;s++){var l=a[s];this.recycleCell(n.shift(),l)}else for(var h=0,c=r;h<c.length;h++){c[h];t.appendChild(n.shift())}n.forEach(function(t,e){o.recycleCell(t,e+i)})},t.prototype.selectCell=function(t,e,i){var o=this.cellPool[e],n=i[e];if(o.length>0){var r=o.pop(),s=this.updateCell(r,t,n);return s&&s!==r&&A(s,n),s||r}var a=this.createCell(this.header.ownerDocument,t,n);return A(a,n),a},t.prototype.recycleCell=function(t,e){this.cellPool[e].push(t)},t.prototype.addColumnAtStart=function(t,e,i){var o=this;void 0===i&&(i=this.visibleColumns.frozen.length);var n=this.context.columns;this.forEachRow(function(r,s){o.addCellAtStart(r,s,t,e,i,n)})},t.prototype.addCellAtStart=function(t,e,i,o,n,r){for(var s=o;s>=i;--s){var a=this.selectCell(e,s,r);t.insertBefore(a,n>0?t.children[n]:t.firstChild)}},t.prototype.insertFrozenCells=function(t,e,i,o,n){for(var r=t.children[o],s=0,a=i;s<a.length;s++){var l=a[s],h=this.selectCell(e,l,n);r?t.insertBefore(h,r):t.appendChild(h)}},t.prototype.insertFrozenColumns=function(t,e){var i=this,o=this.context.columns;this.forEachRow(function(n,r){i.insertFrozenCells(n,r,t,e,o)})},t.prototype.addColumnAtEnd=function(t,e){var i=this,o=this.context.columns;this.forEachRow(function(n,r){i.addCellAtEnd(n,r,t,e,o)})},t.prototype.verifyRows=function(){var t=this.context.columns;this.forEachRow(function(e,i){return T(e,i,t)})},t.prototype.addCellAtEnd=function(t,e,i,o,n){for(var r=i;r<=o;++r){var s=this.selectCell(e,r,n);t.appendChild(s)}},t.prototype.updateHeaders=function(){var t=this,e=this.context.columns;Array.from(this.header.children).forEach(function(i,o){t.updateHeader(i,e[o])})},t.prototype.recreate=function(t,e){var i=this,o=this.context;this.style.update(o.defaultRowHeight-o.padding(-1),o.columns,-this.leftShift(),this.tableId),this.clearPool();for(var n=this.cellPool.length;n<o.columns.length;++n)this.cellPool.push([]);var r=this.columnFragment,s=r.ownerDocument;this.header.innerHTML=\"\",o.columns.forEach(function(t){var e=i.createHeader(s,t);A(e,t),r.appendChild(e)}),this.header.appendChild(r);var a=g(t,e,o.column.defaultRowHeight,o.column.exceptions,o.column.numberOfRows),l=a.first,h=a.last,c=a.firstRowPos;if(this.visibleColumns.first=this.visibleColumns.forcedFirst=l,this.visibleColumns.last=this.visibleColumns.forcedLast=h,o.columns.some(function(t){return t.frozen})){var u=x([],o.columns,l).target;this.visibleColumns.frozen=u}else this.visibleColumns.frozen=[];this.updateColumnOffset(c)},t.prototype.clearPool=function(){this.cellPool.forEach(function(t){return t.splice(0,t.length)})},t.prototype.updateColumnOffset=function(t){var e=t!==this.visibleFirstColumnPos;if(this.visibleFirstColumnPos=t,e){var i=this.context;this.style.update(i.defaultRowHeight-i.padding(-1),i.columns,-this.leftShift(),this.tableId)}},t.prototype.createRow=function(t,e){var i=this.context.columns,o=this.visibleColumns;if(o.frozen.length>0)for(var n=0,r=o.frozen;n<r.length;n++){var s=r[n],a=this.selectCell(e,s,i);t.appendChild(a)}for(s=o.first;s<=o.last;++s){a=this.selectCell(e,s,i);t.appendChild(a)}},t.prototype.updateRow=function(t,e){var i=this.context.columns,o=this.visibleColumns,n=Array.from(t.children);switch(n.length){case 0:o.frozen.length>0&&this.insertFrozenCells(t,e,o.frozen,0,i),this.addCellAtEnd(t,e,o.first,o.last,i);break;case 1:var r=n[0],s=r.dataset.id,a=i.findIndex(function(t){return t.id===s});t.removeChild(r),a>=0&&this.recycleCell(r,a),o.frozen.length>0&&this.insertFrozenCells(t,e,o.frozen,0,i),this.addCellAtEnd(t,e,o.first,o.last,i);break;default:this.mergeColumns(t,e,n)}},t.prototype.mergeColumns=function(t,e,i){var o=this,n=this.context.columns,r=this.visibleColumns;t.innerHTML=\"\";var s=new Map(i.map(function(t){return[t.dataset.id,t]})),a=function(i){var r=n[i],a=s.get(r.id);if(a){var l=o.updateCell(a,e,r);l&&l!==a&&A(l,r),t.appendChild(l||a)}else{var h=o.selectCell(e,i,n);t.appendChild(h)}};r.frozen.forEach(a);for(var l=r.first;l<=r.last;++l)a(l)},t.prototype.syncFrozen=function(t){var e=this.context.columns,i=this.visibleColumns;if(!e.some(function(t){return t.frozen}))return 0;if(0===t)return i.frozen.length>0&&(this.removeFrozenColumns(i.frozen,0),i.frozen=[]),0;var o=i.frozen.length,n=x(i.frozen,e,t),r=n.target,s=n.added,a=n.removed;return a.length>0&&this.removeFrozenColumns(a,o-a.length),s.length>0&&this.insertFrozenColumns(s,o-a.length),i.frozen=r,r.length},t.prototype.onScrolledHorizontallyImpl=function(t,e){var i=this.context.column,o=g(t,e,i.defaultRowHeight,i.exceptions,i.numberOfRows),n=o.first,r=o.last,s=o.firstRowPos,a=this.visibleColumns;if(a.forcedFirst=n,a.forcedLast=r,n-a.first>=0&&r-a.last<=0)return d.NONE;var l=d.SOME,h=this.syncFrozen(n);return n>a.last||r<a.first?(this.removeAllColumns(!1),this.addColumnAtEnd(n,r),l=d.ALL):n<a.first?(this.removeColumnFromEnd(r+1,a.last),this.addColumnAtStart(n,a.first-1,h),l=d.SOME_TOP):(this.removeColumnFromStart(a.first,n-1,h),this.addColumnAtEnd(a.last+1,r),l=d.SOME_BOTTOM),a.first=n,a.last=r,this.updateColumnOffset(s),l},t}();function T(t,e,i){var o=Array.from(t.children);if(!(o.length<=1)){var n=o.map(function(t){return i.find(function(e){return e.id===t.dataset.id})});console.assert(n.every(function(t){return Boolean(t)}),\"all columns must exist\",e),console.assert(n.every(function(t,e){return 0===e||t.index>=n[e-1].index}),\"all columns in ascending order\",e),console.assert(new Set(n).size===n.length,\"unique columns\",n)}}var z=function(t){function e(e,i,o){void 0===o&&(o={});var r=t.call(this,H(e).querySelector(\"main > article\"),o)||this;r.root=e,e.classList.add(\"lineup-engine\"),r.style=new M(r.root,i);var s=r,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,\"context\",{get:function(){return s.context},enumerable:!0,configurable:!0}),e.prototype.createHeader=function(t,e){return s.createHeader(t,e)},e.prototype.updateHeader=function(t,e){return s.updateHeader(t,e)},e.prototype.createCell=function(t,e,i){return s.createCell(t,e,i)},e.prototype.updateCell=function(t,e,i){return s.updateCell(t,e,i)},e.prototype.updateColumnOffset=function(e){t.prototype.updateColumnOffset.call(this,e),s.updateOffset(s.visibleFirstRowPos)},e.prototype.forEachRow=function(t){return s.forEachRow(t)},e}(F);return r.cell=new(a.bind.apply(a,[void 0,r.header,r.style,void 0].concat(o.mixins||[]))),r}return n(e,t),Object.defineProperty(e.prototype,\"header\",{get:function(){return this.root.querySelector(\"header > article\")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"headerScroller\",{get:function(){return this.root.querySelector(\"header\")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"visibleColumns\",{get:function(){return this.cell.visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"visibleFirstColumnPos\",{get:function(){return this.cell.visibleFirstColumnPos},enumerable:!0,configurable:!0}),e.prototype.addColumnMixin=function(t,e){this.cell.addColumnMixin(t,e)},e.prototype.init=function(){var e=this;this.cell.init();var i=R(this.body.parentElement,this.options.async,function(t){if(!(Math.abs(i.left-t.left)<e.options.minScrollDelta&&Math.abs(i.width-t.width)<e.options.minScrollDelta)){var o=t.left>i.left;i=t,e.onScrolledHorizontally(t.left,t.width,o)}});t.prototype.init.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.root.remove()},e.prototype.onScrolledHorizontally=function(t,e,i){return this.cell.onScrolledHorizontally(t,e,i)},e.prototype.updateHeaders=function(){this.cell.updateHeaders()},e.prototype.updateColumnWidths=function(){var t=this.context;this.style.update(t.defaultRowHeight-t.padding(-1),t.columns,-this.cell.leftShift())},e.prototype.updateSizer=function(t){var e=this.context,i=e.totalHeight,o=e.column.totalHeight;this.updateShifts(t,this.cell.leftShift()),this.bodySizer.style.transform=\"translate(\"+Math.max(0,o-1).toFixed(0)+\"px, \"+Math.max(0,i-1).toFixed(0)+\"px)\"},e.prototype.updateShifts=function(t,e){this.body.style.transform=\"translate(\"+e.toFixed(0)+\"px, \"+t.toFixed(0)+\"px)\"},e.prototype.recreate=function(e){var i=this.bodyScroller,o=i.scrollLeft;this.cell.recreate(o,i.clientWidth),t.prototype.recreate.call(this,e),i.scrollLeft=o},e.prototype.clearPool=function(){t.prototype.clearPool.call(this),this.cell.clearPool()},e.prototype.createRow=function(t,e){this.cell.createRow(t,e)},e.prototype.updateRow=function(t,e){this.cell.updateRow(t,e)},e}(O),L=i(1),_=function(){function t(t,e){return this.adapter=t,this.prefetchTimeout=-1,this.cleanupTimeout=-1,this.options={prefetchRows:20,cleanUpRows:3,delay:50},Object.assign(this.options,e),this}return t.prototype.prefetchDown=function(){this.prefetchTimeout=-1;var t=this.adapter.context,e=Math.min(this.adapter.visible.forcedLast+this.options.prefetchRows,t.numberOfRows-1);this.adapter.visible.last===e&&this.adapter.visible.last>=this.adapter.visible.forcedLast+this.options.prefetchRows||(this.adapter.addAtBottom(this.adapter.visible.last+1,e),this.adapter.visible.last=e)},t.prototype.prefetchUp=function(){if(this.prefetchTimeout=-1,!(this.adapter.visible.first<=this.adapter.visible.forcedFirst-this.options.prefetchRows)){var t=this.adapter.context,e=this.adapter.scroller,i=g(Math.max(e.scrollTop-this.options.prefetchRows*t.defaultRowHeight,0),e.clientHeight,t.defaultRowHeight,t.exceptions,t.numberOfRows),o=i.first,n=i.firstRowPos;if(o!==this.adapter.visible.first){var r=this.adapter.syncFrozen?this.adapter.syncFrozen(o):0;this.adapter.addAtBeginning(o,this.adapter.visible.first-1,r),this.adapter.visible.first=o,this.adapter.updateOffset(n)}}},t.prototype.triggerPrefetch=function(t){this.prefetchTimeout>=0&&clearTimeout(this.prefetchTimeout);var e=this.adapter.visible.last<this.adapter.visible.forcedLast+this.options.prefetchRows,i=this.adapter.visible.first>this.adapter.visible.forcedFirst-this.options.prefetchRows,o=this.adapter.visible.last===this.adapter.context.numberOfRows,n=0===this.adapter.visible.first;if((!t||e||o)&&(t||i||n)){var r=t||n?this.prefetchDown.bind(this):this.prefetchUp.bind(this);this.prefetchTimeout=self.setTimeout(r,this.options.delay)}},t.prototype.cleanUpTop=function(t){this.cleanupTimeout=-1;var e=Math.max(0,t-this.options.cleanUpRows);if(!(e<=this.adapter.visible.first)){var i=this.adapter.syncFrozen?this.adapter.syncFrozen(e):0;this.adapter.removeFromBeginning(this.adapter.visible.first,e-1,i);var o=this.adapter.context,n=(e-this.adapter.visible.first)*o.defaultRowHeight;if(o.exceptions.length>0)for(var r=this.adapter.visible.first;r<e;++r)o.exceptionsLookup.has(r)&&(n+=o.exceptionsLookup.get(r)-o.defaultRowHeight);this.adapter.visible.first=e,this.adapter.updateOffset(this.adapter.visibleFirstRowPos+n),this.prefetchDown()}},t.prototype.cleanUpBottom=function(t){this.cleanupTimeout=-1;var e=t+this.options.cleanUpRows;this.adapter.visible.last<=e||(this.adapter.removeFromBottom(e+1,this.adapter.visible.last),this.adapter.visible.last=e,this.prefetchUp())},t.prototype.triggerCleanUp=function(t,e,i){this.cleanupTimeout>=0&&clearTimeout(this.cleanupTimeout),i&&t-this.options.cleanUpRows<=this.adapter.visible.first||!i&&this.adapter.visible.last<=e+this.options.cleanUpRows||(this.cleanupTimeout=self.setTimeout(i?this.cleanUpTop.bind(this):this.cleanUpBottom.bind(this),this.options.delay,i?t:e))},t.prototype.onScrolled=function(t,e){e!==d.ALL&&this.options.cleanUpRows>0&&this.triggerCleanUp(this.adapter.visible.forcedFirst,this.adapter.visible.forcedLast,t),e!==d.NONE&&this.options.prefetchRows>0&&this.triggerPrefetch(t)},t}(),B=function(t){function e(e,i,o,r,s){void 0===s&&(s={});var a=t.call(this,i,s)||this;a.header=e,a.body=i,a.tableId=o,a.style=r;var l=a,h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,\"context\",{get:function(){return l.context},enumerable:!0,configurable:!0}),e.prototype.createHeader=function(t,e){return l.createHeader(t,e)},e.prototype.updateHeader=function(t,e){return l.updateHeader(t,e)},e.prototype.createCell=function(t,e,i){return l.createCell(t,e,i)},e.prototype.updateColumnOffset=function(e){t.prototype.updateColumnOffset.call(this,e),l.updateOffset(l.visibleFirstRowPos)},e.prototype.updateCell=function(t,e,i){return l.updateCell(t,e,i)},e.prototype.forEachRow=function(t){return l.forEachRow(t)},e}(F);return a.cell=new(h.bind.apply(h,[void 0,a.header,a.style,o].concat(s.mixins||[]))),a}return n(e,t),e.prototype.addColumnMixin=function(t,e){this.cell.addColumnMixin(t,e)},Object.defineProperty(e.prototype,\"width\",{get:function(){return this.context.column.totalHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"visibleColumns\",{get:function(){return this.cell.visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"visibleFirstColumnPos\",{get:function(){return this.cell.visibleFirstColumnPos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"height\",{get:function(){return this.context.totalHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"hidden\",{get:function(){return this.header.classList.contains(\"loading\")},set:function(t){this.hidden!==t&&(this.header.classList.toggle(\"loading\",t),this.body.classList.toggle(\"loading\",t),this.onVisibilityChanged(!t))},enumerable:!0,configurable:!0}),e.prototype.updateSizer=function(t){this.updateShifts(t,this.cell.leftShift())},e.prototype.updateShifts=function(t,e){this.body.style.transform=\"translate(\"+e.toFixed(0)+\"px, \"+t.toFixed(0)+\"px)\"},e.prototype.onVisibilityChanged=function(t){},e.prototype.hide=function(){this.hidden=!0},e.prototype.show=function(t,e,i){var o=this.hidden;this.hidden=!1,o?this.revalidate():this.onScrolledHorizontally(t,e,i)},e.prototype.init=function(){this.hide(),this.cell.init(),t.prototype.init.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.header.remove(),this.style.remove(this.tableId)},e.prototype.onScrolledVertically=function(e,i,o){return this.hidden?d.NONE:t.prototype.onScrolledVertically.call(this,e,i,o)},e.prototype.onScrolledHorizontally=function(t,e,i){var o=this.cell.onScrolledHorizontally(t,e,i);return this.updateSizer(this.visibleFirstRowPos),o},e.prototype.updateHeaders=function(){this.cell.updateHeaders()},e.prototype.updateColumnWidths=function(){var t=this.context;this.style.update(t.defaultRowHeight-t.padding(-1),t.columns,-this.cell.leftShift(),this.tableId)},e.prototype.recreate=function(e){var i=this.bodyScroller,o=i.scrollLeft;this.cell.recreate(o,i.clientWidth),t.prototype.recreate.call(this,e),i.scrollLeft=o},e.prototype.clearPool=function(){t.prototype.clearPool.call(this),this.cell.clearPool()},e.prototype.createRow=function(t,e){this.cell.createRow(t,e)},e.prototype.updateRow=function(t,e){this.cell.updateRow(t,e)},e}(S),D=function(){function t(t,e,i){void 0===i&&(i={});var o=this;this.node=t,this.tableId=0,this.sections=[],this.options={columnPadding:0,async:w,minScrollDelta:30},Object.assign(this.options,i),t.id=e.startsWith(\"#\")?e.slice(1):e,t.innerHTML=\"<header><footer>&nbsp;</footer></header><main><footer>&nbsp;</footer></main>\",t.classList.add(\"lineup-engine\",\"lineup-multi-engine\"),this.style=new M(this.node,e);var n=R(this.main,this.options.async,function(t){if(!(Math.abs(n.left-t.left)<o.options.minScrollDelta&&Math.abs(n.width-t.width)<o.options.minScrollDelta)){var e=t.left>n.left;n=t,o.onScrolledHorizontally(t.left,t.width,e)}})}return t.prototype.update=function(){var t=this;this.onScrolledHorizontally(this.main.scrollLeft,this.main.clientWidth,!1);var e=0;this.sections.forEach(function(i){i.body.style.left=i.header.style.left=e+\"px\",e+=i.width+t.options.columnPadding})},t.prototype.onScrolledHorizontally=function(t,e,i){var o=this,n=0,r=t+e;this.sections.forEach(function(e){var s=n+e.width;s<t||n>r?e.hide():e.show(Math.max(0,t-n),Math.min(r-n,e.width),i),n=s+o.options.columnPadding}),this.updateOffset()},t.prototype.updateOffset=function(){var t=this,e=this.header.querySelector(\"footer\"),i=this.main.querySelector(\"footer\"),o=Math.max.apply(Math,[0].concat(this.sections.map(function(t){return t.height}))),n=this.sections.reduce(function(e,i){return e+i.width+t.options.columnPadding},0);e.style.transform=\"translate(\"+n+\"px,0)\",i.style.transform=\"translate(\"+n+\"px, \"+o+\"px)\"},t.prototype.destroy=function(){this.sections.forEach(function(t){return t.destroy()}),this.node.remove()},Object.defineProperty(t.prototype,\"doc\",{get:function(){return this.node.ownerDocument},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"header\",{get:function(){return this.node.querySelector(\"header\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"main\",{get:function(){return this.node.querySelector(\"main\")},enumerable:!0,configurable:!0}),t.prototype.pushTable=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this.doc.createElement(\"article\"),n=this.doc.createElement(\"article\"),r=\"T\"+this.tableId++,s=this.style.tableIds(r);o.id=s.header,n.id=s.body,this.header.insertBefore(o,this.header.lastElementChild),this.main.appendChild(n);var a=t.apply(void 0,[o,n,r,this.style].concat(e));return a.init(),this.sections.push(a),this.update(),a},t.prototype.pushSeparator=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this.doc.createElement(\"section\"),n=this.doc.createElement(\"section\");this.header.insertBefore(o,this.header.lastElementChild),this.main.appendChild(n);var r=t.apply(void 0,[o,n,this.style].concat(e));return r.init(),this.sections.push(r),this.update(),r},t.prototype.remove=function(t){var e=this.sections.indexOf(t);return!(e<0)&&(this.sections.splice(e,1),t.destroy(),this.update(),!0)},t.prototype.clear=function(){this.sections.splice(0,this.sections.length).forEach(function(t){return t.destroy()}),this.update()},t.prototype.widthChanged=function(){this.update()},t}();i.d(e,\"version\",function(){return I}),i.d(e,\"ACellRenderer\",function(){return z}),i.d(e,\"ARowRenderer\",function(){return O}),i.d(e,\"uniformContext\",function(){return m}),i.d(e,\"nonUniformContext\",function(){return y}),i.d(e,\"randomContext\",function(){return v}),i.d(e,\"range\",function(){return g}),i.d(e,\"frozenDelta\",function(){return b}),i.d(e,\"updateFrozen\",function(){return x}),i.d(e,\"ABORTED\",function(){return r}),i.d(e,\"isAbortAble\",function(){return a}),i.d(e,\"abortAble\",function(){return s}),i.d(e,\"IColumn\",function(){return L.IColumn}),i.d(e,\"GridStyleManager\",function(){return M}),i.d(e,\"setColumn\",function(){return A}),i.d(e,\"TEMPLATE\",function(){return P}),i.d(e,\"setTemplate\",function(){return H}),i.d(e,\"StyleManager\",function(){return E}),i.d(e,\"IMixin\",function(){}),i.d(e,\"IMixinAdapter\",function(){}),i.d(e,\"IMixinClass\",function(){}),i.d(e,\"EScrollResult\",function(){return d}),i.d(e,\"PrefetchMixin\",function(){return _}),i.d(e,\"ITableCellRenderContext\",function(){}),i.d(e,\"ACellTableSection\",function(){return B}),i.d(e,\"IMultiTableRowRendererOptions\",function(){}),i.d(e,\"ISeparatorFactory\",function(){}),i.d(e,\"ITableFactory\",function(){}),i.d(e,\"ITableSection\",function(){}),i.d(e,\"MultiTableRowRenderer\",function(){return D}),i.d(e,\"KeyFinder\",function(){return h}),i.d(e,\"EAnimationMode\",function(){return l}),i.d(e,\"noAnimationChange\",function(){return u}),i.d(e,\"defaultPhases\",function(){return f});var I=\"1.1.2\"}])});","import Column from '../../model';\r\nimport {forEach, uniqueId} from '../../renderer/utils';\r\nimport {isMapAbleColumn} from '../../model/MappingFunction';\r\n\r\n/** @internal */\r\nexport function updateFilterState(attachment: HTMLElement, column: Column, filtered: boolean) {\r\n  const toggle = (e: Element) => {\r\n    const n = <HTMLElement>e;\r\n    if (filtered) {\r\n      n.dataset.active = '';\r\n    } else {\r\n      delete n.dataset.active;\r\n    }\r\n  };\r\n\r\n  toggle(attachment);\r\n  const root = attachment.closest('.lu');\r\n  if (!root) {\r\n    return;\r\n  }\r\n  Array.from(root.querySelectorAll(`[data-col-id=\"${column.id}\"] i[title^=Filter]`)).forEach(toggle);\r\n}\r\n\r\n/** @internal */\r\nexport function sortMethods(node: HTMLElement, column: {setSortMethod(v: string): void, getSortMethod(): string}, methods: string[], idPrefix: string) {\r\n  const id = uniqueId(idPrefix);\r\n  const bak = column.getSortMethod();\r\n  methods.forEach((d) => node.insertAdjacentHTML('beforeend', `<div class=\"checkbox\"><input id=\"${id}${d}\" type=\"radio\" name=\"multivaluesort\" value=\"${d}\"  ${(bak === d) ? 'checked' : ''} ><label for=\"${id}${d}\">${d.slice(0, 1).toUpperCase() + d.slice(1)}</label></div>`));\r\n\r\n  forEach(node, 'input[name=multivaluesort]', (n: HTMLInputElement) => {\r\n    n.addEventListener('change', () => column.setSortMethod(n.value), {\r\n      passive: true\r\n    });\r\n  });\r\n}\r\n\r\n/** @internal */\r\nexport function colorOf(col: Column) {\r\n  if (isMapAbleColumn(col)) {\r\n    return col.getColorMapping().apply(0);\r\n  }\r\n  return Column.DEFAULT_COLOR;\r\n}\r\n\r\n\r\nexport {uniqueId, forEach, forEachChild} from '../../renderer/utils';\r\n","// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimal(1.23) returns [\"123\", 0].\nexport default function(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n","import formatDecimal from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimal(Math.abs(x)), x ? x[1] : NaN;\n}\n","// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n","// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (i0 > 0) { if (!+s[i]) break out; i0 = 0; } break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n","import formatDecimal from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimal(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimal(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n","import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  decimal: \".\",\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"],\n  minus: \"-\"\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n","import formatDecimal from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimal(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n","import formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": function(x, p) { return (x * 100).toFixed(p); },\n  \"b\": function(x) { return Math.round(x).toString(2); },\n  \"c\": function(x) { return x + \"\"; },\n  \"d\": function(x) { return Math.round(x).toString(10); },\n  \"e\": function(x, p) { return x.toExponential(p); },\n  \"f\": function(x, p) { return x.toFixed(p); },\n  \"g\": function(x, p) { return x.toPrecision(p); },\n  \"o\": function(x) { return Math.round(x).toString(8); },\n  \"p\": function(x, p) { return formatRounded(x * 100, p); },\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": function(x) { return Math.round(x).toString(16).toUpperCase(); },\n  \"x\": function(x) { return Math.round(x).toString(16); }\n};\n","export default function(x) {\n  return x;\n}\n","import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"-\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Perform the initial formatting.\n        var valueNegative = value < 0;\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero during formatting, treat as positive.\n        if (valueNegative && +value === 0) valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer value part that can be\n        // grouped, and fractional or exponential suffix part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n","export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n","export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n","export {default as formatDefaultLocale, format, formatPrefix} from \"./defaultLocale.js\";\nexport {default as formatLocale} from \"./locale.js\";\nexport {default as formatSpecifier, FormatSpecifier} from \"./formatSpecifier.js\";\nexport {default as precisionFixed} from \"./precisionFixed.js\";\nexport {default as precisionPrefix} from \"./precisionPrefix.js\";\nexport {default as precisionRound} from \"./precisionRound.js\";\n","import {timeFormat, timeParse} from 'd3-time-format';\nimport {Category, toolbar, dialogAddons} from './annotations';\nimport {IDataRow, IGroupData, IGroup} from './interfaces';\nimport {FIRST_IS_MISSING, isMissingValue, missingGroup, isUnknown} from './missing';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport Column from './Column';\nimport {IDateFilter, IDateDesc, noDateFilter, isDateIncluded, isDummyDateFilter, isEqualDateFilter, IDateGrouper, restoreDateFilter, IDateColumn, toDateGroup, isDefaultDateGrouper, defaultDateGrouper} from './IDateColumn';\nimport {median} from 'd3-array';\nimport {defaultGroup} from './Group';\nimport {equal} from '../internal/utils';\nimport {numberCompare} from './INumberColumn';\n\n\nexport declare type IDateColumnDesc = IValueColumnDesc<Date> & IDateDesc;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf DateColumn\n * @event\n */\nexport declare function filterChanged(previous: IDateFilter | null, current: IDateFilter | null): void;\n\n/**\n * emitted when the grouping property changes\n * @asMemberOf DateColumn\n * @event\n */\nexport declare function groupingChanged(previous: IDateGrouper | null, current: IDateGrouper | null): void;\n\n\n@toolbar('groupBy', 'sortGroupBy', 'filterDate')\n@dialogAddons('group', 'groupDate')\n@Category('date')\nexport default class DateColumn extends ValueColumn<Date> implements IDateColumn {\n  static readonly EVENT_FILTER_CHANGED = 'filterChanged';\n  static readonly EVENT_GROUPING_CHANGED = 'groupingChanged';\n\n  private readonly format: (date: Date) => string;\n  private readonly parse: (date: string) => Date | null;\n\n  /**\n   * currently active filter\n   * @type {{min: number, max: number}}\n   * @private\n   */\n  private currentFilter: IDateFilter = noDateFilter();\n  private currentGrouper: IDateGrouper = defaultDateGrouper();\n\n  constructor(id: string, desc: Readonly<IDateColumnDesc>) {\n    super(id, desc);\n    this.format = timeFormat(desc.dateFormat || '%x');\n    this.parse = desc.dateParse ? timeParse(desc.dateParse) : timeParse(desc.dateFormat || '%x');\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.filter = isDummyDateFilter(this.currentFilter) ? null : this.currentFilter;\n    if (this.currentGrouper && !isDefaultDateGrouper(this.currentGrouper)) {\n      r.grouper = this.currentGrouper;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.filter) {\n      this.currentFilter = restoreDateFilter(dump.filter);\n    }\n    if (dump.grouper) {\n      this.currentGrouper = dump.grouper;\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([DateColumn.EVENT_FILTER_CHANGED, DateColumn.EVENT_GROUPING_CHANGED]);\n  }\n\n  on(type: typeof DateColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof DateColumn.EVENT_GROUPING_CHANGED, listener: typeof groupingChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow): Date | null {\n    return this.getDate(row);\n  }\n\n  getDate(row: IDataRow) {\n    const v = super.getValue(row);\n    if (isMissingValue(v)) {\n      return null;\n    }\n    if (v instanceof Date) {\n      return v;\n    }\n    return this.parse(String(v));\n  }\n\n  getLabel(row: IDataRow) {\n    const v = this.getValue(row);\n    if (!(v instanceof Date)) {\n      return '';\n    }\n    return this.format(v);\n  }\n\n  isFiltered() {\n    return !isDummyDateFilter(this.currentFilter);\n  }\n\n  getFilter(): IDateFilter {\n    return Object.assign({}, this.currentFilter);\n  }\n\n  setFilter(value: IDateFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    if (isEqualDateFilter(value, this.currentFilter)) {\n      return;\n    }\n    const bak = this.getFilter();\n    this.currentFilter.min = isUnknown(value.min) ? -Infinity : value.min;\n    this.currentFilter.max = isUnknown(value.max) ? Infinity : value.max;\n    this.currentFilter.filterMissing = value.filterMissing;\n    this.fire([DateColumn.EVENT_FILTER_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, this.getFilter());\n  }\n\n  /**\n   * filter the current row if any filter is set\n   * @param row\n   * @returns {boolean}\n   */\n  filter(row: IDataRow) {\n    return isDateIncluded(this.currentFilter, this.getDate(row));\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    const av = this.getDate(a);\n    const bv = this.getDate(b);\n    if (av === bv) {\n      return 0;\n    }\n    if (!(av instanceof Date)) {\n      return (bv instanceof Date) ? FIRST_IS_MISSING : 0;\n    }\n    if (!(bv instanceof Date)) {\n      return FIRST_IS_MISSING * -1;\n    }\n    return av.getTime() - bv.getTime();\n  }\n\n  getDateGrouper() {\n    return Object.assign({}, this.currentGrouper);\n  }\n\n  setDateGrouper(value: IDateGrouper) {\n    if (equal(this.currentGrouper, value)) {\n      return;\n    }\n    const bak = this.getDateGrouper();\n    this.currentGrouper = Object.assign({}, value);\n    this.fire([DateColumn.EVENT_GROUPING_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, value);\n  }\n\n  group(row: IDataRow): IGroup {\n    const v = this.getDate(row);\n    if (!v || !(v instanceof Date)) {\n      return missingGroup;\n    }\n    if (!this.currentGrouper) {\n      return defaultGroup;\n    }\n    const g = toDateGroup(this.currentGrouper, v);\n    return {\n      name: g.name,\n      color: Column.DEFAULT_COLOR\n    };\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData): number {\n    const av = choose(a.rows, this.currentGrouper, this).value;\n    const bv = choose(b.rows, this.currentGrouper, this).value;\n    return numberCompare(av, bv, false, false);\n  }\n}\n\n/**\n * @internal\n */\nexport function choose(rows: IDataRow[], grouper: IDateGrouper | null, col: IDateColumn): { value: number | null, name: string } {\n  const vs = <Date[]>rows.map((d) => col.getDate(d)).filter((d) => d instanceof Date);\n  if (vs.length === 0) {\n    return {value: null, name: ''};\n  }\n  const median = trueMedian(vs, (d) => d.getTime())!;\n  if (!grouper) {\n    return {value: median, name: (new Date(median)).toString()};\n  }\n  return toDateGroup(grouper, new Date(median));\n}\n\nfunction trueMedian(dates: Date[], acc: (d: Date) => number) {\n  if (dates.length % 2 === 1) {\n    return median(dates, acc);\n  }\n  // to avoid interpolating between the centers do it manually\n  const s = dates.slice().sort((a, b) => a.getTime() - b.getTime());\n  return s[Math.floor(s.length / 2)].getTime();\n}\n","import Column from '../../model/Column';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {uniqueId} from './utils';\r\n\r\n/** @internal */\r\nexport default class ChangeRendererDialog extends ADialog {\r\n  constructor(private readonly column: Column, dialog: IDialogContext, private readonly ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const current = this.column.getRenderer();\r\n    const currentGroup = this.column.getGroupRenderer();\r\n    const currentSummary = this.column.getSummaryRenderer();\r\n    const {item, group, summary} = this.ctx.getPossibleRenderer(this.column);\r\n\r\n    console.assert(item.length > 1 || group.length > 1 || summary.length > 1); // otherwise no need to show this\r\n\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n    node.insertAdjacentHTML('beforeend', `\r\n      <strong>Item Visualization</strong>\r\n      ${item.sort((a, b) => a.label.localeCompare(b.label)).map((d) => ` <div class=\"lu-checkbox\"><input id=\"${id}0${d.type}\" type=\"radio\" name=\"renderer\" value=\"${d.type}\" ${(current === d.type) ? 'checked' : ''}><label for=\"${id}0${d.type}\">${d.label}</label></div>`).join('')}\r\n      <strong>Group Visualization</strong>\r\n      ${group.sort((a, b) => a.label.localeCompare(b.label)).map((d) => ` <div class=\"lu-checkbox\"><input id=\"${id}1${d.type}\" type=\"radio\" name=\"group\" value=\"${d.type}\" ${(currentGroup === d.type) ? 'checked' : ''}><label for=\"${id}1${d.type}\">${d.label}</label></div>`).join('')}\r\n      <strong>Summary Visualization</strong>\r\n      ${summary.sort((a, b) => a.label.localeCompare(b.label)).map((d) => ` <div class=\"lu-checkbox\"><input id=\"${id}2${d.type}\" type=\"radio\" name=\"summary\" value=\"${d.type}\" ${(currentSummary === d.type) ? 'checked' : ''}><label for=\"${id}2${d.type}\">${d.label}</label></div>`).join('')}\r\n    `);\r\n    this.forEach('input[name=\"renderer\"]', (n: HTMLInputElement) => {\r\n      n.addEventListener('change', () => this.column.setRenderer(n.value), { passive: true });\r\n    });\r\n    this.forEach('input[name=\"group\"]', (n: HTMLInputElement) => {\r\n      n.addEventListener('change', () => this.column.setGroupRenderer(n.value), { passive: true });\r\n    });\r\n    this.forEach('input[name=\"summary\"]', (n: HTMLInputElement) => {\r\n      n.addEventListener('change', () => this.column.setSummaryRenderer(n.value), { passive: true });\r\n    });\r\n  }\r\n\r\n}\r\n","import colors from \"../colors.js\";\n\nexport default colors(\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\");\n","import {IColumnMetaData} from '../../model';\r\nimport Column from '../../model/Column';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {uniqueId} from '../../renderer/utils';\r\nimport {schemeCategory10} from 'd3-scale-chromatic';\r\n\r\n/** @internal */\r\nexport default class RenameDialog extends ADialog {\r\n\r\n  private readonly before: IColumnMetaData;\r\n\r\n  constructor(private readonly column: Column, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n    this.before = column.getMetaData();\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-rename-dialog');\r\n    const id = uniqueId('col');\r\n    node.insertAdjacentHTML('beforeend', `\r\n      <datalist id=\"${id}L\"><option value=\"${Column.DEFAULT_COLOR}\"></option>${schemeCategory10.slice(1).map((d) => `<option>${d}</option>`).join('')}</datalist>\r\n      <input type=\"text\" value=\"${this.column.label}\" required autofocus placeholder=\"name\">\r\n      <textarea rows=\"5\" placeholder=\"Description\">${this.column.description}</textarea>`);\r\n  }\r\n\r\n  protected reset() {\r\n    this.findInput('input[type=\"text\"]').value = this.before.label;\r\n    this.node.querySelector('textarea')!.value = this.before.description;\r\n    this.column.setMetaData(this.before);\r\n  }\r\n\r\n  protected submit() {\r\n    const newValue = this.findInput('input[type=\"text\"]').value;\r\n    const newDescription = this.node.querySelector('textarea')!.value;\r\n    this.column.setMetaData({label: newValue, description: newDescription});\r\n    return true;\r\n  }\r\n}\r\n","import BooleanColumn from '../../model/BooleanColumn';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {updateFilterState, uniqueId} from './utils';\r\n\r\n/** @internal */\r\nexport default class BooleanFilterDialog extends ADialog {\r\n\r\n  private readonly before: boolean | null;\r\n\r\n  constructor(private readonly column: BooleanColumn, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n    this.before = this.column.getFilter();\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n    node.insertAdjacentHTML('beforeend', `\r\n     <div class=\"lu-checkbox\"><input id=\"${id}0\" type=\"radio\" name=\"boolean_check\" value=\"null\" ${this.before == null ? 'checked=\"checked\"' : ''}><label id=\"${id}0\">No Filter</label></div>\r\n     <div class=\"lu-checkbox\"><input id=\"${id}1\" type=\"radio\" name=\"boolean_check\" value=\"true\" ${this.before === true ? 'checked=\"checked\"' : ''}><label id=\"${id}1\">True</label></div>\r\n     <div class=\"lu-checkbox\"><input id=\"${id}2\" type=\"radio\" name=\"boolean_check\" value=\"false\" ${this.before === false ? 'checked=\"checked\"' : ''}><label id=\"${id}2\">False</label></div>\r\n    `);\r\n  }\r\n\r\n  private updateFilter(filter: boolean | null) {\r\n    updateFilterState(this.attachment, this.column, filter != null);\r\n    this.column.setFilter(filter);\r\n  }\r\n\r\n  reset() {\r\n    const v = 'null';\r\n    this.forEach('input[type=\"radio\"]', (d: HTMLInputElement) => d.checked = d.value === v);\r\n    this.updateFilter(null);\r\n  }\r\n\r\n  submit() {\r\n    const isTrue = this.findInput('input[type=\"radio\"][value=\"true\"]').checked;\r\n    const isFalse = this.findInput('input[type=\"radio\"][value=\"false\"]').checked;\r\n    this.updateFilter(isTrue ? true : (isFalse ? false : null));\r\n    return true;\r\n  }\r\n}\r\n","import CategoricalColumn from '../../model/CategoricalColumn';\r\nimport {ICategoricalFilter, isCategoryIncluded} from '../../model/ICategoricalColumn';\r\nimport SetColumn from '../../model/SetColumn';\r\nimport {filterMissingMarkup, findFilterMissing} from '../missing';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {updateFilterState, uniqueId, forEach} from './utils';\r\n\r\n/** @internal */\r\nexport default class CategoricalFilterDialog extends ADialog {\r\n\r\n  private readonly before: ICategoricalFilter;\r\n\r\n  constructor(private readonly column: CategoricalColumn | SetColumn, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n    this.before = this.column.getFilter() || {filter: this.column.categories.map((d) => d.name), filterMissing: false};\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-filter-table');\r\n\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n\r\n    node.insertAdjacentHTML('beforeend', `<div>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}\" type=\"checkbox\" checked><label for=\"${id}\"><span></span><div>Un/Select All</div></label></div>\r\n        ${this.column.categories.map((c) => `<div class=\"lu-checkbox\"><input id=\"${id}${c.name}\" data-cat=\"${c.name}\" type=\"checkbox\"${isCategoryIncluded(this.before, c) ? 'checked' : ''}><label for=\"${id}${c.name}\"><span style=\"background-color: ${c.color}\"></span><div>${c.label}</div></label></div>`).join('')}\r\n    </div>`);\r\n    // selectAll\r\n    this.findInput('input:not([data-cat])').onchange = function (this: GlobalEventHandlers) {\r\n      const input = <HTMLInputElement>this;\r\n      forEach(node, 'input[data-cat]', (n: HTMLInputElement) => n.checked = input.checked);\r\n    };\r\n    node.insertAdjacentHTML('beforeend', filterMissingMarkup(this.before.filterMissing, this.dialog.idPrefix));\r\n  }\r\n\r\n  private updateFilter(filter: string[] | null, filterMissing: boolean) {\r\n    const noFilter = filter == null && filterMissing === false;\r\n    updateFilterState(this.attachment, this.column, !noFilter);\r\n    this.column.setFilter(noFilter ? null : {filter: filter!, filterMissing});\r\n  }\r\n\r\n  reset() {\r\n    this.forEach('input[data-cat]', (n: HTMLInputElement) => n.checked = true);\r\n    this.updateFilter(null, false);\r\n  }\r\n\r\n  submit() {\r\n    let f: string[] | null = this.forEach('input[data-cat]', (n: HTMLInputElement) => n.checked ? n.dataset.cat! : '').filter(Boolean);\r\n    if (f.length === this.column.categories.length) { // all checked = no filter\r\n      f = null;\r\n    }\r\n    const filterMissing = findFilterMissing(this.node).checked;\r\n    this.updateFilter(f, filterMissing);\r\n    return true;\r\n  }\r\n}\r\n","import {round} from '../../internal';\r\nimport OrdinalColumn from '../../model/OrdinalColumn';\r\nimport {ICategoricalFilter, isCategoryIncluded} from '../../model/ICategoricalColumn';\r\nimport {filterMissingMarkup, findFilterMissing} from '../missing';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {updateFilterState, uniqueId, forEach} from './utils';\r\n\r\n/** @internal */\r\nexport default class CategoricalMappingFilterDialog extends ADialog {\r\n\r\n  private readonly before: ICategoricalFilter;\r\n\r\n  constructor(private readonly column: OrdinalColumn, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n    this.before = this.column.getFilter() || {filter: this.column.categories.map((d) => d.name), filterMissing: false};\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-filter-table');\r\n    const joint = this.column.categories.map((d) => Object.assign({\r\n      range: round(d.value * 100, 2)\r\n    }));\r\n    joint.sort((a, b) => a.label.localeCompare(b.label));\r\n\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n    node.insertAdjacentHTML('beforeend', `<div>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}\" type=\"checkbox\" checked><label for=\"${id}\"><div>Un/Select All</div></label></div>\r\n        ${joint.map(({name, color, label, range}) => `<input id=\"${id}${name}\" data-cat=\"${name}\" type=\"checkbox\"${isCategoryIncluded(this.before, name) ? 'checked' : ''}>\r\n        <div class=\"lu-checkbox\"><input type=\"number\" value=\"${range}\" min=\"0\" max=\"100\" size=\"5\"><label for=\"${id}${name}\"><div><div style=\"background-color: ${color}; width: ${range}%\"></div></div><div>${label}</div></label></div>`).join('')}\r\n    </div>`);\r\n    // selectAll\r\n    this.findInput('input[type=checkbox]:not([data-cat])').onchange = function (this: GlobalEventHandlers) {\r\n      const input = <HTMLInputElement>this;\r\n      forEach(node, '[data-cat]', (n: HTMLInputElement) => n.checked = input.checked);\r\n    };\r\n    this.forEach('input[type=number]', (d: HTMLInputElement) => {\r\n      d.oninput = () => {\r\n        (<HTMLElement>d.nextElementSibling!.firstElementChild).style.width = `${d.value}%`;\r\n      };\r\n    });\r\n    node.insertAdjacentHTML('beforeend', filterMissingMarkup(this.before.filterMissing, this.dialog.idPrefix));\r\n  }\r\n\r\n  private updateFilter(filter: string[] | null, filterMissing: boolean) {\r\n    const noFilter = filter == null && filterMissing === false;\r\n    updateFilterState(this.attachment, this.column, !noFilter);\r\n    this.column.setFilter(noFilter ? null : {filter: filter!, filterMissing});\r\n  }\r\n\r\n  reset() {\r\n    this.forEach('[data-cat]', (n: HTMLInputElement) => {\r\n      n.checked = false;\r\n      (<HTMLInputElement>n.nextElementSibling!).value = '50';\r\n    });\r\n    this.updateFilter(null, false);\r\n    this.column.setMapping(this.column.categories.map(() => 1));\r\n  }\r\n\r\n  submit() {\r\n    const items = this.forEach('input[data-cat]', (n: HTMLInputElement) => ({\r\n      checked: n.checked,\r\n      cat: n.dataset.cat!,\r\n      range: parseFloat((<HTMLInputElement>n.nextElementSibling)!.value)\r\n    }));\r\n    let f: string[] | null = items.filter((d) => d.checked).map((d) => d.cat);\r\n    if (f.length === this.column.categories.length) { // all checked = no filter\r\n      f = null;\r\n    }\r\n    const filterMissing = findFilterMissing(this.node).checked;\r\n    this.updateFilter(f, filterMissing);\r\n    this.column.setMapping(items.map((d) => d.range / 100));\r\n    return true;\r\n  }\r\n}\r\n","import {suffix} from '../../internal/AEventDispatcher';\r\nimport debounce from '../../internal/debounce';\r\nimport CompositeColumn from '../../model/CompositeColumn';\r\nimport {createHeader, updateHeader} from '../header';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class CompositeChildrenDialog extends ADialog {\r\n\r\n  private readonly id: string;\r\n\r\n  constructor(private readonly column: CompositeColumn, dialog: IDialogContext, private ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n    this.id = `.dialog${Math.random().toString(36).slice(-8).substr(0, 3)}`;\r\n  }\r\n\r\n  destroy() {\r\n    this.column.on(suffix(this.id, CompositeColumn.EVENT_ADD_COLUMN, CompositeColumn.EVENT_REMOVE_COLUMN), null);\r\n    super.destroy();\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-sub-nested');\r\n    const createChildren = () => {\r\n      this.column.children.forEach((c) => {\r\n        const n = createHeader(c, this.ctx, {\r\n          mergeDropAble: false,\r\n          resizeable: false,\r\n          level: this.dialog.level + 1\r\n        });\r\n        n.className = `lu-header`;\r\n        updateHeader(n, c);\r\n        const summary = this.ctx.summaryRenderer(c, false);\r\n        n.insertAdjacentHTML('beforeend', summary.template);\r\n        const summaryNode = <HTMLElement>n.lastElementChild!;\r\n        summaryNode.dataset.renderer = c.getSummaryRenderer();\r\n        summaryNode.classList.add('lu-summary');\r\n        summary.update(summaryNode, this.ctx.statsOf(<any>c));\r\n        node.appendChild(n);\r\n      });\r\n    };\r\n    createChildren();\r\n\r\n    this.column.on(suffix(this.id, CompositeColumn.EVENT_ADD_COLUMN, CompositeColumn.EVENT_REMOVE_COLUMN), debounce(() => {\r\n      if (!node.parentElement) {\r\n        // already closed\r\n        this.destroy();\r\n        return;\r\n      }\r\n      node.innerHTML = '';\r\n      createChildren();\r\n    }));\r\n  }\r\n}\r\n","import HierarchyColumn, {ICategoryInternalNode, ICutOffNode, resolveInnerNodes} from '../../model/HierarchyColumn';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class CutOffHierarchyDialog extends ADialog {\r\n\r\n  private readonly innerNodes: ICategoryInternalNode[];\r\n  private readonly innerNodePaths: string[];\r\n\r\n  private readonly before: ICutOffNode;\r\n\r\n\r\n  constructor(private readonly column: HierarchyColumn, dialog: IDialogContext, private readonly idPrefix: string) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n\r\n    this.innerNodes = resolveInnerNodes(this.column.hierarchy);\r\n    this.innerNodePaths = this.innerNodes.map((n) => n.path);\r\n    this.before = column.getCutOff();\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.insertAdjacentHTML('beforeend', `\r\n        <input type=\"text\" value=\"${this.before.node.label}\" required=\"required\" autofocus=\"autofocus\" list=\"ui${this.idPrefix}lineupHierarchyList\" placeholder=\"cut off node\">\r\n        <input type=\"number\" value=\"${isFinite(this.before.maxDepth) ? this.before.maxDepth : ''}\" placeholder=\"max depth (&infin;)\">\r\n        <datalist id=\"ui${this.idPrefix}lineupHierarchyList\">${this.innerNodes.map((node) => `<option value=\"${node.path}\">${node.label}</option>`)}</datalist>`);\r\n\r\n    //custom validation\r\n    const innerNodePaths = this.innerNodePaths;\r\n    this.findInput('input[type=\"text\"]').addEventListener('change', function (this: HTMLInputElement) {\r\n      const value = this.value;\r\n      if (innerNodePaths.indexOf(value) < 0) {\r\n        this.setCustomValidity('invalid node');\r\n      } else {\r\n        this.setCustomValidity('');\r\n      }\r\n    }, {\r\n      passive: true\r\n    });\r\n  }\r\n\r\n  protected reset() {\r\n    this.findInput('input[type=\"text\"]').value = this.before.node.label;\r\n    this.findInput('input[type=\"number\"]').value = isFinite(this.before.maxDepth) ? String(this.before.maxDepth) : '';\r\n    this.column.setCutOff(this.before);\r\n  }\r\n\r\n  protected submit() {\r\n    const newNode = this.findInput('input[type=\"text\"]').value;\r\n    const newNodeIndex = this.innerNodePaths.indexOf(newNode);\r\n    const node = this.innerNodes[newNodeIndex];\r\n    const maxDepthText = this.findInput('input[type=\"number\"]').value;\r\n    const maxDepth = maxDepthText === '' ? Infinity : parseInt(maxDepthText, 10);\r\n    this.column.setCutOff({node, maxDepth});\r\n    return true;\r\n  }\r\n}\r\n","import LinkColumn from '../../model/LinkColumn';\r\nimport LinkMapColumn from '../../model/LinkMapColumn';\r\nimport LinksColumn from '../../model/LinksColumn';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class EditPatternDialog extends ADialog {\r\n\r\n  constructor(private readonly column: LinkColumn | LinksColumn | LinkMapColumn, dialog: IDialogContext, private readonly idPrefix: string) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const templates = this.column.patternTemplates;\r\n    node.insertAdjacentHTML('beforeend', `<strong>Edit Pattern (access via $\\{value}, $\\{item})</strong><input\r\n        type=\"text\"\r\n        size=\"30\"\r\n        value=\"${this.column.getPattern()}\"\r\n        required\r\n        autofocus\r\n        placeholder=\"pattern (access via $\\{value}, $\\{item})\"\r\n        ${templates.length > 0 ? `list=\"ui${this.idPrefix}lineupPatternList\"` : ''}\r\n      >`);\r\n    if (templates.length > 0) {\r\n      node.insertAdjacentHTML('beforeend', `<datalist id=\"ui${this.idPrefix}lineupPatternList\">${templates.map((t) => `<option value=\"${t}\">`)}</datalist>`);\r\n    }\r\n  }\r\n\r\n  protected reset() {\r\n    this.node.querySelector('input')!.value = '';\r\n    this.column.setPattern('');\r\n  }\r\n\r\n  protected submit() {\r\n    const newValue = this.node.querySelector('input')!.value;\r\n    this.column.setPattern(newValue);\r\n    return true;\r\n  }\r\n}\r\n","import {IMapAbleColumn} from '../../model';\r\nimport {ISummaryRenderer} from '../../renderer/interfaces';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class NumberFilterDialog extends ADialog {\r\n  private readonly summary: ISummaryRenderer;\r\n\r\n  constructor(private readonly column: IMapAbleColumn, dialog: IDialogContext, private readonly ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n\r\n    this.summary = ctx.summaryRenderer(this.column, true);\r\n  }\r\n\r\n  build(node: HTMLElement) {\r\n    node.classList.add('lu-dialog-mapper');\r\n\r\n    // patch in lu-summary and renderer\r\n    node.insertAdjacentHTML('beforeend', this.summary.template);\r\n    const summary = <HTMLElement>node.lastElementChild!;\r\n    summary.classList.add('lu-summary', 'lu-renderer');\r\n    summary.dataset.renderer = this.column.getSummaryRenderer();\r\n    summary.dataset.interactive = '';\r\n    node.appendChild(summary);\r\n\r\n    this.summary.update(<HTMLElement>this.node.querySelector('.lu-summary')!, this.ctx.statsOf(this.column));\r\n  }\r\n}\r\n","import {EAdvancedSortMethod} from '../../model/INumberColumn';\r\nimport ReduceColumn from '../../model/ReduceColumn';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {sortMethods} from './utils';\r\n\r\n/** @internal */\r\nexport default class ReduceDialog extends ADialog {\r\n  constructor(private readonly column: ReduceColumn, dialog: IDialogContext) {\r\n    super(dialog);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const wrapper = {\r\n      getSortMethod: () => this.column.getReduce(),\r\n      setSortMethod: (s: EAdvancedSortMethod) => this.column.setReduce(s)\r\n    };\r\n    sortMethods(node, wrapper, Object.keys(EAdvancedSortMethod), this.dialog.idPrefix);\r\n  }\r\n}\r\n","import ScriptColumn from '../../model/ScriptColumn';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n//\r\n// const help = `<div class=\"script-description\">\r\n//       <p>You can write any valid JavaScript code. It will be embedded in a function. Therefore the last statement has to return a value.\r\n//       In case of a single line statement the code piece statement <code>return</code> will be automatically prefixed.</p>\r\n//       <p>The function signature is: <br><code>(row: any, index: number, children: Column[], values: any[], raws: (number|null)[]) => number</code>\r\n//       <dl>\r\n//         <dt>param: <code>row</code></dt>\r\n//         <dd>the row in the dataset to compute the value for</dd>\r\n//         <dt>param: <code>index</code></dt>\r\n//         <dd>the index of the row</dd>\r\n//         <dt>param: <code>children</code></dt>\r\n//         <dd>the list of LineUp columns that are part of this ScriptColumn</dd>\r\n//         <dt>param: <code>values</code></dt>\r\n//         <dd>the computed value of each column (see <code>children</code>) for the current row</dd>\r\n//         <dt>param: <code>raws</code></dt>\r\n//         <dd>similar to <code>values</code>. Numeric columns return by default the normalized value, this array gives access to the original \"raw\" values before mapping is applied</dd>\r\n//         <dt>returns:</dt>\r\n//         <dd>the computed number <strong>in the range [0, 1] or NaN</strong></dd>\r\n//       </dl>\r\n//       <p>In addition to the standard JavaScript functions and objects (Math, ...) a couple of utility functions are available: </p>\r\n//       <dl>\r\n//         <dt><code>max(arr: number[]) => number</code></dt>\r\n//         <dd>computes the maximum of the given array of numbers</dd>\r\n//         <dt><code>min(arr: number[]) => number</code></dt>\r\n//         <dd>computes the minimum of the given array of numbers</dd>\r\n//         <dt><code>extent(arr: number[]) => [number, number]</code></dt>\r\n//         <dd>computes both minimum and maximum and returning an array with the first element the minimum and the second the maximum</dd>\r\n//         <dt><code>clamp(v: number, min: number, max: number) => number</code></dt>\r\n//         <dd>ensures that the given value is within the given min/max value</dd>\r\n//         <dt><code>normalize(v: number, min: number, max: number) => number</code></dt>\r\n//         <dd>normalizes the given value <code>(v - min) / (max - min)</code></dd>\r\n//         <dt><code>denormalize(v: number, min: number, max: number) => number</code></dt>\r\n//         <dd>inverts a normalized value <code>v * (max - min) + min</code></dd>\r\n//         <dt><code>linear(v: number, input: [number, number], output: [number, number]) => number</code></dt>\r\n//         <dd>performs a linear mapping from input domain to output domain both given as an array of [min, max] values. <code>denormalize(normalize(v, input[0], input[1]), output[0], output[1])</code></dd>\r\n//       </dl>\r\n//       </div>`;\r\n\r\n/** @internal */\r\nexport default class ScriptEditDialog extends ADialog {\r\n  private readonly before: string;\r\n\r\n  constructor(private readonly column: ScriptColumn, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n    this.before = column.getScript();\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.insertAdjacentHTML('beforeend', `<textarea autofocus=\"true\" rows=\"5\" autofocus=\"autofocus\" style=\"width: 95%;\">${this.column.getScript()}</textarea>`);\r\n  }\r\n\r\n  protected reset() {\r\n    this.node.querySelector('textarea')!.value = this.before;\r\n    this.column.setScript(this.before);\r\n  }\r\n\r\n  protected submit() {\r\n    this.column.setScript(this.node.querySelector('textarea')!.value);\r\n    return true;\r\n  }\r\n}\r\n","import Column from '../../model/Column';\r\nimport {IDataProvider} from '../../provider/ADataProvider';\r\nimport ADialog, { IDialogContext} from './ADialog';\r\nimport {uniqueId} from './utils';\r\n\r\n/** @internal */\r\nexport default class SearchDialog extends ADialog {\r\n\r\n  constructor(private readonly column: Column, dialog: IDialogContext, private readonly provider: IDataProvider) {\r\n    super(dialog);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n    node.insertAdjacentHTML('beforeend', `<input type=\"text\" size=\"20\" value=\"\" required autofocus placeholder=\"search... (>= 3 chars)\"><div class=\"lu-checkbox\"><input id=\"${id}\" type=\"checkbox\"><label for=\"${id}\">Use regular expressions</label></div>`);\r\n\r\n    const input = <HTMLInputElement>node.querySelector('input[type=\"text\"]')!;\r\n    const checkbox = <HTMLInputElement>node.querySelector('input[type=\"checkbox\"]')!;\r\n    const update = () => {\r\n      let search: any = input.value;\r\n      if (search.length < 3) {\r\n        input.setCustomValidity('at least 3 characters');\r\n        return;\r\n      }\r\n      input.setCustomValidity('');\r\n      const isRegex = checkbox.checked;\r\n      if (isRegex) {\r\n        search = new RegExp(search);\r\n      }\r\n      this.provider.searchAndJump(search, this.column);\r\n    };\r\n    input.addEventListener('input', update, {\r\n      passive: true\r\n    });\r\n    checkbox.addEventListener('change', update, {\r\n      passive: true\r\n    });\r\n  }\r\n}\r\n","import StringColumn from '../../model/StringColumn';\r\nimport {filterMissingMarkup, findFilterMissing} from '../missing';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {updateFilterState, uniqueId} from './utils';\r\n\r\n/** @internal */\r\nexport default class StringFilterDialog extends ADialog {\r\n\r\n  constructor(private readonly column: StringColumn, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n  }\r\n\r\n  private updateFilter(filter: string | RegExp | null) {\r\n    updateFilterState(this.attachment, this.column, filter != null && filter !== '');\r\n    this.column.setFilter(filter);\r\n  }\r\n\r\n  reset() {\r\n    this.findInput('input[type=\"text\"]').value = '';\r\n    this.forEach('input[type=checkbox]', (n: HTMLInputElement) => n.checked = false);\r\n    this.updateFilter(null);\r\n  }\r\n\r\n  submit() {\r\n    const filterMissing = findFilterMissing(this.node).checked;\r\n    if (filterMissing) {\r\n      this.updateFilter(StringColumn.FILTER_MISSING);\r\n      return true;\r\n    }\r\n    const input = this.findInput('input[type=\"text\"]').value;\r\n    const isRegex = this.findInput('input[type=\"checkbox\"]').checked;\r\n    this.updateFilter(isRegex ? new RegExp(input) : input);\r\n    return true;\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    let bak = this.column.getFilter() || '';\r\n    const bakMissing = bak === StringColumn.FILTER_MISSING;\r\n    if (bakMissing) {\r\n      bak = '';\r\n    }\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n    node.insertAdjacentHTML('beforeend', `<input type=\"text\" placeholder=\"Filter ${this.column.desc.label}...\" autofocus value=\"${(bak instanceof RegExp) ? bak.source : bak}\" style=\"width: 100%\">\r\n    <span class=\"lu-checkbox\"><input id=\"${id}\" type=\"checkbox\" ${(bak instanceof RegExp) ? 'checked=\"checked\"' : ''}><label for=\"${id}\">Use regular expressions</label></span>\r\n    ${filterMissingMarkup(bakMissing, this.dialog.idPrefix)}`);\r\n\r\n    const filterMissing = findFilterMissing(node);\r\n    const input = <HTMLInputElement>node.querySelector('input[type=\"text\"]');\r\n    const isRegex = <HTMLInputElement>node.querySelector('input[type=\"checkbox\"]');\r\n\r\n    const update = () => {\r\n      input.disabled = filterMissing.checked;\r\n      isRegex.disabled = filterMissing.checked;\r\n\r\n      if (filterMissing.checked) {\r\n        this.updateFilter(StringColumn.FILTER_MISSING);\r\n        return;\r\n      }\r\n      const valid = input.value.trim();\r\n      filterMissing.disabled = valid.length > 0;\r\n      if (valid.length <= 0) {\r\n        this.updateFilter(null);\r\n        return;\r\n      }\r\n      this.updateFilter(isRegex.checked ? new RegExp(input.value, 'gm') : input.value);\r\n    };\r\n\r\n    filterMissing.onchange = update;\r\n    input.onchange = update;\r\n    isRegex.onchange = update;\r\n  }\r\n}\r\n","import {round} from '../../internal';\r\nimport StackColumn from '../../model/StackColumn';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {forEach, colorOf} from './utils';\r\n\r\n/** @internal */\r\nexport default class WeightsEditDialog extends ADialog {\r\n\r\n  private readonly weights: number[];\r\n\r\n  constructor(private readonly column: StackColumn, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n\r\n    this.weights = this.column.getWeights();\r\n  }\r\n\r\n  protected reset() {\r\n    forEach(this.node, 'input[type=number]', (n: HTMLInputElement) => {\r\n      const v = round(100 / this.weights.length, 2);\r\n      n.value = String(v);\r\n      (<HTMLElement>n.nextElementSibling!.firstElementChild!).style.width = `${v}%`;\r\n    });\r\n    this.column.setWeights(this.weights.slice().fill(100 / this.weights.length));\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-filter-table', 'lu-weights-table');\r\n\r\n    const children = this.column.children;\r\n    node.insertAdjacentHTML('beforeend', `<div>\r\n        ${this.weights.map((weight, i) => `<div><input type=\"number\" value=\"${round(weight * 100, 2)}\" min=\"0\" max=\"100\" step=\"any\"><span><span style=\"background-color: ${colorOf(children[i])}; width: ${round(weight * 100, 2)}%\"></span></span>${children[i].label}</div>`).join('')}\r\n    </div>`);\r\n    this.forEach('input[type=number]', (d: HTMLInputElement) => {\r\n      d.oninput = () => {\r\n        (<HTMLElement>d.nextElementSibling!.firstElementChild!).style.width = `${d.value}%`;\r\n      };\r\n    });\r\n  }\r\n\r\n  submit() {\r\n    const items = this.forEach('input[type=number]', (n: HTMLInputElement) => parseFloat(n.value) / 100);\r\n    this.column.setWeights(items);\r\n    return true;\r\n  }\r\n}\r\n","import Column from '../../model/Column';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {uniqueId, forEach} from './utils';\r\nimport {getToolbarDialogAddons, IToolbarDialogAddon} from '../toolbar';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\n\r\n/** @internal */\r\nexport default class GroupDialog extends ADialog {\r\n  private readonly addons: IToolbarDialogAddon[];\r\n\r\n  constructor(private readonly column: Column, dialog: IDialogContext, private readonly ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n    this.addons = getToolbarDialogAddons(this.column, 'group', ctx);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    for(const addon of this.addons) {\r\n      this.node.insertAdjacentHTML('beforeend', `<strong>${addon.title}</strong>`);\r\n      addon.append(this.column, this.node, this.dialog, this.ctx);\r\n    }\r\n\r\n    sortOrder(node, this.column, this.dialog.idPrefix);\r\n  }\r\n}\r\n\r\nfunction sortOrder(node: HTMLElement, column: Column, idPrefix: string) {\r\n  const ranking = column.findMyRanker()!;\r\n  const current = ranking.getGroupCriteria();\r\n  let order = current.indexOf(column);\r\n  let enabled = order >= 0;\r\n\r\n  if (order < 0) {\r\n    order = current.length;\r\n  }\r\n\r\n  const id = uniqueId(idPrefix);\r\n  node.insertAdjacentHTML('afterbegin', `\r\n        <strong>Group By</strong>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}B\" type=\"radio\" name=\"grouped\" value=\"true\" ${enabled ? 'checked' : ''} ><label for=\"${id}B\">Enabled</label></div>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}N\" type=\"radio\" name=\"grouped\" value=\"false\" ${!enabled ? 'checked' : ''} ><label for=\"${id}N\">Disabled</label></div>\r\n        <strong>Group Priority</strong>\r\n        <input type=\"number\" id=\"${id}P\" step=\"1\" min=\"1\" max=\"${current.length + 1}\" value=\"${order + 1}\">\r\n    `);\r\n\r\n  const updateDisabled = (disable: boolean) => {\r\n    forEach(node, 'input:not([name=grouped]), select, textarea', (d: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement) => {\r\n      d.disabled = disable;\r\n    });\r\n  };\r\n  updateDisabled(!enabled);\r\n\r\n  const trigger = () => {\r\n    ranking.groupBy(column, !enabled ? -1 : order);\r\n    updateDisabled(!enabled);\r\n  };\r\n\r\n  forEach(node, 'input[name=grouped]', (n: HTMLInputElement) => {\r\n    n.addEventListener('change', () => {\r\n      enabled = n.value === 'true';\r\n      trigger();\r\n    }, {\r\n      passive: true\r\n    });\r\n  });\r\n  {\r\n    const priority = (<HTMLInputElement>node.querySelector(`#${id}P`));\r\n    priority.addEventListener('change', () => {\r\n      order = parseInt(priority.value, 10) - 1;\r\n      trigger();\r\n    }, {\r\n      passive: true\r\n    });\r\n  }\r\n}\r\n","import Column from '../../model/Column';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {uniqueId, forEach} from './utils';\r\nimport {getToolbarDialogAddons, IToolbarDialogAddon} from '../toolbar';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\n\r\n/** @internal */\r\nexport default class SortDialog extends ADialog {\r\n  private readonly addons: IToolbarDialogAddon[];\r\n\r\n  constructor(private readonly column: Column, private readonly group: boolean, dialog: IDialogContext, private readonly ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n    this.addons = getToolbarDialogAddons(this.column, group ? 'sortGroup' : 'sort', ctx);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    for(const addon of this.addons) {\r\n      this.node.insertAdjacentHTML('beforeend', `<strong>${addon.title}</strong>`);\r\n      addon.append(this.column, this.node, this.dialog, this.ctx);\r\n    }\r\n\r\n    sortOrder(node, this.column, this.dialog.idPrefix, this.group);\r\n  }\r\n}\r\n\r\nfunction sortOrder(node: HTMLElement, column: Column, idPrefix: string, groupSortBy: boolean = false) {\r\n  const ranking = column.findMyRanker()!;\r\n  const current = groupSortBy  ? ranking.getGroupSortCriteria() : ranking.getSortCriteria();\r\n  const order = Object.assign({}, groupSortBy ? column.isGroupSortedByMe() : column.isSortedByMe());\r\n\r\n  if (order.priority === undefined) {\r\n    order.priority = current.length;\r\n  }\r\n\r\n  const id = uniqueId(idPrefix);\r\n  node.insertAdjacentHTML('afterbegin', `\r\n        <strong>Sort Order</strong>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}B\" type=\"radio\" name=\"sortorder\" value=\"asc\"  ${(order.asc === 'asc') ? 'checked' : ''} ><label for=\"${id}B\">Ascending</label></div>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}D\" type=\"radio\" name=\"sortorder\" value=\"desc\"  ${(order.asc === 'desc') ? 'checked' : ''} ><label for=\"${id}D\">Decending</label></div>\r\n        <div class=\"lu-checkbox\"><input id=\"${id}N\" type=\"radio\" name=\"sortorder\" value=\"none\"  ${(order.asc === undefined) ? 'checked' : ''} ><label for=\"${id}N\">Unsorted</label></div>\r\n        <strong>Sort Priority</strong>\r\n        <input type=\"number\" id=\"${id}P\" step=\"1\" min=\"1\" max=\"${current.length + 1}\" value=\"${order.priority + 1}\">\r\n    `);\r\n\r\n  const updateDisabled = (disable: boolean) => {\r\n    forEach(node, 'input:not([name=sortorder]), select, textarea', (d: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement) => {\r\n      d.disabled = disable;\r\n    });\r\n  };\r\n  updateDisabled(order.asc === undefined);\r\n\r\n  const trigger = () => {\r\n    if (groupSortBy) {\r\n      ranking.groupSortBy(column, order.asc === 'asc', order.asc === undefined ? -1 : order.priority);\r\n    } else {\r\n      ranking.sortBy(column, order.asc === 'asc', order.asc === undefined ? -1 : order.priority);\r\n    }\r\n\r\n    updateDisabled(order.asc === undefined);\r\n  };\r\n\r\n  forEach(node, 'input[name=sortorder]', (n: HTMLInputElement) => {\r\n    n.addEventListener('change', () => {\r\n      order.asc = n.value === 'none' ? undefined : <'asc'|'desc'>n.value;\r\n      trigger();\r\n    }, {\r\n      passive: true\r\n    });\r\n  });\r\n  {\r\n    const priority = (<HTMLInputElement>node.querySelector(`#${id}P`));\r\n    priority.addEventListener('change', () => {\r\n      order.priority = parseInt(priority.value, 10) - 1;\r\n      trigger();\r\n    }, {\r\n      passive: true\r\n    });\r\n  }\r\n}\r\n","import colors from \"../colors.js\";\n\nexport default colors(\"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666\");\n","import colors from \"../colors.js\";\n\nexport default colors(\"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666\");\n","import colors from \"../colors.js\";\n\nexport default colors(\"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2\");\n","import colors from \"../colors.js\";\n\nexport default colors(\"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc\");\n","import colors from \"../colors.js\";\n\nexport default colors(\"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999\");\n","import colors from \"../colors.js\";\n\nexport default colors(\"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3\");\n","import colors from \"../colors.js\";\n\nexport default colors(\"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f\");\n","import ADialog from './ADialog';\r\nimport {IDialogContext} from './ADialog';\r\nimport {schemeCategory10, schemeSet1, schemeSet2, schemeSet3, schemeAccent, schemeDark2, schemePastel2, schemePastel1} from 'd3-scale-chromatic';\r\nimport {round, fixCSS} from '../../internal';\r\nimport {uniqueId} from '../../renderer/utils';\r\nimport {sequentialColors, divergentColors, createColorMappingFunction, lookupInterpolatingColor, QuantizedColorFunction, asColorFunction, CustomColorMappingFunction} from '../../model/ColorMappingFunction';\r\nimport Column, {IMapAbleColumn} from '../../model';\r\n\r\n/** @internal */\r\nexport default class ColorMappingDialog extends ADialog {\r\n  constructor(private readonly column: IMapAbleColumn, dialog: IDialogContext) {\r\n    super(dialog);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-dialog-color');\r\n    const id = uniqueId('col');\r\n\r\n    const current = this.column.getColorMapping();\r\n    const entries = current.type === 'custom' ? current.entries : [];\r\n\r\n    let h = '';\r\n    h += `<datalist id=\"${id}L\">${schemeCategory10.map((d) => `<option>${d}\"</option>`).join('')}</datalist>`;\r\n    h += `<datalist id=\"${id}LW\"><option>#FFFFFF\"</option>${schemeCategory10.slice(0, -1).map((d) => `<option>${d}</option>`).join('')}</datalist>`;\r\n\r\n    h += `<strong>Quantization</strong>\r\n    <div class=\"lu-checkbox\">\r\n      <input id=\"${id}KC\" name=\"kind\" type=\"radio\" value=\"continuous\" ${current.type !== 'quantized' ? 'checked': ''}>\r\n      <label for=\"${id}CK\">Continuous</label>\r\n    </div>\r\n    <div class=\"lu-checkbox\">\r\n      <input id=\"${id}KQ\" name=\"kind\" type=\"radio\" value=\"quantized\" ${current.type === 'quantized' ? 'checked': ''}>\r\n      <label for=\"${id}KQ\"><input type=\"number\" id=\"${id}KQS\" min=\"2\" step=\"1\" value=\"${current.type === 'quantized' ? current.steps : 5}\">&nbsp; steps</label>\r\n    </div>`;\r\n\r\n    h += `<strong data-toggle=\"${current.type === 'solid' ? 'open' : ''}\">Solid Color</strong>`;\r\n    h += `<div>`;\r\n    {\r\n      const refColor = current.type === 'solid' ? current.color : '';\r\n      let has = false;\r\n      const colorsets = [schemeCategory10, schemeAccent, schemeDark2, schemePastel1, schemePastel2, schemeSet1, schemeSet2, schemeSet3];\r\n      for (const colors of colorsets) {\r\n        has = has || colors.includes(refColor);\r\n        h += `<div class=\"lu-color-line\">\r\n          ${colors.map((d) => `<div class=\"lu-checkbox-color\">\r\n              <input id=\"${id}${fixCSS(d)}\" name=\"color\" type=\"radio\" value=\"${d}\" ${d === refColor ? 'checked=\"checked\"': ''}>\r\n              <label for=\"${id}${fixCSS(d)}\" style=\"background: ${d}\"></label>\r\n            </div>`).join('')}\r\n        </div>`;\r\n      }\r\n      h += `<div class=\"lu-checkbox\"><input id=\"${id}O\" name=\"color\" type=\"radio\" value=\"custom:solid\" ${refColor && !has ? 'checked=\"checked\"' : ''}>\r\n        <label for=\"${id}O\"><input type=\"color\" name=\"solid\" list=\"${id}L\" value=\"${current.type === 'solid' ? current.color : Column.DEFAULT_COLOR}\" ${refColor && !has ? '' : 'disabled'}></label>\r\n      </div>`;\r\n    }\r\n    h += '</div>';\r\n\r\n    h += `<strong data-toggle=\"${current.type === 'sequential' || (current.type === 'custom' && entries.length === 2) ? 'open' : ''}\">Sequential Color</strong>`;\r\n    h += '<div>';\r\n    {\r\n      const name = current.type === 'sequential' ? current.name : '';\r\n      for (const colors of sequentialColors) {\r\n        h += `<div class=\"lu-checkbox lu-color-gradient\"><input id=\"${id}${colors.name}\" name=\"color\" type=\"radio\" value=\"${colors.name}\" ${colors.name === name ? 'checked=\"checked\"' : ''}>\r\n        <label for=\"${id}${colors.name}\" data-c=\"${colors.name}\" style=\"background: ${gradient(colors.apply, 9)}\"></label>\r\n      </div>`;\r\n      }\r\n      const isCustom = entries.length === 2;\r\n      h += `<div class=\"lu-checkbox lu-color-gradient\">\r\n        <input id=\"${id}S\" name=\"color\" type=\"radio\" value=\"custom:sequential\" ${isCustom ? 'checked': ''}>\r\n        <label for=\"${id}S\" class=\"lu-color-custom\">\r\n          <input type=\"color\" name=\"interpolate0\" list=\"${id}LW\" ${!isCustom ? 'disabled': `value=\"${entries[0].color}\"`}>\r\n          <input type=\"color\" name=\"interpolate1\" list=\"${id}LW\" ${!isCustom ? 'disabled': `value=\"${entries[entries.length - 1].color}\"`}>\r\n        </label>\r\n      </div>`;\r\n    }\r\n    h += '</div>';\r\n    h += `<strong data-toggle=\"${current.type === 'divergent' || (current.type === 'custom' && entries.length === 3) ? 'open' : ''}\">Diverging Color</strong>`;\r\n    h += '<div>';\r\n    {\r\n      const name = current.type === 'sequential' ? current.name : '';\r\n      for (const colors of divergentColors) {\r\n        h += `<div class=\"lu-checkbox lu-color-gradient\"><input id=\"${id}${colors.name}\" name=\"color\" type=\"radio\" value=\"${colors.name}\" ${colors.name === name ? 'checked=\"checked\"' : ''}>\r\n        <label for=\"${id}${colors.name}\" data-c=\"${colors.name}\" style=\"background: ${gradient(colors.apply, 11)}\"></label>\r\n      </div>`;\r\n      }\r\n      const isCustom = entries.length === 3;\r\n      h += `<div class=\"lu-checkbox lu-color-gradient\"><input id=\"${id}D\" name=\"color\" type=\"radio\" value=\"custom:divergent\" ${isCustom ? 'checked': ''}>\r\n        <label for=\"${id}D\" class=\"lu-color-custom\">\r\n          <input type=\"color\" name=\"divergingm1\" list=\"${id}L\" ${!isCustom ? 'disabled': `value=\"${entries[0].color}\"`}>\r\n          <input type=\"color\" name=\"diverging0\" list=\"${id}LW\" ${!isCustom ? 'disabled': `value=\"${entries[1].color}\"`}>\r\n          <input type=\"color\" name=\"diverging1\" list=\"${id}L\" ${!isCustom ? 'disabled': `value=\"${entries[2].color}\"`}>\r\n          </label>\r\n      </div>`;\r\n    }\r\n    h += '</div>';\r\n\r\n    node.insertAdjacentHTML('beforeend', h);\r\n\r\n    this.interactive(node, id);\r\n  }\r\n\r\n  private interactive(node: HTMLElement, id: string) {\r\n    const continuouos = this.findInput(`#${id}KC`);\r\n    const quantized = this.findInput(`#${id}KQ`);\r\n    const steps = this.findInput(`#${id}KQS`);\r\n    const toggles = <HTMLElement[]>Array.from(node.querySelectorAll('strong[data-toggle]'));\r\n\r\n    continuouos.onchange = () => {\r\n      if (continuouos.checked) {\r\n        this.updateGradients(-1);\r\n      }\r\n    };\r\n    quantized.onchange = steps.onchange = () => {\r\n      if (!quantized.checked) {\r\n        this.updateGradients(-1);\r\n        return;\r\n      }\r\n      if (toggles[0].dataset.toggle === 'open') {\r\n        // auto open sequential\r\n        toggles[0].dataset.toggle = '';\r\n        toggles[1].dataset.toggle = 'open';\r\n      }\r\n      this.updateGradients(parseInt(steps.value, 10));\r\n    };\r\n\r\n    for (const toggle of toggles) {\r\n      toggle.onclick = (evt) => {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        for (const t2 of toggles) {\r\n          t2.dataset.toggle = t2.dataset.toggle === 'open' || toggle !== t2 ? '' : 'open';\r\n        }\r\n      };\r\n    }\r\n\r\n    const customs: HTMLElement[] = [];\r\n\r\n    const toColor = (input: HTMLInputElement) => {\r\n      switch (input.value) {\r\n        case 'custom:solid':\r\n          return asColorFunction((<HTMLInputElement>node.querySelector('input[name=solid]')!).value);\r\n        case 'custom:sequential':\r\n          const s0 = (<HTMLInputElement>node.querySelector('input[name=interpolate0]')!).value;\r\n          const s1 = (<HTMLInputElement>node.querySelector('input[name=interpolate1]')!).value;\r\n          return new CustomColorMappingFunction([{color: s0, value: 0}, {color: s1, value: 1}]);\r\n        case 'custom:diverging':\r\n          const dm1 = (<HTMLInputElement>node.querySelector('input[name=divergentm1]')!).value;\r\n          const d0 = (<HTMLInputElement>node.querySelector('input[name=divergent0]')!).value;\r\n          const d1 = (<HTMLInputElement>node.querySelector('input[name=divergent1]')!).value;\r\n          return new CustomColorMappingFunction([{color: dm1, value: 0}, {color: d0, value: 0.5}, {color: d1, value: 1}]);\r\n      }\r\n      return createColorMappingFunction(input.value);\r\n    };\r\n\r\n    this.forEach('input[name=color]', (d: HTMLInputElement) => {\r\n      if (d.value.startsWith('custom:')) {\r\n        customs.push(d);\r\n      }\r\n      d.onchange = () => {\r\n        if (!d.checked) {\r\n          return;\r\n        }\r\n        // disable customs\r\n        for (const custom of customs) {\r\n          Array.from(custom.nextElementSibling!.querySelectorAll('input')).forEach((s) => s.disabled = custom !== d);\r\n        }\r\n        const base = toColor(d);\r\n        if (quantized.checked && base.type !== 'solid') {\r\n          this.column.setColorMapping(new QuantizedColorFunction(base, parseInt(steps.value, 10)));\r\n        } else {\r\n          this.column.setColorMapping(base);\r\n        }\r\n      };\r\n    });\r\n\r\n    // upon changing custom parameter trigger an update\r\n    this.forEach('label > input[type=color]', (d: HTMLInputElement) => {\r\n      d.onchange = () => {\r\n        const item = (<HTMLInputElement>d.parentElement!.previousElementSibling!);\r\n        item.onchange!.call(item, null);\r\n      };\r\n    });\r\n  }\r\n\r\n  private updateGradients(steps: number) {\r\n    this.forEach(`label[data-c]`, (d: HTMLElement) => {\r\n      const f = lookupInterpolatingColor.get(d.dataset.c!)!;\r\n      d.style.background = steps < 0 ? gradient(f.apply, f.type === 'sequential' ? 9 : 11) : steppedGradient(f.apply, steps);\r\n    });\r\n  }\r\n}\r\n\r\nfunction gradient(interpolate: (v: number)=>string, steps = 2) {\r\n  if (steps <= 1) {\r\n    return `${interpolate(0)}`;\r\n  }\r\n  const stepSize = 1 / (steps - 1);\r\n  let r = `linear-gradient(to right`;\r\n  for (let i = 0; i < steps; ++i) {\r\n    r += `, ${interpolate(i * stepSize)} ${round((i * stepSize) * 100, 2)}%`;\r\n  }\r\n  r += ')';\r\n  return r;\r\n}\r\n\r\nfunction steppedGradient(color: (v: number)=>string, count = 2) {\r\n  if (count === 1) {\r\n    return `${color(0)}`;\r\n  }\r\n  let r = `linear-gradient(to right`;\r\n  const stepSize = 1 / count;\r\n  const half = stepSize / 2;\r\n  for (let i = 0; i < count; ++i) {\r\n    // stepped\r\n    // first and last at border else center\r\n    const shift = i === 0 ? 0 : (i === (count - 1) ? stepSize : half);\r\n    const c = color(i * stepSize + shift);\r\n    r += `, ${c} ${round((i * stepSize) * 100, 2)}%, ${c} ${round(((i + 1) * stepSize) * 100, 2)}%`;\r\n  }\r\n  r += ')';\r\n  return r;\r\n}\r\n","import {round, similar} from '../../internal/math';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {dragHandle, IDragHandleOptions} from '../../internal/drag';\r\n\r\nfunction clamp(v: number) {\r\n  return Math.max(Math.min(v, 100), 0);\r\n}\r\n\r\n/** @internal */\r\nexport interface IMappingAdapter {\r\n  destroyed(self: MappingLine): void;\r\n\r\n  updated(self: MappingLine): void;\r\n\r\n  domain(): number[];\r\n\r\n  normalizeRaw(v: number): number;\r\n\r\n  unnormalizeRaw(v: number): number;\r\n\r\n  dialog: IDialogContext;\r\n}\r\n\r\n/** @internal */\r\nexport default class MappingLineDialog extends ADialog {\r\n  constructor(private readonly line: {destroy(): void, domain: number, range: number, frozen: boolean, update(domain: number, range: number): void}, dialog: IDialogContext, private readonly adapter: IMappingAdapter) {\r\n    super(dialog);\r\n  }\r\n\r\n  build(node: HTMLElement) {\r\n    const domain = this.adapter.domain();\r\n    node.insertAdjacentHTML('beforeend', `\r\n        <strong>Input Domain Value (min ... max)</strong>\r\n        <input type=\"number\" value=\"${round(this.adapter.unnormalizeRaw(this.line.domain), 3)}\" ${this.line.frozen ? 'readonly' : ''} autofocus required min=\"${domain[0]}\" max=\"${domain[1]}\" step=\"any\">\r\n        <strong>Output Normalized Value (0 ... 1)</strong>\r\n        <input type=\"number\" value=\"${round(this.line.range / 100, 3)}\" required min=\"0\" max=\"1\" step=\"any\">\r\n        <button type=\"button\" ${this.line.frozen ? 'disabled' : ''} >Remove Mapping Line</button>\r\n      `);\r\n\r\n    this.forEach('input', (d: HTMLInputElement) => d.onchange = () => this.submit());\r\n    this.find('button').addEventListener('click', () => {\r\n      this.destroy();\r\n      this.line.destroy();\r\n    }, {\r\n      passive: true\r\n    });\r\n  }\r\n\r\n  protected submit() {\r\n    if (!this.node.checkValidity()) {\r\n      return false;\r\n    }\r\n    const domain = this.adapter.normalizeRaw(parseFloat(this.findInput('input[type=number]').value));\r\n    const range = parseFloat(this.findInput('input[type=number]:last-of-type').value) * 100;\r\n    this.line.update(domain, range);\r\n    return true;\r\n  }\r\n}\r\n\r\n/** @internal */\r\nexport class MappingLine {\r\n  readonly node: SVGGElement;\r\n\r\n  constructor(g: SVGGElement, public domain: number, public range: number, private readonly adapter: IMappingAdapter) {\r\n    g.insertAdjacentHTML('beforeend', `<g class=\"lu-mapping\" transform=\"translate(${domain},0)\">\r\n      <line x1=\"0\" x2=\"${range - domain}\" y2=\"60\"></line>\r\n      <line x1=\"0\" x2=\"${range - domain}\" y2=\"60\"></line>\r\n      <circle r=\"3\"></circle>\r\n      <circle cx=\"${range - domain}\" cy=\"60\" r=\"3\"></circle>\r\n      <title>Drag the anchor circle to change the mapping, shift click to edit</title>\r\n    </g>`);\r\n    this.node = <SVGGElement>g.lastElementChild!;\r\n\r\n    // freeze 0 and 100 domain = raw domain ones\r\n    this.node.classList.toggle('lu-frozen', similar(0, domain) || similar(domain, 100));\r\n    {\r\n      let beforeDomain: number;\r\n      let beforeRange: number;\r\n      let shiftDomain: number;\r\n      let shiftRange: number;\r\n\r\n      const normalize = (x: number) => x * 100 / g.getBoundingClientRect().width;\r\n\r\n      const common: Partial<IDragHandleOptions> =  {\r\n        container: g.parentElement!,\r\n        filter: (evt) => evt.button === 0 && !evt.shiftKey,\r\n        onStart: (_, x) => {\r\n          beforeDomain = this.domain;\r\n          beforeRange = this.range;\r\n          const normalized = normalize(x);\r\n          shiftDomain = this.domain - normalized;\r\n          shiftRange = this.range - normalized;\r\n        } ,\r\n        onEnd: () => {\r\n          if (!similar(beforeDomain, this.domain) || !similar(beforeRange, this.range)) {\r\n            this.adapter.updated(this);\r\n          }\r\n        }\r\n      };\r\n\r\n      const line = this.node.querySelector<SVGLineElement>('line:first-of-type')!;\r\n      dragHandle(line, { // line\r\n        ...common,\r\n        onDrag: (_, x) => {\r\n          const normalized = normalize(x);\r\n          this.update(clamp(normalized + shiftDomain), clamp(normalized + shiftRange));\r\n        },\r\n      });\r\n\r\n      const domainCircle = this.node.querySelector<SVGLineElement>('circle:first-of-type')!;\r\n      dragHandle(domainCircle, {\r\n        ...common,\r\n        onDrag: (_, x) => {\r\n          const normalized = normalize(x);\r\n          this.update(clamp(normalized), this.range);\r\n        },\r\n      });\r\n      const rangeCircle = this.node.querySelector<SVGLineElement>('circle:last-of-type')!;\r\n      dragHandle(rangeCircle, {\r\n        ...common,\r\n        onDrag: (_, x) => {\r\n          const normalized = normalize(x);\r\n          this.update(this.domain, clamp(normalized));\r\n        },\r\n      });\r\n    }\r\n\r\n    this.node.onclick = (evt) => {\r\n      if (!evt.shiftKey) {\r\n        return;\r\n      }\r\n      const ctx = {\r\n        manager: this.adapter.dialog.manager,\r\n        level: this.adapter.dialog.level + 1,\r\n        attachment: <any>this.node,\r\n        idPrefix: this.adapter.dialog.idPrefix\r\n      };\r\n      const dialog = new MappingLineDialog(this, ctx, this.adapter);\r\n      dialog.open();\r\n    };\r\n  }\r\n\r\n  get frozen() {\r\n    return this.node.classList.contains('lu-frozen');\r\n  }\r\n\r\n  destroy() {\r\n    this.node.remove();\r\n    this.adapter.destroyed(this);\r\n  }\r\n\r\n  update(domain: number, range: number) {\r\n    if (similar(domain, this.domain) && similar(range, this.range)) {\r\n      return;\r\n    }\r\n    if (this.frozen) {\r\n      domain = this.domain;\r\n    }\r\n    this.domain = domain;\r\n    this.range = range;\r\n    this.node.setAttribute('transform', `translate(${domain},0)`);\r\n    const shift = range - domain;\r\n    Array.from(this.node.querySelectorAll<SVGLineElement>('line')).forEach((d) => d.setAttribute('x2', String(shift)));\r\n    this.node.querySelector<SVGCircleElement>('circle[cx]')!.setAttribute('cx', String(shift));\r\n  }\r\n}\r\n","import {round} from '../../internal';\r\nimport {\r\n  IMapAbleColumn, IMappingFunction, isMissingValue, ScaleMappingFunction,\r\n  ScriptMappingFunction,\r\n  isMapAbleColumn\r\n} from '../../model';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {IMappingAdapter, MappingLine} from './MappingLineDialog';\r\n\r\n/** @internal */\r\nexport default class MappingDialog extends ADialog {\r\n\r\n  private scale: IMappingFunction;\r\n\r\n  private readonly mappingLines: MappingLine[] = [];\r\n  private rawDomain: [number, number];\r\n\r\n  private readonly data: Promise<number[]>;\r\n  private readonly idPrefix: string;\r\n  private loadedData: number[] | null = null;\r\n\r\n  private readonly mappingAdapter: IMappingAdapter = {\r\n    destroyed: (self: MappingLine) => {\r\n      this.mappingLines.splice(this.mappingLines.indexOf(self), 1);\r\n    },\r\n    updated: () => this.updateLines(this.computeScale()),\r\n    domain: () => this.rawDomain,\r\n    normalizeRaw: this.normalizeRaw.bind(this),\r\n    unnormalizeRaw: this.unnormalizeRaw.bind(this),\r\n    dialog: this.dialog\r\n  };\r\n\r\n  constructor(private readonly column: IMapAbleColumn, dialog: IDialogContext, ctx: IRankingHeaderContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n\r\n    this.idPrefix = `me${ctx.idPrefix}`;\r\n    this.scale = this.column.getMapping().clone();\r\n    const domain = this.scale.domain;\r\n    this.rawDomain = [domain[0], domain[domain.length - 1]];\r\n\r\n    this.data = Promise.resolve(ctx.provider.mappingSample(column));\r\n  }\r\n\r\n  private get scaleType() {\r\n    if (!(this.scale instanceof ScaleMappingFunction)) {\r\n      return 'script';\r\n    }\r\n    const base = this.scale.scaleType;\r\n    if (base !== 'linear') {\r\n      return base;\r\n    }\r\n    // check if invert or absolute\r\n    const r = this.scale.range;\r\n    if (r.length === 2 && r[0] === 1 && r[1] === 0) {\r\n      return 'linear_invert';\r\n    }\r\n    if (r.length === 3 && r[0] === 1 && r[1] === 0 && r[2] === 1) {\r\n      return 'linear_abs';\r\n    }\r\n    return 'linear';\r\n  }\r\n\r\n  build(node: HTMLElement) {\r\n    node.classList.add('lu-dialog-mapper');\r\n\r\n    const r = this.column.findMyRanker();\r\n    const others = !r ? [] : r.flatColumns.filter((d) => isMapAbleColumn(d) && d !== this.column);\r\n\r\n    node.insertAdjacentHTML('beforeend', `\r\n        <div><label for=\"${this.idPrefix}mapping_type\"><strong>Normalization Scaling:</strong></label><select id=\"${this.idPrefix}mapping_type\" class=\"browser-default\">\r\n        <option value=\"linear\">Linear</option>\r\n        <option value=\"linear_invert\">Invert</option>\r\n        <option value=\"linear_abs\">Absolute</option>\r\n        <option value=\"log\">Log</option>\r\n        <option value=\"pow1.1\">Pow 1.1</option>\r\n        <option value=\"pow2\">Pow 2</option>\r\n        <option value=\"pow3\">Pow 3</option>\r\n        <option value=\"sqrt\">Sqrt</option>\r\n        <option value=\"script\">Custom Script</option>\r\n        ${others.length > 0 ? `<optgroup label=\"Copy From\">${others.map((d) => `<option value=\"copy_${d.id}\">${d.label}</option>`).join('')}</optgroup>`: ''}\r\n      </select>\r\n      </div>\r\n        <div class=\"lu-details\"><strong>Domain (min - max): </strong><input id=\"${this.idPrefix}min\" required type=\"number\" value=\"${round(this.rawDomain[0], 3)}\" step=\"any\"> - <input id=\"${this.idPrefix}max\" required type=\"number\" value=\"${round(this.rawDomain[1], 3)}\" step=\"any\"></div>\r\n        <strong class=\"lu-details\" style=\"text-align: center\">Input Domain (min - max)</strong>\r\n        <svg class=\"lu-details\" viewBox=\"0 0 106 66\">\r\n           <g transform=\"translate(3,3)\">\r\n              <line x2=\"100\"></line>\r\n              <rect y=\"-3\" width=\"100\" height=\"10\"></rect>\r\n              <line y1=\"60\" x2=\"100\" y2=\"60\"></line>\r\n              <rect y=\"36\" width=\"100\" height=\"10\"></rect>\r\n           </g>\r\n        </svg>\r\n        <strong class=\"lu-details\" style=\"text-align: center; margin-top: 0\">Output Normalized Domain (0 - 1)</strong>\r\n        <div class=\"lu-script\">\r\n          <strong>Custom Normalization Script</strong>\r\n          <textarea></textarea>\r\n        </div>`);\r\n\r\n    const g = <SVGGElement>node.querySelector('.lu-details > g');\r\n\r\n    this.forEach('.lu-details rect', (d: SVGRectElement) => d.onclick = (evt) => {\r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n      const bb = d.getBoundingClientRect();\r\n      const x = round((evt.x - bb.left) * 100 / bb.width, 2);\r\n      const m = new MappingLine(g, x, x, this.mappingAdapter);\r\n      this.mappingLines.push(m);\r\n    });\r\n\r\n    {\r\n\r\n      const select = <HTMLSelectElement>this.find('select');\r\n      const textarea = <HTMLTextAreaElement>this.find('textarea');\r\n      select.onchange = (evt) => {\r\n        const select = <HTMLSelectElement>evt.currentTarget;\r\n        switch (select.value) {\r\n          case 'linear_invert':\r\n            this.scale = new ScaleMappingFunction(this.rawDomain.slice(), 'linear', [1, 0]);\r\n            break;\r\n          case 'linear_abs':\r\n            this.scale = new ScaleMappingFunction([this.rawDomain[0], (this.rawDomain[1] - this.rawDomain[0]) / 2, this.rawDomain[1]], 'linear', [1, 0, 1]);\r\n            break;\r\n          case 'script':\r\n            const s = new ScriptMappingFunction(this.rawDomain.slice());\r\n            this.scale = s;\r\n            textarea.value = s.code;\r\n            break;\r\n          default:\r\n            if (select.value.startsWith('copy_')) {\r\n              this.copyMapping(select.value.slice('copy_'.length));\r\n              return;\r\n            }\r\n            this.scale = new ScaleMappingFunction(this.rawDomain.slice(), select.value);\r\n            break;\r\n        }\r\n        this.createMappings();\r\n        node.dataset.scale = select.value;\r\n        this.updateLines();\r\n      };\r\n      const scaleType = node.dataset.scale = this.scaleType;\r\n      select.selectedIndex = Array.from(select.options).findIndex((d) => d.value === scaleType);\r\n\r\n      if (scaleType === 'script') {\r\n        textarea.value = (<ScriptMappingFunction>this.scale).code;\r\n      }\r\n      this.createMappings();\r\n    }\r\n\r\n    {\r\n      this.forEach('.lu-details input[type=number]', (d: HTMLInputElement, i) => d.onchange = () => {\r\n        const v = parseFloat(d.value);\r\n        if (v === this.rawDomain[i]) {\r\n          d.setCustomValidity('');\r\n          return;\r\n        }\r\n        const other = this.rawDomain[1 - i];\r\n        if (isNaN(v) || (i === 0 && v >= other) || (i === 1 && v <= other)) {\r\n          d.setCustomValidity(`value has to be ${i === 0 ? '<= max' : '>= min'}`);\r\n          return;\r\n        }\r\n        d.setCustomValidity('');\r\n        this.rawDomain[i] = v;\r\n        this.scale.domain = this.rawDomain.slice();\r\n\r\n        if (!this.loadedData) {\r\n          return;\r\n        }\r\n        this.applyMapping(this.scale);\r\n        this.updateLines();\r\n      });\r\n    }\r\n\r\n    this.data.then((values) => {\r\n      this.loadedData = values;\r\n\r\n      Array.from(values).forEach((v) => {\r\n        if (!isMissingValue(v)) {\r\n          g.insertAdjacentHTML('afterbegin', `<line data-v=\"${v}\" x1=\"${round(this.normalizeRaw(v), 2)}\" x2=\"${round(this.scale.apply(v) * 100, 2)}\" y2=\"60\"></line>`);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private createMappings() {\r\n    this.mappingLines.splice(0, this.mappingLines.length).forEach((d) => d.destroy());\r\n    if (!(this.scale instanceof ScaleMappingFunction)) {\r\n      return;\r\n    }\r\n    const g = <SVGGElement>this.node.querySelector('.lu-details > g');\r\n    const domain = this.scale.domain;\r\n    const range = this.scale.range;\r\n    this.mappingLines.push(...domain.map((d, i) => new MappingLine(g, this.normalizeRaw(d), range[i] * 100, this.mappingAdapter)));\r\n  }\r\n\r\n  private update() {\r\n    const scaleType = this.node.dataset.scale = this.scaleType;\r\n    const select = <HTMLSelectElement>this.find('select');\r\n    select.selectedIndex = Array.from(select.options).findIndex((d) => d.value === scaleType);\r\n    if (scaleType === 'script') {\r\n      (<HTMLTextAreaElement>this.find('textarea')).value = (<ScriptMappingFunction>this.scale).code;\r\n    }\r\n    const domain = this.scale.domain;\r\n    this.forEach('.lu-details input[type=number]', (d: HTMLInputElement, i) => {\r\n      d.value = String(domain[i]);\r\n    });\r\n  }\r\n\r\n  private updateLines(scale = this.scale) {\r\n    this.forEach('.lu-details > g > line[x1]', (d: SVGLineElement) => {\r\n      const v = parseFloat(d.getAttribute('data-v')!);\r\n      d.setAttribute('x1', round(this.normalizeRaw(v), 2).toString());\r\n      d.setAttribute('x2', round(scale.apply(v) * 100, 2).toString());\r\n    });\r\n  }\r\n\r\n  private applyMapping(newScale: IMappingFunction) {\r\n    this.column.setMapping(newScale);\r\n  }\r\n\r\n  protected reset() {\r\n    this.scale = this.column.getOriginalMapping();\r\n    this.rawDomain = <[number, number]>this.scale.domain.slice();\r\n    this.applyMapping(this.scale);\r\n    this.update();\r\n    this.updateLines();\r\n    this.createMappings();\r\n  }\r\n\r\n  private copyMapping(columnId: string) {\r\n    const r = this.column.findMyRanker();\r\n    if (!r) {\r\n      return;\r\n    }\r\n    const ref = <IMapAbleColumn>r.find(columnId)!;\r\n    this.scale = ref.getMapping().clone();\r\n    this.rawDomain = <[number, number]>this.scale.domain.slice();\r\n    this.applyMapping(this.scale);\r\n    this.update();\r\n    this.updateLines();\r\n  }\r\n\r\n  private normalizeRaw(d: number) {\r\n    const v = (d - this.rawDomain[0]) * 100 / (this.rawDomain[1] - this.rawDomain[0]);\r\n    return Math.max(Math.min(v, 100), 0); // clamp\r\n  }\r\n\r\n  private unnormalizeRaw(d: number) {\r\n    return (d) * (this.rawDomain[1] - this.rawDomain[0]) / 100 + this.rawDomain[0];\r\n  }\r\n\r\n  private computeScale() {\r\n    const s = this.scale.clone();\r\n    if (this.scaleType === 'script') {\r\n      (<ScriptMappingFunction>s).code = this.node.querySelector('textarea')!.value;\r\n      s.domain = this.rawDomain.slice();\r\n    }\r\n    if (s instanceof ScaleMappingFunction) {\r\n      this.mappingLines.sort((a, b) => a.domain - b.domain);\r\n      s.domain = this.mappingLines.map((d) => this.unnormalizeRaw(d.domain));\r\n      s.range = this.mappingLines.map((d) => d.range / 100);\r\n    }\r\n    return s;\r\n  }\r\n\r\n  protected submit() {\r\n    if (!this.node.checkValidity()) {\r\n      return false;\r\n    }\r\n    if (this.scaleType === 'script') {\r\n      (<ScriptMappingFunction>this.scale).code = this.node.querySelector('textarea')!.value;\r\n      this.scale.domain = this.rawDomain.slice();\r\n    }\r\n    if (this.scale instanceof ScaleMappingFunction) {\r\n      this.mappingLines.sort((a, b) => a.domain - b.domain);\r\n      this.scale.domain = this.mappingLines.map((d) => this.unnormalizeRaw(d.domain));\r\n      this.scale.range = this.mappingLines.map((d) => d.range / 100);\r\n    }\r\n    this.applyMapping(this.scale);\r\n    return true;\r\n  }\r\n}\r\n","import {filterMissingMarkup, findFilterMissing} from '../missing';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {updateFilterState, uniqueId} from './utils';\r\nimport DateColumn from '../../model/DateColumn';\r\nimport {IDateFilter, isDummyDateFilter, noDateFilter} from '../../model/IDateColumn';\r\nimport {timeFormat} from 'd3-time-format';\r\n\r\n/** @internal */\r\nexport default class DateFilterDialog extends ADialog {\r\n\r\n  constructor(private readonly column: DateColumn, dialog: IDialogContext) {\r\n    super(dialog);\r\n  }\r\n\r\n  private updateFilter(filter: IDateFilter | null) {\r\n    updateFilterState(this.attachment, this.column, filter != null && !isDummyDateFilter(filter));\r\n    this.column.setFilter(filter != null ? filter : undefined);\r\n  }\r\n\r\n  reset() {\r\n    this.forEach('input[type=date]', (n: HTMLInputElement) => n.value = '');\r\n    this.forEach('input[type=checkbox]', (n: HTMLInputElement) => n.checked = false);\r\n    this.updateFilter(null);\r\n  }\r\n\r\n  submit() {\r\n    const filterMissing = findFilterMissing(this.node).checked;\r\n    const from: Date | null = this.findInput('input[name=\"from\"]').valueAsDate;\r\n    const to: Date | null = this.findInput('input[name=\"to\"]').valueAsDate;\r\n    this.updateFilter({filterMissing, min: from == null ? -Infinity : from.getTime(), max: to == null ? +Infinity : to.getTime()});\r\n    return true;\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const act = this.column.getFilter() || noDateFilter();\r\n    const id = uniqueId(this.dialog.idPrefix);\r\n\r\n    const f = timeFormat('%Y-%m-%d');\r\n\r\n    node.insertAdjacentHTML('beforeend', `\r\n    <label for=\"${id}F\">From: </label>\r\n    <input type=\"date\" id=\"${id}F\" name=\"from\" placeholder=\"From...\" autofocus value=\"${isFinite(act.min) ? f(new Date(act.min)) : ''}\">\r\n    <label for=\"${id}T\">To: </label>\r\n    <input type=\"date\" id=\"${id}T\" name=\"to\" placeholder=\"To...\" value=\"${isFinite(act.max) ? f(new Date(act.max)) : ''}\">\r\n    ${filterMissingMarkup(act.filterMissing, this.dialog.idPrefix)}`);\r\n\r\n    const update = () => {\r\n      this.submit();\r\n    };\r\n\r\n    this.forEach('input', (n: HTMLInputElement) => n.onchange = update);\r\n  }\r\n}\r\n","import {getAllToolbarActions, isSupportType, getAllToolbarDialogAddons, isSortingAscByDefault} from '../model/annotations';\r\nimport Column from '../model/Column';\r\nimport CompositeColumn, {IMultiLevelColumn} from '../model/CompositeColumn';\r\nimport ADialog, {IDialogContext} from './dialogs/ADialog';\r\nimport ChangeRendererDialog from './dialogs/ChangeRendererDialog';\r\nimport RenameDialog from './dialogs/RenameDialog';\r\nimport BooleanFilterDialog from './dialogs/BooleanFilterDialog';\r\nimport CategoricalFilterDialog from './dialogs/CategoricalFilterDialog';\r\nimport CategoricalMappingFilterDialog from './dialogs/CategoricalMappingFilterDialog';\r\nimport CompositeChildrenDialog from './dialogs/CompositeChildrenDialog';\r\nimport CutOffHierarchyDialog from './dialogs/CutOffHierarchyDialog';\r\nimport EditPatternDialog from './dialogs/EditPatternDialog';\r\nimport NumberFilterDialog from './dialogs/NumberFilterDialog';\r\nimport ReduceDialog from './dialogs/ReduceDialog';\r\nimport ScriptEditDialog from './dialogs/ScriptEditDialog';\r\nimport SearchDialog from './dialogs/SearchDialog';\r\nimport StringFilterDialog from './dialogs/StringFilterDialog';\r\nimport WeightsEditDialog from './dialogs/WeightsEditDialog';\r\nimport GroupDialog from './dialogs/GroupDialog';\r\nimport {sortMethods} from './dialogs/utils';\r\nimport {IRankingHeaderContext} from './interfaces';\r\nimport SortDialog from './dialogs/SortDialog';\r\nimport {EAdvancedSortMethod, ESortMethod} from '../model/INumberColumn';\r\nimport {EDateSort} from '../model/DatesColumn';\r\nimport appendNumber from './dialogs/groupNumber';\r\nimport appendString from './dialogs/groupString';\r\nimport appendDate from './dialogs/groupDate';\r\nimport ColorMappingDialog from './dialogs/ColorMappingDialog';\r\nimport MappingDialog from './dialogs/MappingDialog';\r\nimport DateFilterDialog from './dialogs/DateFilterDialog';\r\n\r\nexport interface IUIOptions {\r\n  shortcut: boolean|'only';\r\n  order: number;\r\n  featureLevel: 'basic' | 'advanced';\r\n  featureCategory: 'ranking' | 'model' | 'ui';\r\n}\r\n\r\nexport interface IMouseEvent {\r\n  stopPropagation(): void;\r\n  currentTarget: Element;\r\n  shiftKey: boolean;\r\n  altKey: boolean;\r\n  ctrlKey: boolean;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface IOnClickHandler {\r\n  (col: Column, evt: IMouseEvent, ctx: IRankingHeaderContext, level: number, viaShortcut: boolean): any;\r\n}\r\n\r\nexport interface IToolbarAction {\r\n  title: string;\r\n\r\n  onClick: IOnClickHandler;\r\n\r\n  options: Partial<IUIOptions>;\r\n}\r\n\r\nexport interface IToolbarDialogAddon {\r\n  title: string;\r\n\r\n  order: number;\r\n\r\n  append(col: Column, node: HTMLElement, dialog: IDialogContext, ctx: IRankingHeaderContext): void;\r\n}\r\n\r\nexport interface IDialogClass {\r\n  new(col: any, dialog: IDialogContext, ...args: any[]): ADialog;\r\n}\r\n\r\nfunction ui(title: string, onClick: IOnClickHandler, options: Partial<IUIOptions> = {}): IToolbarAction {\r\n  return { title, onClick, options };\r\n}\r\n\r\nexport function dialogContext(ctx: IRankingHeaderContext, level: number, evt: { currentTarget: Element }): IDialogContext {\r\n  return {\r\n    attachment: <HTMLElement>evt.currentTarget,\r\n    level,\r\n    manager: ctx.dialogManager,\r\n    idPrefix: ctx.idPrefix\r\n  };\r\n}\r\n\r\nfunction uiDialog(title: string, dialogClass: IDialogClass, extraArgs: ((ctx: IRankingHeaderContext) => any[]) = () => [], options: Partial<IUIOptions> = {}): IToolbarAction {\r\n  return {\r\n    title,\r\n    onClick: (col, evt, ctx, level) => {\r\n      const dialog = new dialogClass(col, dialogContext(ctx, level, evt), ...extraArgs(ctx));\r\n      dialog.open();\r\n    }, options\r\n  };\r\n}\r\n\r\nfunction uiSortMethod(methods: string[]): IToolbarDialogAddon {\r\n  methods = methods.sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));\r\n  return {\r\n    title: 'Sort By',\r\n    order: 2,\r\n    append(col, node, dialog) {\r\n      sortMethods(node, <any>col, methods, dialog.idPrefix);\r\n    }\r\n  };\r\n}\r\n\r\nconst sort: IToolbarAction = {\r\n  title: 'Sort', // basic ranking\r\n  onClick: (col, evt, ctx, level) => {\r\n    ctx.dialogManager.removeAboveLevel(level);\r\n    if (!evt.ctrlKey) {\r\n      col.toggleMySorting();\r\n      return;\r\n    }\r\n    const ranking = col.findMyRanker()!;\r\n    const current = ranking.getSortCriteria();\r\n    const order = col.isSortedByMe();\r\n\r\n    const isAscByDefault = isSortingAscByDefault(col);\r\n\r\n    if (order.priority === undefined) {\r\n      ranking.sortBy(col, isAscByDefault, current.length);\r\n      return;\r\n    }\r\n    let next: string|undefined = undefined;\r\n    if (isAscByDefault) {\r\n      next = order.asc ? 'desc' : undefined;\r\n    } else {\r\n      next = !order.asc ? 'asc' : undefined;\r\n    }\r\n    ranking.sortBy(col, next === 'asc', next ? order.priority : -1);\r\n  },\r\n  options: {\r\n    shortcut: 'only',\r\n    order: 1,\r\n    featureCategory: 'ranking',\r\n    featureLevel: 'basic'\r\n  }\r\n};\r\n\r\nconst sortBy: IToolbarAction = {\r\n  title: 'Sort By &hellip;', // advanced ranking\r\n  onClick: (col, evt, ctx, level) => {\r\n    const dialog = new SortDialog(col, false, dialogContext(ctx, level, evt), ctx);\r\n    dialog.open();\r\n  },\r\n  options: {\r\n    shortcut: false,\r\n    order: 1,\r\n    featureCategory: 'ranking',\r\n    featureLevel: 'advanced'\r\n  }\r\n};\r\n\r\nconst sortGroupBy: IToolbarAction = {\r\n  title: 'Sort Groups By &hellip;', // advanced ranking\r\n  onClick: (col, evt, ctx, level) => {\r\n    const dialog = new SortDialog(col, true, dialogContext(ctx, level, evt), ctx);\r\n    dialog.open();\r\n  },\r\n  options: {\r\n    shortcut: false,\r\n    order: 3,\r\n    featureCategory: 'ranking',\r\n    featureLevel: 'advanced'\r\n  }\r\n};\r\n\r\nconst rename: IToolbarAction = {\r\n  title: 'Rename &hellip;', // advanced\r\n  onClick: (col, evt, ctx, level) => {\r\n    const dialog = new RenameDialog(col, dialogContext(ctx, level, evt));\r\n    dialog.open();\r\n  },\r\n  options: {\r\n    order: 4,\r\n    featureCategory: 'ui',\r\n    featureLevel: 'advanced'\r\n  }\r\n};\r\n\r\nconst vis: IToolbarAction = {\r\n  title: 'Visualization &hellip;', // advanced view\r\n  onClick: (col, evt, ctx, level) => {\r\n    const dialog = new ChangeRendererDialog(col, dialogContext(ctx, level, evt), ctx);\r\n    dialog.open();\r\n  },\r\n  options: {\r\n    featureCategory: 'ui',\r\n    featureLevel: 'advanced'\r\n  }\r\n};\r\n\r\nconst clone: IToolbarAction = {\r\n  title: 'Clone', // advanced model\r\n  onClick: (col, _evt, ctx) => {\r\n    ctx.dialogManager.removeAll(); // since the column will be removed\r\n    ctx.provider.takeSnapshot(col);\r\n  },\r\n  options: {\r\n    order: 80,\r\n    featureCategory: 'model',\r\n    featureLevel: 'advanced'\r\n  }\r\n};\r\n\r\nconst remove: IToolbarAction = {\r\n  title: 'Remove', // advanced model\r\n  onClick: (col, _evt, ctx) => {\r\n    ctx.dialogManager.removeAll(); // since the column will be removed\r\n    const ranking = col.findMyRanker()!;\r\n    const last = ranking.children.every((d) => isSupportType(d) || d.fixed || d === col);\r\n    if (!last) {\r\n      col.removeMe();\r\n      return;\r\n    }\r\n    ctx.provider.removeRanking(ranking);\r\n    ctx.provider.ensureOneRanking();\r\n  },\r\n  options: {\r\n    order: 90,\r\n    featureCategory: 'model',\r\n    featureLevel: 'advanced'\r\n  }\r\n};\r\n\r\n// basic ranking\r\nconst group = ui('Group', (col, evt, ctx, level) => {\r\n  ctx.dialogManager.removeAboveLevel(level);\r\n\r\n  if (!evt.ctrlKey) {\r\n    col.groupByMe();\r\n    return;\r\n  }\r\n  const ranking = col.findMyRanker()!;\r\n  const current = ranking.getGroupCriteria();\r\n  const order = current.indexOf(col);\r\n\r\n  ranking.groupBy(col, order >= 0 ? -1 : current.length);\r\n}, { shortcut: 'only', order: 2, featureCategory: 'ranking', featureLevel: 'basic' });\r\n\r\n// advanced ranking\r\nconst groupBy = ui('Group By &hellip;', (col, evt, ctx, level) => {\r\n  const dialog = new GroupDialog(col, dialogContext(ctx, level, evt), ctx);\r\n  dialog.open();\r\n}, { shortcut: false, order: 2, featureCategory: 'ranking', featureLevel: 'advanced' });\r\n\r\n\r\n\r\nconst collapse = ui('Compress', (col, evt, ctx, level) => {\r\n  ctx.dialogManager.removeAboveLevel(level);\r\n  const mcol = <IMultiLevelColumn>col;\r\n  mcol.setCollapsed(!mcol.getCollapsed());\r\n  const i = <HTMLElement>evt.currentTarget;\r\n  i.title = mcol.getCollapsed() ? 'Expand' : 'Compress';\r\n}, { featureCategory: 'model', featureLevel: 'advanced' });\r\n\r\nconst toolbarAddons: { [key: string]: IToolbarDialogAddon } = {\r\n  sortNumber: uiSortMethod(Object.keys(EAdvancedSortMethod)),\r\n  sortNumbers: uiSortMethod(Object.keys(EAdvancedSortMethod)),\r\n  sortBoxPlot: uiSortMethod(Object.keys(ESortMethod)),\r\n  sortDates: uiSortMethod(Object.keys(EDateSort)),\r\n  sortGroup: uiSortMethod(['count', 'name']),\r\n  groupNumber: <IToolbarDialogAddon>{\r\n    title: 'Split',\r\n    order: 2,\r\n    append: appendNumber\r\n  },\r\n  groupString: <IToolbarDialogAddon>{\r\n    title: 'Groups',\r\n    order: 2,\r\n    append: appendString\r\n  },\r\n  groupDate: <IToolbarDialogAddon>{\r\n    title: 'Granularity',\r\n    order: 2,\r\n    append: appendDate\r\n  },\r\n};\r\n\r\nexport const toolbarActions: { [key: string]: IToolbarAction | IToolbarDialogAddon } = Object.assign({\r\n  group,\r\n  groupBy,\r\n  collapse,\r\n  sort,\r\n  sortBy,\r\n  sortGroupBy,\r\n  clone,\r\n  remove,\r\n  rename,\r\n  search: uiDialog('Search &hellip;', SearchDialog, (ctx) => [ctx.provider], { shortcut: true, order: 3, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  filterNumber: uiDialog('Filter &hellip;', NumberFilterDialog, (ctx) => [ctx], { shortcut: true, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  filterDate: uiDialog('Filter &hellip;', DateFilterDialog, (ctx) => [ctx], { shortcut: true, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  filterString: uiDialog('Filter &hellip;', StringFilterDialog, () => [], { shortcut: true, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  filterCategorical: uiDialog('Filter &hellip;', CategoricalFilterDialog, () => [], { shortcut: true, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  filterOrdinal: uiDialog('Filter &hellip;', CategoricalMappingFilterDialog, () => [], { shortcut: true, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  filterBoolean: uiDialog('Filter &hellip;', BooleanFilterDialog, () => [], { shortcut: true, featureCategory: 'ranking', featureLevel: 'basic' }),\r\n  colorMapped: uiDialog('Color Mapping &hellip;', ColorMappingDialog, () => [], { shortcut: false, featureCategory: 'ui', featureLevel: 'advanced' }),\r\n  script: uiDialog('Edit Combine Script &hellip;', ScriptEditDialog, () => [], { shortcut: true, featureCategory: 'model', featureLevel: 'advanced' }),\r\n  reduce: uiDialog('Reduce by &hellip;', ReduceDialog, () => [], { featureCategory: 'model', featureLevel: 'advanced' }),\r\n  cutoff: uiDialog('Set Cut Off &hellip;', CutOffHierarchyDialog, (ctx) => [ctx.idPrefix], { featureCategory: 'model', featureLevel: 'advanced' }),\r\n  editMapping: uiDialog('Data Mapping &hellip;', MappingDialog, (ctx) => [ctx], { featureCategory: 'model', featureLevel: 'advanced' }),\r\n  editPattern: uiDialog('Edit Pattern &hellip;', EditPatternDialog, (ctx) => [ctx.idPrefix], { featureCategory: 'model', featureLevel: 'advanced' }),\r\n  editWeights: uiDialog('Edit Weights &hellip;', WeightsEditDialog, () => [], { shortcut: true, featureCategory: 'model', featureLevel: 'advanced' }),\r\n  compositeContained: uiDialog('Contained Columns &hellip;', CompositeChildrenDialog, (ctx) => [ctx], { featureCategory: 'model', featureLevel: 'advanced' }),\r\n  splitCombined: ui('Split Combined Column', (col, _evt, ctx, level) => {\r\n    ctx.dialogManager.removeAboveLevel(level);\r\n    // split the combined column into its children\r\n    (<CompositeColumn>col).children.reverse().forEach((c) => col.insertAfterMe(c));\r\n    col.removeMe();\r\n  }, { featureCategory: 'model', featureLevel: 'advanced' }),\r\n  invertSelection: ui('Invert Selection', (col, _evt, ctx, level) => {\r\n    ctx.dialogManager.removeAboveLevel(level - 1); // close itself\r\n    const s = ctx.provider.getSelection();\r\n    const order = col.findMyRanker()!.getOrder();\r\n    if (s.length === 0) {\r\n      ctx.provider.setSelection(order);\r\n      return;\r\n    }\r\n    const ss = new Set(s);\r\n    const others = order.filter((d) => !ss.has(d));\r\n    ctx.provider.setSelection(others);\r\n  }, { featureCategory: 'model', featureLevel: 'advanced' })\r\n}, toolbarAddons);\r\n\r\nfunction sortActions(a: IToolbarAction, b: IToolbarAction) {\r\n  if (a.options.order === b.options.order) {\r\n    return a.title.localeCompare(b.title);\r\n  }\r\n  return (a.options.order || 50) - (b.options.order || 50);\r\n}\r\n\r\nconst cache = new Map<string, IToolbarAction[]>();\r\nconst cacheAddon = new Map<string, IToolbarDialogAddon[]>();\r\n\r\nfunction getFullToolbar(col: Column, ctx: IRankingHeaderContext) {\r\n  if (cache.has(col.desc.type)) {\r\n    return cache.get(col.desc.type)!;\r\n  }\r\n  const icons = <{ [key: string]: IToolbarAction }>ctx.toolbar;\r\n  const actions = new Set<IToolbarAction>();\r\n  if (!col.fixed) {\r\n    actions.add(remove);\r\n  }\r\n  {\r\n    const possible = ctx.getPossibleRenderer(col);\r\n    if (possible.item.length > 2 || possible.group.length > 2 || possible.summary.length > 2) { // default always possible\r\n      actions.add(vis);\r\n    }\r\n  }\r\n\r\n  if (!isSupportType(col)) {\r\n    actions.add(sort);\r\n    actions.add(sortBy);\r\n    actions.add(rename);\r\n    actions.add(clone);\r\n  }\r\n\r\n  const keys = getAllToolbarActions(col);\r\n\r\n  keys.forEach((key) => {\r\n    if (icons.hasOwnProperty(key)) {\r\n      actions.add(icons[key]);\r\n    } else {\r\n      console.warn('cannot find: ', col.desc.type, key);\r\n    }\r\n  });\r\n\r\n  const r = Array.from(actions).sort(sortActions);\r\n  cache.set(col.desc.type, r);\r\n  return r;\r\n}\r\n\r\n\r\nexport function getToolbar(col: Column, ctx: IRankingHeaderContext) {\r\n  const toolbar = getFullToolbar(col, ctx);\r\n  const flags = ctx.flags;\r\n\r\n  return toolbar.filter((a) => {\r\n    // level is basic or not one of disabled features\r\n    return a.options.featureLevel === 'basic' || !((flags.advancedModelFeatures === false && a.options.featureCategory === 'model') || (flags.advancedRankingFeatures === false && a.options.featureCategory === 'ranking') || (flags.advancedUIFeatures === false && a.options.featureCategory === 'ui'));\r\n  });\r\n}\r\n\r\nexport function getToolbarDialogAddons(col: Column, key: string, ctx: IRankingHeaderContext) {\r\n  const cacheKey = `${col.desc.type}@${key}`;\r\n  if (cacheAddon.has(cacheKey)) {\r\n    return cacheAddon.get(cacheKey)!;\r\n  }\r\n  const icons = <{ [key: string]: IToolbarDialogAddon }>ctx.toolbar;\r\n  const actions = new Set<IToolbarDialogAddon>();\r\n\r\n  const keys = getAllToolbarDialogAddons(col, key);\r\n\r\n  keys.forEach((key) => {\r\n    if (icons.hasOwnProperty(key)) {\r\n      actions.add(icons[key]);\r\n    } else {\r\n      console.warn('cannot find: ', col.desc.type, key);\r\n    }\r\n  });\r\n\r\n  const r = Array.from(actions).sort((a, b) => {\r\n    if (a.order === b.order) {\r\n      return a.title.localeCompare(b.title);\r\n    }\r\n    return (a.order || 50) - (b.order || 50);\r\n  });\r\n  cacheAddon.set(cacheKey, r);\r\n  return r;\r\n}\r\n\r\nexport function isSortAble(col: Column, ctx: IRankingHeaderContext) {\r\n  const toolbar = getFullToolbar(col, ctx);\r\n  return toolbar.includes(sortBy);\r\n}\r\n\r\nexport function isGroupAble(col: Column, ctx: IRankingHeaderContext) {\r\n  const toolbar = getFullToolbar(col, ctx);\r\n  return toolbar.includes(groupBy);\r\n}\r\n\r\nexport function isGroupSortAble(col: Column, ctx: IRankingHeaderContext) {\r\n  const toolbar = getFullToolbar(col, ctx);\r\n  return toolbar.includes(sortGroupBy);\r\n}\r\n","import NumberColumn from '../../model/NumberColumn';\r\nimport {IDialogContext} from './ADialog';\r\nimport {round, getNumberOfBins} from '../../internal/math';\r\nimport {forEach} from '../../renderer/utils';\r\n\r\n\r\n/** @internal */\r\nexport default function append(col: NumberColumn, node: HTMLElement, dialog: IDialogContext) {\r\n  const domain = col.getMapping().domain;\r\n  const current = col.getGroupThresholds();\r\n  let isThreshold = current.length <= 1;\r\n  const ranking =  col.findMyRanker()!;\r\n  node.insertAdjacentHTML('beforeend', `\r\n    <div class=\"lu-checkbox\">\r\n      <input type=\"radio\" name=\"threshold\" value=\"threshold\" id=\"${dialog.idPrefix}T1\" ${isThreshold ? 'checked' : ''}>\r\n      <label for=\"${dialog.idPrefix}T1\">at&nbsp;<input type=\"number\" size=\"10\" id=\"${dialog.idPrefix}N1\" value=\"${current.length > 0 ? current[0] : round((domain[1] - domain[0]) / 2, 2)}\"\r\n          required min=\"${domain[0]}\" max=\"${domain[1]}\" step=\"any\" ${!isThreshold ? 'disabled': ''}>\r\n      </label>\r\n    </div>\r\n    <div class=\"lu-checkbox\">\r\n      <input type=\"radio\" name=\"threshold\" value=\"bins\" id=\"${dialog.idPrefix}T2\" ${!isThreshold ? 'checked' : ''}>\r\n      <label for=\"${dialog.idPrefix}T2\"> in&nbsp;<input type=\"number\" size=\"5\" id=\"${dialog.idPrefix}N2\" value=\"${current.length > 1 ? current.length : getNumberOfBins(ranking.getOrder().length)}\"\r\n          required min=\"2\" step=\"1\" ${isThreshold ? 'disabled': ''}>&nbsp;bins\r\n      </label>\r\n    </div>\r\n  `);\r\n\r\n  const threshold = <HTMLInputElement>node.querySelector(`#${dialog.idPrefix}N1`);\r\n  const bins = <HTMLInputElement>node.querySelector(`#${dialog.idPrefix}N2`);\r\n\r\n  const update = () => {\r\n    threshold.disabled = !isThreshold;\r\n    bins.disabled = isThreshold;\r\n\r\n    if (isThreshold) {\r\n      col.setGroupThresholds([parseFloat(threshold.value)]);\r\n      return;\r\n    }\r\n\r\n    const count = parseInt(bins.value, 10);\r\n    const delta = (domain[1] - domain[0]) / count;\r\n    let act = domain[0] + delta;\r\n    const thresholds = [act];\r\n    for(let i = 1; i < count - 1; ++i) {\r\n      act += delta;\r\n      thresholds.push(act);\r\n    }\r\n    col.setGroupThresholds(thresholds);\r\n  };\r\n\r\n  threshold.addEventListener('change', update, { passive: true });\r\n  bins.addEventListener('change', update, { passive: true });\r\n\r\n\r\n  forEach(node, 'input[name=threshold]', (d: HTMLInputElement) => {\r\n    d.addEventListener('change', () => {\r\n      isThreshold = d.value === 'threshold';\r\n      update();\r\n    }, { passive: true });\r\n  });\r\n}\r\n","import {IDialogContext} from './ADialog';\r\nimport StringColumn from '../../model/StringColumn';\r\n\r\n\r\n/** @internal */\r\nexport default function append(col: StringColumn, node: HTMLElement, dialog: IDialogContext) {\r\n  const current = col.getGroupCriteria();\r\n  const isRegex = current.length > 0 && current[0] instanceof RegExp;\r\n  node.insertAdjacentHTML('beforeend', `\r\n    <div class=\"lu-checkbox\">\r\n      <input type=\"radio\" name=\"regex\" value=\"startsWith\" id=\"${dialog.idPrefix}RW\" ${!isRegex ? 'checked' : ''}>\r\n      <label for=\"${dialog.idPrefix}RW\">Text starts with &hellip;</label>\r\n    </div>\r\n    <div class=\"lu-checkbox\">\r\n      <input type=\"radio\" name=\"regex\" value=\"regex\" id=\"${dialog.idPrefix}RE\" ${isRegex ? 'checked' : ''}>\r\n      <label for=\"${dialog.idPrefix}RE\">Use regular expressions</label>\r\n    </div>\r\n    <textarea required rows=\"5\" placeholder=\"e.g. Test,a.*\" id=\"${dialog.idPrefix}T\">${current.map((d) => typeof d === 'string' ? d : d.source).join('\\n')}</textarea>\r\n    <button id=\"${dialog.idPrefix}A\">Apply</button>\r\n  `);\r\n\r\n  const button = node.querySelector<HTMLButtonElement>(`#${dialog.idPrefix}A`)!;\r\n  const isRegexCheck = node.querySelector<HTMLInputElement>(`#${dialog.idPrefix}RE`)!;\r\n  const groups = node.querySelector<HTMLTextAreaElement>(`#${dialog.idPrefix}T`)!;\r\n\r\n  button.onclick = (evt) => {\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n\r\n    let items: (string | RegExp)[] = groups.value.trim().split('\\n').map((d) => d.trim()).filter((d) => d.length > 0);\r\n    const invalid = items.length === 0;\r\n    groups.setCustomValidity(invalid ? 'At least one group is required' : '');\r\n    if (invalid) {\r\n      (<any>groups).reportValidity(); // typedoc not uptodate\r\n      return;\r\n    }\r\n    if (isRegexCheck.checked) {\r\n      items = items.map((d) => new RegExp(d.toString(), 'gm'));\r\n    }\r\n    col.setGroupCriteria(items);\r\n  };\r\n}\r\n","import {IDialogContext} from './ADialog';\r\nimport {forEach} from '../../renderer/utils';\r\nimport DateColumn from '../../model/DateColumn';\r\nimport {IDateGranularity} from '../../model';\r\n\r\n\r\n/** @internal */\r\nexport default function appendDate(col: DateColumn, node: HTMLElement, dialog: IDialogContext) {\r\n  const current = col.getDateGrouper();\r\n\r\n  let granularity = current.granularity;\r\n  let circular = current.circular;\r\n\r\n  let html: string = '';\r\n  for (const g of ['century', 'decade', 'year', 'month', 'week', 'day_of_week', 'day_of_month', 'day_of_year', 'hour', 'minute', 'second']) {\r\n    html += `<div class=\"lu-checkbox\">\r\n    <input type=\"radio\" name=\"granularity\" value=\"${g}\" id=\"${dialog.idPrefix}D${g}\" ${granularity === g ? 'checked' : ''}>\r\n    <label for=\"${dialog.idPrefix}D${g}\"> by ${g}\r\n    </label>\r\n  </div>`;\r\n  }\r\n  html += `<div class=\"lu-checkbox\">\r\n    <input type=\"checkbox\" name=\"circular\" id=\"${dialog.idPrefix}DC\" ${circular ? 'checked' : ''}>\r\n    <label for=\"${dialog.idPrefix}DC\"> Circular\r\n    </label>\r\n  </div>`;\r\n\r\n  node.insertAdjacentHTML('beforeend', html);\r\n\r\n  const update = () => {\r\n    col.setDateGrouper({granularity, circular});\r\n  };\r\n\r\n\r\n  node.querySelector<HTMLInputElement>(`#${dialog.idPrefix}DC`)!.addEventListener('change', (evt) => {\r\n    circular = (<HTMLInputElement>evt.currentTarget).checked;\r\n    update();\r\n  }, { passive: true });\r\n\r\n  forEach(node, 'input[name=granularity]', (d: HTMLInputElement) => {\r\n    d.addEventListener('change', () => {\r\n      granularity = <IDateGranularity>d.value;\r\n      update();\r\n    }, { passive: true });\r\n  });\r\n}\r\n","import {Category, toolbar, dialogAddons} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IDataRow, IGroup} from './interfaces';\nimport {patternFunction} from './internal';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {IStringDesc, EAlignment} from './StringColumn';\nimport StringColumn from './StringColumn';\n\nexport interface ILinkDesc extends IStringDesc {\n  /**\n   * replacement pattern, use use <code>${value}</code> for the current value, <code>${escapedValue}</code> for an url safe value and <code>${item}</code> for the whole item\n   */\n  pattern?: string;\n\n  /**\n   * optional list of pattern templates\n   */\n  patternTemplates?: string[];\n}\n\nexport interface ILink {\n  alt: string;\n  href: string;\n}\n\nexport declare type ILinkColumnDesc = ILinkDesc & IValueColumnDesc<string | ILink>;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf LinkColumn\n * @event\n */\nexport declare function filterChanged(previous: string | RegExp | null, current: string | RegExp | null): void;\n\n\n/**\n * emitted when the grouping property changes\n * @asMemberOf LinkColumn\n * @event\n */\nexport declare function groupingChanged(previous: (RegExp | string)[][], current: (RegExp | string)[][]): void;\n\n/**\n * emitted when the pattern property changes\n * @asMemberOf LinkColumn\n * @event\n */\nexport declare function patternChanged(previous: string, current: string): void;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('search', 'groupBy', 'filterString', 'editPattern')\n@dialogAddons('group', 'groupString')\n@Category('string')\nexport default class LinkColumn extends ValueColumn<string | ILink> {\n  static readonly EVENT_FILTER_CHANGED = StringColumn.EVENT_FILTER_CHANGED;\n  static readonly EVENT_GROUPING_CHANGED = StringColumn.EVENT_GROUPING_CHANGED;\n  static readonly EVENT_PATTERN_CHANGED = 'patternChanged';\n\n  private pattern: string;\n  private patternFunction: Function | null = null;\n  readonly patternTemplates: string[];\n\n  private currentFilter: string | RegExp | null = null;\n  private currentGroupCriteria: (RegExp | string)[] = [];\n\n  readonly alignment: EAlignment;\n  readonly escape: boolean;\n\n  constructor(id: string, desc: Readonly<ILinkColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(200); //by default 200\n    this.alignment = <any>desc.alignment || EAlignment.left;\n    this.escape = desc.escape !== false;\n\n    this.pattern = desc.pattern || '';\n    this.patternTemplates = desc.patternTemplates || [];\n\n    if (this.pattern) {\n      this.setDefaultRenderer('link');\n      this.setDefaultGroupRenderer('link');\n    }\n  }\n\n  setPattern(pattern: string) {\n    if (pattern === this.pattern) {\n      return;\n    }\n    this.patternFunction = null; // reset cache\n    this.fire([LinkColumn.EVENT_PATTERN_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.pattern, this.pattern = pattern);\n  }\n\n  getPattern() {\n    return this.pattern;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([LinkColumn.EVENT_PATTERN_CHANGED, LinkColumn.EVENT_GROUPING_CHANGED, LinkColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof LinkColumn.EVENT_PATTERN_CHANGED, listener: typeof patternChanged | null): this;\n  on(type: typeof LinkColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof LinkColumn.EVENT_GROUPING_CHANGED, listener: typeof groupingChanged | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    const l = this.getLink(row);\n    return l == null ? '' : l.href;\n  }\n\n  getLink(row: IDataRow): ILink | null {\n    const v: string | null | ILink = super.getValue(row);\n    return this.transformValue(v, row);\n  }\n\n  private transformValue(v: any, row: IDataRow) {\n    if (v == null || v === '') {\n      return null;\n    }\n    if (typeof v === 'string') {\n      if (!this.pattern) {\n        return {\n          alt: v,\n          href: v\n        };\n      }\n      if (!this.patternFunction) {\n        this.patternFunction = patternFunction(this.pattern, 'item');\n      }\n      return {\n        alt: v,\n        href: this.patternFunction.call(this, v, row.v)\n      };\n    }\n    return v;\n  }\n\n  getLabel(row: IDataRow) {\n    const l = this.getLink(row);\n    return l == null ? '' : l.alt;\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = StringColumn.prototype.dump.call(this, toDescRef);\n    if (this.pattern !== (<any>this.desc).pattern) {\n      r.pattern = this.pattern;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    StringColumn.prototype.restore.call(this, dump, factory);\n    if (dump.pattern) {\n      this.pattern = dump.pattern;\n    }\n  }\n\n  isFiltered() {\n    return this.currentFilter != null;\n  }\n\n  filter(row: IDataRow) {\n    return StringColumn.prototype.filter.call(this, row);\n  }\n\n  getFilter() {\n    return this.currentFilter;\n  }\n\n  setFilter(filter: string | RegExp | null) {\n    return StringColumn.prototype.setFilter.call(this, filter);\n  }\n\n  getGroupCriteria() {\n    return this.currentGroupCriteria.slice();\n  }\n\n  setGroupCriteria(value: (string | RegExp)[]) {\n    return StringColumn.prototype.setGroupCriteria.call(this, value);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return StringColumn.prototype.compare.call(this, a, b);\n  }\n\n  group(row: IDataRow): IGroup {\n    return StringColumn.prototype.group.call(this, row);\n  }\n}\n\n","import {IGroup} from './interfaces';\r\n\r\n\r\nexport interface IOrderedGroup extends IGroup {\r\n  order: number[];\r\n}\r\n\r\nexport const defaultGroup: IGroup = {\r\n  name: 'Default',\r\n  color: 'gray'\r\n};\r\n","import {format} from 'd3-format';\nimport {IBoxPlotData} from '../internal';\nimport {Category, toolbar, SortByDefault, dialogAddons} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IDataRow} from './interfaces';\nimport {\n  compareBoxPlot, ESortMethod, getBoxPlotNumber, IBoxPlotColumn, INumberFilter, noNumberFilter, isDummyNumberFilter, restoreNumberFilter\n} from './INumberColumn';\nimport {\n  createMappingFunction, IMapAbleDesc, IMappingFunction, restoreMapping,\n  ScaleMappingFunction\n} from './MappingFunction';\nimport NumberColumn, {colorMappingChanged} from './NumberColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {IColorMappingFunction, restoreColorMapping, createColorMappingFunction} from './ColorMappingFunction';\n\n\nexport interface IBoxPlotDesc extends IMapAbleDesc {\n  sort?: ESortMethod;\n}\n\nexport declare type IBoxPlotColumnDesc = IBoxPlotDesc & IValueColumnDesc<IBoxPlotData>;\n\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf BoxPlotColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: ESortMethod, current: ESortMethod): void;\n\n/**\n * emitted when the mapping property changes\n * @asMemberOf BoxPlotColumn\n * @event\n */\nexport declare function mappingChanged(previous: IMappingFunction, current: IMappingFunction): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf BoxPlotColumn\n * @event\n */\nexport declare function filterChanged(previous: INumberFilter | null, current: INumberFilter | null): void;\n\n\n@toolbar('filterNumber', 'colorMapped', 'editMapping')\n@dialogAddons('sort', 'sortBoxPlot')\n@Category('array')\n@SortByDefault('descending')\nexport default class BoxPlotColumn extends ValueColumn<IBoxPlotData> implements IBoxPlotColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumberColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_COLOR_MAPPING_CHANGED = NumberColumn.EVENT_COLOR_MAPPING_CHANGED;\n  static readonly EVENT_SORTMETHOD_CHANGED = NumberColumn.EVENT_SORTMETHOD_CHANGED;\n  static readonly EVENT_FILTER_CHANGED = NumberColumn.EVENT_FILTER_CHANGED;\n\n  static readonly DEFAULT_FORMATTER = format('.3n');\n\n  private sort: ESortMethod;\n\n  private mapping: IMappingFunction;\n  private colorMapping: IColorMappingFunction;\n\n  private original: Readonly<IMappingFunction>;\n  /**\n   * currently active filter\n   * @type {{min: number, max: number}}\n   * @private\n   */\n  private currentFilter: INumberFilter = noNumberFilter();\n\n\n  constructor(id: string, desc: Readonly<IBoxPlotColumnDesc>) {\n    super(id, desc);\n    this.mapping = restoreMapping(desc);\n    this.original = this.mapping.clone();\n    this.colorMapping = restoreColorMapping(desc);\n\n    this.sort = desc.sort || ESortMethod.min;\n\n  }\n\n  compare(a: IDataRow, b: IDataRow): number {\n    return compareBoxPlot(this, a, b);\n  }\n\n  getBoxPlotData(row: IDataRow): IBoxPlotData | null {\n    return this.getValue(row);\n  }\n\n  getRange() {\n    return this.mapping.getRange(BoxPlotColumn.DEFAULT_FORMATTER);\n  }\n\n  getRawBoxPlotData(row: IDataRow): IBoxPlotData | null {\n    return this.getRawValue(row);\n  }\n\n  getRawValue(row: IDataRow) {\n    return super.getValue(row);\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    return format === 'json' ? this.getRawValue(row) : super.getExportValue(row, format);\n  }\n\n  getValue(row: IDataRow) {\n    const v = this.getRawValue(row);\n    if (v == null) {\n      return v;\n    }\n    const r: IBoxPlotData = {\n      min: this.mapping.apply(v.min),\n      max: this.mapping.apply(v.max),\n      median: this.mapping.apply(v.median),\n      q1: this.mapping.apply(v.q1),\n      q3: this.mapping.apply(v.q3)\n    };\n    if (v.outlier) {\n      Object.assign(r, {\n        outlier: v.outlier.map((d) => this.mapping.apply(d))\n      });\n    }\n    if (v.whiskerLow != null) {\n      Object.assign(r, {\n        whiskerLow: this.mapping.apply(v.whiskerLow)\n      });\n    }\n    if (v.whiskerHigh != null) {\n      Object.assign(r, {\n        whiskerHigh: this.mapping.apply(v.whiskerHigh)\n      });\n    }\n    return r;\n  }\n\n  getNumber(row: IDataRow): number {\n    return getBoxPlotNumber(this, row, 'normalized');\n  }\n\n  getRawNumber(row: IDataRow): number {\n    return getBoxPlotNumber(this, row, 'raw');\n  }\n\n  getLabel(row: IDataRow): string {\n    const v = this.getRawValue(row);\n    if (v == null) {\n      return '';\n    }\n    const f = BoxPlotColumn.DEFAULT_FORMATTER;\n    return `BoxPlot(min = ${f(v.min)}, q1 = ${f(v.q1)}, median = ${f(v.median)}, q3 = ${f(v.q3)}, max = ${f(v.max)})`;\n  }\n\n  getSortMethod() {\n    return this.sort;\n  }\n\n  setSortMethod(sort: ESortMethod) {\n    if (this.sort === sort) {\n      return;\n    }\n    this.fire(BoxPlotColumn.EVENT_SORTMETHOD_CHANGED, this.sort, this.sort = sort);\n    // sort by me if not already sorted by me\n    if (!this.isSortedByMe().asc) {\n      this.sortByMe();\n    }\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.sortMethod = this.getSortMethod();\n    r.filter = !isDummyNumberFilter(this.currentFilter) ? this.currentFilter : null;\n    r.map = this.mapping.dump();\n    r.colorMapping = this.colorMapping.dump();\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.sortMethod) {\n      this.sort = dump.sortMethod;\n    }\n    if (dump.filter) {\n      this.currentFilter = restoreNumberFilter(dump.filter);\n    }\n    if (dump.map) {\n      this.mapping = createMappingFunction(dump.map);\n    } else if (dump.domain) {\n      this.mapping = new ScaleMappingFunction(dump.domain, 'linear', dump.range || [0, 1]);\n    }\n    if (dump.colorMapping) {\n      this.colorMapping = createColorMappingFunction(dump.colorMapping);\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([BoxPlotColumn.EVENT_SORTMETHOD_CHANGED, BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED, BoxPlotColumn.EVENT_MAPPING_CHANGED, BoxPlotColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof BoxPlotColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof BoxPlotColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof BoxPlotColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getOriginalMapping() {\n    return this.original.clone();\n  }\n\n  getMapping() {\n    return this.mapping.clone();\n  }\n\n  setMapping(mapping: IMappingFunction) {\n    if (this.mapping.eq(mapping)) {\n      return;\n    }\n    this.fire([BoxPlotColumn.EVENT_MAPPING_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.mapping.clone(), this.mapping = mapping);\n  }\n\n  getColor(row: IDataRow) {\n    return NumberColumn.prototype.getColor.call(this, row);\n  }\n\n  getColorMapping() {\n    return this.colorMapping.clone();\n  }\n\n  setColorMapping(mapping: IColorMappingFunction) {\n    if (this.colorMapping.eq(mapping)) {\n      return;\n    }\n    this.fire([BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.colorMapping.clone(), this.colorMapping = mapping);\n  }\n\n  isFiltered() {\n    return NumberColumn.prototype.isFiltered.call(this);\n  }\n\n  getFilter(): INumberFilter {\n    return NumberColumn.prototype.getFilter.call(this);\n  }\n\n  setFilter(value: INumberFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    NumberColumn.prototype.setFilter.call(this, value);\n  }\n\n  filter(row: IDataRow) {\n    return NumberColumn.prototype.filter.call(this, row);\n  }\n}\n\n","import {Category, SupportType} from './annotations';\r\nimport ValueColumn, {IValueColumnDesc} from './ValueColumn';\r\n\r\n/**\r\n * factory for creating a description creating a rank column\r\n * @param label\r\n * @returns {{type: string, label: string}}\r\n */\r\nexport function createRankDesc(label: string = 'Rank') {\r\n  return {type: 'rank', label};\r\n}\r\n\r\n/**\r\n * a rank column\r\n */\r\n@SupportType()\r\n@Category('support')\r\nexport default class RankColumn extends ValueColumn<number> {\r\n\r\n  constructor(id: string, desc: IValueColumnDesc<number>) {\r\n    super(id, desc);\r\n    this.setDefaultWidth(50);\r\n  }\r\n\r\n  get frozen() {\r\n    return this.desc.frozen !== false;\r\n  }\r\n}\r\n","import {Category} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {range} from 'd3-array';\nimport {IArrayColumn} from './IArrayColumn';\nimport {IDataRow} from './interfaces';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n\nexport interface IArrayDesc {\n  dataLength?: number;\n  labels?: string[];\n}\n\nexport interface ISplicer {\n  length: number | null;\n\n  splice<T>(values: T[]): T[];\n}\n\nexport interface IArrayColumnDesc<T> extends IArrayDesc, IValueColumnDesc<T[]> {\n  // dummy\n}\n\n/**\n * emitted when the splicer property changes\n * @asMemberOf ArrayColumn\n * @event\n */\nexport declare function spliceChanged(previous: ISplicer, current: ISplicer): void;\n\n\n@Category('array')\nexport default class ArrayColumn<T> extends ValueColumn<T[]> implements IArrayColumn<T> {\n  static readonly EVENT_SPLICE_CHANGED = 'spliceChanged';\n\n  private readonly _dataLength: number | null;\n\n  private splicer: Readonly<ISplicer>;\n\n  private readonly originalLabels: string[];\n\n  constructor(id: string, desc: Readonly<IArrayColumnDesc<T>>) {\n    super(id, desc);\n    this._dataLength = desc.dataLength == null || isNaN(desc.dataLength) ? null : desc.dataLength;\n    this.originalLabels = desc.labels || (range(this._dataLength == null ? 0 : this._dataLength).map((_d, i) => `Column ${i}`));\n    this.splicer = {\n      length: this._dataLength,\n      splice: (v) => v\n    };\n  }\n\n  setSplicer(splicer: Readonly<ISplicer>) {\n    this.fire([ArrayColumn.EVENT_SPLICE_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], this.splicer, this.splicer = splicer);\n  }\n\n  get labels() {\n    if (this.splicer) {\n      return this.splicer.splice(this.originalLabels);\n    }\n    return this.originalLabels;\n  }\n\n  getSplicer() {\n    return this.splicer;\n  }\n\n  get dataLength() {\n    if (this.splicer) {\n      return this.splicer.length;\n    }\n    return this._dataLength;\n  }\n\n  getValue(row: IDataRow) {\n    return this.getValues(row);\n  }\n\n  getValues(row: IDataRow) {\n    let r = super.getValue(row);\n    if (this.splicer && r != null) {\n      r = this.splicer.splice(r);\n    }\n    return r == null ? [] : r;\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getValues(row).map(String);\n  }\n\n  getLabel(row: IDataRow): string {\n    const v = this.getLabels(row);\n    if (!v) {\n      return '';\n    }\n    return v.toString();\n  }\n\n  getMap(row: IDataRow) {\n    const labels = this.labels;\n    return this.getValues(row).map((value, i) => ({key: labels[i], value}));\n  }\n\n  getMapLabel(row: IDataRow) {\n    const labels = this.labels;\n    return this.getLabels(row).map((value, i) => ({key: labels[i], value}));\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ArrayColumn.EVENT_SPLICE_CHANGED]);\n  }\n\n  on(type: typeof ArrayColumn.EVENT_SPLICE_CHANGED, listener: typeof spliceChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n}\n\n","import * as equalImpl from 'fast-deep-equal';\r\n\r\nexport const equal: (a: any, b: any) => boolean = (typeof equalImpl === 'function' ? equalImpl : (<any>equalImpl).default);\r\n\r\n/** @internal */\r\nexport function findOption(options: any) {\r\n  return (key: string, defaultValue: any): any => {\r\n    if (key in options) {\r\n      return options[key];\r\n    }\r\n    if (key.indexOf('.') > 0) {\r\n      const p = key.substring(0, key.indexOf('.'));\r\n      key = key.substring(key.indexOf('.') + 1);\r\n      if (p in options && key in options[p]) {\r\n        return options[p][key];\r\n      }\r\n    }\r\n    return defaultValue;\r\n  };\r\n}\r\n\r\n/** @internal */\r\nexport function equalArrays<T>(a: T[], b: T[]) {\r\n  if (a.length !== b.length) {\r\n    return false;\r\n  }\r\n  return a.every((ai, i) => ai === b[i]);\r\n}\r\n\r\n\r\n/**\r\n * converts a given id to css compatible one\r\n * @param id\r\n * @return {string|void}\r\n * @internal\r\n */\r\nexport function fixCSS(id: string) {\r\n  return id.replace(/[\\s!#$%&'()*+,.\\/:;<=>?@\\[\\\\\\]^`{|}~]+/g, '_'); //replace non css stuff to _\r\n}\r\n","import {round, similar} from '../internal';\nimport {toolbar} from './annotations';\nimport Column, {IFlatColumn, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {IMultiLevelColumn, addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport CompositeNumberColumn, {ICompositeNumberDesc} from './CompositeNumberColumn';\nimport {IDataRow} from './interfaces';\nimport {isNumberColumn} from './INumberColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n/**\n * factory for creating a description creating a stacked column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createStackDesc(label: string = 'Weighted Sum') {\n  return {type: 'stack', label};\n}\n\n\n/**\n * emitted when the collapse property changes\n * @asMemberOf StackColumn\n * @event\n */\nexport declare function collapseChanged(previous: boolean, current: boolean): void;\n\n\n/**\n * emitted when the weights change\n * @asMemberOf StackColumn\n * @event\n */\nexport declare function weightsChanged(previous: number[], current: number[]): void;\n\n\n/**\n * emitted when the ratios between the children changes\n * @asMemberOf StackColumn\n * @event\n */\nexport declare function nestedChildRatio(previous: number[], current: number[]): void;\n\n/**\n * implementation of the stacked column\n */\n@toolbar('editWeights', 'collapse')\nexport default class StackColumn extends CompositeNumberColumn implements IMultiLevelColumn {\n  static readonly EVENT_COLLAPSE_CHANGED = 'collapseChanged';\n  static readonly EVENT_WEIGHTS_CHANGED = 'weightsChanged';\n  static readonly EVENT_MULTI_LEVEL_CHANGED = 'nestedChildRatio';\n\n  static readonly COLLAPSED_RENDERER = 'number';\n\n  private readonly adaptChange: (old: number, newValue: number) => void;\n\n  /**\n   * whether this stack column is collapsed i.e. just looks like an ordinary number column\n   * @type {boolean}\n   * @private\n   */\n  private collapsed = false;\n\n  constructor(id: string, desc: ICompositeNumberDesc) {\n    super(id, desc);\n\n    const that = this;\n    this.adaptChange = function (this: {source: Column}, oldValue, newValue) {\n      that.adaptWidthChange(this.source, oldValue, newValue);\n    };\n\n    this.setDefaultRenderer('stack');\n    this.setDefaultGroupRenderer('stack');\n    this.setDefaultSummaryRenderer('default');\n  }\n\n  get label() {\n    const l = super.getMetaData().label;\n    const c = this._children;\n    if (l !== 'Weighted Sum' || c.length === 0) {\n      return l;\n    }\n    const weights = this.getWeights();\n    return c.map((c, i) => `${c.label} (${round(100 * weights[i], 1)}%)`).join(' + ');\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([StackColumn.EVENT_COLLAPSE_CHANGED, StackColumn.EVENT_WEIGHTS_CHANGED, StackColumn.EVENT_MULTI_LEVEL_CHANGED]);\n  }\n\n  on(type: typeof StackColumn.EVENT_COLLAPSE_CHANGED, listener: typeof collapseChanged | null): this;\n  on(type: typeof StackColumn.EVENT_WEIGHTS_CHANGED, listener: typeof weightsChanged | null): this;\n  on(type: typeof StackColumn.EVENT_MULTI_LEVEL_CHANGED, listener: typeof nestedChildRatio | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  setCollapsed(value: boolean) {\n    if (this.collapsed === value) {\n      return;\n    }\n    this.fire([StackColumn.EVENT_COLLAPSE_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.collapsed, this.collapsed = value);\n  }\n\n  getCollapsed() {\n    return this.collapsed;\n  }\n\n  get canJustAddNumbers() {\n    return true;\n  }\n\n  flatten(r: IFlatColumn[], offset: number, levelsToGo = 0, padding = 0) {\n    let self = null;\n    const children = levelsToGo <= Column.FLAT_ALL_COLUMNS ? this._children : this._children.filter((c) => c.isVisible());\n    //no more levels or just this one\n    if (levelsToGo === 0 || levelsToGo <= Column.FLAT_ALL_COLUMNS) {\n      let w = this.getWidth();\n      if (!this.collapsed) {\n        w += (children.length - 1) * padding;\n      }\n      r.push(self = {col: this, offset, width: w});\n      if (levelsToGo === 0) {\n        return w;\n      }\n    }\n    //push children\n    let acc = offset;\n    children.forEach((c) => {\n      acc += c.flatten(r, acc, levelsToGo - 1, padding) + padding;\n    });\n    if (self) { //nesting my even increase my width\n      self.width = acc - offset - padding;\n    }\n    return acc - offset - padding;\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.collapsed = this.collapsed;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    this.collapsed = dump.collapsed === true;\n    super.restore(dump, factory);\n  }\n\n  /**\n   * inserts a column at a the given position\n   */\n  insert(col: Column, index: number, weight = NaN) {\n    if (!isNaN(weight)) {\n      col.setWidth((weight / (1 - weight) * this.getWidth()));\n    }\n    col.on(`${Column.EVENT_WIDTH_CHANGED}.stack`, this.adaptChange);\n    //increase my width\n    super.setWidth(this.length === 0 ? col.getWidth() : (this.getWidth() + col.getWidth()));\n\n    return super.insert(col, index);\n  }\n\n  push(col: Column, weight = NaN) {\n    return this.insert(col, this.length, weight);\n  }\n\n  insertAfter(col: Column, ref: Column, weight = NaN) {\n    const i = this.indexOf(ref);\n    if (i < 0) {\n      return null;\n    }\n    return this.insert(col, i + 1, weight);\n  }\n\n  /**\n   * adapts weights according to an own width change\n   * @param col\n   * @param oldValue\n   * @param newValue\n   */\n  private adaptWidthChange(col: Column, oldValue: number, newValue: number) {\n    if (similar(oldValue, newValue, 0.5)) {\n      return;\n    }\n    const bak = this.getWeights();\n    const full = this.getWidth(),\n      change = (newValue - oldValue) / full;\n    const oldWeight = oldValue / full;\n    const factor = (1 - oldWeight - change) / (1 - oldWeight);\n    const widths = this._children.map((c) => {\n      if (c === col) {\n        //c.weight += change;\n        return newValue;\n      }\n      const guess = c.getWidth() * factor;\n      const w = isNaN(guess) || guess < 1 ? 0 : guess;\n      c.setWidthImpl(w);\n      return w;\n    });\n    //adapt width if needed\n    super.setWidth(widths.reduce((a, b) => a + b, 0));\n\n    this.fire([StackColumn.EVENT_WEIGHTS_CHANGED, StackColumn.EVENT_MULTI_LEVEL_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, this.getWeights());\n  }\n\n  getWeights() {\n    const w = this.getWidth();\n    return this._children.map((d) => d.getWidth() / w);\n  }\n\n  setWeights(weights: number[]) {\n    const bak = this.getWeights();\n    const delta = weights.length - this.length;\n    let s: number;\n    if (delta < 0) {\n      s = weights.reduce((p, a) => p + a, 0);\n      if (s <= 1) {\n        for (let i = 0; i < -delta; ++i) {\n          weights.push((1 - s) * (1 / -delta));\n        }\n      } else if (s <= 100) {\n        for (let i = 0; i < -delta; ++i) {\n          weights.push((100 - s) * (1 / -delta));\n        }\n      }\n    }\n    weights = weights.slice(0, this.length);\n    s = weights.reduce((p, a) => p + a, 0) / this.getWidth();\n    weights = weights.map((d) => d / s);\n\n    this._children.forEach((c, i) => {\n      c.setWidthImpl(weights[i]);\n    });\n    this.fire([StackColumn.EVENT_WEIGHTS_CHANGED, StackColumn.EVENT_MULTI_LEVEL_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, weights);\n\n  }\n\n  removeImpl(child: Column, index: number) {\n    child.on(`${Column.EVENT_WIDTH_CHANGED}.stack`, null);\n    super.setWidth(this.length === 0 ? 100 : this.getWidth() - child.getWidth());\n    return super.removeImpl(child, index);\n  }\n\n  setWidth(value: number) {\n    const factor = value / this.getWidth();\n    this._children.forEach((child) => {\n      //disable since we change it\n      child.setWidthImpl(child.getWidth() * factor);\n    });\n    super.setWidth(value);\n  }\n\n  protected compute(row: IDataRow) {\n    const w = this.getWidth();\n    return this._children.reduce((acc, d) => acc + d.getValue(row) * (d.getWidth() / w), 0);\n  }\n\n  getRenderer() {\n    if (this.getCollapsed() && this.isLoaded()) {\n      return StackColumn.COLLAPSED_RENDERER;\n    }\n    return super.getRenderer();\n  }\n\n  isMissing(row: IDataRow) {\n    return this._children.some((c) => isNumberColumn(c) && c.isMissing(row));\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      return {\n        value: this.getRawNumber(row),\n        children: this.children.map((d) => d.getExportValue(row, format))\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n}\n","export function hasDnDType(e: DragEvent, ...typesToCheck: string[]) {\r\n  console.assert(e.dataTransfer != null);\r\n  const available: any = e.dataTransfer!.types;\r\n\r\n  /*\r\n   * In Chrome datatransfer.types is an Array,\r\n   * while in Firefox it is a DOMStringList\r\n   * that only implements a contains-method!\r\n   */\r\n  if (typeof available.indexOf === 'function') {\r\n    return typesToCheck.some((type) => available.indexOf(type) >= 0);\r\n  }\r\n  if (typeof available.includes === 'function') {\r\n    return typesToCheck.some((type) => available.includes(type));\r\n  }\r\n  if (typeof available.contains === 'function') {\r\n    return typesToCheck.some((type) => available.contains(type));\r\n  }\r\n  return false;\r\n}\r\n\r\n\r\n/**\r\n * helper storage for dnd in edge since edge doesn't support custom mime-types\r\n * @type {Map<number, {[p: string]: string}>}\r\n */\r\nconst dndTransferStorage = new Map<number, { [key: string]: string }>();\r\n\r\nfunction isEdgeDnD(e: DragEvent) {\r\n  return dndTransferStorage.size > 0 && hasDnDType(e, 'text/plain');\r\n}\r\n\r\n/**\r\n * checks whether it is a copy operation\r\n * @param e\r\n * @returns {boolean|RegExpMatchArray}\r\n * @internal\r\n */\r\nexport function copyDnD(e: DragEvent) {\r\n  console.assert(e.dataTransfer != null);\r\n  const dT = e.dataTransfer!;\r\n  return Boolean((e.ctrlKey && dT.effectAllowed.match(/copy/gi)) || (!dT.effectAllowed.match(/move/gi)));\r\n}\r\n\r\n/**\r\n * updates the drop effect accoriding to the current copyDnD state\r\n * @param e\r\n * @internal\r\n */\r\nexport function updateDropEffect(e: DragEvent) {\r\n  console.assert(e.dataTransfer != null);\r\n  const dT = e.dataTransfer!;\r\n  if (copyDnD(e)) {\r\n    dT.dropEffect = 'copy';\r\n  } else {\r\n    dT.dropEffect = 'move';\r\n  }\r\n}\r\n\r\nexport type IDragEffect = 'none' | 'copy' | 'copyLink' | 'copyMove' | 'link' | 'linkMove' | 'move' | 'all';\r\n\r\nexport interface IDragStartResult {\r\n  effectAllowed: IDragEffect;\r\n  data: { [mimeType: string]: string };\r\n}\r\n\r\nexport interface IDropResult {\r\n  effect: IDragEffect;\r\n  data: { [mimeType: string]: string };\r\n}\r\n\r\nlet idCounter = 0;\r\n\r\n/**\r\n * add drag support for the given element\r\n * @param {HTMLElement} node\r\n * @param {() => IDragStartResult} onDragStart callback to compute the payload an object of mime types\r\n * @param {boolean} stopPropagation whether to stop propagation in case of success\r\n * @internal\r\n */\r\nexport function dragAble(node: HTMLElement, onDragStart: () => IDragStartResult, stopPropagation: boolean = false) {\r\n  const id = ++idCounter;\r\n  node.draggable = true;\r\n  node.addEventListener('dragstart', (e) => {\r\n    node.classList.add('lu-dragging');\r\n    const payload = onDragStart();\r\n    console.assert(e.dataTransfer != null);\r\n    const dT = e.dataTransfer!;\r\n    dT.effectAllowed = payload.effectAllowed;\r\n\r\n    if (stopPropagation) {\r\n      e.stopPropagation();\r\n    }\r\n\r\n    const keys = Object.keys(payload.data);\r\n    const allSucceded = keys.every((k) => {\r\n      try {\r\n        dT.setData(k, payload.data[k]);\r\n        return true;\r\n      } catch (e) {\r\n        return false;\r\n      }\r\n    });\r\n    if (allSucceded) {\r\n      return;\r\n    }\r\n    //compatibility mode for edge\r\n    const text = payload.data['text/plain'] || '';\r\n    dT.setData('text/plain', `${id}${text ? `: ${text}` : ''}`);\r\n    dndTransferStorage.set(id, payload.data);\r\n  });\r\n  node.addEventListener('dragend', (e) => {\r\n    node.classList.remove('lu-dragging');\r\n    if (stopPropagation) {\r\n      e.stopPropagation();\r\n    }\r\n    if (dndTransferStorage.size > 0) {\r\n      //clear the id\r\n      dndTransferStorage.delete(id);\r\n    }\r\n\r\n    // remove all\r\n    const over = <HTMLElement>node.ownerDocument!.querySelector('.lu-dragover');\r\n    if (over) {\r\n      over.classList.remove('lu-dragover');\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * add dropable support for the given node\r\n * @param {HTMLElement} node\r\n * @param {string[]} mimeTypes mimeTypes to look for\r\n * @param {(result: IDropResult, e: DragEvent) => boolean} onDrop callback when dropped, returns true if the drop was successful\r\n * @param {(e: DragEvent) => void} onDragOver optional drag over handler, e.g. for special effects\r\n * @param {boolean} stopPropagation flag if the event propagation should be stopped in case of success\r\n * @internal\r\n */\r\nexport function dropAble(node: HTMLElement, mimeTypes: string[], onDrop: (result: IDropResult, e: DragEvent) => boolean, onDragOver: null | ((e: DragEvent) => void) = null, stopPropagation: boolean = false) {\r\n  node.addEventListener('dragenter', (e) => {\r\n    //var xy = mouse($node.node());\r\n    if (!node.classList.contains('lu-dragging') && (hasDnDType(e, ...mimeTypes) || isEdgeDnD(e))) {\r\n      node.classList.add('lu-dragover');\r\n      if (stopPropagation) {\r\n        e.stopPropagation();\r\n      }\r\n      //sounds good\r\n      return false;\r\n    }\r\n    //not a valid mime type\r\n    node.classList.remove('lu-dragover');\r\n    return;\r\n  });\r\n  node.addEventListener('dragover', (e) => {\r\n    if (!node.classList.contains('lu-dragging') && (hasDnDType(e, ...mimeTypes) || isEdgeDnD(e))) {\r\n      e.preventDefault();\r\n      updateDropEffect(e);\r\n      node.classList.add('lu-dragover');\r\n\r\n      if (stopPropagation) {\r\n        e.stopPropagation();\r\n      }\r\n      if (onDragOver) {\r\n        onDragOver(e);\r\n      }\r\n      //sound good\r\n      return false;\r\n    }\r\n    return;\r\n  });\r\n  node.addEventListener('dragleave', (evt) => {\r\n    // same fix as in phovea\r\n    (<HTMLElement>evt.target).classList.remove('lu-dragover');\r\n  });\r\n  node.addEventListener('drop', (e) => {\r\n    e.preventDefault();\r\n    if (stopPropagation) {\r\n      e.stopPropagation();\r\n    }\r\n    updateDropEffect(e);\r\n    console.assert(e.dataTransfer != null);\r\n    const dT = e.dataTransfer!;\r\n    const effect = <IDragEffect>dT.dropEffect;\r\n\r\n    node.classList.remove('lu-dragover');\r\n\r\n    if (isEdgeDnD(e)) {\r\n      const base = dT.getData('text/plain');\r\n      const id = parseInt(base.indexOf(':') >= 0 ? base.substring(0, base.indexOf(':')) : base, 10);\r\n      if (dndTransferStorage.has(id)) {\r\n        const data = dndTransferStorage.get(id)!;\r\n        dndTransferStorage.delete(id);\r\n        return !onDrop({effect, data}, e);\r\n      }\r\n      return;\r\n    }\r\n    if (hasDnDType(e, ...mimeTypes)) {\r\n      const data: any = {};\r\n      //selects the data contained in the data transfer\r\n      mimeTypes.forEach((mime) => {\r\n        const value = dT.getData(mime);\r\n        if (value !== '') {\r\n          data[mime] = value;\r\n        }\r\n      });\r\n      return !onDrop({effect, data}, e);\r\n    }\r\n    return;\r\n  });\r\n}\r\n","import Column from '../../model/Column';\r\nimport {createToolbarMenuItems, updateIconState} from '../header';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class MoreColumnOptionsDialog extends ADialog {\r\n\r\n  constructor(private readonly column: Column, dialog: IDialogContext, private readonly ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-more-options');\r\n    createToolbarMenuItems(node, this.dialog.level + 1, this.column, this.ctx);\r\n\r\n    updateIconState(node, this.column);\r\n  }\r\n}\r\n","// import Popper from 'popper.js';\r\nimport {MIN_LABEL_WIDTH} from '../config';\r\nimport {equalArrays} from '../internal';\r\nimport {dragAble, dropAble, hasDnDType, IDropResult} from '../internal/dnd';\r\nimport {\r\n  createImpositionBoxPlotDesc, createImpositionDesc, createImpositionsDesc, createNestedDesc, createReduceDesc,\r\n  createStackDesc, IColumnDesc, isArrayColumn, isBoxPlotColumn, isCategoricalColumn, isMapColumn, isNumberColumn,\r\n  isNumbersColumn\r\n} from '../model';\r\nimport {categoryOf} from '../model/annotations';\r\nimport Column from '../model/Column';\r\nimport {default as CompositeColumn, IMultiLevelColumn, isMultiLevelColumn} from '../model/CompositeColumn';\r\nimport ImpositionBoxPlotColumn from '../model/ImpositionBoxPlotColumn';\r\nimport ImpositionCompositeColumn from '../model/ImpositionCompositeColumn';\r\nimport ImpositionCompositesColumn from '../model/ImpositionCompositesColumn';\r\nimport {IRankingHeaderContext} from './interfaces';\r\nimport {IOnClickHandler, getToolbar, dialogContext} from './toolbar';\r\nimport {IToolbarAction} from './toolbar';\r\nimport MoreColumnOptionsDialog from './dialogs/MoreColumnOptionsDialog';\r\n\r\n/** @internal */\r\nexport interface IHeaderOptions {\r\n  dragAble: boolean;\r\n  mergeDropAble: boolean;\r\n  rearrangeAble: boolean;\r\n  resizeable: boolean;\r\n  level: number;\r\n}\r\n\r\n/** @internal */\r\nexport function createHeader(col: Column, ctx: IRankingHeaderContext, options: Partial<IHeaderOptions> = {}) {\r\n  options = Object.assign({\r\n    dragAble: true,\r\n    mergeDropAble: true,\r\n    rearrangeAble: true,\r\n    resizeable: true,\r\n    level: 0\r\n  }, options);\r\n  const node = ctx.document.createElement('section');\r\n  node.innerHTML = `\r\n    <div class=\"lu-label\">${col.getWidth() < MIN_LABEL_WIDTH ? '&nbsp;' : col.label}</div>\r\n    <div class=\"lu-toolbar\"></div>\r\n    <div class=\"lu-spacing\"></div>\r\n    <div class=\"lu-handle lu-feature-advanced lu-feature-ui\"></div>\r\n  `;\r\n\r\n  // addTooltip(node, col);\r\n\r\n  createShortcutMenuItems(<HTMLElement>node.querySelector('div.lu-toolbar')!, options.level!, col, ctx);\r\n\r\n  toggleToolbarIcons(node, col);\r\n\r\n  if (options.dragAble) {\r\n    dragAbleColumn(node, col, ctx);\r\n  }\r\n  if (options.mergeDropAble) {\r\n    mergeDropAble(node, col, ctx);\r\n  }\r\n  if (options.rearrangeAble) {\r\n    rearrangeDropAble(<HTMLElement>node.querySelector('.lu-handle')!, col, ctx);\r\n  }\r\n  if (options.resizeable) {\r\n    dragWidth(col, node);\r\n  }\r\n  return node;\r\n}\r\n\r\n\r\n/** @internal */\r\nexport function updateHeader(node: HTMLElement, col: Column) {\r\n  const label = <HTMLElement>node.querySelector('.lu-label')!;\r\n  label.innerHTML = col.getWidth() < MIN_LABEL_WIDTH ? '&nbsp;' : col.label;\r\n  node.title = col.description ? `${col.label}\\n${col.description}` : col.label;\r\n  node.dataset.colId = col.id;\r\n  node.dataset.type = col.desc.type;\r\n  node.dataset.typeCat = categoryOf(col).name;\r\n\r\n  updateIconState(node, col);\r\n}\r\n\r\n\r\n/** @internal */\r\nexport function updateIconState(node: HTMLElement, col: Column) {\r\n  const sort = <HTMLElement>node.querySelector(`i[title='Sort']`)!;\r\n  if (sort) {\r\n    const {asc, priority} = col.isSortedByMe();\r\n    sort.dataset.sort = asc !== undefined ? asc : '';\r\n    if (priority !== undefined) {\r\n      sort.dataset.priority = (priority + 1).toString();\r\n    } else {\r\n      delete sort.dataset.priority;\r\n    }\r\n  }\r\n\r\n  const sortGroups = <HTMLElement>node.querySelector(`i[title='Sort Group']`)!;\r\n  if (sortGroups) {\r\n    const {asc, priority} = col.isGroupSortedByMe();\r\n    sortGroups.dataset.sort = asc !== undefined ? asc : '';\r\n    if (priority !== undefined) {\r\n      sortGroups.dataset.priority = (priority + 1).toString();\r\n    } else {\r\n      delete sortGroups.dataset.priority;\r\n    }\r\n  }\r\n\r\n  const group = <HTMLElement>node.querySelector(`i[title^='Group']`)!;\r\n  if (group) {\r\n    const groupedBy = col.isGroupedBy();\r\n    group.dataset.group = groupedBy >= 0 ? 'true' : 'false';\r\n    if (groupedBy >= 0) {\r\n      group.dataset.priority = (groupedBy + 1).toString();\r\n    } else {\r\n      delete group.dataset.priority;\r\n    }\r\n  }\r\n\r\n  const filter = <HTMLElement>node.querySelector(`i[title^='Filter']`)!;\r\n  if (!filter) {\r\n    return;\r\n  }\r\n  if (col.isFiltered()) {\r\n    filter.dataset.active = '';\r\n  } else {\r\n    delete filter.dataset.active;\r\n  }\r\n}\r\n\r\nfunction addIconDOM(node: HTMLElement, col: Column, ctx: IRankingHeaderContext, level: number, showLabel: boolean) {\r\n  return (action: IToolbarAction) => {\r\n    node.insertAdjacentHTML('beforeend', `<i data-a=\"${action.options.shortcut === 'only' ? 'o' : action.options.shortcut ? 's' : 'r'}\" title=\"${action.title}\" class=\"lu-action lu-feature-${action.options.featureLevel || 'basic'} lu-feature-${action.options.featureCategory || 'others'}\"><span${!showLabel ? ' aria-hidden=\"true\"' : ''}>${action.title}</span> </i>`);\r\n    const i = <HTMLElement>node.lastElementChild;\r\n    i.onclick = (evt) => {\r\n      evt.stopPropagation();\r\n      ctx.dialogManager.setHighlightColumn(col);\r\n      action.onClick(col, <any>evt, ctx, level, !showLabel);\r\n    };\r\n    return i;\r\n  };\r\n}\r\n\r\nexport interface IAddIcon {\r\n  (title: string, onClick: IOnClickHandler): void;\r\n}\r\n\r\nexport function createShortcutMenuItems(node: HTMLElement, level: number, col: Column, ctx: IRankingHeaderContext, willAutoHide: boolean = true) {\r\n  const addIcon = addIconDOM(node, col, ctx, level, false);\r\n  const toolbar = getToolbar(col, ctx);\r\n  const shortcuts = toolbar.filter((d) => d.options.shortcut);\r\n  const hybrids = shortcuts.reduce((a, b) => a + (b.options.shortcut === true ? 1 : 0), 0);\r\n\r\n  shortcuts.forEach(addIcon);\r\n  const moreEntries = toolbar.length - shortcuts.length + hybrids;\r\n\r\n  if (shortcuts.length === toolbar.length || (moreEntries === hybrids && !willAutoHide)) {\r\n    // all visible or just hybrids that will always be visible\r\n    return;\r\n  }\r\n\r\n  // need a more entry\r\n  node.insertAdjacentHTML('beforeend', `<i data-a=\"m\" data-m=\"${moreEntries}\" title=\"More &hellip;\" class=\"lu-action\"><span aria-hidden=\"true\">More &hellip;</span></i>`);\r\n  const i = <HTMLElement>node.lastElementChild;\r\n  i.onclick = (evt) => {\r\n    evt.stopPropagation();\r\n    ctx.dialogManager.setHighlightColumn(col);\r\n    const dialog = new MoreColumnOptionsDialog(col, dialogContext(ctx, level, <any>evt), ctx);\r\n    dialog.open();\r\n  };\r\n}\r\n\r\nexport function createToolbarMenuItems(node: HTMLElement, level: number, col: Column, ctx: IRankingHeaderContext) {\r\n  const addIcon = addIconDOM(node, col, ctx, level, true);\r\n  getToolbar(col, ctx).filter((d) => d.options.shortcut !== 'only').forEach(addIcon);\r\n}\r\n\r\n/** @internal */\r\nfunction toggleRotatedHeader(node: HTMLElement, col: Column, defaultVisibleClientWidth: number) {\r\n  // rotate header flag if needed\r\n  const label = <HTMLElement>node.querySelector('.lu-label');\r\n  if (col.getWidth() < MIN_LABEL_WIDTH) {\r\n    label.classList.remove('lu-rotated');\r\n    return;\r\n  }\r\n  const width = label.clientWidth;\r\n  const rotated = width <= 0 ? (col.label.length * defaultVisibleClientWidth / 3 * 0.6 > col.getWidth()) : (label.scrollWidth * 0.6 > label.clientWidth);\r\n  label.classList.toggle('lu-rotated', rotated);\r\n}\r\n\r\n/** @internal */\r\nfunction toggleToolbarIcons(node: HTMLElement, col: Column, defaultVisibleClientWidth = 22.5) {\r\n  toggleRotatedHeader(node, col, defaultVisibleClientWidth);\r\n\r\n  const toolbar = <HTMLElement>node.querySelector('.lu-toolbar');\r\n  if (toolbar.childElementCount === 0) {\r\n    return;\r\n  }\r\n  const availableWidth = col.getWidth();\r\n  const actions = Array.from(toolbar.children).map((d) => ({node: <HTMLElement>d, width: d.clientWidth > 0 ? d.clientWidth : defaultVisibleClientWidth}));\r\n\r\n  const shortCuts =  actions.filter((d) => d.node.dataset.a === 'o');\r\n  const hybrids = actions.filter((d) => d.node.dataset.a === 's');\r\n  const moreIcon = actions.find((d) => d.node.dataset.a === 'm');\r\n  const moreEntries = moreIcon ? parseInt(moreIcon.node.dataset.m!, 10) : 0;\r\n  const needMore = moreEntries > hybrids.length;\r\n\r\n  let total = actions.reduce((a, b) => a + b.width, 0);\r\n\r\n  for (const action of actions) {\r\n    // maybe hide not needed \"more\"\r\n    action.node.classList.remove('hidden');\r\n  }\r\n\r\n  // all visible\r\n  if (total < availableWidth) {\r\n    return;\r\n  }\r\n  if (moreIcon && !needMore && (total - moreIcon.width) < availableWidth) {\r\n    // available space is enougth we can skip the \"more\" and then it fits\r\n    moreIcon.node.classList.add('hidden');\r\n    return;\r\n  }\r\n\r\n  for (const action of hybrids.reverse().concat(shortCuts.reverse())) { // back to forth and hybrids earlier than pure shortcuts\r\n    // hide and check if enough\r\n    action.node.classList.add('hidden');\r\n    total -= action.width;\r\n    if (total < availableWidth) {\r\n      return;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// function addTooltip(node: HTMLElement, col: Column) {\r\n//   let timer = -1;\r\n//   let popper: Popper | null = null;\r\n\r\n//   const showTooltip = () => {\r\n//     timer = -1;\r\n//     // no tooltip if no description\r\n//     if (col.description.length <= 0) {\r\n//       return;\r\n//     }\r\n//     const parent = <HTMLElement>node.closest('.lu')!;\r\n//     parent.insertAdjacentHTML('beforeend', `<div class=\"lu-tooltip\" data-type=\"${col.desc.type}\" data-type-cat=\"${categoryOf(col).name}\">\r\n//         <div x-arrow></div>\r\n//         <strong class=\"lu-label\">${col.label}</strong>\r\n//         <p>${col.description.replace('\\n', `<br/>`)}</p>\r\n//     </div>`);\r\n//     popper = new Popper(node, parent.lastElementChild!, {\r\n//       removeOnDestroy: true,\r\n//       placement: 'auto',\r\n//       modifiers: {\r\n//         flip: {\r\n//           enabled: false\r\n//         },\r\n//         preventOverflow: {\r\n//           enabled: false\r\n//         }\r\n//       }\r\n//     });\r\n//   };\r\n\r\n//   node.addEventListener('mouseenter', () => {\r\n//     if (col.description.length > 0) {\r\n//       timer = self.setTimeout(showTooltip, HOVER_DELAY_SHOW_DETAIL);\r\n//     }\r\n//   });\r\n//   node.addEventListener('mouseleave', () => {\r\n//     if (timer >= 0) {\r\n//       clearTimeout(timer);\r\n//       timer = -1;\r\n//     }\r\n//     if (popper) {\r\n//       popper.destroy();\r\n//       popper = null;\r\n//     }\r\n//   });\r\n// }\r\n\r\n/**\r\n * allow to change the width of a column using dragging the handle\r\n * @internal\r\n */\r\nexport function dragWidth(col: Column, node: HTMLElement) {\r\n  let ueberElement: HTMLElement;\r\n  const handle = <HTMLElement>node.querySelector('.lu-handle');\r\n\r\n\r\n  let start = 0;\r\n  const mouseMove = (evt: MouseEvent) => {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    const end = evt.clientX;\r\n    const delta = end - start;\r\n    const width = Math.max(0, col.getWidth() + delta);\r\n\r\n    if (Math.abs(start - end) < 2) {\r\n      //ignore\r\n      return;\r\n    }\r\n    start = end;\r\n    node.style.width = `${width}px`;\r\n    col.setWidth(width);\r\n    toggleToolbarIcons(node, col);\r\n  };\r\n\r\n  const mouseUp = (evt: MouseEvent) => {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    const end = evt.clientX;\r\n    node.classList.remove('lu-change-width');\r\n\r\n    ueberElement.removeEventListener('mousemove', mouseMove);\r\n    ueberElement.removeEventListener('mouseup', mouseUp);\r\n    ueberElement.removeEventListener('mouseleave', mouseUp);\r\n    node.style.width = null;\r\n\r\n    if (Math.abs(start - end) < 2) {\r\n      //ignore\r\n      return;\r\n    }\r\n    const delta = end - start;\r\n    const width = Math.max(0, col.getWidth() + delta);\r\n    col.setWidth(width);\r\n    toggleToolbarIcons(node, col);\r\n  };\r\n  handle.onmousedown = (evt) => {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    node.classList.add('lu-change-width');\r\n\r\n    start = evt.clientX;\r\n    ueberElement = <HTMLElement>node.closest('header')!;\r\n    ueberElement.addEventListener('mousemove', mouseMove);\r\n    ueberElement.addEventListener('mouseup', mouseUp);\r\n    ueberElement.addEventListener('mouseleave', mouseUp);\r\n  };\r\n  handle.onclick = (evt) => {\r\n    // avoid resorting\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n  };\r\n}\r\n\r\nexport const MIMETYPE_PREFIX = 'text/x-caleydo-lineup-column';\r\n\r\n/**\r\n * allow to drag the column away\r\n * @internal\r\n */\r\nexport function dragAbleColumn(node: HTMLElement, column: Column, ctx: IRankingHeaderContext) {\r\n  dragAble(node, () => {\r\n    const ref = JSON.stringify(ctx.provider.toDescRef(column.desc));\r\n    const data: any = {\r\n      'text/plain': column.label,\r\n      [`${MIMETYPE_PREFIX}-ref`]: column.id,\r\n      [MIMETYPE_PREFIX]: ref\r\n    };\r\n    if (isNumberColumn(column)) {\r\n      data[`${MIMETYPE_PREFIX}-number`] = ref;\r\n      data[`${MIMETYPE_PREFIX}-number-ref`] = column.id;\r\n    }\r\n    if (isCategoricalColumn(column)) {\r\n      data[`${MIMETYPE_PREFIX}-categorical`] = ref;\r\n      data[`${MIMETYPE_PREFIX}-categorical-ref`] = column.id;\r\n    }\r\n    if (isBoxPlotColumn(column)) {\r\n      data[`${MIMETYPE_PREFIX}-boxplot`] = ref;\r\n      data[`${MIMETYPE_PREFIX}-boxplot-ref`] = column.id;\r\n    }\r\n    if (isMapColumn(column)) {\r\n      data[`${MIMETYPE_PREFIX}-map`] = ref;\r\n      data[`${MIMETYPE_PREFIX}-map-ref`] = column.id;\r\n    }\r\n    if (isArrayColumn(column)) {\r\n      data[`${MIMETYPE_PREFIX}-array`] = ref;\r\n      data[`${MIMETYPE_PREFIX}-array-ref`] = column.id;\r\n    }\r\n    if (isNumbersColumn(column)) {\r\n      data[`${MIMETYPE_PREFIX}-numbers`] = ref;\r\n      data[`${MIMETYPE_PREFIX}-numbers-ref`] = column.id;\r\n    }\r\n    return {\r\n      effectAllowed: 'copyMove',\r\n      data\r\n    };\r\n  }, true);\r\n}\r\n\r\n/**\r\n * dropper for allowing to rearrange (move, copy) columns\r\n * @internal\r\n */\r\nexport function rearrangeDropAble(node: HTMLElement, column: Column, ctx: IRankingHeaderContext) {\r\n  dropAble(node, [`${MIMETYPE_PREFIX}-ref`, MIMETYPE_PREFIX], (result) => {\r\n    let col: Column | null = null;\r\n    const data = result.data;\r\n    if (!(`${MIMETYPE_PREFIX}-ref` in data)) {\r\n      const desc = JSON.parse(data[MIMETYPE_PREFIX]);\r\n      col = ctx.provider.create(ctx.provider.fromDescRef(desc));\r\n      return col != null && column.insertAfterMe(col) != null;\r\n    }\r\n\r\n    // find by reference\r\n    const id = data[`${MIMETYPE_PREFIX}-ref`];\r\n    col = ctx.provider.find(id);\r\n    if (!col || (col === column && !result.effect.startsWith('copy'))) {\r\n      return false;\r\n    }\r\n    if (result.effect.startsWith('copy')) {\r\n      col = ctx.provider.clone(col!);\r\n      return col != null && column.insertAfterMe(col) != null;\r\n    }\r\n    // detect whether it is an internal move operation or an real remove/insert operation\r\n    const toInsertParent = col.parent;\r\n    if (!toInsertParent) { // no parent will always be a move\r\n      return column.insertAfterMe(col) != null;\r\n    }\r\n    if (toInsertParent === column.parent) {\r\n      // move operation\r\n      return toInsertParent.moveAfter(col, column) != null;\r\n    }\r\n    col.removeMe();\r\n    return column.insertAfterMe(col) != null;\r\n  }, null, true);\r\n}\r\n\r\n/**\r\n * dropper for allowing to change the order by dropping it at a certain position\r\n * @internal\r\n */\r\nexport function resortDropAble(node: HTMLElement, column: Column, ctx: IRankingHeaderContext, where: 'before' | 'after', autoGroup: boolean) {\r\n  dropAble(node, [`${MIMETYPE_PREFIX}-ref`, MIMETYPE_PREFIX], (result) => {\r\n    let col: Column | null = null;\r\n    const data = result.data;\r\n    if (`${MIMETYPE_PREFIX}-ref` in data) {\r\n      const id = data[`${MIMETYPE_PREFIX}-ref`];\r\n      col = ctx.provider.find(id);\r\n      if (!col || col === column) {\r\n        return false;\r\n      }\r\n    } else {\r\n      const desc = JSON.parse(data[MIMETYPE_PREFIX]);\r\n      col = ctx.provider.create(ctx.provider.fromDescRef(desc));\r\n      if (col) {\r\n        column.findMyRanker()!.push(col);\r\n      }\r\n    }\r\n    const ranking = column.findMyRanker()!;\r\n    if (!col || col === column || !ranking) {\r\n      return false;\r\n    }\r\n\r\n    const criteria = ranking.getSortCriteria();\r\n    const groups = ranking.getGroupCriteria();\r\n\r\n    const removeFromSort = (col: Column) => {\r\n      const existing = criteria.findIndex((d) => d.col === col);\r\n      if (existing >= 0) { // remove existing column but keep asc state\r\n        return criteria.splice(existing, 1)[0].asc;\r\n      }\r\n      return false;\r\n    };\r\n\r\n    // remove the one to add\r\n    const asc = removeFromSort(col);\r\n\r\n    const groupIndex = groups.indexOf(column);\r\n    const index = criteria.findIndex((d) => d.col === column);\r\n\r\n    if (autoGroup && groupIndex >= 0) {\r\n      // before the grouping, so either ungroup or regroup\r\n      removeFromSort(column);\r\n      if (isCategoricalColumn(col)) { // we can group by it\r\n        groups.splice(groupIndex + (where === 'after' ? 1 : 0), 0, col);\r\n        if (groups.length > ranking.getMaxGroupColumns()) {\r\n          // move the rest to sorting\r\n          const removed = groups.splice(0, groups.length - ranking.getMaxGroupColumns());\r\n          criteria.unshift(...removed.reverse().map((d) => ({asc: false, col: d}))); // now a first sorting criteria\r\n        }\r\n      } else {\r\n        // remove all before and shift to sorting + sorting\r\n        const removed = groups.splice(0, groups.length - groupIndex);\r\n        criteria.unshift(...removed.reverse().map((d) => ({asc: false, col: d}))); // now a first sorting criteria\r\n        criteria.unshift({asc, col});\r\n      }\r\n    } else if (index < 0) {\r\n      criteria.push({asc, col});\r\n    } else if (index === 0 && autoGroup && isCategoricalColumn(col)) {\r\n      // make group criteria\r\n      groups.push(col);\r\n    } else {\r\n      criteria.splice(index + (where === 'after' ? 1 : 0), 0, {asc, col});\r\n    }\r\n\r\n    if (!equalArrays(groups, ranking.getGroupCriteria())) {\r\n      ranking.setGroupCriteria(groups);\r\n    }\r\n    ranking.setSortCriteria(criteria);\r\n    return true;\r\n  }, null, true);\r\n}\r\n\r\n/**\r\n * dropper for merging columns\r\n * @internal\r\n */\r\nexport function mergeDropAble(node: HTMLElement, column: Column, ctx: IRankingHeaderContext) {\r\n  const resolveDrop = (result: IDropResult) => {\r\n    const data = result.data;\r\n    const copy = result.effect === 'copy';\r\n    const prefix = MIMETYPE_PREFIX;\r\n    const key = Object.keys(data).find((d) => d.startsWith(prefix) && d.endsWith('-ref'));\r\n    if (key) {\r\n      const id = data[key];\r\n      let col: Column = ctx.provider.find(id)!;\r\n      if (copy) {\r\n        col = ctx.provider.clone(col);\r\n      } else if (col === column) {\r\n        return null;\r\n      } else {\r\n        col.removeMe();\r\n      }\r\n      return col;\r\n    }\r\n    const alternative = Object.keys(data).find((d) => d.startsWith(prefix));\r\n    if (!alternative) {\r\n      return null;\r\n    }\r\n    const desc = JSON.parse(alternative);\r\n    return ctx.provider.create(ctx.provider.fromDescRef(desc))!;\r\n  };\r\n\r\n  const pushChild = (result: IDropResult) => {\r\n    const col: Column | null = resolveDrop(result);\r\n    return col != null && (<CompositeColumn>column).push(col) != null;\r\n  };\r\n\r\n  const mergeImpl = (col: Column | null, desc: IColumnDesc) => {\r\n    if (col == null) {\r\n      return false;\r\n    }\r\n    const ranking = column.findMyRanker()!;\r\n    const index = ranking.indexOf(column);\r\n    const parent = <CompositeColumn>ctx.provider.create(desc);\r\n    column.removeMe();\r\n    parent.push(column);\r\n    parent.push(col);\r\n    return ranking.insert(parent, index) != null;\r\n  };\r\n\r\n  const mergeWith = (desc: IColumnDesc) => (result: IDropResult) => {\r\n    const col: Column | null = resolveDrop(result);\r\n    return mergeImpl(col, desc);\r\n  };\r\n\r\n  const all = [`${MIMETYPE_PREFIX}-ref`, MIMETYPE_PREFIX];\r\n  const numberish = [`${MIMETYPE_PREFIX}-number-ref`, `${MIMETYPE_PREFIX}-number`];\r\n  const categorical = [`${MIMETYPE_PREFIX}-categorical-ref`, `${MIMETYPE_PREFIX}-categorical`];\r\n  const boxplot = [`${MIMETYPE_PREFIX}-boxplot-ref`, `${MIMETYPE_PREFIX}-boxplot`];\r\n  const numbers = [`${MIMETYPE_PREFIX}-numbers-ref`, `${MIMETYPE_PREFIX}-numbers`];\r\n\r\n  node.dataset.draginfo = '+';\r\n  if (column instanceof ImpositionCompositeColumn) {\r\n    return dropAble(node, categorical.concat(numberish), pushChild, (e) => {\r\n      if (hasDnDType(e, ...categorical)) {\r\n        node.dataset.draginfo = 'Color by';\r\n        return;\r\n      }\r\n      if (hasDnDType(e, ...numberish)) {\r\n        node.dataset.draginfo = 'Wrap';\r\n      }\r\n    });\r\n  }\r\n  if (column instanceof ImpositionBoxPlotColumn) {\r\n    return dropAble(node, categorical.concat(boxplot), pushChild, (e) => {\r\n      if (hasDnDType(e, ...categorical)) {\r\n        node.dataset.draginfo = 'Color by';\r\n        return;\r\n      }\r\n      if (hasDnDType(e, ...boxplot)) {\r\n        node.dataset.draginfo = 'Wrap';\r\n      }\r\n    });\r\n  }\r\n  if (column instanceof ImpositionCompositesColumn) {\r\n    return dropAble(node, categorical.concat(numbers), pushChild, (e) => {\r\n      if (hasDnDType(e, ...categorical)) {\r\n        node.dataset.draginfo = 'Color by';\r\n        return;\r\n      }\r\n      if (hasDnDType(e, ...numbers)) {\r\n        node.dataset.draginfo = 'Wrap';\r\n      }\r\n    });\r\n  }\r\n  if (isMultiLevelColumn(column)) {\r\n    // stack column or nested\r\n    return dropAble(node, (<IMultiLevelColumn>column).canJustAddNumbers ? numberish : all, pushChild);\r\n  }\r\n  if (column instanceof CompositeColumn) {\r\n    return dropAble(node, (<CompositeColumn>column).canJustAddNumbers ? numberish : all, pushChild);\r\n  }\r\n  if (isNumbersColumn(column)) {\r\n    node.dataset.draginfo = 'Color by';\r\n    return dropAble(node, categorical, mergeWith(createImpositionsDesc()));\r\n  }\r\n  if (isBoxPlotColumn(column)) {\r\n    node.dataset.draginfo = 'Color by';\r\n    return dropAble(node, categorical, mergeWith(createImpositionBoxPlotDesc()));\r\n  }\r\n  if (isNumberColumn(column)) {\r\n    node.dataset.draginfo = 'Merge';\r\n    return dropAble(node, categorical.concat(numberish), (result: IDropResult, evt: DragEvent) => {\r\n      const col: Column | null = resolveDrop(result);\r\n      if (col == null) {\r\n        return false;\r\n      }\r\n      if (isCategoricalColumn(col)) {\r\n        return mergeImpl(col, createImpositionDesc());\r\n      }\r\n      if (isNumberColumn(col)) {\r\n        return mergeImpl(col, evt.shiftKey ? createReduceDesc() : createStackDesc());\r\n      }\r\n      return false;\r\n    }, (e) => {\r\n      if (hasDnDType(e, ...categorical)) {\r\n        node.dataset.draginfo = 'Color by';\r\n        return;\r\n      }\r\n      if (hasDnDType(e, ...numberish)) {\r\n        node.dataset.draginfo = e.shiftKey ? 'Min/Max' : 'Sum';\r\n      }\r\n    });\r\n  }\r\n  node.dataset.draginfo = 'Group';\r\n  return dropAble(node, all, mergeWith(createNestedDesc()));\r\n}\r\n","import {Category, toolbar} from './annotations';\nimport CategoricalColumn from './CategoricalColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {ICategoricalColumn, ICategory} from './ICategoricalColumn';\nimport {IDataRow, IGroup} from './interfaces';\nimport {colorPool} from './internal';\nimport {missingGroup} from './missing';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport interface ICategoryNode extends ICategory {\n  children: Readonly<ICategoryNode>[];\n}\n\nexport interface IPartialCategoryNode extends Partial<ICategory> {\n  children: IPartialCategoryNode[];\n}\n\nexport interface IHierarchyDesc {\n  hierarchy: IPartialCategoryNode;\n  hierarchySeparator?: string;\n}\n\nexport declare type IHierarchyColumnDesc = IHierarchyDesc & IValueColumnDesc<string>;\n\nexport interface ICategoryInternalNode extends ICategory {\n  path: string;\n  children: Readonly<ICategoryInternalNode>[];\n}\n\nexport interface ICutOffNode {\n  node: Readonly<ICategoryInternalNode>;\n  maxDepth: number;\n}\n\n/**\n * emitted when the cut off property changes\n * @asMemberOf HierarchyColumn\n * @event\n */\nexport declare function cutOffChanged(previous: ICutOffNode, current: ICutOffNode): void;\n\n/**\n * column for hierarchical categorical values\n */\n@toolbar('cutoff', 'group', 'groupBy')\n@Category('categorical')\nexport default class HierarchyColumn extends ValueColumn<string> implements ICategoricalColumn {\n  static readonly EVENT_CUTOFF_CHANGED = 'cutOffChanged';\n\n  private readonly hierarchySeparator: string;\n  readonly hierarchy: Readonly<ICategoryInternalNode>;\n\n  private currentNode: Readonly<ICategoryInternalNode>;\n  private currentMaxDepth: number = Infinity;\n  private currentLeaves: Readonly<ICategoryInternalNode>[] = [];\n  private readonly currentLeavesNameCache = new Map<string, Readonly<ICategoryInternalNode>>();\n  private readonly currentLeavesPathCache = new Map<string, Readonly<ICategoryInternalNode>>();\n\n  constructor(id: string, desc: Readonly<IHierarchyColumnDesc>) {\n    super(id, desc);\n    this.hierarchySeparator = desc.hierarchySeparator || '.';\n    this.hierarchy = this.initHierarchy(desc.hierarchy);\n    this.currentNode = this.hierarchy;\n    this.currentLeaves = computeLeaves(this.currentNode, this.currentMaxDepth);\n    this.updateCaches();\n\n    this.setDefaultRenderer('categorical');\n  }\n\n  private initHierarchy(root: IPartialCategoryNode) {\n    const colors = colorPool();\n    const s = this.hierarchySeparator;\n    const add = (prefix: string, node: IPartialCategoryNode): ICategoryInternalNode => {\n      const name = node.name == null ? String(node.value) : node.name;\n      const children = (node.children || []).map((child: IPartialCategoryNode | string): ICategoryInternalNode => {\n        if (typeof child === 'string') {\n          const path = prefix + child;\n          return {\n            path,\n            name: child,\n            label: path,\n            color: colors(),\n            value: 0,\n            children: []\n          };\n        }\n        const r = add(`${prefix}${name}${s}`, child);\n        if (!r.color) {\n          //hack to inject the next color\n          (<any>r).color = colors();\n        }\n        return r;\n      });\n      const path = prefix + name;\n      const label = node.label ? `${node.label}` : path;\n      return {path, name, children, label, color: node.color!, value: 0};\n    };\n    return add('', root);\n  }\n\n  get categories() {\n    return this.currentLeaves;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([HierarchyColumn.EVENT_CUTOFF_CHANGED]);\n  }\n\n  on(type: typeof HierarchyColumn.EVENT_CUTOFF_CHANGED, listener: typeof cutOffChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getCutOff(): ICutOffNode {\n    return {\n      node: this.currentNode,\n      maxDepth: this.currentMaxDepth\n    };\n  }\n\n  setCutOff(value: ICutOffNode) {\n    const maxDepth = value.maxDepth == null ? Infinity : value.maxDepth;\n    if (this.currentNode === value.node && this.currentMaxDepth === maxDepth) {\n      return;\n    }\n    const bak = this.getCutOff();\n    this.currentNode = value.node;\n    this.currentMaxDepth = maxDepth;\n    this.currentLeaves = computeLeaves(value.node, maxDepth);\n    this.updateCaches();\n    this.fire([HierarchyColumn.EVENT_CUTOFF_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, this.getCutOff());\n  }\n\n  getCategory(row: IDataRow) {\n    let v = super.getValue(row);\n    if (v == null || v === '') {\n      return null;\n    }\n    v = v.trim();\n    if (this.currentLeavesNameCache.has(v)) {\n      return this.currentLeavesNameCache.get(v)!;\n    }\n    if (this.currentLeavesPathCache.has(v)) {\n      return this.currentLeavesPathCache.get(v)!;\n    }\n    return this.currentLeaves.find((n) => {\n      //direct hit or is a child of it\n      return n.path === v || n.name === v || v!.startsWith(n.path + this.hierarchySeparator);\n    }) || null;\n  }\n\n  get dataLength() {\n    return this.currentLeaves.length;\n  }\n\n  get labels() {\n    return this.currentLeaves.map((d) => d.label);\n  }\n\n  getValue(row: IDataRow) {\n    const v = this.getCategory(row);\n    return v ? v.name : null;\n  }\n\n  getLabel(row: IDataRow) {\n    return CategoricalColumn.prototype.getLabel.call(this, row);\n  }\n\n  getColor(row: IDataRow) {\n    return CategoricalColumn.prototype.getColor.call(this, row);\n  }\n\n  getLabels(row: IDataRow) {\n    return CategoricalColumn.prototype.getLabels.call(this, row);\n  }\n\n  getValues(row: IDataRow) {\n    return CategoricalColumn.prototype.getValues.call(this, row);\n  }\n\n  getMap(row: IDataRow) {\n    return CategoricalColumn.prototype.getMap.call(this, row);\n  }\n\n  getMapLabel(row: IDataRow) {\n    return CategoricalColumn.prototype.getMapLabel.call(this, row);\n  }\n\n  getSet(row: IDataRow) {\n    return CategoricalColumn.prototype.getSet.call(this, row);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return CategoricalColumn.prototype.compare.call(this, a, b);\n  }\n\n  group(row: IDataRow): IGroup {\n    if (this.isMissing(row)) {\n      return missingGroup;\n    }\n    const base = this.getCategory(row);\n    if (!base) {\n      return super.group(row);\n    }\n    return {name: base.label, color: base.color};\n  }\n\n  private updateCaches() {\n    this.currentLeavesPathCache.clear();\n    this.currentLeavesNameCache.clear();\n\n    this.currentLeaves.forEach((n) => {\n      this.currentLeavesPathCache.set(n.path, n);\n      this.currentLeavesNameCache.set(n.name, n);\n    });\n  }\n}\n\nfunction computeLeaves(node: ICategoryInternalNode, maxDepth: number = Infinity) {\n  const leaves: ICategoryInternalNode[] = [];\n  //depth first\n  const visit = (node: ICategoryInternalNode, depth: number) => {\n    //hit or end\n    if (depth >= maxDepth || node.children.length === 0) {\n      leaves.push(node);\n    } else {\n      // go down\n      node.children.forEach((c) => visit(c, depth + 1));\n    }\n  };\n  visit(node, 0);\n  return leaves;\n}\n\nexport function resolveInnerNodes(node: ICategoryInternalNode) {\n  //breath first\n  const queue: ICategoryInternalNode[] = [node];\n  let index = 0;\n  while (index < queue.length) {\n    const next = queue[index++];\n    queue.push(...next.children);\n  }\n  return queue;\n}\n\nexport function isHierarchical(categories: (string | Partial<ICategory>)[]) {\n  if (categories.length === 0 || typeof categories[0] === 'string') {\n    return false;\n  }\n  // check if any has a given parent name\n  return categories.some((c) => (<any>c).parent != null);\n}\n\nexport function deriveHierarchy(categories: (Partial<ICategory> & { parent: string | null })[]) {\n  const lookup = new Map<string, ICategoryNode>();\n  categories.forEach((c) => {\n    const p = c.parent || '';\n    // set and fill up proxy\n    const item = Object.assign(<ICategoryNode>{\n      children: [],\n      label: c.name!,\n      name: c.name!,\n      color: Column.DEFAULT_COLOR,\n      value: 0\n    }, lookup.get(c.name!) || {}, c);\n    lookup.set(c.name!, item);\n\n    if (!lookup.has(p)) {\n      // create proxy\n      lookup.set(p, {name: p, children: [], label: p, value: 0, color: Column.DEFAULT_COLOR});\n    }\n    lookup.get(p)!.children.push(item);\n  });\n  const root = lookup.get('')!;\n  console.assert(root !== undefined, 'hierarchy with no root');\n  if (root.children.length === 1) {\n    return root.children[0];\n  }\n  return root;\n}\n","import {Category} from './annotations';\r\nimport {IKeyValue, IMapColumn} from './IArrayColumn';\r\nimport {IDataRow} from './interfaces';\r\nimport ValueColumn, {IValueColumnDesc} from './ValueColumn';\r\n\r\nexport interface IMapColumnDesc<T> extends IValueColumnDesc<IKeyValue<T>[]> {\r\n  // dummy\r\n}\r\n\r\n@Category('map')\r\nexport default class MapColumn<T> extends ValueColumn<IKeyValue<T>[]> implements IMapColumn<T> {\r\n\r\n  constructor(id: string, desc: Readonly<IMapColumnDesc<T>>) {\r\n    super(id, desc);\r\n    this.setDefaultWidth(200); //by default 200\r\n  }\r\n\r\n  getValue(row: IDataRow) {\r\n    return toKeyValue<T>(<any>super.getValue(row));\r\n  }\r\n\r\n  getLabels(row: IDataRow): IKeyValue<string>[] {\r\n    const v = this.getValue(row);\r\n    return v.map(({key, value}) => ({key, value: String(value)}));\r\n  }\r\n\r\n  getMap(row: IDataRow) {\r\n    return this.getValue(row);\r\n  }\r\n\r\n  getMapLabel(row: IDataRow) {\r\n    return this.getLabels(row);\r\n  }\r\n\r\n  getLabel(row: IDataRow) {\r\n    const v = this.getLabels(row);\r\n    return `{${v.map(({key, value}) => `${key}: ${value}`).join(', ')}}`;\r\n  }\r\n}\r\n\r\nfunction byKey(a: IKeyValue<any>, b: IKeyValue<any>) {\r\n  if (a === b) {\r\n    return 0;\r\n  }\r\n  return a.key.localeCompare(b.key);\r\n}\r\n\r\nfunction toKeyValue<T>(v?: Map<string, T> | { [key: string]: T } | IKeyValue<T>[]): IKeyValue<T>[] {\r\n  if (!v) {\r\n    return [];\r\n  }\r\n  if (v instanceof Map) {\r\n    return Array.from(v.entries()).map(([key, value]) => ({key, value})).sort(byKey);\r\n  }\r\n  if (Array.isArray(v)) {\r\n    return v; // keep original order\r\n  }\r\n  // object\r\n  return Object.keys(v).map((key) => ({key, value: v[key]})).sort(byKey);\r\n}\r\n","import {timeFormat, timeParse} from 'd3-time-format';\nimport {median, min, max} from 'd3-array';\nimport {dialogAddons, toolbar} from './annotations';\nimport ArrayColumn, {IArrayColumnDesc, spliceChanged} from './ArrayColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IDateDesc, IDateColumn, IDateFilter, noDateFilter, restoreDateFilter, isDummyDateFilter} from './IDateColumn';\nimport {IDataRow} from './interfaces';\nimport {FIRST_IS_MISSING, isMissingValue} from './missing';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport DateColumn from './DateColumn';\n\nexport enum EDateSort {\n  min = 'min',\n  max = 'max',\n  median = 'median'\n}\n\nexport interface IDatesDesc extends IDateDesc {\n  sort?: EDateSort;\n}\n\nexport declare type IDatesColumnDesc = IDatesDesc & IArrayColumnDesc<Date>;\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf DatesColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: EDateSort, current: EDateSort): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf DatesColumn\n * @event\n */\nexport declare function filterChanged(previous: IDateFilter | null, current: IDateFilter | null): void;\n\n@toolbar('filterDate')\n@dialogAddons('sort', 'sortDates')\nexport default class DatesColumn extends ArrayColumn<Date | null> implements IDateColumn {\n  static readonly EVENT_SORTMETHOD_CHANGED = 'sortMethodChanged';\n  static readonly EVENT_FILTER_CHANGED = DateColumn.EVENT_FILTER_CHANGED;\n\n  private readonly format: (date: Date) => string;\n  private readonly parse: (date: string) => Date | null;\n  private sort: EDateSort;\n  private currentFilter: IDateFilter = noDateFilter();\n\n  constructor(id: string, desc: Readonly<IDatesColumnDesc>) {\n    super(id, desc);\n    this.format = timeFormat(desc.dateFormat || '%x');\n    this.parse = desc.dateParse ? timeParse(desc.dateParse) : timeParse(desc.dateFormat || '%x');\n    this.sort = desc.sort || EDateSort.median;\n    this.setDefaultRenderer('default');\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([DatesColumn.EVENT_SORTMETHOD_CHANGED, DatesColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof DatesColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof DatesColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ArrayColumn.EVENT_SPLICE_CHANGED, listener: typeof spliceChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow): (Date | null)[] {\n    return this.getDates(row);\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getValue(row).map((v) => (v instanceof Date) ? this.format(v) : '');\n  }\n\n  getDates(row: IDataRow): (Date | null)[] {\n    return super.getValue(row).map((v) => {\n      if (isMissingValue(v)) {\n        return null;\n      }\n      if (v instanceof Date) {\n        return v;\n      }\n      return this.parse(String(v));\n    });\n  }\n\n  getDate(row: IDataRow) {\n    const av = <Date[]>this.getDates(row).filter(Boolean);\n    if (av.length === 0) {\n      return null;\n    }\n    return new Date(compute(av, this.sort));\n  }\n\n  getSortMethod() {\n    return this.sort;\n  }\n\n  setSortMethod(sort: EDateSort) {\n    if (this.sort === sort) {\n      return;\n    }\n    this.fire([DatesColumn.EVENT_SORTMETHOD_CHANGED], this.sort, this.sort = sort);\n    // sort by me if not already sorted by me\n    if (!this.isSortedByMe().asc) {\n      this.sortByMe();\n    }\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.sortMethod = this.getSortMethod();\n    r.filter = !isDummyDateFilter(this.currentFilter) ? this.currentFilter : null;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (dump.sortMethod) {\n      this.sort = dump.sortMethod;\n    }\n    if (dump.filter) {\n      this.currentFilter = restoreDateFilter(dump.filter);\n    }\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    const av = <Date[]>this.getValue(a).filter(Boolean);\n    const bv = <Date[]>this.getValue(b).filter(Boolean);\n    if (av === bv) {\n      return 0;\n    }\n    if (av.length === 0) {\n      return bv.length === 0 ? 0 : FIRST_IS_MISSING;\n    }\n    if (bv.length === 0) {\n      return -FIRST_IS_MISSING;\n    }\n    const as = compute(av, this.sort);\n    const bs = compute(bv, this.sort);\n    return as - bs;\n  }\n\n  isFiltered() {\n    return DateColumn.prototype.isFiltered.call(this);\n  }\n\n  getFilter(): IDateFilter {\n    return DateColumn.prototype.getFilter.call(this);\n  }\n\n  setFilter(value: IDateFilter = {min: -Infinity, max: +Infinity, filterMissing: false}) {\n    DateColumn.prototype.setFilter.call(this, value);\n  }\n\n  filter(row: IDataRow) {\n    return DateColumn.prototype.filter.call(this, row);\n  }\n}\n\nfunction compute(arr: Date[], sort: EDateSort) {\n  switch (sort) {\n    case EDateSort.min:\n      return min(arr, (d) => d.getTime())!;\n    case EDateSort.max:\n      return max(arr, (d) => d.getTime())!;\n    case EDateSort.median:\n      return median(arr, (d) => d.getTime())!;\n  }\n}\n","import AEventDispatcher, {IEventListener} from '../../internal/AEventDispatcher';\n\nexport interface IItem {\n  id: string;\n  text: string;\n}\n\nexport interface IGroupSearchItem<T extends IItem> {\n  text: string;\n  children: (T | IGroupSearchItem<T>)[];\n}\n\nfunction isItem<T extends IItem>(v: T | IGroupSearchItem<T>): v is T {\n  return (<T>v).id !== undefined;\n}\n\nexport interface ISearchBoxOptions<T extends IItem> {\n  doc: Document;\n\n  formatItem(item: T | IGroupSearchItem<T>, node: HTMLElement): string;\n\n  placeholder: string;\n}\n\n/**\n * @asMemberOf SearchBox\n * @event\n */\nexport declare function select(item: any): void;\n\n\nexport default class SearchBox<T extends IItem> extends AEventDispatcher {\n  static readonly EVENT_SELECT = 'select';\n\n  private readonly options: Readonly<ISearchBoxOptions<T>> = {\n    formatItem: (item) => item.text,\n    doc: document,\n    placeholder: 'Select...',\n  };\n\n  readonly node: HTMLElement;\n  private search: HTMLInputElement;\n  private body: HTMLElement;\n\n  private values: (T | IGroupSearchItem<T>)[] = [];\n\n  constructor(options: Partial<ISearchBoxOptions<T>> = {}) {\n    super();\n    Object.assign(this.options, options);\n\n    this.node = this.options.doc.createElement('div');\n    this.node.classList.add('lu-search');\n    this.node.innerHTML = `<input type=\"search\" placeholder=\"${this.options.placeholder}\"><ul></ul>`;\n\n    this.search = this.node.querySelector('input')!;\n    this.body = this.node.querySelector('ul')!;\n\n    this.search.onfocus = () => this.focus();\n    this.search.onblur = () => this.blur();\n    this.search.oninput = () => this.filter();\n    this.search.onkeydown = (evt) => this.handleKey(evt);\n  }\n\n  get data() {\n    return this.values;\n  }\n\n  set data(data: (T | IGroupSearchItem<T>)[]) {\n    this.values = data;\n    this.body.innerHTML = '';\n    this.buildDialog(this.body, this.values);\n  }\n\n  private buildDialog(node: HTMLElement, values: (T | IGroupSearchItem<T>)[]) {\n    values.forEach((v) => {\n      if (isItem(v)) {\n        node.insertAdjacentHTML('beforeend', `<li class=\"lu-search-item\"><span></span></li>`);\n        const span = (<HTMLElement>node.lastElementChild!);\n        span.onmousedown = (evt) => {\n          // see https://stackoverflow.com/questions/10652852/jquery-fire-click-before-blur-event#10653160\n          evt.preventDefault();\n        };\n        span.onclick = () => this.select(v);\n        span.onmouseenter = () => this.highlighted = span;\n        span.onmouseleave = () => this.highlighted = null;\n      } else {\n        node.insertAdjacentHTML('beforeend', `<li class=\"lu-search-group\"><span></span><ul></ul></li>`);\n        const ul = <HTMLElement>node.lastElementChild!.lastElementChild!;\n        this.buildDialog(ul, v.children);\n      }\n      const item = <HTMLElement>node.lastElementChild!.firstElementChild!;\n      item.innerHTML = this.options.formatItem(v, item);\n    });\n  }\n\n  private handleKey(evt: KeyboardEvent) {\n    const KEYS = {\n      ESC: 27,\n      ENTER: 13,\n      UP: 38,\n      DOWN: 40\n    };\n    switch (evt.which) {\n      case KEYS.ESC:\n        this.search.blur();\n        break;\n      case KEYS.ENTER:\n        const h = this.highlighted;\n        if (h) {\n          h.click();\n        }\n        break;\n      case KEYS.UP:\n        this.highlightPrevious();\n        break;\n      case KEYS.DOWN:\n        this.highlightNext();\n        break;\n    }\n  }\n\n  private select(item: T) {\n    this.search.value = ''; // reset\n    this.search.blur();\n    this.fire(SearchBox.EVENT_SELECT, item);\n  }\n\n  focus() {\n    this.body.style.width = `${this.search.offsetWidth}px`;\n    this.highlighted = <HTMLElement>this.body.firstElementChild || null;\n    this.node.classList.add('lu-search-open');\n  }\n\n  private get highlighted() {\n    return <HTMLElement>this.body.querySelector('.lu-search-highlighted') || null;\n  }\n\n  private set highlighted(value: HTMLElement | null) {\n    const old = this.highlighted;\n    if (old === value) {\n      return;\n    }\n    if (old) {\n      old.classList.remove('lu-search-highlighted');\n    }\n    if (value) {\n      value.classList.add('lu-search-highlighted');\n    }\n  }\n\n  private highlightNext() {\n    const h = this.highlighted;\n    if (!h || h.classList.contains('hidden')) {\n      this.highlighted = <HTMLElement>this.body.querySelector('.lu-search-item:not(.hidden)') || null;\n      return;\n    }\n\n    const items = <HTMLElement[]>Array.from(this.body.querySelectorAll('.lu-search-item:not(.hidden)'));\n    const index = items.indexOf(h);\n    this.highlighted = items[index + 1] || null;\n  }\n\n  private highlightPrevious() {\n    const h = this.highlighted;\n    const items = <HTMLElement[]>Array.from(this.body.querySelectorAll('.lu-search-item:not(.hidden)'));\n\n    if (!h || h.classList.contains('hidden')) {\n      this.highlighted = items[items.length - 1] || null;\n      return;\n    }\n    const index = items.indexOf(h);\n    this.highlighted = items[index - 1] || null;\n  }\n\n  private blur() {\n    this.search.value = '';\n    // clear filter\n    this.filterResults(this.body, '');\n    this.node.classList.remove('lu-search-open');\n  }\n\n  private filter() {\n    const empty = this.filterResults(this.body, this.search.value.toLowerCase());\n    this.body.classList.toggle('lu-search-empty', empty);\n  }\n\n  private filterResults(node: HTMLElement, text: string) {\n    if (text === '') {\n      // show all\n      (<HTMLElement[]>Array.from(node.querySelectorAll('.hidden'))).forEach((d: HTMLElement) => d.classList.remove('hidden'));\n      return false;\n    }\n    const children = Array.from(node.children);\n    children.forEach((d) => {\n      const content = d.firstElementChild!.innerHTML.toLowerCase();\n      let hidden = !content.includes(text);\n      if (d.classList.contains('lu-search-group')) {\n        const ul = <HTMLElement>d.lastElementChild!;\n        const allChildrenHidden = this.filterResults(ul, text);\n        hidden = hidden && allChildrenHidden;\n      }\n      d.classList.toggle('hidden', hidden);\n    });\n\n    return children.every((d) => d.classList.contains('hidden'));\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([SearchBox.EVENT_SELECT]);\n  }\n\n  on(type: typeof SearchBox.EVENT_SELECT, listener: typeof select | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n}\n","import {format} from 'd3-format';\r\nimport Column, {IColumnDesc} from './Column';\r\nimport CompositeColumn from './CompositeColumn';\r\nimport {IDataRow, IGroupData} from './interfaces';\r\nimport {isMissingValue} from './missing';\r\nimport NumberColumn, {INumberColumn} from './NumberColumn';\r\nimport {SortByDefault} from './annotations';\r\n\r\nexport interface ICompositeNumberDesc extends IColumnDesc {\r\n  /**\r\n   * d3 format number Format\r\n   * @default 0.3n\r\n   */\r\n  numberFormat?: string;\r\n\r\n  /**\r\n   * missing value to use\r\n   * @default 0\r\n   */\r\n  missingValue?: number;\r\n}\r\n\r\nexport declare type ICompositeNumberColumnDesc = ICompositeNumberDesc & IColumnDesc;\r\n\r\n/**\r\n * implementation of a combine column, standard operations how to select\r\n */\r\n@SortByDefault('descending')\r\nexport default class CompositeNumberColumn extends CompositeColumn implements INumberColumn {\r\n  missingValue = NaN;\r\n\r\n  private numberFormat: (n: number) => string = format('.3n');\r\n\r\n  constructor(id: string, desc: Readonly<ICompositeNumberColumnDesc>) {\r\n    super(id, desc);\r\n\r\n    if (desc.numberFormat) {\r\n      this.numberFormat = format(desc.numberFormat);\r\n    }\r\n\r\n    if (desc.missingValue !== undefined) {\r\n      this.missingValue = desc.missingValue;\r\n    }\r\n  }\r\n\r\n\r\n  dump(toDescRef: (desc: any) => any) {\r\n    const r = super.dump(toDescRef);\r\n    r.missingValue = this.missingValue;\r\n    return r;\r\n  }\r\n\r\n  restore(dump: any, factory: (dump: any) => Column | null) {\r\n    if (dump.missingValue !== undefined) {\r\n      this.missingValue = dump.missingValue;\r\n    }\r\n    if (dump.numberFormat) {\r\n      this.numberFormat = format(dump.numberFormat);\r\n    }\r\n    super.restore(dump, factory);\r\n  }\r\n\r\n  getLabel(row: IDataRow) {\r\n    if (!this.isLoaded()) {\r\n      return '';\r\n    }\r\n    const v = this.getValue(row);\r\n    //keep non number if it is not a number else convert using formatter\r\n    return String(typeof v === 'number' && !isNaN(v) && isFinite(v) ? this.numberFormat(v) : v);\r\n  }\r\n\r\n  getValue(row: IDataRow) {\r\n    if (!this.isLoaded()) {\r\n      return null;\r\n    }\r\n    //weighted sum\r\n    const v = this.compute(row);\r\n    if (isMissingValue(v)) {\r\n      return this.missingValue;\r\n    }\r\n    return v;\r\n  }\r\n\r\n  protected compute(_row: IDataRow) {\r\n    return NaN;\r\n  }\r\n\r\n  getNumber(row: IDataRow) {\r\n    const r = this.getValue(row);\r\n    return r == null ? NaN : r;\r\n  }\r\n\r\n  getRawNumber(row: IDataRow) {\r\n    return this.getNumber(row);\r\n  }\r\n\r\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\r\n    if (format === 'json') {\r\n      return {\r\n        value: this.getRawNumber(row),\r\n        children: this.children.map((d) => d.getExportValue(row, format))\r\n      };\r\n    }\r\n    return super.getExportValue(row, format);\r\n  }\r\n\r\n  isMissing(row: IDataRow) {\r\n    return isMissingValue(this.compute(row));\r\n  }\r\n\r\n  compare(a: IDataRow, b: IDataRow) {\r\n    return NumberColumn.prototype.compare.call(this, a, b);\r\n  }\r\n\r\n  groupCompare(a: IGroupData, b: IGroupData) {\r\n    return NumberColumn.prototype.groupCompare.call(this, a, b);\r\n  }\r\n\r\n  getRenderer(): string {\r\n    return NumberColumn.prototype.getRenderer.call(this);\r\n  }\r\n}\r\n","import {Category, SupportType} from './annotations';\nimport Column, {IColumnDesc, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IGroup} from './interfaces';\nimport Ranking from './Ranking';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n/**\n * factory for creating a description creating a rank column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createAggregateDesc(label: string = 'Aggregate Groups') {\n  return {type: 'aggregate', label, fixed: true};\n}\n\nexport interface IAggregateGroupColumnDesc extends IColumnDesc {\n  isAggregated(ranking: Ranking, group: IGroup): boolean;\n\n  setAggregated(ranking: Ranking, group: IGroup, value: boolean): void;\n}\n\n/**\n * emitted upon changing of the aggregate attribute\n * @asMemberOf AggregateGroupColumn\n * @event\n */\nexport declare function aggregate(ranking: Ranking, group: IGroup, value: boolean): void;\n\n/**\n * a checkbox column for selections\n */\n@SupportType()\n@Category('support')\nexport default class AggregateGroupColumn extends Column {\n  static readonly EVENT_AGGREGATE = 'aggregate';\n\n  constructor(id: string, desc: Readonly<IAggregateGroupColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(20);\n  }\n\n  get frozen() {\n    return this.desc.frozen !== false;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([AggregateGroupColumn.EVENT_AGGREGATE]);\n  }\n\n  on(type: typeof AggregateGroupColumn.EVENT_AGGREGATE, listener: typeof aggregate | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  isAggregated(group: IGroup) {\n    const ranking = this.findMyRanker()!;\n    if ((<IAggregateGroupColumnDesc>this.desc).isAggregated) {\n      return (<IAggregateGroupColumnDesc>this.desc).isAggregated(ranking, group);\n    }\n    return false;\n  }\n\n  setAggregated(group: IGroup, value: boolean) {\n    const ranking = this.findMyRanker()!;\n    const current = ((<IAggregateGroupColumnDesc>this.desc).isAggregated) && (<IAggregateGroupColumnDesc>this.desc).isAggregated(ranking, group);\n    if (current === value) {\n      return true;\n    }\n\n    if ((<IAggregateGroupColumnDesc>this.desc).setAggregated) {\n      (<IAggregateGroupColumnDesc>this.desc).setAggregated(ranking, group, value);\n    }\n    this.fire(AggregateGroupColumn.EVENT_AGGREGATE, ranking, group, value);\n    return false;\n  }\n}\n","import {IGroupData, IGroupItem} from './model';\r\nimport Ranking from './model/Ranking';\r\nimport {IDataProvider} from './provider';\r\nimport {ICellRendererFactory} from './renderer';\r\nimport {IToolbarAction, IToolbarDialogAddon} from './ui';\r\n\r\n\r\n/**\r\n * number of bins before switching to dense mode\r\n */\r\nexport const DENSE_HISTOGRAM = 19;\r\n/**\r\n * minimal witdh of a column to show the label in the header\r\n */\r\nexport const MIN_LABEL_WIDTH = 30;\r\n/**\r\n * number of milliseconds to wait before a hovered canvas row will be replaced with a DOM one\r\n * @type {number}\r\n */\r\nexport const HOVER_DELAY_SHOW_DETAIL = 500;\r\n\r\n/**\r\n * custom height implementation logic\r\n */\r\nexport interface IDynamicHeight {\r\n  /**\r\n   * default height for a row for optimized styling\r\n   */\r\n  defaultHeight: number;\r\n\r\n  /**\r\n   * returns the height in pixel for the given row\r\n   * @param {IGroupItem | IGroupData} item the item to show\r\n   * @returns {number} its height in pixel\r\n   */\r\n  height(item: IGroupItem | IGroupData): number;\r\n\r\n  /**\r\n   * returns the padding in pixel after the given row\r\n   * @param {IGroupItem | IGroupData | null} item item to show\r\n   * @returns {number} its padding in pixel\r\n   */\r\n  padding(item: IGroupItem | IGroupData | null): number;\r\n}\r\n\r\nexport interface ILineUpFlags {\r\n  /**\r\n   * optimization flag to disable frozen columns for optimizing rendering performance\r\n   * @default true\r\n   */\r\n  disableFrozenColumns: boolean;\r\n  /**\r\n   * flag whether advanced ranking features are enabled\r\n   * @default true\r\n   */\r\n  advancedRankingFeatures: boolean;\r\n  /**\r\n   * flag whether advanced model features are enabled\r\n   * @default true\r\n   */\r\n  advancedModelFeatures: boolean;\r\n  /**\r\n   * flag whether advanced UI features are enabled\r\n   * @default true\r\n   */\r\n  advancedUIFeatures: boolean;\r\n}\r\n\r\nexport interface ILineUpOptions {\r\n  /**\r\n   * option to enable/disable showing a summary (histogram, ...) in the header\r\n   * @default true\r\n   */\r\n  summaryHeader: boolean;\r\n  /**\r\n   * option to enable/disable animated transitions\r\n   * @default true\r\n   */\r\n  animated: boolean;\r\n  /**\r\n   * option to enforce that the whole row is shown upon hover without overflow hidden\r\n   * @default false\r\n   */\r\n  expandLineOnHover: boolean;\r\n  /**\r\n   * option to enable/disable the panel\r\n   * @default true\r\n   */\r\n  sidePanel: boolean;\r\n  /**\r\n   * option to specify whether the panel should be collapsed by default\r\n   * @default false\r\n   */\r\n  sidePanelCollapsed: boolean;\r\n  /**\r\n   * show the sorting and grouping hierarchy indicators in the side panel\r\n   * @default true\r\n   */\r\n  hierarchyIndicator: boolean;\r\n\r\n  /**\r\n   * option to specify the default slope graph mode\r\n   * @default 'item'\r\n   */\r\n  defaultSlopeGraphMode: 'item' | 'band';\r\n\r\n  /**\r\n   * how many degrees should a label be rotated in case of narrow columns\r\n   * @default 0 no rotation\r\n   */\r\n  labelRotation: number;\r\n\r\n  /**\r\n   * height of a row\r\n   * @default 18\r\n   */\r\n  rowHeight: number;\r\n  /**\r\n   * padding between two rows\r\n   * @default 2\r\n   */\r\n  rowPadding: number;\r\n  /**\r\n   * height of an aggregated group in pixel\r\n   * @default 40\r\n   */\r\n  groupHeight: number;\r\n  /**\r\n   * padding between two groups in pixel\r\n   * @default 5\r\n   */\r\n  groupPadding: number;\r\n\r\n  /**\r\n   * custom function to compute the level of detail for a row\r\n   * @param {number} rowIndex the current row index to be rendered\r\n   * @returns {\"high\" | \"low\"}\r\n   */\r\n  levelOfDetail: (rowIndex: number) => 'high' | 'low';\r\n  /**\r\n   * custom function to compute the height of a row (group or item)\r\n   * @param {(IGroupItem | IGroupData)[]} data the data to render\r\n   * @param {Ranking} ranking the ranking of the data\r\n   * @returns {IDynamicHeight | null} the height compute function or null to use the default\r\n   */\r\n  dynamicHeight: (data: (IGroupItem | IGroupData)[], ranking: Ranking) => IDynamicHeight | null;\r\n  /**\r\n   * custom function to be called when updating a HTML row\r\n   * @param {HTMLElement} row node element to be updated\r\n   * @param {number} rowIndex row index to be rendered in the row\r\n   */\r\n  customRowUpdate: (row: HTMLElement, rowIndex: number) => void;\r\n\r\n  /**\r\n   * register custom toolbar actions and dialog addons\r\n   */\r\n  toolbar: {[key: string]: IToolbarAction | IToolbarDialogAddon};\r\n  /**\r\n   * register custom renderer factories\r\n   */\r\n  renderers: {[type: string]: ICellRendererFactory};\r\n\r\n  /**\r\n   * custom flags for optimization\r\n   */\r\n  flags: Partial<ILineUpFlags>;\r\n\r\n  /**\r\n   * ignore incompatible browser and always show (on own risk)\r\n   * @default false\r\n   */\r\n  ignoreUnsupportedBrowser: boolean;\r\n}\r\n\r\nexport interface ITaggleOptions extends ILineUpOptions {\r\n  /**\r\n   * whether the overview mode is enabled by default\r\n   * @default false\r\n   */\r\n  overviewMode: boolean;\r\n}\r\n\r\nexport interface ILineUpLike {\r\n  readonly node: HTMLElement;\r\n  readonly data: IDataProvider;\r\n\r\n  dump(): any;\r\n\r\n  destroy(): void;\r\n}\r\n","import {ITaggleOptions} from './interfaces';\r\nimport {renderers} from './renderer';\r\nimport {toolbarActions} from './ui';\r\n\r\nexport * from './interfaces';\r\n\r\n\r\nexport function defaultOptions(): ITaggleOptions {\r\n  return {\r\n    toolbar: Object.assign({}, toolbarActions),\r\n    renderers: Object.assign({}, renderers),\r\n\r\n    labelRotation: 0,\r\n    summaryHeader: true,\r\n    animated: true,\r\n    expandLineOnHover: false,\r\n    sidePanel: true,\r\n    sidePanelCollapsed: false,\r\n    hierarchyIndicator: true,\r\n    defaultSlopeGraphMode: 'item',\r\n    overviewMode: false,\r\n\r\n    rowHeight: 18,\r\n    groupHeight: 40,\r\n    groupPadding: 5,\r\n    rowPadding: 2,\r\n\r\n    levelOfDetail: () => 'high',\r\n    customRowUpdate: () => undefined,\r\n    dynamicHeight: () => null,\r\n    flags: {\r\n      disableFrozenColumns: true, //disable by default for speed navigator.userAgent.includes('Firefox/52') // disable by default in Firefox ESR 52\r\n      advancedRankingFeatures: true,\r\n      advancedModelFeatures: true,\r\n      advancedUIFeatures: true\r\n    },\r\n    ignoreUnsupportedBrowser: false\r\n  };\r\n}\r\n","import {timeFormat} from 'd3-time-format';\r\nimport Column from './Column';\r\nimport {IColumnDesc, IDataRow} from './interfaces';\r\nimport {isNumberIncluded, INumberFilter} from './INumberColumn';\r\nimport {timeDay, timeMonth, timeWeek, timeMinute, timeSecond, timeHour} from 'd3-time';\r\nimport {equal} from '../internal/utils';\r\n\r\nexport {INumberFilter as IDateFilter, restoreNumberFilter as restoreDateFilter,\r\n  noNumberFilter as noDateFilter, isEqualNumberFilter as isEqualDateFilter,\r\n  isDummyNumberFilter as isDummyDateFilter} from './INumberColumn';\r\n\r\nexport interface IDateColumn extends Column {\r\n  getDate(row: IDataRow): Date | null;\r\n}\r\n\r\nexport default IDateColumn;\r\n\r\n\r\nexport interface IDateDesc {\r\n  /**\r\n   * d3 formatting option\r\n   * @default %x\r\n   */\r\n  dateFormat?: string;\r\n\r\n  /**\r\n   * d3 formation option\r\n   * @dfeault dateFormat\r\n   */\r\n  dateParse?: string;\r\n}\r\n\r\n\r\n/**\r\n * checks whether the given column or description is a date column, i.e. the value is a date\r\n * @param col\r\n * @returns {boolean}\r\n */\r\nexport function isDateColumn(col: Column): col is IDateColumn;\r\nexport function isDateColumn(col: IColumnDesc): col is IDateDesc & IColumnDesc;\r\nexport function isDateColumn(col: Column | IColumnDesc) {\r\n  return (col instanceof Column && typeof (<IDateColumn>col).getDate === 'function' || (!(col instanceof Column) && (<IColumnDesc>col).type.startsWith('date')));\r\n}\r\n\r\nexport function isDateIncluded(filter: INumberFilter | null, value: Date | null) {\r\n  if (!filter) {\r\n    return true;\r\n  }\r\n  if (value == null || !(value instanceof Date)) {\r\n    return !filter.filterMissing;\r\n  }\r\n  return isNumberIncluded(filter, value!.getTime());\r\n}\r\n\r\nexport declare type IDateGranularity = 'century' | 'decade' | 'year' | 'month' | 'week' | 'day_of_week' | 'day_of_month' | 'day_of_year' | 'hour' | 'minute' | 'second';\r\n\r\nexport interface IDateGrouper {\r\n  /**\r\n   * granuality level for the grouping\r\n   */\r\n  granularity: IDateGranularity;\r\n  /**\r\n   * whether circular occurrences should be in the same bin\r\n   * e.g. granularity = month\r\n   * circular: 01.2018 == 01.2017\r\n   * not circular: 01.2018 != 01.2017\r\n   */\r\n  circular: boolean;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function defaultDateGrouper(): IDateGrouper {\r\n  return { granularity: 'month', circular: false};\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function isDefaultDateGrouper(grouper: IDateGrouper) {\r\n  return equal(defaultDateGrouper(), grouper);\r\n}\r\n\r\n/**\r\n * convert the given date to the desired grouper\r\n * @internal\r\n */\r\nexport function toDateGroup(grouper: IDateGrouper, value: Date): {value: number, name: string} {\r\n  switch(grouper.granularity) {\r\n  case 'century':\r\n    const centuryP = Math.floor(value.getFullYear() / 100);\r\n    if (grouper.circular) {\r\n      const century = centuryP % 10;\r\n      return {\r\n        value: century,\r\n        name: `*${century}00`\r\n      };\r\n    }\r\n    return {\r\n      value: centuryP,\r\n      name: `${centuryP}00`\r\n    };\r\n  case 'decade':\r\n    const decadeP = Math.floor(value.getFullYear() / 10);\r\n    if (grouper.circular) {\r\n      const decade = decadeP % 10;\r\n      return {\r\n        value: decade,\r\n        name: `**${decade}0`\r\n      };\r\n    }\r\n    return {\r\n      value: decadeP,\r\n      name: `${decadeP}0`\r\n    };\r\n  case 'year':\r\n    if (grouper.circular) {\r\n      const year = value.getFullYear() % 10;\r\n      return {\r\n        value: year,\r\n        name: `***${year}`\r\n      };\r\n    }\r\n    return {\r\n      value: value.getFullYear(),\r\n      name: String(value.getFullYear())\r\n    };\r\n  case 'month':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getMonth(),\r\n        name: timeFormat('%B')(value)\r\n      };\r\n    }\r\n    return {\r\n      value: timeMonth(value).getTime(),\r\n      name: timeFormat('%B %Y')(value)\r\n    };\r\n  case 'week':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getMonth(),\r\n        name: timeFormat('%B')(value) // TODO\r\n      };\r\n    }\r\n    return {\r\n      value: timeWeek(value).getTime(),\r\n      name: timeFormat('%B %Y')(value) // TODO\r\n    };\r\n  case 'day_of_week':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getDay(),\r\n        name: timeFormat('%A')(value)\r\n      };\r\n    }\r\n    return {\r\n      value: timeDay(value).getTime(),\r\n      name: timeFormat('%x')(value)\r\n    };\r\n  case 'day_of_month':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getDate(),\r\n        name: timeFormat('%d')(value)\r\n      };\r\n    }\r\n    return {\r\n      value: timeDay(value).getTime(),\r\n      name: timeFormat('%x')(value)\r\n    };\r\n  case 'day_of_year':\r\n    if (grouper.circular) {\r\n      // %j = day of year\r\n      const v = timeFormat('%j')(value);\r\n      return {\r\n        value: parseInt(v, 10),\r\n        name: v\r\n      };\r\n    }\r\n    return {\r\n      value: timeDay(value).getTime(),\r\n      name: timeFormat('%x')(value)\r\n    };\r\n  case 'hour':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getHours(),\r\n        name: timeFormat('%A')(value)\r\n      };\r\n    }\r\n    return {\r\n      value: timeHour(value).getTime(),\r\n      name: timeFormat('%x')(value)\r\n    };\r\n  case 'minute':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getMinutes(),\r\n        name: timeFormat('%A')(value)\r\n      };\r\n    }\r\n    return {\r\n      value: timeMinute(value).getTime(),\r\n      name: timeFormat('%x')(value)\r\n    };\r\n  case 'second':\r\n    if (grouper.circular) {\r\n      return {\r\n        value: value.getSeconds(),\r\n        name: timeFormat('%A')(value)\r\n      };\r\n    }\r\n    return {\r\n      value: timeSecond(value).getTime(),\r\n      name: timeFormat('%x')(value)\r\n    };\r\n  }\r\n\r\n  return {\r\n    value: value.getTime(),\r\n    name: value.toString()\r\n  };\r\n}\r\n","import {\r\n  defaultPhases, EAnimationMode, IAnimationContext, IAnimationItem, IPhase,\r\n  KeyFinder, IExceptionContext\r\n} from 'lineupengine';\r\nimport {IGroupData, IGroupItem, isGroup} from '../model';\r\n\r\n/** @internal */\r\nexport interface IGroupLookUp {\r\n  item2groupIndex: Map<number, number>;\r\n  group2firstItemIndex: Map<string, number>;\r\n}\r\n\r\nfunction toGroupLookup(items: (IGroupItem | IGroupData)[]): IGroupLookUp {\r\n  const item2groupIndex = new Map<number, number>();\r\n  const group2firstItemIndex = new Map<string, number>();\r\n  items.forEach((item, i) => {\r\n    if (isGroup(item)) {\r\n      item.rows.forEach((d) => item2groupIndex.set(d.i, i));\r\n    } else if (item.group && item.relativeIndex === 0) {\r\n      group2firstItemIndex.set(item.group.name, i);\r\n    }\r\n  });\r\n  return {item2groupIndex, group2firstItemIndex};\r\n}\r\n\r\nfunction toKey(item: IGroupItem | IGroupData) {\r\n  if (isGroup(item)) {\r\n    return item.name;\r\n  }\r\n  return (<IGroupItem>item).i.toString();\r\n}\r\n\r\n/** @internal */\r\nexport function lineupAnimation(previous: IExceptionContext, previousData: (IGroupItem | IGroupData)[], currentData: (IGroupItem | IGroupData)[]): IAnimationContext {\r\n\r\n  const previousKey = (index: number) => toKey(previousData[index]);\r\n  const currentKey = (index: number) => toKey(currentData[index]);\r\n\r\n\r\n  const previousGroupCount = previousData.reduce((acc, i) => acc + (isGroup(i) ? 1 : 0), 0);\r\n  const currentGroupCount = currentData.reduce((acc, i) => acc + (isGroup(i) ? 1 : 0), 0);\r\n\r\n  if (previousGroupCount === currentGroupCount) {\r\n    // reorder or filter only\r\n    return {currentKey, previous, previousKey};\r\n  }\r\n\r\n  // try to appear where the group was uncollapsed and vice versa\r\n  let prevHelper: IGroupLookUp;\r\n  const appearPosition = (currentRowIndex: number, previousFinder: KeyFinder, defaultValue: number) => {\r\n    if (!prevHelper) {\r\n      prevHelper = toGroupLookup(previousData);\r\n    }\r\n    const item = currentData[currentRowIndex];\r\n    const referenceIndex = isGroup(item) ? prevHelper.group2firstItemIndex.get(item.name) : prevHelper.item2groupIndex.get(item.i);\r\n    if (referenceIndex === undefined) {\r\n      return defaultValue;\r\n    }\r\n    const pos = previousFinder.posByKey(previousKey(referenceIndex));\r\n    return pos.pos >= 0 ? pos.pos : defaultValue;\r\n  };\r\n\r\n\r\n  let currHelper: IGroupLookUp;\r\n  const removePosition = (previousRowIndex: number, currentFinder: KeyFinder, defaultValue: number) => {\r\n    if (!currHelper) {\r\n      currHelper = toGroupLookup(currentData);\r\n    }\r\n    const item = previousData[previousRowIndex];\r\n    const referenceIndex = isGroup(item) ? currHelper.group2firstItemIndex.get(item.name) : currHelper.item2groupIndex.get(item.i);\r\n    if (referenceIndex === undefined) {\r\n      return defaultValue;\r\n    }\r\n    const pos = currentFinder.posByKey(currentKey(referenceIndex));\r\n    return pos.pos >= 0 ? pos.pos : defaultValue;\r\n  };\r\n\r\n  const phases: IPhase[] = [\r\n    Object.assign({}, defaultPhases[0], {\r\n      apply(item: Readonly<IAnimationItem>, previousFinder: KeyFinder) {\r\n        defaultPhases[0].apply(item);\r\n        if (item.mode === EAnimationMode.SHOW) {\r\n          item.node.style.transform = `translate(0, ${appearPosition(item.current.index, previousFinder, item.previous.y) - item.nodeY}px)`;\r\n        }\r\n      }\r\n    }),\r\n    Object.assign({}, defaultPhases[1], {\r\n      apply(item: Readonly<IAnimationItem>, _previousFinder: KeyFinder, currentFinder: KeyFinder) {\r\n        defaultPhases[1].apply(item);\r\n        if (item.mode === EAnimationMode.HIDE) {\r\n          item.node.style.transform = `translate(0, ${removePosition(item.previous.index, currentFinder, item.current.y) - item.nodeY}px)`;\r\n        }\r\n      }\r\n    }),\r\n    defaultPhases[defaultPhases.length - 1]\r\n  ];\r\n\r\n  return {previous, previousKey, currentKey, phases};\r\n}\r\n","import {IColumn} from 'lineupengine';\r\nimport Column from '../model/Column';\r\nimport {ICellRenderer, IGroupCellRenderer} from '../renderer';\r\nimport {ISummaryRenderer} from '../renderer/interfaces';\r\nimport {createHeader, updateHeader} from './header';\r\nimport {IRankingContext} from './interfaces';\r\nimport {ILineUpFlags} from '../interfaces';\r\n\r\n\r\nexport interface IRenderers {\r\n  singleId: string;\r\n  single: ICellRenderer;\r\n  groupId: string;\r\n  group: IGroupCellRenderer;\r\n  summaryId: string;\r\n  summary: ISummaryRenderer | null;\r\n  singleTemplate: HTMLElement | null;\r\n  groupTemplate: HTMLElement | null;\r\n  summaryTemplate: HTMLElement | null;\r\n}\r\n\r\nexport default class RenderColumn implements IColumn {\r\n  renderers: IRenderers | null = null;\r\n\r\n  constructor(public readonly c: Column, public index: number, protected ctx: IRankingContext, protected readonly flags: ILineUpFlags) {\r\n\r\n  }\r\n\r\n  get width() {\r\n    return this.c.getWidth();\r\n  }\r\n\r\n  get id() {\r\n    return this.c.id;\r\n  }\r\n\r\n  get frozen() {\r\n    return this.flags.disableFrozenColumns ? false : this.c.frozen;\r\n  }\r\n\r\n  private singleRenderer() {\r\n    if (!this.renderers || !this.renderers.single) {\r\n      return null;\r\n    }\r\n    if (this.renderers.singleTemplate)  {\r\n      return <HTMLElement>this.renderers.singleTemplate.cloneNode(true);\r\n    }\r\n    const elem = asElement(this.ctx.document, this.renderers.single.template);\r\n    elem.dataset.renderer = this.renderers.singleId;\r\n    elem.dataset.group = 'd';\r\n\r\n    this.renderers.singleTemplate = <HTMLElement>elem.cloneNode(true);\r\n    return elem;\r\n  }\r\n\r\n  private groupRenderer() {\r\n    if (!this.renderers || !this.renderers.group) {\r\n      return null;\r\n    }\r\n    if (this.renderers.groupTemplate)  {\r\n      return <HTMLElement>this.renderers.groupTemplate.cloneNode(true);\r\n    }\r\n    const elem = asElement(this.ctx.document, this.renderers.group.template);\r\n    elem.dataset.renderer = this.renderers.groupId;\r\n    elem.dataset.group = 'g';\r\n\r\n    this.renderers.groupTemplate = <HTMLElement>elem.cloneNode(true);\r\n    return elem;\r\n  }\r\n\r\n  private summaryRenderer() {\r\n    if (!this.renderers || !this.renderers.summary) {\r\n      return null;\r\n    }\r\n    if (this.renderers.summaryTemplate)  {\r\n      return <HTMLElement>this.renderers.summaryTemplate.cloneNode(true);\r\n    }\r\n    const elem = asElement(this.ctx.document, this.renderers.summary.template);\r\n    elem.dataset.renderer = this.renderers.summaryId;\r\n    elem.classList.add('lu-summary');\r\n    this.renderers.summaryTemplate = <HTMLElement>elem.cloneNode(true);\r\n    return elem;\r\n  }\r\n\r\n  createHeader() {\r\n    const node = createHeader(this.c, this.ctx, {\r\n      dragAble: this.flags.advancedUIFeatures,\r\n      mergeDropAble: this.flags.advancedModelFeatures,\r\n      rearrangeAble: this.flags.advancedUIFeatures,\r\n      resizeable: this.flags.advancedUIFeatures\r\n    });\r\n    node.className = `lu-header`;\r\n    node.classList.toggle('frozen', this.frozen);\r\n\r\n    if (this.renderers && this.renderers.summary) {\r\n      const summary = this.summaryRenderer()!;\r\n      node.appendChild(summary);\r\n    }\r\n    this.updateHeader(node);\r\n    return node;\r\n  }\r\n\r\n  updateHeader(node: HTMLElement) {\r\n    updateHeader(node, this.c);\r\n    if (!this.renderers || !this.renderers.summary) {\r\n      return;\r\n    }\r\n    let summary = <HTMLElement>node.querySelector('.lu-summary')!;\r\n    const oldRenderer = summary.dataset.renderer;\r\n    const currentRenderer = this.renderers.summaryId;\r\n    if (oldRenderer !== currentRenderer) {\r\n      summary.remove();\r\n      summary = this.summaryRenderer()!;\r\n      node.appendChild(summary);\r\n    }\r\n    this.renderers.summary.update(summary, this.ctx.statsOf(<any>this.c));\r\n  }\r\n\r\n  createCell(index: number) {\r\n    const isGroup = this.ctx.isGroup(index);\r\n    const node = isGroup ? this.groupRenderer()! : this.singleRenderer()!;\r\n    this.updateCell(node, index);\r\n    return node;\r\n  }\r\n\r\n  updateCell(node: HTMLElement, index: number): HTMLElement | void {\r\n    node.classList.toggle('frozen', this.frozen);\r\n    const isGroup = this.ctx.isGroup(index);\r\n    // assert that we have the template of the right mode\r\n    const oldRenderer = node.dataset.renderer;\r\n    const currentRenderer = isGroup ? this.renderers!.groupId : this.renderers!.singleId;\r\n    const oldGroup = node.dataset.group;\r\n    const currentGroup = (isGroup ? 'g' : 'd');\r\n    if (oldRenderer !== currentRenderer || oldGroup !== currentGroup) {\r\n      node = isGroup ? this.groupRenderer()! : this.singleRenderer()!;\r\n    }\r\n    if (isGroup) {\r\n      const g = this.ctx.getGroup(index);\r\n      this.renderers!.group.update(node, g, g.rows);\r\n    } else {\r\n      const r = this.ctx.getRow(index);\r\n      this.renderers!.single.update(node, r, r.relativeIndex, r.group);\r\n    }\r\n    return node;\r\n  }\r\n\r\n  renderCell(ctx: CanvasRenderingContext2D, index: number) {\r\n    const r = this.ctx.getRow(index);\r\n    this.renderers!.single.render(ctx, r, r.relativeIndex, r.group);\r\n  }\r\n}\r\n\r\nfunction asElement(doc: Document, html: string): HTMLElement {\r\n  const helper = doc.createElement('div');\r\n  helper.innerHTML = html;\r\n  const s = <HTMLElement>helper.firstElementChild!;\r\n  helper.innerHTML = '';\r\n  return s;\r\n}\r\n","import {StyleManager} from 'lineupengine';\r\nimport {round} from '../internal';\r\nimport Column from '../model/Column';\r\nimport {IMultiLevelColumn} from '../model';\r\nimport {ISummaryRenderer} from '../renderer/interfaces';\r\nimport {gridClass} from '../renderer/MultiLevelCellRenderer';\r\nimport {COLUMN_PADDING} from '../styles';\r\nimport {createHeader, updateHeader} from './header';\r\nimport {IRankingContext} from './interfaces';\r\nimport RenderColumn from './RenderColumn';\r\nimport {ILineUpFlags} from '../interfaces';\r\n\r\n/** @internal */\r\nexport default class MultiLevelRenderColumn extends RenderColumn {\r\n  private readonly summaries: ISummaryRenderer[] = [];\r\n\r\n  constructor(c: IMultiLevelColumn & Column, index: number, ctx: IRankingContext, flags: ILineUpFlags) {\r\n    super(c, index, ctx, flags);\r\n  }\r\n\r\n  private get mc() {\r\n    return <IMultiLevelColumn & Column>this.c;\r\n  }\r\n\r\n  get width() {\r\n    return this.c.getWidth() + COLUMN_PADDING * this.mc.length;\r\n  }\r\n\r\n  createHeader() {\r\n    const node = super.createHeader();\r\n    const wrapper = this.ctx.document.createElement('div');\r\n    wrapper.classList.add('lu-nested');\r\n    wrapper.classList.add(gridClass(this.c));\r\n    node.appendChild(wrapper);\r\n\r\n    this.summaries.splice(0, this.summaries.length);\r\n    this.mc.children.forEach((cc, i) => {\r\n      const n = createHeader(cc, this.ctx, {\r\n        mergeDropAble: false,\r\n        dragAble: this.flags.advancedModelFeatures,\r\n        rearrangeAble: this.flags.advancedModelFeatures,\r\n        resizeable: this.flags.advancedModelFeatures\r\n      });\r\n      n.classList.add('lu-header');\r\n      (<any>n.style).gridColumnStart = (i + 1).toString();\r\n      wrapper.appendChild(n);\r\n\r\n      if (!this.renderers || !this.renderers.summary) {\r\n        return;\r\n      }\r\n      const summary = this.ctx.summaryRenderer(cc, false);\r\n      n.insertAdjacentHTML('beforeend', summary.template);\r\n      const summaryNode = <HTMLElement>n.lastElementChild!;\r\n      summaryNode.classList.add('lu-summary');\r\n      summaryNode.dataset.renderer = cc.getSummaryRenderer();\r\n      this.summaries.push(summary);\r\n      summary.update(summaryNode, this.ctx.statsOf(<any>cc));\r\n    });\r\n\r\n    this.updateNested(wrapper);\r\n\r\n    return node;\r\n  }\r\n\r\n  updateHeader(node: HTMLElement) {\r\n    super.updateHeader(node);\r\n\r\n    const wrapper = <HTMLElement>node.querySelector('.lu-nested');\r\n    if (!wrapper) {\r\n      return node; // too early\r\n    }\r\n    node.appendChild(wrapper); // ensure the last one\r\n    this.updateNested(wrapper);\r\n    return node;\r\n  }\r\n\r\n  updateWidthRule(style: StyleManager) {\r\n    const mc = this.mc;\r\n    // need this for chrome to work properly\r\n    const widths = mc.children.map((c) => `minmax(0, ${round(c.getWidth())}fr)`);\r\n    const clazz = gridClass(this.c);\r\n    style.updateRule(`stacked-${this.c.id}`, `.lineup-engine .${clazz} {\r\n      display: grid;\r\n      grid-template-columns: ${widths.join(' ')};\r\n    }`);\r\n    return clazz;\r\n  }\r\n\r\n  private updateNested(wrapper: HTMLElement) {\r\n    const sub = this.mc.children;\r\n    const children = <HTMLElement[]>Array.from(wrapper.children);\r\n    sub.forEach((c, i) => {\r\n      const node = children[i];\r\n      updateHeader(node, c);\r\n\r\n      if (!this.renderers || !this.renderers.summary) {\r\n        return;\r\n      }\r\n      let summary = <HTMLElement>node.querySelector('.lu-summary')!;\r\n      const oldRenderer = summary.dataset.renderer;\r\n      const currentRenderer = c.getSummaryRenderer();\r\n      if (oldRenderer !== currentRenderer) {\r\n        const renderer = this.ctx.summaryRenderer(c, false);\r\n        summary.remove();\r\n        summary.innerHTML = renderer.template;\r\n        summary = <HTMLElement>summary.firstElementChild!;\r\n        summary.classList.add('lu-summary');\r\n        summary.dataset.renderer = currentRenderer;\r\n        this.summaries[i] = renderer;\r\n        node.appendChild(summary);\r\n      }\r\n      this.summaries[i].update(summary, this.ctx.statsOf(<any>c));\r\n    });\r\n  }\r\n}\r\n","import AEventDispatcher from '../internal/AEventDispatcher';\nimport OrderedSet from '../internal/OrderedSet';\nimport {IGroupData, IGroupItem, isGroup} from '../model';\nimport {IDataProvider} from '../provider/ADataProvider';\nimport {rangeSelection} from '../renderer/SelectionRenderer';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\ninterface IPoint {\n  x: number;\n  y: number;\n}\n\ninterface IShift {\n  xShift: number;\n  yShift: number;\n  node: HTMLElement;\n}\n\n/**\n * @asMemberOf SelectionManager\n * @event\n */\nexport declare function selectRange(from: number, to: number, additional: boolean): void;\n\n/** @internal */\nexport default class SelectionManager extends AEventDispatcher {\n  static readonly EVENT_SELECT_RANGE = 'selectRange';\n  private static readonly MIN_DISTANCE = 10;\n\n  private readonly hr: HTMLHRElement;\n\n  private start: (IPoint & IShift) | null = null;\n\n  constructor(private readonly ctx: { provider: IDataProvider }, private readonly body: HTMLElement) {\n    super();\n    const root = body.parentElement!.parentElement!;\n    let hr = <HTMLHRElement>root.querySelector('hr');\n    if (!hr) {\n      console.assert(root.ownerDocument != null);\n      hr = root.ownerDocument!.createElement('hr');\n      root.appendChild(hr);\n    }\n    this.hr = hr;\n\n    const mouseMove = (evt: MouseEvent) => {\n      this.showHint(evt);\n    };\n    const mouseUp = (evt: MouseEvent) => {\n      this.body.removeEventListener('mousemove', mouseMove);\n      this.body.removeEventListener('mouseup', mouseUp);\n      this.body.removeEventListener('mouseleave', mouseUp);\n\n      if (!this.start) {\n        return;\n      }\n      const startNode = this.start.node.classList.contains('lu-row') ? this.start.node : <HTMLElement>this.start.node.closest('.lu-row');\n      // somehow on firefox the mouseUp will be triggered on the original node\n      // thus search the node explicitly\n      console.assert(this.body.ownerDocument != null);\n      const end = <HTMLElement>this.body.ownerDocument!.elementFromPoint(evt.clientX, evt.clientY);\n      const endNode = end.classList.contains('lu-row') ? end : <HTMLElement>(end.closest('.lu-row'));\n      this.start = null;\n      this.body.classList.remove('lu-selection-active');\n      this.hr.classList.remove('lu-selection-active');\n\n      this.select(evt.ctrlKey, startNode, endNode);\n    };\n\n    body.addEventListener('mousedown', (evt) => {\n      const r = root.getBoundingClientRect();\n      this.start = {x: evt.clientX, y: evt.clientY, xShift: r.left, yShift: r.top, node: <HTMLElement>evt.target};\n      this.body.classList.add('lu-selection-active');\n      body.addEventListener('mousemove', mouseMove, {\n        passive: true\n      });\n      body.addEventListener('mouseup', mouseUp, {\n        passive: true\n      });\n      body.addEventListener('mouseleave', mouseUp, {\n        passive: true\n      });\n    }, {\n      passive: true\n    });\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([SelectionManager.EVENT_SELECT_RANGE]);\n  }\n\n  on(type: typeof SelectionManager.EVENT_SELECT_RANGE, listener: typeof selectRange | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  private select(additional: boolean, startNode?: HTMLElement, endNode?: HTMLElement) {\n    if (!startNode || !endNode || startNode === endNode) {\n      return; // no single\n    }\n\n    const startIndex = parseInt(startNode.dataset.index!, 10);\n    const endIndex = parseInt(endNode.dataset.index!, 10);\n\n    const from = Math.min(startIndex, endIndex);\n    const end = Math.max(startIndex, endIndex);\n    if (from === end) {\n      return; // no single\n    }\n    // bounce event end\n    requestAnimationFrame(() => this.fire(SelectionManager.EVENT_SELECT_RANGE, from, end, additional));\n  }\n\n  private showHint(end: MouseEvent) {\n    const start = this.start!;\n    const sy = start.y;\n    const ey = end.clientY;\n\n    const visible = Math.abs(sy - ey) > SelectionManager.MIN_DISTANCE;\n    this.hr.classList.toggle('lu-selection-active', visible);\n    this.hr.style.transform = `translate(${start.x - start.xShift}px,${sy - start.yShift}px)scale(1,${Math.abs(ey - sy)})rotate(${ey > sy ? 90 : -90}deg)`;\n  }\n\n  remove(node: HTMLElement) {\n    node.onclick = <any>undefined;\n  }\n\n  add(node: HTMLElement) {\n    node.onclick = (evt) => {\n      const dataIndex = parseInt(node.dataset.i!, 10);\n      if (evt.shiftKey) {\n        const relIndex = parseInt(node.dataset.index!, 10);\n        const ranking = node.parentElement!.dataset.ranking!;\n        if (rangeSelection(this.ctx.provider, ranking, dataIndex, relIndex, evt.ctrlKey)) {\n          return;\n        }\n      }\n      this.ctx.provider.toggleSelection(dataIndex, evt.ctrlKey);\n    };\n  }\n\n  /**\n   *\n   */\n\n\n  selectRange(rows: { forEach: (c: (item: (IGroupItem | IGroupData)) => void) => void }, additional: boolean = false) {\n    const current = new OrderedSet<number>(additional ? this.ctx.provider.getSelection() : []);\n    const toggle = (dataIndex: number) => {\n      if (current.has(dataIndex)) {\n        current.delete(dataIndex);\n      } else {\n        current.add(dataIndex);\n      }\n    };\n    rows.forEach((d) => {\n      if (isGroup(d)) {\n        d.rows.forEach((r) => toggle(r.i));\n      } else {\n        toggle(d.i);\n      }\n    });\n    this.ctx.provider.setSelection(Array.from(current));\n  }\n\n  updateState(node: HTMLElement, dataIndex: number) {\n    if (this.ctx.provider.isSelected(dataIndex)) {\n      node.classList.add('lu-selected');\n    } else {\n      node.classList.remove('lu-selected');\n    }\n  }\n\n  update(node: HTMLElement, selectedDataIndices: { has(dataIndex: number): boolean }) {\n    const dataIndex = parseInt(node.dataset.i!, 10);\n    if (selectedDataIndices.has(dataIndex)) {\n      node.classList.add('lu-selected');\n    } else {\n      node.classList.remove('lu-selected');\n    }\n  }\n}\n","import {IExceptionContext, nonUniformContext, uniformContext, PrefetchMixin, GridStyleManager, setColumn, ACellTableSection, ITableSection, ICellRenderContext} from 'lineupengine';\nimport {HOVER_DELAY_SHOW_DETAIL} from '../config';\nimport AEventDispatcher, {IEventContext, IEventHandler, IEventListener} from '../internal/AEventDispatcher';\nimport debounce from '../internal/debounce';\nimport {IDataRow, IGroupData, IGroupItem, isGroup, isMultiLevelColumn, ValueColumn} from '../model';\nimport Column from '../model/Column';\nimport Ranking from '../model/Ranking';\nimport StackColumn from '../model/StackColumn';\nimport {IImposer, IRenderContext} from '../renderer';\nimport {CANVAS_HEIGHT, COLUMN_PADDING} from '../styles';\nimport {lineupAnimation} from './animation';\nimport {IRankingBodyContext, IRankingHeaderContextContainer} from './interfaces';\nimport MultiLevelRenderColumn from './MultiLevelRenderColumn';\nimport RenderColumn, {IRenderers} from './RenderColumn';\nimport SelectionManager from './SelectionManager';\nimport {ILineUpFlags} from '../interfaces';\n\nexport interface IEngineRankingContext extends IRankingHeaderContextContainer, IRenderContext {\n  createRenderer(c: Column, imposer?: IImposer): IRenderers;\n}\n\n\nexport interface IEngineRankingOptions {\n  animation: boolean;\n  levelOfDetail: (rowIndex: number) => 'high' | 'low';\n  customRowUpdate: (row: HTMLElement, rowIndex: number) => void;\n  flags: ILineUpFlags;\n}\n\n/**\n * emitted when the width of the ranking changed\n * @asMemberOf EngineRanking\n * @event\n */\nexport declare function widthChanged(): void;\n/**\n * emitted when the data of the ranking needs to be updated\n * @asMemberOf EngineRanking\n * @event\n */\nexport declare function updateData(): void;\n/**\n * emitted when the histogram of a column needs to be updated\n * @asMemberOf EngineRanking\n * @param col the column to update the histogram of\n * @event\n */\nexport declare function updateHist(col: Column): void;\n/**\n * emitted when the highlight changes\n * @asMemberOf EngineRanking\n * @param dataIndex the highlghted data index or -1 for none\n * @event\n */\nexport declare function highlightChanged(dataIndex: number): void;\n\n\n/** @internal */\nclass RankingEvents extends AEventDispatcher {\n  static readonly EVENT_WIDTH_CHANGED = 'widthChanged';\n  static readonly EVENT_UPDATE_DATA = 'updateData';\n  static readonly EVENT_UPDATE_HIST = 'updateHist';\n  static readonly EVENT_HIGHLIGHT_CHANGED = 'highlightChanged';\n\n  fire(type: string | string[], ...args: any[]) {\n    super.fire(type, ...args);\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([RankingEvents.EVENT_WIDTH_CHANGED, RankingEvents.EVENT_UPDATE_DATA, RankingEvents.EVENT_UPDATE_HIST, RankingEvents.EVENT_HIGHLIGHT_CHANGED]);\n  }\n}\n\nexport default class EngineRanking extends ACellTableSection<RenderColumn> implements ITableSection, IEventHandler {\n  static readonly EVENT_WIDTH_CHANGED = RankingEvents.EVENT_WIDTH_CHANGED;\n  static readonly EVENT_UPDATE_DATA = RankingEvents.EVENT_UPDATE_DATA;\n  static readonly EVENT_UPDATE_HIST = RankingEvents.EVENT_UPDATE_HIST;\n  static readonly EVENT_HIGHLIGHT_CHANGED = RankingEvents.EVENT_HIGHLIGHT_CHANGED;\n\n  private _context: ICellRenderContext<RenderColumn>;\n\n  private readonly renderCtx: IRankingBodyContext;\n  private data: (IGroupItem | IGroupData)[] = [];\n  private readonly selection: SelectionManager;\n  private highlight: number = -1;\n  private readonly canvasPool: HTMLCanvasElement[] = [];\n  private oldLeft: number = 0;\n\n  private readonly events = new RankingEvents();\n\n  private roptions: Readonly<IEngineRankingOptions> = {\n    animation: true,\n    levelOfDetail: () => 'high',\n    customRowUpdate: () => undefined,\n    flags: {\n      disableFrozenColumns: false,\n      advancedModelFeatures: true,\n      advancedRankingFeatures: true,\n      advancedUIFeatures: true\n    }\n  };\n\n  private readonly delayedUpdate: (this: { type: string }) => void;\n  private readonly delayedUpdateAll: () => void;\n  private readonly delayedUpdateColumnWidths: () => void;\n  private readonly columns: RenderColumn[];\n\n  private readonly canvasMouseHandler = {\n    timer: -1,\n    enter: (evt: MouseEvent) => {\n      const c = this.canvasMouseHandler;\n      if (c.timer > 0) {\n        self.clearTimeout(c.timer);\n      }\n      const row = <HTMLElement>evt.currentTarget;\n      row.addEventListener('mouseleave', c.leave, {\n        passive: true\n      });\n      c.timer = self.setTimeout(() => this.updateHoveredRow(row, true), HOVER_DELAY_SHOW_DETAIL);\n    },\n    leave: (evt: MouseEvent) => {\n      const c = this.canvasMouseHandler;\n      if (c.timer > 0) {\n        self.clearTimeout(c.timer);\n        c.timer = -1;\n      }\n      const row = <HTMLElement>evt.currentTarget;\n      if (!EngineRanking.isCanvasRenderedRow(row)) {\n        self.setTimeout(() => this.updateHoveredRow(row, false));\n      }\n      // remove self\n      row.removeEventListener('mouseleave', c.leave);\n    }\n  };\n\n  private readonly highlightHandler = {\n    enabled: false,\n    enter: (evt: MouseEvent) => {\n      if (this.highlight >= 0) {\n        const old = this.body.querySelector('.le-highlighted');\n        if (old) {\n          old.classList.remove('le-highlighted');\n        }\n        this.highlight = -1;\n      }\n      const row = <HTMLElement>evt.currentTarget;\n      const dataIndex = parseInt(row.dataset.i || '-1', 10);\n      this.events.fire(EngineRanking.EVENT_HIGHLIGHT_CHANGED, dataIndex);\n    },\n    leave: () => {\n      if (this.highlight >= 0) {\n        const old = this.body.querySelector('.le-highlighted');\n        if (old) {\n          old.classList.remove('le-highlighted');\n        }\n        this.highlight = -1;\n      }\n      this.events.fire(EngineRanking.EVENT_HIGHLIGHT_CHANGED, -1);\n    }\n  };\n\n  constructor(public readonly ranking: Ranking, header: HTMLElement, body: HTMLElement, tableId: string, style: GridStyleManager, private readonly ctx: IEngineRankingContext, roptions: Partial<IEngineRankingOptions> = {}) {\n    super(header, body, tableId, style, {mixins: [PrefetchMixin], batchSize: 10});\n    Object.assign(this.roptions, roptions);\n    body.classList.add('lu-row-body');\n    body.dataset.ranking = ranking.id;\n\n    const that = this;\n    this.delayedUpdate = debounce((function (this: { type: string, primaryType: string }) {\n      if (this.type !== Ranking.EVENT_DIRTY_VALUES) {\n        that.events.fire(EngineRanking.EVENT_UPDATE_DATA);\n        return;\n      }\n      if (this.primaryType !== Column.EVENT_RENDERER_TYPE_CHANGED && this.primaryType !== Column.EVENT_GROUP_RENDERER_TYPE_CHANGED && this.primaryType !== Column.EVENT_LABEL_CHANGED) { // just the single column will be updated\n        that.updateBody();\n      }\n    }), 50, (current, next) => {\n      const currentEvent = current.self.type;\n      // order changed is more important\n      return currentEvent === Ranking.EVENT_ORDER_CHANGED ? current : next;\n    });\n\n    this.delayedUpdateAll = debounce(() => this.updateAll(), 50);\n    this.delayedUpdateColumnWidths = debounce(() => this.updateColumnWidths(), 50);\n    ranking.on(`${Ranking.EVENT_ADD_COLUMN}.hist`, (col: Column, index: number) => {\n      this.columns.splice(index, 0, this.createCol(col, index));\n      this.reindex();\n      this.updateHist(col);\n      this.delayedUpdateAll();\n    });\n    ranking.on(`${Ranking.EVENT_REMOVE_COLUMN}.body`, (col: Column, index: number) => {\n      EngineRanking.disableListener(col);\n      this.columns.splice(index, 1);\n      this.reindex();\n      this.delayedUpdateAll();\n    });\n    ranking.on(`${Ranking.EVENT_MOVE_COLUMN}.body`, (col: Column, index: number, old: number) => {\n      //delete first\n      const c = this.columns.splice(old, 1)[0];\n      console.assert(c.c === col);\n      // adapt target index based on previous index, i.e shift by one\n      this.columns.splice(old < index ? index - 1 : index, 0, c);\n      this.reindex();\n      this.delayedUpdateAll();\n    });\n    ranking.on(`${Ranking.EVENT_COLUMN_VISIBILITY_CHANGED}.body`, (col: Column, _oldValue: boolean, newValue: boolean) => {\n      if (newValue) {\n        // become visible\n        const index = ranking.children.indexOf(col);\n        this.columns.splice(index, 0, this.createCol(col, index));\n        this.updateHist(col);\n      } else {\n        // hide\n        const index = this.columns.findIndex((d) => d.c === col);\n        EngineRanking.disableListener(col);\n        this.columns.splice(index, 1);\n      }\n      this.reindex();\n      this.delayedUpdateAll();\n    });\n    ranking.on(`${Ranking.EVENT_ORDER_CHANGED}.body`, this.delayedUpdate);\n\n    this.selection = new SelectionManager(this.ctx, body);\n    this.selection.on(SelectionManager.EVENT_SELECT_RANGE, (from: number, to: number, additional: boolean) => {\n      this.selection.selectRange(this.data.slice(from, to + 1), additional);\n    });\n\n    this.renderCtx = Object.assign({\n      isGroup: (index: number) => isGroup(this.data[index]),\n      getRow: (index: number) => <IGroupItem>this.data[index],\n      getGroup: (index: number) => <IGroupData>this.data[index]\n    }, ctx);\n\n    // default context\n    this.columns = ranking.children.filter((c) => c.isVisible()).map((c, i) => this.createCol(c, i));\n    this._context = Object.assign({\n      columns: this.columns,\n      column: nonUniformContext(this.columns.map((w) => w.width), 100, COLUMN_PADDING)\n    }, uniformContext(0, 20));\n\n    this.columns.forEach((column) => {\n      if (column instanceof MultiLevelRenderColumn) {\n        column.updateWidthRule(this.style);\n      }\n      column.renderers = this.ctx.createRenderer(column.c);\n    });\n  }\n\n  on(type: typeof EngineRanking.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof EngineRanking.EVENT_UPDATE_DATA, listener: typeof updateData | null): this;\n  on(type: typeof EngineRanking.EVENT_UPDATE_HIST, listener: typeof updateHist | null): this;\n  on(type: typeof EngineRanking.EVENT_HIGHLIGHT_CHANGED, listener: typeof highlightChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    this.events.on(type, listener);\n    return this;\n  }\n\n  get id() {\n    return this.ranking.id;\n  }\n\n  protected onVisibilityChanged(visible: boolean) {\n    super.onVisibilityChanged(visible);\n    if (visible) {\n      this.delayedUpdate.call({type: Ranking.EVENT_ORDER_CHANGED});\n    }\n  }\n\n  updateHeaders() {\n    return super.updateHeaders();\n  }\n\n  get currentData() {\n    return this.data;\n  }\n\n  get context(): ICellRenderContext<RenderColumn> {\n    return this._context;\n  }\n\n  protected createHeader(_document: Document, column: RenderColumn) {\n    return column.createHeader();\n  }\n\n  protected updateHeader(node: HTMLElement, column: RenderColumn) {\n    if (column instanceof MultiLevelRenderColumn) {\n      column.updateWidthRule(this.style);\n    }\n    return column.updateHeader(node);\n  }\n\n  protected createCell(_document: Document, index: number, column: RenderColumn) {\n    return column.createCell(index);\n  }\n\n  protected updateCell(node: HTMLElement, index: number, column: RenderColumn) {\n    return column.updateCell(node, index);\n  }\n\n  private selectCanvas() {\n    if (this.canvasPool.length > 0) {\n      return this.canvasPool.pop()!;\n    }\n    console.assert(this.body.ownerDocument != null);\n    const c = this.body.ownerDocument!.createElement('canvas');\n    c.classList.add('lu-detail-canvas');\n    return c;\n  }\n\n  private rowFlags(row: HTMLElement) {\n    const rowany: any = row;\n    const v = rowany.__lu__;\n    if (v == null) {\n      return rowany.__lu__ = {};\n    }\n    return v;\n  }\n\n  private visibleRenderedWidth() {\n    let width = 0;\n    for (const col of this.visibleColumns.frozen) {\n      width += this.columns[col].width + COLUMN_PADDING;\n    }\n    for(let col = this.visibleColumns.first; col <= this.visibleColumns.last; ++col) {\n      width += this.columns[col].width + COLUMN_PADDING;\n    }\n    if (width > 0) {\n      width -= COLUMN_PADDING; // for the last one\n    }\n    return width;\n  }\n\n  private renderRow(canvas: HTMLCanvasElement, index: number, width = this.visibleRenderedWidth()) {\n    canvas.width = width;\n    canvas.style.width = `${width}px`;\n    canvas.height = CANVAS_HEIGHT;\n    const ctx = canvas.getContext('2d')!;\n    ctx.imageSmoothingEnabled = false;\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.save();\n    for (const col of this.visibleColumns.frozen) {\n      const c = this.columns[col];\n      c.renderCell(ctx, index);\n      const shift = c.width + COLUMN_PADDING;\n      ctx.translate(shift, 0);\n    }\n    for(let col = this.visibleColumns.first; col <= this.visibleColumns.last; ++col) {\n      const c = this.columns[col];\n      c.renderCell(ctx, index);\n      const shift = c.width + COLUMN_PADDING;\n      ctx.translate(shift, 0);\n    }\n    ctx.restore();\n  }\n\n  protected updateCanvasCell(canvas: HTMLCanvasElement, index: number, column: RenderColumn, x: number) {\n    const ctx = canvas.getContext('2d')!;\n    ctx.clearRect(x - 1, 0, column.width + 2, canvas.height);\n    ctx.save();\n    ctx.translate(x, 0);\n    column.renderCell(ctx, index);\n    ctx.restore();\n  }\n\n  private reindex() {\n    this.columns.forEach((c, i) => {\n      c.index = i;\n    });\n  }\n\n  updateAll() {\n    this.columns.forEach((c, i) => {\n      c.index = i;\n      c.renderers = this.ctx.createRenderer(c.c);\n    });\n\n    this._context = Object.assign({}, this._context, {\n      column: nonUniformContext(this.columns.map((w) => w.width), 100, COLUMN_PADDING)\n    });\n\n    super.recreate();\n    this.events.fire(EngineRanking.EVENT_WIDTH_CHANGED);\n  }\n\n  updateBody() {\n    if (this.hidden) {\n      return;\n    }\n    this.events.fire(EngineRanking.EVENT_WIDTH_CHANGED);\n    super.forEachRow((row, rowIndex) => this.updateRow(row, rowIndex));\n  }\n\n  updateHeaderOf(col: Column) {\n    const i = this._context.columns.findIndex((d) => d.c === col);\n    if (i < 0) {\n      return false;\n    }\n    const node = <HTMLElement>this.header.children[i]!;\n    const column = this._context.columns[i];\n    if (node && column) {\n      this.updateHeader(node, column);\n    }\n    return node && column;\n  }\n\n  protected createRow(node: HTMLElement, rowIndex: number): void {\n    node.classList.add('lu-row');\n    this.roptions.customRowUpdate(node, rowIndex);\n    if (this.highlightHandler.enabled) {\n      node.addEventListener('mouseenter', this.highlightHandler.enter, {\n        passive: true\n      });\n      this.rowFlags(node).highlight = true;\n    }\n\n    const isGroup = this.renderCtx.isGroup(rowIndex);\n\n    if (isGroup) {\n      node.dataset.agg = 'group';\n      super.createRow(node, rowIndex);\n      return;\n    }\n\n    const {i, meta} = this.renderCtx.getRow(rowIndex);\n    node.classList.toggle('le-highlighted', this.highlight === i);\n    node.dataset.i = i.toString();\n    node.dataset.agg = 'detail'; //or 'group'\n    if (!meta) {\n      delete node.dataset.meta;\n    } else {\n      node.dataset.meta = meta;\n    }\n\n    this.selection.updateState(node, i);\n    this.selection.add(node);\n\n    const lod = this.roptions.levelOfDetail(rowIndex);\n\n    if (lod === 'high') {\n      delete node.dataset.lod;\n    } else {\n      node.dataset.lod = lod;\n    }\n\n    if (lod === 'high' || meta || this.ctx.provider.isSelected(i)) {\n      super.createRow(node, rowIndex);\n      return;\n    }\n\n    const canvas = this.selectCanvas();\n    node.appendChild(canvas);\n    this.renderRow(canvas, rowIndex);\n    node.addEventListener('mouseenter', this.canvasMouseHandler.enter, {\n      passive: true\n    });\n  }\n\n  protected updateRow(node: HTMLElement, rowIndex: number, forcedLod?: 'high' | 'low'): void {\n    this.roptions.customRowUpdate(node, rowIndex);\n\n    const computedLod = this.roptions.levelOfDetail(rowIndex);\n    const lod = forcedLod ? forcedLod : computedLod;\n    const wasLod = node.dataset.lod || 'high';\n    const isGroup = this.renderCtx.isGroup(rowIndex);\n    const wasGroup = node.dataset.agg === 'group';\n\n    if (computedLod === 'high') {\n      delete node.dataset.lod;\n    } else {\n      node.dataset.lod = computedLod;\n    }\n\n    if (this.highlightHandler.enabled && !this.rowFlags(node).highlight) {\n      node.addEventListener('mouseenter', this.highlightHandler.enter, {\n        passive: true\n      });\n      this.rowFlags(node).highlight = true;\n    }\n\n    node.removeEventListener('mouseenter', this.canvasMouseHandler.enter);\n\n    if (isGroup !== wasGroup) {\n      // change of mode clear the children to reinitialize them\n      node.innerHTML = '';\n\n      // adapt body\n      node.dataset.agg = isGroup ? 'group' : 'detail';\n      if (isGroup) {\n        node.dataset.i = '';\n        this.selection.remove(node);\n      } else {\n        this.selection.add(node);\n      }\n    }\n\n    if (isGroup) {\n      node.classList.remove('le-highlighted');\n      super.updateRow(node, rowIndex);\n      return;\n    }\n\n    const {i, meta} = this.renderCtx.getRow(rowIndex);\n    node.classList.toggle('le-highlighted', this.highlight === i);\n    node.dataset.i = i.toString();\n    if (!meta) {\n      delete node.dataset.meta;\n    } else {\n      node.dataset.meta = meta;\n    }\n    this.selection.updateState(node, i);\n\n    const canvas = <HTMLCanvasElement>Array.from(node.children).find((d) => d.classList.contains('lu-detail-canvas'));\n    if (lod === 'high' || meta || this.ctx.provider.isSelected(i)) {\n      if (canvas) {\n        this.canvasPool.push(canvas);\n        canvas.remove();\n      }\n      super.updateRow(node, rowIndex);\n      return;\n    }\n\n    node.addEventListener('mouseenter', this.canvasMouseHandler.enter, {\n      passive: true\n    });\n    // use canvas\n    if (wasLod !== 'high' && canvas) {\n      this.renderRow(canvas, rowIndex);\n      return;\n    }\n    // clear old\n    node.innerHTML = '';\n    node.dataset.agg = 'detail';\n    const canvas2 = this.selectCanvas();\n    node.appendChild(canvas2);\n    this.renderRow(canvas2, rowIndex);\n  }\n\n  private updateCanvasBody() {\n    const width = this.visibleRenderedWidth();\n    super.forEachRow((row, index) => {\n      if (EngineRanking.isCanvasRenderedRow(row)) {\n        this.renderRow(row.querySelector('canvas')!, index, width);\n      }\n    });\n  }\n\n  protected updateShifts(top: number, left: number) {\n    super.updateShifts(top, left);\n\n    if (left === this.oldLeft) {\n      return;\n    }\n    this.oldLeft = left;\n    this.updateCanvasBody();\n  }\n\n  enableHighlightListening(enable: boolean) {\n    if (this.highlightHandler.enabled === enable) {\n      return;\n    }\n\n    this.highlightHandler.enabled = enable;\n\n    if (enable) {\n      this.body.addEventListener('mouseleave', this.highlightHandler.leave, {\n        passive: true\n      });\n      super.forEachRow((row) => {\n        row.addEventListener('mouseenter', this.highlightHandler.enter, {\n          passive: true\n        });\n        this.rowFlags(row).highlight = true;\n      });\n      return;\n    }\n\n    this.body.removeEventListener('mouseleave', this.highlightHandler.leave);\n\n    super.forEachRow((row) => {\n      row.removeEventListener('mouseenter', this.highlightHandler.enter);\n      this.rowFlags(row).highlight = false;\n    });\n  }\n\n  private updateHoveredRow(row: HTMLElement, hover: boolean) {\n    const isCanvas = EngineRanking.isCanvasRenderedRow(row);\n    if (isCanvas !== hover) {\n      return; // good nothing to do\n    }\n    const index = parseInt(row.dataset.index!, 10);\n    this.updateRow(row, index, hover ? 'high' : 'low');\n  }\n\n  protected forEachRow(callback: (row: HTMLElement, rowIndex: number) => void, inplace: boolean = false) {\n    const adapter = (row: HTMLElement, rowIndex: number) => {\n      if (EngineRanking.isCanvasRenderedRow(row)) {\n        // skip canvas\n        return;\n      }\n      callback(row, rowIndex);\n    };\n    return super.forEachRow(adapter, inplace);\n  }\n\n  updateSelection(selectedDataIndices: { has(i: number): boolean }) {\n    super.forEachRow((node: HTMLElement, rowIndex: number) => {\n      if (this.renderCtx.isGroup(rowIndex)) {\n        this.updateRow(node, rowIndex);\n      } else {\n        // fast pass for item\n        this.selection.update(node, selectedDataIndices);\n      }\n    }, true);\n  }\n\n  updateColumnWidths() {\n    // update the column context in place\n    (<any>this._context).column = nonUniformContext(this._context.columns.map((w) => w.width), 100, COLUMN_PADDING);\n    super.updateColumnWidths();\n    const {columns} = this.context;\n    //no data update needed since just width changed\n    columns.forEach((column) => {\n      if (column instanceof MultiLevelRenderColumn) {\n        column.updateWidthRule(this.style);\n      }\n      column.renderers = this.ctx.createRenderer(column.c);\n    });\n    this.events.fire(EngineRanking.EVENT_WIDTH_CHANGED);\n  }\n\n  private updateHist(col: Column) {\n    this.events.fire(EngineRanking.EVENT_UPDATE_HIST, col);\n  }\n\n  private updateColumn(index: number) {\n    const columns = this.context.columns;\n    const column = columns[index];\n    if (!column) {\n      return false;\n    }\n    let x = 0;\n    for (let i = this.visibleColumns.first; i < index; ++i) {\n      x += columns[i].width + COLUMN_PADDING;\n    }\n    super.forEachRow((row, rowIndex) => {\n      if (EngineRanking.isCanvasRenderedRow(row)) {\n        this.updateCanvasCell(row.querySelector('canvas')!, rowIndex, column, x);\n        return;\n      }\n      const before = <HTMLElement>row.children[index];\n      if (!before) {\n        return; // race condition\n      }\n      const after = this.updateCell(before, rowIndex, column);\n      if (before !== after && after) {\n        setColumn(after, column);\n        row.replaceChild(after, before);\n      }\n    });\n    return true;\n  }\n\n  destroy() {\n    super.destroy();\n    this.ranking.flatColumns.forEach((c) => EngineRanking.disableListener(c));\n  }\n\n  groupData(data: IDataRow[]): (IGroupItem | IGroupData)[] {\n    const groups = this.ranking.getGroups();\n    const provider = this.ctx.provider;\n    const toMeta = (relativeIndex: number, length: number): 'first' | 'last' | 'first last' | undefined => {\n      if (length === 1) {\n        return 'first last';\n      }\n      if (relativeIndex === 0) {\n        return 'first';\n      }\n      if (relativeIndex === length - 1) {\n        return 'last';\n      }\n      return undefined;\n    };\n    if (groups.length === 1) {\n      // simple case\n      if (provider.isAggregated(this.ranking, groups[0])) {\n        // just a single row\n        return [Object.assign({rows: data}, groups[0])];\n      }\n      // simple ungrouped case\n      return data.map((r, i) => Object.assign({group: groups[0], relativeIndex: i, meta: toMeta(i, data.length)}, r));\n    }\n\n    //multiple groups\n    let offset = 0;\n    const r = <(IGroupItem | IGroupData)[]>[];\n    groups.forEach((group) => {\n      const length = group.order.length;\n      const groupData = data.slice(offset, offset + length);\n      offset += length;\n\n      if (provider.isAggregated(this.ranking, group)) {\n        r.push(Object.assign({rows: groupData}, group));\n        return;\n      }\n      r.push(...groupData.map((r, i) => Object.assign({\n        group,\n        relativeIndex: i,\n        meta: toMeta(i, groupData.length)\n      }, r)));\n    });\n    return r;\n  }\n\n  render(data: (IGroupItem | IGroupData)[], rowContext: IExceptionContext) {\n    const previous = this._context;\n    const previousData = this.data;\n    this.data = data;\n    (<any>this.renderCtx).totalNumberOfRows = data.length;\n\n    this.columns.forEach((c, i) => {\n      c.index = i;\n      c.renderers = this.ctx.createRenderer(c.c);\n    });\n    this._context = Object.assign({\n      columns: this.columns,\n      column: nonUniformContext(this.columns.map((w) => w.width), 100, COLUMN_PADDING)\n    }, rowContext);\n\n    if (!this.bodyScroller) { // somehow not part of dom\n      return;\n    }\n    return super.recreate(this.roptions.animation ? lineupAnimation(previous, previousData, this.data) : undefined);\n  }\n\n  setHighlight(dataIndex: number) {\n    this.highlight = dataIndex;\n    const old = this.body.querySelector(`[data-i].le-highlighted`);\n    if (old) {\n      old.classList.remove('le-highlighted');\n    }\n    if (dataIndex < 0) {\n      return;\n    }\n    const item = this.body.querySelector(`[data-i=\"${dataIndex}\"]`);\n    if (item) {\n      item.classList.add('le-highlighted');\n    }\n    return item != null;\n  }\n\n  findNearest(dataIndices: number[]) {\n    // find the nearest visible data index\n    // first check if already visible\n    const index = dataIndices.find((d) => Boolean(this.body.querySelectorAll(`[data-i=\"${d}\"]`)));\n    if (index != null) {\n      return index; // visible one\n    }\n    const visible = this.visible;\n    const lookFor = new Set(dataIndices);\n    let firstBeforePos = -1;\n    let firstAfterPos = -1;\n    for (let i = visible.first; i >= 0; --i) {\n      const d = this.data[i];\n      if (!isGroup(d) && lookFor.has(d.i)) {\n        firstBeforePos = i;\n        break;\n      }\n    }\n    for (let i = visible.last; i < this.data.length; ++i) {\n      const d = this.data[i];\n      if (!isGroup(d) && lookFor.has(d.i)) {\n        firstAfterPos = i;\n        break;\n      }\n    }\n\n    if (firstBeforePos < 0 && firstBeforePos < 0) {\n      return -1; // not found at all\n    }\n    const nearestPos = (firstBeforePos >= 0 && (visible.first - firstBeforePos) < (firstAfterPos - visible.last)) ? firstBeforePos : firstAfterPos;\n    return (<IGroupItem>this.data[nearestPos]).i;\n  }\n\n  scrollIntoView(dataIndex: number) {\n    const item = this.body.querySelector(`[data-i=\"${dataIndex}\"]`);\n    if (item) {\n      item.scrollIntoView(true);\n      return true;\n    }\n    const index = this.data.findIndex((d) => !isGroup(d) && d.i === dataIndex);\n    if (index < 0) {\n      return false; // part of a group?\n    }\n\n    const posOf = () => {\n      const c = this._context;\n      if (c.exceptions.length === 0 || index < c.exceptions[0].index) {\n        // fast pass\n        return index * c.defaultRowHeight;\n      }\n      const before = c.exceptions.reverse().find((d) => d.index <= index);\n      if (!before) {\n        return -1;\n      }\n      if (before.index === index) {\n        return before.y;\n      }\n      const regular = index - before.index - 1;\n      return before.y2 + regular * c.defaultRowHeight;\n    };\n    const pos = posOf();\n    if (pos < 0) {\n      return false;\n    }\n    const scroller = this.bodyScroller;\n    if (!scroller) {\n      return false;\n    }\n    const top = scroller.scrollTop;\n    scroller.scrollTop = Math.min(pos, scroller.scrollHeight - scroller.clientHeight);\n    this.onScrolledVertically(scroller.scrollTop, scroller.clientHeight, top < scroller.scrollTop);\n\n    const found = this.body.querySelector(`[data-i=\"${dataIndex}\"]`);\n    if (found) {\n      found.scrollIntoView(true);\n      return true;\n    }\n    return false;\n  }\n\n  getHighlight() {\n    const item = <HTMLElement>this.body.querySelector(`[data-i]:hover, [data-i].le-highlighted`);\n    if (item) {\n      return parseInt(item.dataset.i!, 10);\n    }\n    return this.highlight;\n  }\n\n  private createCol(c: Column, index: number) {\n    const col = (isMultiLevelColumn(c) && !c.getCollapsed()) ? new MultiLevelRenderColumn(c, index, this.renderCtx, this.roptions.flags) : new RenderColumn(c, index, this.renderCtx, this.roptions.flags);\n\n    c.on(`${Column.EVENT_WIDTH_CHANGED}.body`, () => {\n      this.delayedUpdateColumnWidths();\n    });\n    c.on(`${ValueColumn.EVENT_DATA_LOADED}.hist`, () => this.updateHist(c));\n    const debounceUpdate = debounce(() => {\n      const valid = this.updateColumn(col.index);\n      if (!valid) {\n        EngineRanking.disableListener(c); // destroy myself\n      }\n    }, 25);\n    c.on([`${Column.EVENT_RENDERER_TYPE_CHANGED}.body`, `${Column.EVENT_GROUP_RENDERER_TYPE_CHANGED}.body`], () => {\n      // replace myself upon renderer type change\n      col.renderers = this.ctx.createRenderer(c);\n      debounceUpdate();\n    });\n    const that = this;\n    c.on(`${Column.EVENT_DIRTY_HEADER}.body`, function (this: IEventContext) {\n      const valid = that.updateHeaderOf(col.c);\n      if (!valid) {\n        EngineRanking.disableListener(c); // destroy myself\n      }\n      if (this.primaryType === Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED || this.primaryType === Column.EVENT_LABEL_CHANGED || this.primaryType === Column.EVENT_METADATA_CHANGED) {\n        return;\n      }\n      self.setTimeout(() => that.updateHist(col.c), 50);\n    });\n    c.on(`${Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED}.body`, () => {\n      // replace myself upon renderer type change\n      col.renderers = this.ctx.createRenderer(c);\n      const valid = this.updateHeaderOf(col.c);\n      if (!valid) {\n        EngineRanking.disableListener(c); // destroy myself\n      }\n    });\n    c.on(`${Column.EVENT_DIRTY_VALUES}.body`, debounceUpdate);\n\n    if (isMultiLevelColumn(c) && !c.getCollapsed()) {\n      (<MultiLevelRenderColumn>col).updateWidthRule(this.style);\n      c.on(`${StackColumn.EVENT_MULTI_LEVEL_CHANGED}.body`, () => {\n        (<MultiLevelRenderColumn>col).updateWidthRule(this.style);\n      });\n      c.on(`${StackColumn.EVENT_MULTI_LEVEL_CHANGED}.bodyUpdate`, debounceUpdate);\n    }\n\n    return col;\n  }\n\n  private static isCanvasRenderedRow(row: HTMLElement) {\n    return row.dataset.lod === 'low' && row.childElementCount === 1 && row.firstElementChild!.classList.contains('lu-detail-canvas');\n  }\n\n  private static disableListener(c: Column) {\n    c.on(`${Column.EVENT_WIDTH_CHANGED}.body`, null);\n    c.on(`${ValueColumn.EVENT_DATA_LOADED}.hist`, null);\n    c.on([`${Column.EVENT_RENDERER_TYPE_CHANGED}.body`, `${Column.EVENT_GROUP_RENDERER_TYPE_CHANGED}.body`, `${Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED}.body`, `${Column.EVENT_LABEL_CHANGED}.body`], null);\n    c.on(`${Ranking.EVENT_DIRTY_HEADER}.body`, null);\n    c.on(`${Ranking.EVENT_DIRTY_VALUES}.body`, null);\n\n    if (!(isMultiLevelColumn(c))) {\n      return;\n    }\n    c.on(`${StackColumn.EVENT_MULTI_LEVEL_CHANGED}.body`, null);\n    c.on(`${StackColumn.EVENT_MULTI_LEVEL_CHANGED}.bodyUpdate`, null);\n  }\n}\n","interface IDebounceContext {\r\n  self: any;\r\n  args: any[];\r\n}\r\n\r\n/**\r\n * create a delayed call, can be called multiple times but only the last one at most delayed by timeToDelay will be executed\r\n * @param {(...args: any[]) => void} callback the callback to call\r\n * @param {number} timeToDelay delay the call in milliseconds\r\n * @return {(...args: any[]) => any} a function that can be called with the same interface as the callback but delayed\r\n * @internal\r\n */\r\nexport default function debounce(callback: (...args: any[]) => void, timeToDelay = 100, choose?: (current: IDebounceContext, next: IDebounceContext) => IDebounceContext) {\r\n  let tm = -1;\r\n  let ctx: IDebounceContext | null = null;\r\n  return function (this: any, ...args: any[]) {\r\n    if (tm >= 0) {\r\n      clearTimeout(tm);\r\n      tm = -1;\r\n    }\r\n    const next = {self: this, args};\r\n    ctx = ctx && choose ? choose(ctx, next) : next;\r\n    tm = self.setTimeout(() => {\r\n      console.assert(ctx != null);\r\n      callback.call(ctx!.self, ...ctx!.args);\r\n      ctx = null;\r\n    }, timeToDelay);\r\n  };\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport {default as ActionColumn} from '../model/ActionColumn';\r\nimport Column from '../model/Column';\r\nimport {ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {forEachChild, noop, noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport default class ActionRenderer implements ICellRendererFactory {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return col instanceof ActionColumn && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  create(col: ActionColumn) {\r\n    const actions = col.actions;\r\n    return {\r\n      template: `<div class='actions lu-hover-only'>${actions.map((a) => `<span title='${a.name}' class='${a.className || ''}'>${a.icon || ''}</span>`).join('')}</div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        forEachChild(n, (ni: HTMLSpanElement, i: number) => {\r\n          ni.onclick = function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            actions[i].action(d);\r\n          };\r\n        });\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(col: ActionColumn) {\r\n    const actions = col.groupActions;\r\n    return {\r\n      template: `<div class='actions lu-hover-only'>${actions.map((a) => `<span title='${a.name}' class='${a.className || ''}'>${a.icon || ''}</span>`).join('')}</div>`,\r\n      update: (n: HTMLElement, group: IGroup, rows: IDataRow[]) => {\r\n        forEachChild(n, (ni: HTMLSpanElement, i: number) => {\r\n          ni.onclick = function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            actions[i].action(group, rows);\r\n          };\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport AggregateGroupColumn from '../model/AggregateGroupColumn';\r\nimport Column from '../model/Column';\r\nimport {AGGREGATE, CANVAS_HEIGHT} from '../styles';\r\nimport {default as IRenderContext, ICellRendererFactory} from './interfaces';\r\n\r\n/** @internal */\r\nexport default class AggregateGroupRenderer implements ICellRendererFactory {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof AggregateGroupColumn;\r\n  }\r\n\r\n  create(col: AggregateGroupColumn, context: IRenderContext) {\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div title=\"Collapse Group\"></div>`,\r\n      update(node: HTMLElement, _row: IDataRow, _i: number, group: IGroup) {\r\n        node.onclick = function (event) {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          col.setAggregated(group, true);\r\n        };\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D) => {\r\n        ctx.fillStyle = AGGREGATE.color;\r\n        // weird shift of 1\r\n        ctx.fillRect(width - AGGREGATE.width - 1, 0, AGGREGATE.strokeWidth, CANVAS_HEIGHT);\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: AggregateGroupColumn) {\r\n    return {\r\n      template: `<div title=\"Expand Group\"></div>`,\r\n      update(node: HTMLElement, group: IGroup) {\r\n        node.onclick = function (event) {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          col.setAggregated(group, false);\r\n        };\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: AggregateGroupColumn, context: IRenderContext) {\r\n    return {\r\n      template: `<div title=\"(Un)Aggregate All\" data-icon=\"caret-down\"></div>`,\r\n      update: (node: HTMLElement) => {\r\n        const ranking = col.findMyRanker();\r\n        const right = Boolean(ranking && ranking.getGroups().every((g) => col.isAggregated(g)));\r\n\r\n        node.dataset.icon = right ? 'caret-right' : 'caret-down';\r\n\r\n        node.onclick = (evt) => {\r\n          evt.stopPropagation();\r\n          const ranking = col.findMyRanker();\r\n          if (!ranking || !context) {\r\n            return;\r\n          }\r\n          const aggregate = node.dataset.icon === 'caret-down';\r\n          node.dataset.icon = aggregate ? 'caret-right' : 'caret-down';\r\n          context.provider.aggregateAllOf(ranking, aggregate);\r\n        };\r\n      }\r\n    };\r\n  }\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport StringColumn from '../model/StringColumn';\r\nimport {filterMissingMarkup, findFilterMissing} from '../ui/missing';\r\nimport {default as IRenderContext, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, setText, uniqueId, exampleText} from './utils';\r\n\r\n\r\n/**\r\n * renders a string with additional alignment behavior\r\n * one instance factory shared among strings\r\n * @internal\r\n */\r\nexport default class StringCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof StringColumn;\r\n  }\r\n\r\n  create(col: StringColumn) {\r\n    const align = col.alignment || 'left';\r\n    return {\r\n      template: `<div${align !== 'left' ? ` class=\"lu-${align}\"` : ''}> </div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow) => {\r\n        renderMissingDOM(n, col, d);\r\n        if (col.escape) {\r\n          setText(n, col.getLabel(d));\r\n        } else {\r\n          n.innerHTML = col.getLabel(d);\r\n        }\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n\r\n  createGroup(col: StringColumn) {\r\n    return {\r\n      template: `<div> </div>`,\r\n      update: (n: HTMLDivElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const v = exampleText(col, rows);\r\n        if (col.escape) {\r\n          setText(n, v);\r\n        } else {\r\n          n.innerHTML = v;\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  private static interactiveSummary(col: StringColumn, node: HTMLElement) {\r\n    const form = <HTMLFormElement>node;\r\n    const filterMissing = findFilterMissing(node);\r\n    const input = <HTMLInputElement>node.querySelector('input[type=\"text\"]');\r\n    const isRegex = <HTMLInputElement>node.querySelector('input[type=\"checkbox\"]');\r\n\r\n    const update = () => {\r\n      input.disabled = filterMissing.checked;\r\n      isRegex.disabled = filterMissing.checked;\r\n\r\n      if (filterMissing.checked) {\r\n        col.setFilter(StringColumn.FILTER_MISSING);\r\n        return;\r\n      }\r\n      const valid = input.value.trim();\r\n      filterMissing.disabled = valid.length > 0;\r\n      if (valid.length <= 0) {\r\n        col.setFilter(null);\r\n        return;\r\n      }\r\n      col.setFilter(isRegex.checked ? new RegExp(input.value) : input.value);\r\n    };\r\n\r\n    filterMissing.onchange = update;\r\n    input.onchange = update;\r\n    isRegex.onchange = update;\r\n    form.onsubmit = (evt) => {\r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n      update();\r\n      return false;\r\n    };\r\n\r\n    return (actCol: StringColumn) => {\r\n      col = actCol;\r\n      let bak = col.getFilter() || '';\r\n      const bakMissing = bak === StringColumn.FILTER_MISSING;\r\n      if (bakMissing) {\r\n        bak = '';\r\n      }\r\n      filterMissing.checked = bakMissing;\r\n      input.value = bak instanceof RegExp ? bak.source : bak;\r\n      isRegex.checked = bak instanceof RegExp;\r\n      filterMissing.disabled = input.value.trim().length > 0;\r\n      input.disabled = filterMissing.checked;\r\n      isRegex.disabled = filterMissing.checked;\r\n    };\r\n  }\r\n\r\n  createSummary(col: StringColumn, context: IRenderContext, interactive: boolean) {\r\n    if (!interactive) {\r\n      return {\r\n        template: `<div></div>`,\r\n        update: (node: HTMLElement) => {\r\n          const filter = col.getFilter() || '';\r\n          node.textContent = toString(filter);\r\n        }\r\n      };\r\n    }\r\n    let bak = col.getFilter() || '';\r\n    const bakMissing = bak === StringColumn.FILTER_MISSING;\r\n    if (bakMissing) {\r\n      bak = '';\r\n    }\r\n    let update: (col: StringColumn) => void;\r\n    const id = uniqueId(context.idPrefix);\r\n    return {\r\n      template: `<form><input type=\"text\" placeholder=\"Filter ${col.desc.label}...\" autofocus value=\"${(bak instanceof RegExp) ? bak.source : bak}\">\r\n          <div class=\"lu-checkbox\"><input id=\"${id}\" type=\"checkbox\" ${(bak instanceof RegExp) ? 'checked=\"checked\"' : ''}><label for=\"${id}\">Use regular expressions</label></div>\r\n          ${filterMissingMarkup(bakMissing, context.idPrefix)}</form>`,\r\n      update: (node: HTMLElement) => {\r\n        if (!update) {\r\n          update = StringCellRenderer.interactiveSummary(col, node);\r\n        }\r\n        update(col);\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nfunction toString(filter: null | string | RegExp) {\r\n  if (filter == null || filter === '' || filter === StringColumn.FILTER_MISSING) {\r\n    return '';\r\n  }\r\n  if (filter instanceof RegExp) {\r\n    return filter.source;\r\n  }\r\n  return String(filter);\r\n}\r\n","import {IDataRow} from '../model';\r\nimport AnnotateColumn from '../model/AnnotateColumn';\r\nimport Column from '../model/Column';\r\nimport StringCellRenderer from './StringCellRenderer';\r\nimport {noop} from './utils';\r\n\r\n/** @internal */\r\nexport default class AnnotationRenderer extends StringCellRenderer {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column) {\r\n    return super.canRender(col) && col instanceof AnnotateColumn;\r\n  }\r\n\r\n  create(col: AnnotateColumn) {\r\n    return {\r\n      template: `<div class='annotations text'>\r\n        <input class='lu-hover-only'>\r\n        <span class='text lu-not-hover'></span>\r\n       </div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        const input: HTMLInputElement = <HTMLInputElement>n.firstElementChild!;\r\n        input.onchange = () => {\r\n          col.setValue(d, input.value);\r\n        };\r\n        input.onclick = (event) => {\r\n          event.stopPropagation();\r\n        };\r\n        n.lastElementChild!.textContent = input.value = col.getLabel(d);\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n}\r\n","import {IDataRow} from '../model';\r\nimport Column from '../model/Column';\r\nimport {IImposer} from './interfaces';\r\nimport {isMapAbleColumn} from '../model/MappingFunction';\r\n\r\nexport function colorOf(col: Column, row: IDataRow | null, imposer?: IImposer, valueHint?: number) {\r\n  if (imposer && imposer.color) {\r\n    return imposer.color(row, valueHint);\r\n  }\r\n  if (!row) {\r\n    if (isMapAbleColumn(col)) {\r\n      return col.getColorMapping().apply(valueHint != null ? valueHint : 0);\r\n    }\r\n    return Column.DEFAULT_COLOR;\r\n  }\r\n  return col.getColor(row);\r\n}\r\n","import {ICategoricalStatistics, IStatistics} from '../internal';\r\nimport {IDataRow, INumberColumn, isNumberColumn} from '../model';\r\nimport Column from '../model/Column';\r\nimport {setText, adaptDynamicColorToBgColor, noRenderer} from './utils';\r\nimport {isNumbersColumn} from '../model';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {colorOf} from './impose';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\n\r\n\r\n/** @internal */\r\nexport default class BarCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Bar';\r\n\r\n  /**\r\n   * flag to always render the value\r\n   * @type {boolean}\r\n   */\r\n\r\n  constructor(private readonly renderValue: boolean = false) {\r\n  }\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return mode === ERenderMode.CELL && isNumberColumn(col) && !isNumbersColumn(col);\r\n  }\r\n\r\n  create(col: INumberColumn, context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div title=\"\">\r\n          <div style='background-color: ${Column.DEFAULT_COLOR}'>\r\n            <span ${this.renderValue ? '' : 'class=\"lu-hover-only\"'}></span>\r\n          </div>\r\n        </div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow) => {\r\n        const value = col.getNumber(d);\r\n        const missing = renderMissingDOM(n, col, d);\r\n        const w = isNaN(value) ? 0 : Math.round(value * 100 * 100) / 100;\r\n        const title = col.getLabel(d);\r\n        n.title = title;\r\n\r\n        const bar = <HTMLElement>n.firstElementChild!;\r\n        bar.style.width = missing ? '100%' : `${w}%`;\r\n        const color = colorOf(col, d, imposer, value);\r\n        bar.style.backgroundColor = missing ? null : color;\r\n        setText(bar.firstElementChild!, title);\r\n        const item = <HTMLElement>bar.firstElementChild!;\r\n        setText(item, title);\r\n        adaptDynamicColorToBgColor(item, color || Column.DEFAULT_COLOR, title, w / 100);\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        const value = col.getNumber(d);\r\n        ctx.fillStyle = colorOf(col, d, imposer, value) || Column.DEFAULT_COLOR;\r\n        const w = width * value;\r\n        ctx.fillRect(0, 0, isNaN(w) ? 0 : w, CANVAS_HEIGHT);\r\n\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return noRenderer;\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {IDataRow} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ERenderMode, ICellRendererFactory, IGroupCellRenderer, ISummaryRenderer, ICellRenderer} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, noRenderer, setText} from './utils';\r\n\r\n/**\r\n * default renderer instance rendering the value as a text\r\n */\r\nexport class DefaultCellRenderer implements ICellRendererFactory {\r\n  title = 'String';\r\n  groupTitle = 'None';\r\n  summaryTitle = 'None';\r\n\r\n  canRender(_col: Column, _mode: ERenderMode) {\r\n    return true;\r\n  }\r\n\r\n  create(col: Column): ICellRenderer {\r\n    return {\r\n      template: `<div> </div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow) => {\r\n        renderMissingDOM(n, col, d);\r\n        setText(n, col.getLabel(d));\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(_col: Column): IGroupCellRenderer {\r\n    return noRenderer;\r\n  }\r\n\r\n  createSummary(): ISummaryRenderer {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import BooleanColumn from '../model/BooleanColumn';\r\nimport Column from '../model/Column';\r\nimport {DefaultCellRenderer} from './DefaultCellRenderer';\r\nimport {ERenderMode} from './interfaces';\r\n\r\n/** @internal */\r\nexport default class BooleanCellRenderer extends DefaultCellRenderer {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return col instanceof BooleanColumn && mode === ERenderMode.CELL;\r\n  }\r\n\r\n  create(col: Column) {\r\n    const r = super.create(col);\r\n    (<any>r).template = `<div class=\"lu-center\"> </div>`;\r\n    return r;\r\n  }\r\n}\r\n","import {IBoxPlotData, ICategoricalStatistics, IStatistics, LazyBoxPlotData, IAdvancedBoxPlotData, round} from '../internal';\r\nimport {IDataRow, IGroup, isNumberColumn} from '../model';\r\nimport {default as BoxPlotColumn} from '../model/BoxPlotColumn';\r\nimport Column from '../model/Column';\r\nimport {IBoxPlotColumn, INumberColumn, INumbersColumn, isBoxPlotColumn, isNumbersColumn} from '../model/INumberColumn';\r\nimport NumberColumn from '../model/NumberColumn';\r\nimport {BOX_PLOT, CANVAS_HEIGHT, DOT} from '../styles';\r\nimport {colorOf} from './impose';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {isMapAbleColumn} from '../model/MappingFunction';\r\n\r\n/** @internal */\r\nexport function computeLabel(v: IBoxPlotData | IAdvancedBoxPlotData) {\r\n  if (v == null) {\r\n    return '';\r\n  }\r\n  const f = BoxPlotColumn.DEFAULT_FORMATTER;\r\n  const mean = (<IAdvancedBoxPlotData>v).mean != null ? `mean = ${f((<IAdvancedBoxPlotData>v).mean)}\\n` : '';\r\n  return `min = ${f(v.min)}\\nq1 = ${f(v.q1)}\\nmedian = ${f(v.median)}\\n${mean}q3 = ${f(v.q3)}\\nmax = ${f(v.max)}`;\r\n}\r\n\r\n/** @internal */\r\nexport default class BoxplotCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Box Plot';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return (isBoxPlotColumn(col) && mode === ERenderMode.CELL || (isNumberColumn(col) && mode !== ERenderMode.CELL));\r\n  }\r\n\r\n  create(col: IBoxPlotColumn, context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const sortMethod = <keyof IBoxPlotData>col.getSortMethod();\r\n    const sortedByMe = col.isSortedByMe().asc !== undefined;\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div title=\"\">\r\n                    <div><div></div><div></div></div>\r\n                 </div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        const data = col.getBoxPlotData(d);\r\n        if (!data || col.isMissing(d)) {\r\n          n.classList.add('lu-missing');\r\n          return;\r\n        }\r\n        n.classList.remove('lu-missing');\r\n        const label = col.getRawBoxPlotData(d)!;\r\n        renderDOMBoxPlot(n, data!, label, sortedByMe ? sortMethod : '', colorOf(col, d, imposer));\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n\r\n        // Rectangle\r\n        const data = col.getBoxPlotData(d);\r\n        if (!data) {\r\n          return;\r\n        }\r\n\r\n        const scaled = {\r\n          min: data.min * width,\r\n          median: data.median * width,\r\n          q1: data.q1 * width,\r\n          q3: data.q3 * width,\r\n          max: data.max * width,\r\n          outlier: data.outlier ? data.outlier.map((d) => d * width) : undefined,\r\n          whiskerLow: data.whiskerLow != null ? data.whiskerLow * width : undefined,\r\n          whiskerHigh: data.whiskerHigh != null ? data.whiskerHigh * width : undefined\r\n        };\r\n        renderBoxPlot(ctx, scaled, sortedByMe ? sortMethod : '', colorOf(col, d, imposer), CANVAS_HEIGHT, 0);\r\n      }\r\n    };\r\n  }\r\n\r\n  private static createAggregatedBoxPlot(col: INumbersColumn, rows: IDataRow[], raw = false): IBoxPlotData {\r\n    // concat all values\r\n    const vs = (<number[]>[]).concat(...rows.map((r) => (raw ? col.getRawNumbers(r) : col.getNumber(r))));\r\n    return new LazyBoxPlotData(vs);\r\n  }\r\n\r\n  createGroup(col: INumberColumn, _context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const sort = (col instanceof NumberColumn && col.isGroupSortedByMe().asc !== undefined) ? col.getSortMethod() : '';\r\n    return {\r\n      template: `<div title=\"\">\r\n                    <div><div></div><div></div></div>\r\n                 </div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        if (rows.every((row) => col.isMissing(row))) {\r\n          renderMissingDOM(n, col, rows[0]); // doesn't matter since all\r\n          return;\r\n        }\r\n        n.classList.remove('lu-missing');\r\n\r\n        let box: IBoxPlotData, label: IBoxPlotData;\r\n\r\n        if (isNumbersColumn(col)) {\r\n          box = BoxplotCellRenderer.createAggregatedBoxPlot(col, rows);\r\n          label = BoxplotCellRenderer.createAggregatedBoxPlot(col, rows, true);\r\n        } else {\r\n          box = new LazyBoxPlotData(rows.map((row) => col.getNumber(row)));\r\n          label = new LazyBoxPlotData(rows.map((row) => col.getRawNumber(row)));\r\n        }\r\n        renderDOMBoxPlot(n, box, label, sort, colorOf(col, null, imposer));\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: INumberColumn, _comtext: IRenderContext, _interactive: boolean, imposer?: IImposer) {\r\n    let template = `<div title=\"\">\r\n    <div><div></div><div></div></div>`;\r\n    if (isMapAbleColumn(col)) {\r\n      const range = col.getRange();\r\n      template += `<span>${range[0]}</span><span>${range[1]}</span>`;\r\n    }\r\n    template += '</div>';\r\n\r\n    return {\r\n      template,\r\n      update: (n: HTMLElement, hist: IStatistics | null) => {\r\n        if (hist == null || hist.count === 0) {\r\n          n.classList.add('lu-missing');\r\n          return;\r\n        }\r\n        n.classList.remove('lu-missing');\r\n        const sort = (col instanceof NumberColumn && col.isGroupSortedByMe().asc !== undefined) ? col.getSortMethod() : '';\r\n\r\n        if (isMapAbleColumn(col)) {\r\n          const range = col.getRange();\r\n          Array.from(n.querySelectorAll('span')).forEach((d: HTMLElement, i) => d.textContent = range[i]);\r\n        }\r\n\r\n        renderDOMBoxPlot(n, hist, hist, sort, colorOf(col, null, imposer), isMapAbleColumn(col));\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nfunction renderDOMBoxPlot(n: HTMLElement, data: IBoxPlotData, label: IBoxPlotData, sort: string, color: string | null, hasRange: boolean = false) {\r\n  n.title = computeLabel(label);\r\n\r\n  const whiskers = <HTMLElement>n.firstElementChild;\r\n  const box = <HTMLElement>whiskers.firstElementChild;\r\n  const median = <HTMLElement>whiskers.lastElementChild;\r\n\r\n  const leftWhisker = data.whiskerLow != null ? data.whiskerLow : Math.max(data.q1 - 1.5 * (data.q3 - data.q1), data.min);\r\n  const rightWhisker = data.whiskerHigh != null ? data.whiskerHigh : Math.min(data.q3 + 1.5 * (data.q3 - data.q1), data.max);\r\n  whiskers.style.left = `${round(leftWhisker * 100, 2)}%`;\r\n  const range = rightWhisker - leftWhisker;\r\n  whiskers.style.width = `${round(range * 100, 2)}%`;\r\n\r\n  //relative within the whiskers\r\n  box.style.left = `${round((data.q1 - leftWhisker) / range * 100, 2)}%`;\r\n  box.style.width = `${round((data.q3 - data.q1) / range * 100, 2)}%`;\r\n  box.style.backgroundColor = color;\r\n\r\n  //relative within the whiskers\r\n  median.style.left = `${round((data.median - leftWhisker) / range * 100, 2)}%`;\r\n\r\n  // match lengths\r\n  const outliers = <HTMLElement[]>Array.from(n.children).slice(1, hasRange ? -2 : undefined);\r\n  const numOutliers = data.outlier ? data.outlier.length : 0;\r\n  outliers.splice(numOutliers, outliers.length - numOutliers).forEach((v) => v.remove());\r\n\r\n  whiskers.dataset.sort = sort;\r\n\r\n  if (!data.outlier || numOutliers === 0) {\r\n    return;\r\n  }\r\n\r\n  for (let i = outliers.length; i < numOutliers; ++i) {\r\n    console.assert(n.ownerDocument != null);\r\n    const p = n.ownerDocument!.createElement('div');\r\n    outliers.unshift(p);\r\n    whiskers.insertAdjacentElement('afterend', p);\r\n  }\r\n\r\n  data.outlier.forEach((v, i) => {\r\n    delete outliers[i].dataset.sort;\r\n    outliers[i].style.left = `${round(v * 100, 2)}%`;\r\n  });\r\n\r\n  if (sort === 'min' && data.outlier[0] <= leftWhisker) {\r\n    // first outliers is the min\r\n    whiskers.dataset.sort = '';\r\n    outliers[0].dataset.sort = 'min';\r\n    if (outliers.length > 1) {\r\n      // append at the end of the DOM to be on top\r\n      outliers[outliers.length - 1].insertAdjacentElement('afterend', outliers[0]);\r\n    }\r\n  } else if (sort === 'max' && data.outlier[outliers.length - 1] >= rightWhisker) {\r\n    // last outlier is the max\r\n    whiskers.dataset.sort = '';\r\n    outliers[outliers.length - 1].dataset.sort = 'max';\r\n  }\r\n}\r\n\r\nfunction renderBoxPlot(ctx: CanvasRenderingContext2D, box: IBoxPlotData, sort: string, color: string | null, height: number, topPadding: number) {\r\n  const left = box.whiskerLow != null ? box.whiskerLow : Math.max((box.q1 - 1.5 * (box.q3 - box.q1)), box.min);\r\n  const right = box.whiskerHigh != null ? box.whiskerHigh : Math.min((box.q3 + 1.5 * (box.q3 - box.q1)), box.max);\r\n\r\n  ctx.fillStyle = color || BOX_PLOT.box;\r\n  ctx.strokeStyle = BOX_PLOT.stroke;\r\n  ctx.beginPath();\r\n  ctx.rect(box.q1, 0, box.q3 - box.q1, height);\r\n  ctx.fill();\r\n  ctx.stroke();\r\n\r\n  //Line\r\n  const bottomPos = height - topPadding;\r\n  const middlePos = height / 2;\r\n\r\n  ctx.beginPath();\r\n  ctx.moveTo(left, middlePos);\r\n  ctx.lineTo(box.q1, middlePos);\r\n  ctx.moveTo(left, topPadding);\r\n  ctx.lineTo(left, bottomPos);\r\n  ctx.moveTo(box.median, 0);\r\n  ctx.lineTo(box.median, height);\r\n  ctx.moveTo(box.q3, middlePos);\r\n  ctx.lineTo(right, middlePos);\r\n  ctx.moveTo(right, topPadding);\r\n  ctx.lineTo(right, bottomPos);\r\n  ctx.stroke();\r\n  ctx.fill();\r\n\r\n  if (sort !== '') {\r\n    ctx.strokeStyle = BOX_PLOT.sort;\r\n    ctx.beginPath();\r\n    ctx.moveTo(<number>box[<keyof IBoxPlotData>sort], topPadding);\r\n    ctx.lineTo(<number>box[<keyof IBoxPlotData>sort], height - topPadding);\r\n    ctx.stroke();\r\n    ctx.fill();\r\n  }\r\n\r\n  if (!box.outlier) {\r\n    return;\r\n  }\r\n  ctx.fillStyle = BOX_PLOT.outlier;\r\n  box.outlier.forEach((v) => {\r\n    // currently dots with 3px\r\n    ctx.fillRect(Math.max(v - DOT.size / 2, 0), middlePos - DOT.size / 2, DOT.size, DOT.size);\r\n  });\r\n}\r\n","import {hsl} from 'd3-color';\r\nimport {ICategoricalStatistics, IStatistics} from '../internal/math';\r\nimport {IDataRow, INumberColumn, isNumberColumn, isMapAbleColumn} from '../model';\r\nimport Column from '../model/Column';\r\nimport {isNumbersColumn} from '../model/INumberColumn';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {colorOf} from './impose';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {noRenderer, setText} from './utils';\r\n\r\n/** @internal */\r\nexport function toHeatMapColor(v: number | null, row: IDataRow, col: INumberColumn, imposer?: IImposer) {\r\n  if (v == null || isNaN(v)) {\r\n    v = 1; // max = brightest\r\n  }\r\n  if (imposer || !isMapAbleColumn(col)) {\r\n    //hsl space encoding, encode in lightness\r\n    const color = hsl(colorOf(col, row, imposer, v) || Column.DEFAULT_COLOR);\r\n    color.l = 1 - v; // largest value = darkest color\r\n    return color.toString();\r\n  }\r\n  const map = col.getColorMapping();\r\n  const valueColor = map.apply(v);\r\n  if (map.type === 'solid') {\r\n    //hsl space encoding, encode in lightness\r\n    const color = hsl(valueColor);\r\n    color.l = 1 - v; // largest value = darkest color\r\n    return color.toString();\r\n  }\r\n  // some custom logic that maps to another value\r\n  return valueColor;\r\n}\r\n\r\n/** @internal */\r\nexport default class BrightnessCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Brightness';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isNumberColumn(col) && mode === ERenderMode.CELL && !isNumbersColumn(col);\r\n  }\r\n\r\n  create(col: INumberColumn, context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div title=\"\">\r\n        <div style=\"background-color: ${Column.DEFAULT_COLOR}\"></div><div> </div>\r\n      </div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        const missing = renderMissingDOM(n, col, d);\r\n        n.title = col.getLabel(d);\r\n        (<HTMLDivElement>n.firstElementChild!).style.backgroundColor = missing ? null : toHeatMapColor(col.getNumber(d), d, col, imposer);\r\n        setText(<HTMLSpanElement>n.lastElementChild!, n.title);\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        ctx.fillStyle = toHeatMapColor(col.getNumber(d), d, col, imposer);\r\n        ctx.fillRect(0, 0, width, CANVAS_HEIGHT);\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return noRenderer;\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {DENSE_HISTOGRAM} from '../config';\r\nimport {computeHist, ICategoricalBin, ICategoricalStatistics} from '../internal/math';\r\nimport {ICategoricalColumn, IDataRow, IGroup, isCategoricalColumn} from '../model';\r\nimport CategoricalColumn from '../model/CategoricalColumn';\r\nimport Column from '../model/Column';\r\nimport {isCategoryIncluded} from '../model/ICategoricalColumn';\r\nimport OrdinalColumn from '../model/OrdinalColumn';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {filterMissingNumberMarkup, updateFilterMissingNumberMarkup} from '../ui/missing';\r\nimport {default as IRenderContext, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {setText, wideEnough, forEach} from './utils';\r\n\r\n/** @internal */\r\nexport default class CategoricalCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Color';\r\n  readonly groupTitle = 'Histogram';\r\n\r\n  canRender(col: Column) {\r\n    return isCategoricalColumn(col);\r\n  }\r\n\r\n  create(col: ICategoricalColumn, context: IRenderContext) {\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div>\r\n        <div></div><div></div>\r\n      </div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        renderMissingDOM(n, col, d);\r\n        const v = col.getCategory(d);\r\n        (<HTMLDivElement>n.firstElementChild!).style.backgroundColor = v ? v.color : null;\r\n        setText(<HTMLSpanElement>n.lastElementChild!, col.getLabel(d));\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        const v = col.getCategory(d);\r\n        ctx.fillStyle = v ? v.color : '';\r\n        ctx.fillRect(0, 0, width, CANVAS_HEIGHT);\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: ICategoricalColumn, _context: IRenderContext, globalHist: ICategoricalStatistics | null) {\r\n    const {template, update} = hist(col, false);\r\n    return {\r\n      template: `${template}</div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const {maxBin, hist} = computeHist(rows, (r: IDataRow) => col.getCategory(r), col.categories);\r\n\r\n        const max = Math.max(maxBin, globalHist ? globalHist.maxBin : 0);\r\n        update(n, max, hist);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: ICategoricalColumn, ctx: IRenderContext, interactive: boolean) {\r\n    return (col instanceof CategoricalColumn || col instanceof OrdinalColumn) ? interactiveSummary(col, interactive, ctx.idPrefix) : staticSummary(col, interactive);\r\n  }\r\n}\r\n\r\nfunction staticSummary(col: ICategoricalColumn, interactive: boolean) {\r\n  const {template, update} = hist(col, interactive);\r\n  return {\r\n    template: `${template}</div>`,\r\n    update: (n: HTMLElement, hist: ICategoricalStatistics | null) => {\r\n      n.classList.toggle('lu-missing', !hist);\r\n      if (!hist) {\r\n        return;\r\n      }\r\n      update(n, hist.maxBin, hist.hist);\r\n    }\r\n  };\r\n}\r\n\r\nfunction interactiveSummary(col: CategoricalColumn | OrdinalColumn, interactive: boolean, idPrefix: string) {\r\n  const {template, update} = hist(col, interactive || wideEnough(col));\r\n  let filterUpdate: (missing: number, col: CategoricalColumn | OrdinalColumn) => void;\r\n  return {\r\n    template: `${template}${interactive ? filterMissingNumberMarkup(false, 0, idPrefix) : ''}</div>`,\r\n    update: (n: HTMLElement, hist: ICategoricalStatistics | null) => {\r\n      if (!filterUpdate) {\r\n        filterUpdate = interactiveHist(col, n);\r\n      }\r\n      filterUpdate(hist ? hist.missing : 0, col);\r\n\r\n      n.classList.toggle('lu-missing', !hist);\r\n      if (!hist) {\r\n        return;\r\n      }\r\n      update(n, hist.maxBin, hist.hist);\r\n    }\r\n  };\r\n}\r\n\r\nfunction hist(col: ICategoricalColumn, showLabels: boolean) {\r\n  const bins = col.categories.map((c) => `<div title=\"${c.label}: 0\" data-cat=\"${c.name}\" ${showLabels ? `data-title=\"${c.label}\"` : ''}><div style=\"height: 0; background-color: ${c.color}\"></div></div>`).join('');\r\n\r\n  return {\r\n    template: `<div${col.dataLength! > DENSE_HISTOGRAM ? 'class=\"lu-dense\"' : ''}>${bins}`, // no closing div to be able to append things\r\n    update: (n: HTMLElement, maxBin: number, hist: ICategoricalBin[]) => {\r\n      forEach(n, '[data-cat]', (d: HTMLElement, i) => {\r\n        const {y} = hist[i];\r\n        d.title = `${col.categories[i].label}: ${y}`;\r\n        const inner = <HTMLElement>d.firstElementChild!;\r\n        inner.style.height = `${Math.round(y * 100 / maxBin)}%`;\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\nexport function interactiveHist(col: CategoricalColumn | OrdinalColumn, node: HTMLElement) {\r\n  const bins = <HTMLElement[]>Array.from(node.querySelectorAll('[data-cat]'));\r\n\r\n  bins.forEach((bin, i) => {\r\n    const cat = col.categories[i];\r\n\r\n    bin.onclick = (evt) => {\r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n\r\n      // toggle filter\r\n      const old = col.getFilter();\r\n      if (old == null || !Array.isArray(old.filter)) {\r\n        // deselect\r\n        const without = col.categories.slice();\r\n        bin.dataset.filtered = 'filtered';\r\n        without.splice(i, 1);\r\n        col.setFilter({\r\n          filterMissing: old ? old.filterMissing : false,\r\n          filter: without.map((d) => d.name)\r\n        });\r\n        return;\r\n      }\r\n      const filter = old.filter.slice();\r\n      const contained = filter.indexOf(cat.name);\r\n      if (contained >= 0) {\r\n        // remove\r\n        bin.dataset.filtered = 'filtered';\r\n        filter.splice(contained, 1);\r\n      } else {\r\n        // readd\r\n        delete bin.dataset.filtered;\r\n        filter.push(cat.name);\r\n      }\r\n      col.setFilter({\r\n        filterMissing: old.filterMissing,\r\n        filter\r\n      });\r\n    };\r\n  });\r\n\r\n\r\n  const filterMissing = <HTMLInputElement>node.querySelector('input')!;\r\n\r\n  if (filterMissing) {\r\n    filterMissing.onchange = () => {\r\n      // toggle filter\r\n      const v = filterMissing.checked;\r\n      const old = col.getFilter();\r\n      if (old == null) {\r\n        col.setFilter(v ? {filterMissing: v, filter: col.categories.map((d) => d.name)} : null);\r\n      } else {\r\n        col.setFilter({filterMissing: v, filter: old.filter});\r\n      }\r\n    };\r\n  }\r\n\r\n\r\n  return (missing: number, actCol: CategoricalColumn | OrdinalColumn) => {\r\n    col = actCol;\r\n    const cats = col.categories;\r\n    const f = col.getFilter();\r\n    bins.forEach((bin, i) => {\r\n      if (!isCategoryIncluded(f, cats[i])) {\r\n        bin.dataset.filtered = 'filtered';\r\n      } else {\r\n        delete bin.dataset.filtered;\r\n      }\r\n    });\r\n    if (filterMissing) {\r\n      filterMissing.checked = f != null && f.filterMissing;\r\n      updateFilterMissingNumberMarkup(<HTMLElement>filterMissing.parentElement, missing);\r\n    }\r\n  };\r\n}\r\n","import {ICategory, IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ISetColumn, isSetColumn} from '../model/ICategoricalColumn';\r\nimport {CANVAS_HEIGHT, UPSET} from '../styles';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport default class UpSetCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Matrix';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isSetColumn(col) && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  private static calculateSetPath(setData: boolean[], cellDimension: number) {\r\n    const catindexes: number[] = [];\r\n    setData.forEach((d: boolean, i: number) => (d) ? catindexes.push(i) : -1);\r\n\r\n    const left = (catindexes[0] * cellDimension) + (cellDimension / 2);\r\n    const right = (catindexes[catindexes.length - 1] * cellDimension) + (cellDimension / 2);\r\n\r\n    return {left, right};\r\n  }\r\n\r\n  private static createDOMContext(col: ISetColumn) {\r\n    const categories = col.categories;\r\n    let templateRows = '';\r\n    for (const cat of categories) {\r\n      templateRows += `<div title=\"${cat.label}\"></div>`;\r\n    }\r\n    return {\r\n      templateRow: templateRows,\r\n      render: (n: HTMLElement, value: boolean[]) => {\r\n        Array.from(n.children).slice(1).forEach((d, i) => {\r\n          const v = value[i];\r\n          d.classList.toggle('enabled', v);\r\n        });\r\n\r\n        const line = <HTMLElement>n.firstElementChild;\r\n        const left = value.findIndex((d) => d);\r\n        const right = (value.length - 1) - value.reverse().findIndex((d) => d);\r\n\r\n        if (left < 0 || left === right) {\r\n          line.style.display = 'none';\r\n          return;\r\n        }\r\n        line.style.display = null;\r\n        line.style.left = `${Math.round(100 * (left + 0.5) / value.length)}%`;\r\n        line.style.width = `${Math.round(100 * (right - left) / value.length)}%`;\r\n      }\r\n    };\r\n  }\r\n\r\n  create(col: ISetColumn, context: IRenderContext) {\r\n    const {templateRow, render} = UpSetCellRenderer.createDOMContext(col);\r\n    const width = context.colWidth(col);\r\n    const cellDimension = width / col.dataLength!;\r\n\r\n    return {\r\n      template: `<div><div></div>${templateRow}</div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        render(n, col.getValues(d));\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        // Circle\r\n        const data = col.getValues(d);\r\n\r\n        const hasTrueValues = data.some((d) => d); //some values are true?\r\n\r\n        ctx.save();\r\n        ctx.fillStyle = UPSET.circle;\r\n        ctx.strokeStyle = UPSET.stroke;\r\n        if (hasTrueValues) {\r\n          const {left, right} = UpSetCellRenderer.calculateSetPath(data, cellDimension);\r\n          ctx.beginPath();\r\n          ctx.moveTo(left, CANVAS_HEIGHT / 2);\r\n          ctx.lineTo(right, CANVAS_HEIGHT / 2);\r\n          ctx.stroke();\r\n        }\r\n\r\n        data.forEach((d, j) => {\r\n          const posx = (j * cellDimension);\r\n          ctx.beginPath();\r\n          ctx.globalAlpha = d ? 1 : UPSET.inactive;\r\n          ctx.fillRect(posx, 0, cellDimension, CANVAS_HEIGHT);\r\n          ctx.fill();\r\n        });\r\n\r\n        ctx.restore();\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: ISetColumn) {\r\n    const {templateRow, render} = UpSetCellRenderer.createDOMContext(col);\r\n    return {\r\n      template: `<div><div></div>${templateRow}</div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const value = union(col, rows);\r\n        render(n, value);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n\r\n\r\nexport function union(col: ISetColumn, rows: IDataRow[]) {\r\n  const values = new Set<ICategory>();\r\n  rows.forEach((d) => {\r\n    col.getSet(d).forEach((c) => values.add(c));\r\n  });\r\n  return col.categories.map((cat) => values.has(cat));\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ISetColumn, isSetColumn} from '../model/ICategoricalColumn';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {default as IRenderContext, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {union} from './UpSetCellRenderer';\r\nimport {noop, wideEnough, forEachChild} from './utils';\r\n\r\n/** @internal */\r\nexport default class CategoricalHeatmapCellRenderer implements ICellRendererFactory {\r\n  title = 'Heatmap';\r\n\r\n  canRender(col: Column) {\r\n    return isSetColumn(col);\r\n  }\r\n\r\n  private static createDOMContext(col: ISetColumn) {\r\n    const categories = col.categories;\r\n    let templateRows = '';\r\n    for (const cat of categories) {\r\n      templateRows += `<div title=\"${cat.label}\" style=\"background-color: ${cat.color}\"></div>`;\r\n    }\r\n    return {\r\n      templateRow: templateRows,\r\n      render: (n: HTMLElement, value: boolean[]) => {\r\n        forEachChild(n, (d: HTMLElement, i) => {\r\n          const v = value[i];\r\n          d.style.visibility = v ? null : 'hidden';\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  create(col: ISetColumn, context: IRenderContext) {\r\n    const {templateRow, render} = CategoricalHeatmapCellRenderer.createDOMContext(col);\r\n    const width = context.colWidth(col);\r\n    const cellDimension = width / col.dataLength!;\r\n    const cats = col.categories;\r\n\r\n    return {\r\n      template: `<div>${templateRow}</div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        render(n, col.getValues(d));\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        // Circle\r\n        const data = col.getValues(d);\r\n\r\n        ctx.save();\r\n        cats.forEach((d, j) => {\r\n          if (!data[j]) {\r\n            return;\r\n          }\r\n          const posx = (j * cellDimension);\r\n          ctx.fillStyle = d.color;\r\n          ctx.fillRect(posx, 0, cellDimension, CANVAS_HEIGHT);\r\n        });\r\n\r\n        ctx.restore();\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: ISetColumn) {\r\n    const {templateRow, render} = CategoricalHeatmapCellRenderer.createDOMContext(col);\r\n    return {\r\n      template: `<div>${templateRow}</div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const value = union(col, rows);\r\n        render(n, value);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: ISetColumn) {\r\n    const categories = col.categories;\r\n    let templateRows = '<div>';\r\n    const labels = wideEnough(col);\r\n    for (const cat of categories) {\r\n      templateRows += `<div title=\"${cat.label}\"${labels ? ` data-title=\"${cat.label}\"` : ''} style=\"background-color: ${cat.color}\"></div>`;\r\n    }\r\n    templateRows += '</div>';\r\n    return {\r\n      template: templateRows,\r\n      update: noop\r\n    };\r\n  }\r\n}\r\n","import {computeHist, ICategoricalBin, ICategoricalStatistics} from '../internal/math';\r\nimport {ICategoricalColumn, IDataRow, IGroup, isCategoricalColumn} from '../model';\r\nimport CategoricalColumn from '../model/CategoricalColumn';\r\nimport Column from '../model/Column';\r\nimport OrdinalColumn from '../model/OrdinalColumn';\r\nimport {filterMissingNumberMarkup} from '../ui/missing';\r\nimport {interactiveHist} from './CategoricalCellRenderer';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {forEachChild, noRenderer, adaptTextColorToBgColor} from './utils';\r\n\r\n/** @internal */\r\nexport default class CategoricalStackedDistributionlCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Distribution Bar';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isCategoricalColumn(col) && mode !== ERenderMode.CELL;\r\n  }\r\n\r\n  create() {\r\n    return noRenderer;\r\n  }\r\n\r\n\r\n  createGroup(col: ICategoricalColumn) {\r\n    const { template, update } = stackedBar(col);\r\n    return {\r\n      template: `${template}</div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const { hist, missing } = computeHist(rows, (r: IDataRow) => col.getCategory(r), col.categories);\r\n        update(n, hist, missing);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: ICategoricalColumn, ctx: IRenderContext, interactive: boolean) {\r\n    return (col instanceof CategoricalColumn || col instanceof OrdinalColumn) ? interactiveSummary(col, interactive, ctx.idPrefix) : staticSummary(col);\r\n  }\r\n}\r\n\r\nfunction staticSummary(col: ICategoricalColumn) {\r\n  const { template, update } = stackedBar(col);\r\n  return {\r\n    template: `${template}</div>`,\r\n    update: (n: HTMLElement, hist: ICategoricalStatistics | null) => {\r\n      n.classList.toggle('lu-missing', !hist);\r\n      if (!hist) {\r\n        return;\r\n      }\r\n      update(n, hist.hist, hist.missing);\r\n    }\r\n  };\r\n}\r\n\r\nfunction interactiveSummary(col: CategoricalColumn | OrdinalColumn, interactive: boolean, idPrefix: string) {\r\n  const { template, update } = stackedBar(col);\r\n  let filterUpdate: (missing: number, col: CategoricalColumn | OrdinalColumn) => void;\r\n  return {\r\n    template: `${template}${interactive ? filterMissingNumberMarkup(false, 0, idPrefix) : ''}</div>`,\r\n    update: (n: HTMLElement, hist: ICategoricalStatistics | null) => {\r\n      if (!filterUpdate) {\r\n        filterUpdate = interactiveHist(col, n);\r\n      }\r\n      filterUpdate(hist ? hist.missing : 0, col);\r\n\r\n      n.classList.toggle('lu-missing', !hist);\r\n      if (!hist) {\r\n        return;\r\n      }\r\n      update(n, hist.hist, hist.missing);\r\n    }\r\n  };\r\n}\r\n\r\nfunction stackedBar(col: ICategoricalColumn) {\r\n  const cats = col.categories;\r\n  const bins = cats.map((c) => `<div style=\"background-color: ${c.color}; color: ${adaptTextColorToBgColor(c.color)}\" title=\"${c.label}: 0\" data-cat=\"${c.name}\"><span>${c.label}</span></div>`).join('');\r\n\r\n  return {\r\n    template: `<div>${bins}<div title=\"Missing Values\"></div>`, // no closing div to be able to append things\r\n    update: (n: HTMLElement, hist: ICategoricalBin[], missing: number) => {\r\n      const total = hist.reduce((acc, { y }) => acc + y, missing);\r\n      forEachChild(n, (d: HTMLElement, i) => {\r\n        let y: number;\r\n        let label: string;\r\n        if (i >= hist.length) {\r\n          y = missing;\r\n          label = 'Missing Values';\r\n        } else {\r\n          y = hist[i].y;\r\n          label = cats[i].label;\r\n        }\r\n        d.style.flexGrow = `${Math.round(total === 0 ? 0 : y)}`;\r\n        d.title = `${label}: ${y}`;\r\n      });\r\n    }\r\n  };\r\n}\r\n","import {ICategoricalStatistics, IStatistics} from '../internal/math';\r\nimport {IDataRow, INumberColumn, isNumberColumn} from '../model';\r\nimport Column from '../model/Column';\r\nimport {isNumbersColumn} from '../model/INumberColumn';\r\nimport {colorOf} from './impose';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {attr, noop, noRenderer, setText} from './utils';\r\n\r\n/** @internal */\r\nexport default class CircleCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Proportional Symbol';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isNumberColumn(col) && mode === ERenderMode.CELL && !isNumbersColumn(col);\r\n  }\r\n\r\n  create(col: INumberColumn, _context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    return {\r\n      template: `<div style=\"background: radial-gradient(circle closest-side, red 100%, transparent 100%)\" title=\"\">\r\n              <div class=\"lu-hover-only\"></div>\r\n          </div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        const v = col.getNumber(d);\r\n        const p = Math.round(v * 100);\r\n        const missing = renderMissingDOM(n, col, d);\r\n        attr(<HTMLElement>n, {}, {\r\n          background: missing ? null : `radial-gradient(circle closest-side, ${colorOf(col, d, imposer)} ${p}%, transparent ${p}%)`\r\n        },);\r\n        setText(n.firstElementChild!, col.getLabel(d));\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return noRenderer;\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {ICategoricalStatistics, IStatistics} from '../internal';\r\nimport {INumberColumn, IDataRow, IGroup, isMissingValue, isNumberColumn} from '../model';\r\n/**\r\n * a renderer rendering a bar for numerical columns\r\n */\r\nimport Column from '../model/Column';\r\nimport {DEFAULT_FORMATTER, isNumbersColumn} from '../model/INumberColumn';\r\nimport {CANVAS_HEIGHT, DOT} from '../styles';\r\nimport {colorOf} from './impose';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {attr, forEachChild, noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport default class DotCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Dot';\r\n  readonly groupTitle = 'Dots';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isNumberColumn(col) && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  private static getDOMRenderer(col: INumberColumn) {\r\n    const dots = isNumbersColumn(col) ? col.dataLength! : 1;\r\n    let tmp = '';\r\n    for (let i = 0; i < dots; ++i) {\r\n      tmp += `<div style='background-color: ${Column.DEFAULT_COLOR}' title=''></div>`;\r\n    }\r\n\r\n    const update = (n: HTMLElement, vs: number[], labels: string[], colors: (string | null)[]) => {\r\n      //adapt the number of children\r\n      if (n.children.length !== vs.length) {\r\n        let tmp = '';\r\n        for (let i = 0; i < vs.length; ++i) {\r\n          tmp += `<div style='background-color: ${colors[i]}' title='${labels[i]}'></div>`;\r\n        }\r\n        n.innerHTML = tmp;\r\n      }\r\n      forEachChild(n, (d: HTMLElement, i) => {\r\n        const v = vs[i];\r\n        attr(<HTMLElement>d, {\r\n          title: labels[i]\r\n        }, {\r\n          display: isMissingValue(v) ? 'none' : null,\r\n          left: `${Math.round(v * 100)}%`,\r\n          // jitter\r\n          top: vs.length > 1 ? `${Math.round(Math.random() * 80 + 10)}%` : null,\r\n          'background-color': colors[i]\r\n        });\r\n      });\r\n    };\r\n\r\n    const render = (ctx: CanvasRenderingContext2D, vs: number[], colors: (string | null)[], width: number) => {\r\n      ctx.save();\r\n      ctx.globalAlpha = DOT.opacity;\r\n      vs.forEach((v, i) => {\r\n        ctx.fillStyle = colors[i] || DOT.color;\r\n        ctx.fillRect(Math.max(0, v * width - DOT.size / 2), 0, DOT.size, CANVAS_HEIGHT);\r\n      });\r\n      ctx.restore();\r\n    };\r\n\r\n    return {template: `<div>${tmp}</div>`, update, render};\r\n  }\r\n\r\n  create(col: INumberColumn, context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const {template, render, update} = DotCellRenderer.getDOMRenderer(col);\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        const color = colorOf(col, d, imposer);\r\n        const v = col.getValue(d);\r\n        if (!isNumbersColumn(col)) {\r\n          return update(n, [v], [col.getLabel(d)], [color]);\r\n        }\r\n        const vs: number[] = v.filter((vi: number) => !isMissingValue(vi));\r\n        return update(n, vs, vs.map(DEFAULT_FORMATTER), vs.map((_: any) => color));\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        const color = colorOf(col, d, imposer);\r\n        const v = col.getValue(d);\r\n        if (!isNumbersColumn(col)) {\r\n          return render(ctx, [v], [color], width);\r\n        }\r\n        const vs: number[] = v.filter((vi: number) => !isMissingValue(vi));\r\n        return render(ctx, vs, vs.map((_: any) => color), width);\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: INumberColumn, _context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const {template, update} = DotCellRenderer.getDOMRenderer(col);\r\n    return {\r\n      template,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const vs = rows.map((r) => col.getValue(r));\r\n        const colors = rows.map((r) => colorOf(col, r, imposer));\r\n\r\n        if (!isNumbersColumn(col)) {\r\n          return update(n, vs, rows.map((r) => col.getLabel(r)), colors);\r\n        }\r\n        // concatenate all columns\r\n        const all = (<number[]>[]).concat(...vs.filter((vi: number) => !isMissingValue(vi)));\r\n        return update(n, all, all.map(DEFAULT_FORMATTER), vs.map((_v: number[], i) => colors[i]));\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport GroupColumn from '../model/GroupColumn';\r\nimport {ICellRendererFactory} from './interfaces';\r\nimport {noop, noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport default class GroupCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof GroupColumn;\r\n  }\r\n\r\n  create() {\r\n    return {\r\n      template: `<div><div></div></div>`,\r\n      update(node: HTMLElement, _row: IDataRow, i: number, group: IGroup) {\r\n        const p = (<HTMLElement>node.firstElementChild!);\r\n        if (i !== 0) {\r\n          p.innerText = '';\r\n        } else if (Array.isArray((<any>group).order)) {\r\n          p.innerText = `${group.name} (${(<any>group).order.length})`;\r\n        } else {\r\n          p.innerText = group.name;\r\n        }\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return {\r\n      template: `<div><div></div></div>`,\r\n      update(node: HTMLElement, group: IGroup, rows: IDataRow[]) {\r\n        (<HTMLElement>node.firstElementChild!).innerText = `${group.name} (${rows.length})`;\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {LazyBoxPlotData} from '../internal';\r\nimport {IDataRow, IGroup, isMissingValue} from '../model';\r\nimport {INumbersColumn} from '../model/INumberColumn';\r\nimport {default as IRenderContext, IImposer} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\n\r\n/** @internal */\r\nexport abstract class ANumbersCellRenderer {\r\n  abstract readonly title: string;\r\n\r\n  protected abstract createContext(col: INumbersColumn, context: IRenderContext, imposer?: IImposer): {\r\n    templateRow: string,\r\n    update: (row: HTMLElement, data: number[], raw: number[], d: IDataRow) => void,\r\n    render: (ctx: CanvasRenderingContext2D, data: number[], d: IDataRow) => void,\r\n  };\r\n\r\n  static choose(col: INumbersColumn, rows: IDataRow[]) {\r\n    const data = rows.map((r) => ({n: col.getNumbers(r), raw: col.getRawNumbers(r)}));\r\n    const cols = col.dataLength!;\r\n    const normalized = <number[]>[];\r\n    const raw = <number[]>[];\r\n    // mean column)\r\n    for (let i = 0; i < cols; ++i) {\r\n      const vs = data.map((d) => ({n: d.n[i], raw: d.raw[i]})).filter((d) => !isMissingValue(d.n));\r\n      if (vs.length === 0) {\r\n        normalized.push(NaN);\r\n        raw.push(NaN);\r\n      } else {\r\n        const box = <any>new LazyBoxPlotData(vs.map((d) => d.n));\r\n        const boxRaw = <any>new LazyBoxPlotData(vs.map((d) => d.raw));\r\n        normalized.push(box[col.getSortMethod()]);\r\n        raw.push(boxRaw[col.getSortMethod()]);\r\n      }\r\n    }\r\n    return {normalized, raw};\r\n  }\r\n\r\n  create(col: INumbersColumn, context: IRenderContext, _hist: any, imposer?: IImposer) {\r\n    const width = context.colWidth(col);\r\n    const {templateRow, render, update} = this.createContext(col, context, imposer);\r\n    return {\r\n      template: `<div>${templateRow}</div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        update(n, col.getNumbers(d), col.getRawNumbers(d), d);\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        render(ctx, col.getNumbers(d), d);\r\n      },\r\n    };\r\n  }\r\n\r\n  createGroup(col: INumbersColumn, context: IRenderContext, _hist: any, imposer?: IImposer) {\r\n    const {templateRow, update} = this.createContext(col, context, imposer);\r\n    return {\r\n      template: `<div>${templateRow}</div>`,\r\n      update: (n: HTMLDivElement, _group: IGroup, rows: IDataRow[]) => {\r\n        // render a heatmap\r\n        const {normalized, raw} = ANumbersCellRenderer.choose(col, rows);\r\n        update(n, normalized, raw, rows[0]);\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n\r\nexport function matchRows(n: HTMLElement | SVGElement, rows: IDataRow[], template: string) {\r\n  // first match the number of rows\r\n  const children = <(HTMLElement | SVGElement)[]>Array.from(n.children);\r\n  if (children.length > rows.length) {\r\n    children.slice(rows.length).forEach((c) => c.remove());\r\n  } else if (rows.length > children.length) {\r\n    n.insertAdjacentHTML('beforeend', template.repeat(rows.length - children.length));\r\n  }\r\n}\r\n","import {IDataRow, isMissingValue} from '../model';\r\nimport Column from '../model/Column';\r\nimport {DEFAULT_FORMATTER, INumbersColumn, isNumbersColumn} from '../model/INumberColumn';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {ANumbersCellRenderer} from './ANumbersCellRenderer';\r\nimport {toHeatMapColor} from './BrightnessCellRenderer';\r\nimport IRenderContext, {ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingValue, renderMissingDOM} from './missing';\r\nimport {noop, wideEnough} from './utils';\r\nimport {IGroup} from '../model/interfaces';\r\n\r\nconst GUESSED_HEIGHT = 20;\r\n\r\n/** @internal */\r\nexport default class HeatmapCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Heatmap';\r\n\r\n  canRender(col: Column) {\r\n    return isNumbersColumn(col) && Boolean(col.dataLength);\r\n  }\r\n\r\n  private createContext(col: INumbersColumn, context: IRenderContext, _hist: any, imposer?: IImposer) {\r\n    const width = context.colWidth(col);\r\n    const cellDimension = width / col.dataLength!;\r\n    const labels = col.labels;\r\n    const render = (ctx: CanvasRenderingContext2D, data: number[], item: IDataRow, height: number) => {\r\n      data.forEach((d: number, j: number) => {\r\n        const x = j * cellDimension;\r\n        if (isMissingValue(d)) {\r\n          renderMissingValue(ctx, cellDimension, height, x, 0);\r\n          return;\r\n        }\r\n        ctx.fillStyle = toHeatMapColor(d, item, col, imposer);\r\n        ctx.fillRect(x, 0, cellDimension, height);\r\n      });\r\n    };\r\n    return {\r\n      template: `<canvas height=\"${GUESSED_HEIGHT}\" title=\"\"></canvas>`,\r\n      render,\r\n      width,\r\n      mover: (n: HTMLElement, values: string[]) => (evt: MouseEvent) => {\r\n        const percent = evt.offsetX / width;\r\n        const index = Math.max(0, Math.min(col.dataLength! - 1, Math.floor(percent * (col.dataLength! - 1) + 0.5)));\r\n        n.title = `${labels[index]}: ${values[index]}`;\r\n      }\r\n    };\r\n  }\r\n\r\n  create(col: INumbersColumn, context: IRenderContext, _hist: any, imposer?: IImposer) {\r\n    const {template, render, mover, width} = this.createContext(col, context, _hist, imposer);\r\n    return {\r\n      template,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        const ctx = (<HTMLCanvasElement>n).getContext('2d')!;\r\n        ctx.canvas.width = width;\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        n.onmousemove = mover(n, col.getRawNumbers(d).map(DEFAULT_FORMATTER));\r\n        n.onmouseleave = () => n.title = '';\r\n        render(ctx, col.getNumbers(d), d, GUESSED_HEIGHT);\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow) => {\r\n        render(ctx, col.getNumbers(d), d, CANVAS_HEIGHT);\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: INumbersColumn, context: IRenderContext, _hist: any, imposer?: IImposer) {\r\n    const {template, render, mover, width} = this.createContext(col, context, _hist, imposer);\r\n    return {\r\n      template,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        // render a heatmap\r\n        const {normalized, raw} = ANumbersCellRenderer.choose(col, rows);\r\n        const ctx = (<HTMLCanvasElement>n).getContext('2d')!;\r\n        ctx.canvas.width = width;\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n        n.onmousemove = mover(n, raw.map(DEFAULT_FORMATTER));\r\n        n.onmouseleave = () => n.title = '';\r\n        render(ctx, normalized, rows[0], GUESSED_HEIGHT);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: INumbersColumn) {\r\n    let labels = col.labels.slice();\r\n    while (labels.length > 0 && !wideEnough(col, labels.length)) {\r\n      labels = labels.filter((_, i) => i % 2 === 0); // even\r\n    }\r\n    let templateRows = '<div>';\r\n    for (const label of labels) {\r\n      templateRows += `<div title=\"${label}\" data-title=\"${label}\"></div>`;\r\n    }\r\n    templateRows += '</div>';\r\n    return {\r\n      template: templateRows,\r\n      update: noop\r\n    };\r\n  }\r\n}\r\n","import ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport interface IInputNumberOptions {\r\n  min: number;\r\n  max: number;\r\n  step: number | 'any';\r\n  value: number;\r\n  label: string | null;\r\n}\r\n\r\n/** @internal */\r\nexport default class InputNumberDialog extends ADialog {\r\n\r\n  private readonly ioptions: Readonly<IInputNumberOptions> = {\r\n    min: NaN,\r\n    max: NaN,\r\n    step: 'any',\r\n    value: NaN,\r\n    label: null\r\n  };\r\n\r\n  constructor(dialog: IDialogContext, private readonly callback: (value: number) => void, options: Partial<IInputNumberOptions> = {}) {\r\n    super(dialog);\r\n    Object.assign(this.ioptions, options);\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    const o = this.ioptions;\r\n    node.insertAdjacentHTML('beforeend', `\r\n     <input type=\"number\" value=\"${isNaN(o.value) ? '' : String(o.value)}\" required autofocus placeholder=\"${o.label ? o.label : 'enter number'}\" ${isNaN(o.min) ? '' : ` min=\"${o.min}\"`} ${isNaN(o.max) ? '' : ` max=\"${o.max}\"`} step=\"${o.step}\">\r\n    `);\r\n  }\r\n\r\n  submit() {\r\n    this.callback(parseFloat(this.findInput('input[type=number]').value));\r\n    return true;\r\n  }\r\n}\r\n","import {DENSE_HISTOGRAM} from '../config';\r\nimport {computeStats, getNumberOfBins, INumberBin, IStatistics, round} from '../internal/math';\r\nimport {IDataRow, IGroup, isMissingValue} from '../model';\r\nimport Column from '../model/Column';\r\nimport {\r\n  DEFAULT_FORMATTER, INumberColumn, INumbersColumn, isNumberColumn,\r\n  isNumbersColumn\r\n} from '../model/INumberColumn';\r\nimport {IMapAbleColumn, isMapAbleColumn} from '../model/MappingFunction';\r\nimport InputNumberDialog from '../ui/dialogs/InputNumberDialog';\r\nimport {filterMissingNumberMarkup, updateFilterMissingNumberMarkup} from '../ui/missing';\r\nimport {colorOf} from './impose';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop} from './utils';\r\nimport {dragHandle, IDragHandleOptions} from '../internal/drag';\r\n\r\n/** @internal */\r\nexport default class HistogramCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Histogram';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return (isNumberColumn(col) && mode !== ERenderMode.CELL) || (isNumbersColumn(col) && mode === ERenderMode.CELL);\r\n  }\r\n\r\n  create(col: INumbersColumn, context: IRenderContext, hist: IStatistics | null, imposer?: IImposer) {\r\n    const {template, render, guessedBins} = getHistDOMRenderer(context.totalNumberOfRows, col, imposer);\r\n    return {\r\n      template: `${template}</div>`,\r\n      update: (n: HTMLElement, row: IDataRow) => {\r\n        if (renderMissingDOM(n, col, row)) {\r\n          return;\r\n        }\r\n        render(n, createHist(hist, guessedBins, [row], col));\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(col: INumberColumn, context: IRenderContext, hist: IStatistics | null, imposer?: IImposer) {\r\n    const {template, render, guessedBins} = getHistDOMRenderer(context.totalNumberOfRows, col, imposer);\r\n    return {\r\n      template: `${template}</div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        render(n, createHist(hist, guessedBins, rows, col));\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: INumberColumn, context: IRenderContext, interactive: boolean, imposer?: IImposer) {\r\n    const r = getHistDOMRenderer(context.totalNumberOfRows, col, imposer);\r\n\r\n    const staticHist = !interactive || !isMapAbleColumn(col);\r\n    return staticHist ? staticSummary(col, r.template, r.render) : interactiveSummary(<IMapAbleColumn>col, context, r.template, r.render);\r\n  }\r\n}\r\n\r\n\r\nfunction staticSummary(col: INumberColumn, template: string, render: (n: HTMLElement, stats: {bins: number, max: number, hist: INumberBin[]}) => void) {\r\n  if (isMapAbleColumn(col)) {\r\n    const range = col.getRange();\r\n    template += `<span>${range[0]}</span><span>${range[1]}</span>`;\r\n  }\r\n  return {\r\n    template: `${template}</div>`,\r\n    update: (node: HTMLElement, hist: IStatistics | null) => {\r\n      if (isMapAbleColumn(col)) {\r\n        const range = col.getRange();\r\n        Array.from(node.querySelectorAll('span')).forEach((d: HTMLElement, i) => d.textContent = range[i]);\r\n      }\r\n\r\n      node.classList.toggle('lu-missing', !hist);\r\n      if (!hist) {\r\n        return;\r\n      }\r\n      render(node, {bins: hist.hist.length, max: hist.maxBin, hist: hist.hist});\r\n    }\r\n  };\r\n}\r\n\r\nfunction interactiveSummary(col: IMapAbleColumn, context: IRenderContext, template: string, render: (n: HTMLElement, stats: {bins: number, max: number, hist: INumberBin[]}) => void) {\r\n  const f = filter(col);\r\n  template += `\r\n      <div data-handle=\"min-hint\" style=\"width: ${f.percent(f.filterMin)}%\"></div>\r\n      <div data-handle=\"max-hint\" style=\"width: ${100 - f.percent(f.filterMax)}%\"></div>\r\n      <div data-handle=\"min\" data-value=\"${round(f.filterMin, 2)}\" style=\"left: ${f.percent(f.filterMin)}%\" title=\"min filter, drag or shift click to change\"></div>\r\n      <div data-handle='max' data-value=\"${round(f.filterMax, 2)}\" style=\"right: ${100 - f.percent(f.filterMax)}%\" title=\"max filter, drag or shift click to change\"></div>\r\n      ${filterMissingNumberMarkup(f.filterMissing, 0, context.idPrefix)}\r\n    `;\r\n\r\n  let updateFilter: (missing: number, col: IMapAbleColumn) => void;\r\n\r\n  return {\r\n    template: `${template}</div>`,\r\n    update: (node: HTMLElement, hist: IStatistics | null) => {\r\n      if (!updateFilter) {\r\n        updateFilter = initFilter(node, col, context);\r\n      }\r\n      updateFilter(hist ? hist.missing : 0, col);\r\n\r\n      node.classList.toggle('lu-missing', !hist);\r\n      if (!hist) {\r\n        return;\r\n      }\r\n      render(node, {bins: hist.hist.length, max: hist.maxBin, hist: hist.hist});\r\n    }\r\n  };\r\n}\r\n\r\nfunction initFilter(node: HTMLElement, col: IMapAbleColumn, context: IRenderContext) {\r\n  const min = <HTMLElement>node.querySelector('[data-handle=min]');\r\n  const max = <HTMLElement>node.querySelector('[data-handle=max]');\r\n  const minHint = <HTMLElement>node.querySelector('[data-handle=min-hint]');\r\n  const maxHint = <HTMLElement>node.querySelector('[data-handle=max-hint]');\r\n  const filterMissing = <HTMLInputElement>node.querySelector('input');\r\n\r\n  const setFilter = () => {\r\n    const f = filter(col);\r\n    const minValue = f.unpercent(parseFloat(min.style.left!));\r\n    const maxValue = f.unpercent(100 - parseFloat(max.style.right!));\r\n    col.setFilter({\r\n      filterMissing: filterMissing.checked,\r\n      min: Math.abs(minValue - f.domain[0]) < 0.001 ? NaN : minValue,\r\n      max: Math.abs(maxValue - f.domain[1]) < 0.001 ? NaN : maxValue\r\n    });\r\n  };\r\n\r\n  min.onclick = (evt) => {\r\n    if (!evt.shiftKey) {\r\n      return;\r\n    }\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n\r\n    const f = filter(col);\r\n    const value = f.unpercent(parseFloat(min.style.left!));\r\n\r\n    const dialogCtx = {\r\n      attachment: min,\r\n      manager: context.dialogManager,\r\n      level: 1,\r\n      idPrefix: context.idPrefix\r\n    };\r\n\r\n    const dialog = new InputNumberDialog(dialogCtx, (newValue) => {\r\n      minHint.style.width = `${f.percent(newValue)}%`;\r\n      min.dataset.value = round(newValue, 2).toString();\r\n      min.style.left = `${f.percent(newValue)}%`;\r\n      min.classList.toggle('lu-swap-hint', f.percent(newValue) > 15);\r\n      setFilter();\r\n    }, {\r\n        value, min: f.domain[0], max: f.domain[1]\r\n      });\r\n    dialog.open();\r\n  };\r\n\r\n  max.onclick = (evt) => {\r\n    if (!evt.shiftKey) {\r\n      return;\r\n    }\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n\r\n    const f = filter(col);\r\n    const value = f.unpercent(100 - parseFloat(max.style.right!));\r\n\r\n    const dialogCtx = {\r\n      attachment: max,\r\n      manager: context.dialogManager,\r\n      level: 1,\r\n      idPrefix: context.idPrefix\r\n    };\r\n\r\n    const dialog = new InputNumberDialog(dialogCtx, (newValue) => {\r\n      maxHint.style.width = `${100 - f.percent(newValue)}%`;\r\n      max.dataset.value = round(newValue, 2).toString();\r\n      max.style.right = `${100 - f.percent(newValue)}%`;\r\n      min.classList.toggle('lu-swap-hint', f.percent(newValue) < 85);\r\n      setFilter();\r\n    }, {\r\n        value, min: f.domain[0], max: f.domain[1]\r\n      });\r\n    dialog.open();\r\n  };\r\n\r\n  filterMissing.onchange = () => setFilter();\r\n\r\n  const options: Partial<IDragHandleOptions> = {\r\n    minDelta: 0,\r\n    filter: (evt) => evt.button === 0 && !evt.shiftKey,\r\n    onStart: (handle) => handle.classList.add('lu-dragging'),\r\n    onDrag: (handle, x) => {\r\n      const total = node.clientWidth;\r\n      const px = Math.max(0, Math.min(x, total));\r\n      const percent = Math.round(100 * px / total);\r\n      const domain = col.getMapping().domain;\r\n      (<HTMLElement>handle).dataset.value = round(((percent / 100) * (domain[1] - domain[0]) + domain[0]), 2).toString();\r\n\r\n      if ((<HTMLElement>handle).dataset.handle === 'min') {\r\n        handle.style.left = `${percent}%`;\r\n        handle.classList.toggle('lu-swap-hint', percent > 15);\r\n        minHint.style.width = `${percent}%`;\r\n        return;\r\n      }\r\n      handle.style.right = `${100 - percent}%`;\r\n      handle.classList.toggle('lu-swap-hint', percent < 85);\r\n      maxHint.style.width = `${100 - percent}%`;\r\n    },\r\n    onEnd: (handle) => {\r\n      handle.classList.remove('lu-dragging');\r\n      setFilter();\r\n    }\r\n  };\r\n  dragHandle(min, options);\r\n  dragHandle(max, options);\r\n\r\n  return (missing: number, actCol: IMapAbleColumn) => {\r\n    col = actCol;\r\n    const f = filter(col);\r\n    minHint.style.width = `${f.percent(f.filterMin)}%`;\r\n    maxHint.style.width = `${100 - f.percent(f.filterMax)}%`;\r\n    min.dataset.value = round(f.filterMin, 2).toString();\r\n    max.dataset.value = round(f.filterMax, 2).toString();\r\n    min.style.left = `${f.percent(f.filterMin)}%`;\r\n    max.style.right = `${100 - f.percent(f.filterMax)}%`;\r\n    filterMissing.checked = f.filterMissing;\r\n    updateFilterMissingNumberMarkup(<HTMLElement>filterMissing.parentElement, missing);\r\n  };\r\n}\r\n\r\nfunction createHist(globalHist: IStatistics | null, guessedBins: number, rows: IDataRow[], col: INumberColumn) {\r\n  const bins = globalHist ? globalHist.hist.length : guessedBins;\r\n  let stats: IStatistics;\r\n  if (isNumbersColumn(col)) {\r\n    //multiple values\r\n    const values = (<number[]>[]).concat(...rows.map((r) => col.getNumbers(r)));\r\n    stats = computeStats(values, (v: number) => v, isMissingValue, [0, 1], bins);\r\n  } else {\r\n    stats = computeStats(rows, (r: IDataRow) => col.getNumber(r), (r: IDataRow) => col.isMissing(r), [0, 1], bins);\r\n  }\r\n\r\n  const max = Math.max(stats.maxBin, globalHist ? globalHist.maxBin : 0);\r\n  return {bins, max, hist: stats.hist};\r\n}\r\n\r\nexport function getHistDOMRenderer(totalNumberOfRows: number, col: INumberColumn, imposer?: IImposer) {\r\n  const guessedBins = getNumberOfBins(totalNumberOfRows);\r\n  let bins = '';\r\n  for (let i = 0; i < guessedBins; ++i) {\r\n    bins += `<div title=\"Bin ${i}: 0\" data-x=\"\"><div style=\"height: 0\" ></div></div>`;\r\n  }\r\n\r\n  const render = (n: HTMLElement, stats: {bins: number, max: number, hist: INumberBin[]}) => {\r\n    const {bins, max, hist} = stats;\r\n    //adapt the number of children\r\n    let nodes = <HTMLElement[]>Array.from(n.querySelectorAll('[data-x]'));\r\n    if (nodes.length > bins) {\r\n      nodes.splice(bins, nodes.length - bins).forEach((d) => d.remove());\r\n    } else if (nodes.length < bins) {\r\n      for (let i = nodes.length; i < bins; ++i) {\r\n        n.insertAdjacentHTML('afterbegin', `<div title=\"Bin ${i}: 0\" data-x=\"\"><div style=\"height: 0\" ></div></div>`);\r\n      }\r\n      nodes = Array.from(n.querySelectorAll('[data-x]'));\r\n    }\r\n    n.classList.toggle('lu-dense', bins > DENSE_HISTOGRAM);\r\n    nodes.forEach((d: HTMLElement, i) => {\r\n      const {x0, x1, length} = hist[i];\r\n      const inner = <HTMLElement>d.firstElementChild!;\r\n      d.title = `${DEFAULT_FORMATTER(x0)} - ${DEFAULT_FORMATTER(x1)} (${length})`;\r\n      d.dataset.x = DEFAULT_FORMATTER(x0);\r\n      inner.style.height = `${Math.round(length * 100 / max)}%`;\r\n      inner.style.backgroundColor = colorOf(col, null, imposer, (x1 + x0) / 2);\r\n    });\r\n  };\r\n  return {\r\n    template: `<div${guessedBins > DENSE_HISTOGRAM ? ' class=\"lu-dense' : ''}>${bins}`, // no closing div to be able to append things\r\n    render,\r\n    guessedBins\r\n  };\r\n}\r\n\r\n\r\nfunction filter(col: IMapAbleColumn) {\r\n  const filter = col.getFilter();\r\n  const domain = col.getMapping().domain;\r\n  const percent = (v: number) => Math.round(100 * (v - domain[0]) / (domain[1] - domain[0]));\r\n  const unpercent = (v: number) => ((v / 100) * (domain[1] - domain[0]) + domain[0]);\r\n  const filterMin = isFinite(filter.min) ? filter.min : domain[0];\r\n  const filterMax = isFinite(filter.max) ? filter.max : domain[1];\r\n  return {\r\n    filterMissing: filter.filterMissing,\r\n    domain,\r\n    percent,\r\n    unpercent,\r\n    filterMin,\r\n    filterMax\r\n  };\r\n}\r\n","import {IDataRow} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, noRenderer} from './utils';\r\nimport LinkColumn from '../model/LinkColumn';\r\n\r\n/** @internal */\r\nexport default class ImageCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Image';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return col instanceof LinkColumn && mode === ERenderMode.CELL;\r\n  }\r\n\r\n  create(col: LinkColumn) {\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        const missing = renderMissingDOM(n, col, d);\r\n        const v = col.getLink(d);\r\n        n.title = v ? v.alt : '';\r\n        n.style.backgroundImage = missing || !v ? null : `url('${v.href}')`;\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return noRenderer;\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {INumberBin, IStatistics} from '../internal';\r\nimport {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport CompositeNumberColumn from '../model/CompositeNumberColumn';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {getHistDOMRenderer} from './HistogramCellRenderer';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {createData} from './MultiLevelCellRenderer';\r\nimport {matchColumns, forEachChild} from './utils';\r\nimport {colorOf} from '../ui/dialogs/utils';\r\n\r\n\r\n/** @internal */\r\nexport default class InterleavingCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Interleaved';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof CompositeNumberColumn;\r\n  }\r\n\r\n  create(col: CompositeNumberColumn, context: IRenderContext) {\r\n    const {cols} = createData(col, context, false, ERenderMode.CELL);\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div>${cols.map((r) => r.template).join('')}</div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow, i: number, group: IGroup) => {\r\n        const missing = renderMissingDOM(n, col, d);\r\n        if (missing) {\r\n          return;\r\n        }\r\n        matchColumns(n, cols);\r\n        forEachChild(n, (ni: HTMLElement, j) => {\r\n          cols[j].renderer!.update(ni, d, i, group);\r\n        });\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow, _i: number, group: IGroup) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n\r\n        ctx.save();\r\n        ctx.scale(1, 1 / cols.length); // scale since internal use the height, too\r\n        cols.forEach((r, i) => {\r\n          r.renderer!.render(ctx, d, i, group);\r\n          ctx.translate(0, CANVAS_HEIGHT);\r\n        });\r\n        ctx.restore();\r\n      }\r\n    };\r\n  }\r\n\r\n  createGroup(col: CompositeNumberColumn, context: IRenderContext) {\r\n    const {cols} = createData(col, context, false, ERenderMode.GROUP);\r\n    return {\r\n      template: `<div>${cols.map((r) => r.template).join('')}</div>`,\r\n      update: (n: HTMLElement, group: IGroup, rows: IDataRow[]) => {\r\n        matchColumns(n, cols);\r\n        forEachChild(n, (ni: HTMLElement, j) => {\r\n          cols[j].groupRenderer!.update(ni, group, rows);\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: CompositeNumberColumn, context: IRenderContext) {\r\n    const cols = col.children;\r\n    let acc = 0;\r\n    const {template, render} = getHistDOMRenderer(context.totalNumberOfRows, col, {\r\n      color: () => colorOf(cols[(acc++) % cols.length])\r\n    });\r\n    return {\r\n      template,\r\n      update: (n: HTMLElement) => {\r\n        const stats = cols.map((c) => <IStatistics | null>context.statsOf(<any>c));\r\n        if (!stats.some(Boolean)) {\r\n          n.classList.add('lu-missing');\r\n          return;\r\n        }\r\n        n.classList.remove('lu-missing');\r\n        const grouped = groupedHist(stats);\r\n        render(n, grouped);\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nconst dummyBin: INumberBin = {\r\n  length: 0,\r\n  x0: 0,\r\n  x1: 0\r\n};\r\n\r\nfunction groupedHist(stats: (IStatistics | null)[]) {\r\n  const sample = stats.find(Boolean)!;\r\n  const bins = sample.hist.length;\r\n  // assert all have the same bin size\r\n  const hist = <INumberBin[]>[];\r\n  let maxBin = 0;\r\n  for (let i = 0; i < bins; ++i) {\r\n    stats.forEach((s) => {\r\n      const bin = s ? s.hist[i] : null;\r\n      if (!bin) {\r\n        hist.push(dummyBin);\r\n        return;\r\n      }\r\n      if (bin.length > maxBin) {\r\n        maxBin = bin.length;\r\n      }\r\n      hist.push(bin);\r\n    });\r\n  }\r\n  return {bins, max: maxBin, hist};\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, noRenderer, setText} from './utils';\r\nimport LinkColumn from '../model/LinkColumn';\r\n\r\n/** @internal */\r\nexport default class LinkCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Link';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return col instanceof LinkColumn && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  create(col: LinkColumn) {\r\n    const align = col.alignment || 'left';\r\n    return {\r\n      template: `<a${align !== 'left' ? ` class=\"lu-${align}\"` : ''} target=\"_blank\" href=\"\"></a>`,\r\n      update: (n: HTMLAnchorElement, d: IDataRow) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        const v = col.getLink(d);\r\n        n.href = v ? v.href : '';\r\n        if (col.escape) {\r\n          setText(n, v ? v.alt : '');\r\n        } else {\r\n          n.innerHTML = v ? v.alt : '';\r\n        }\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  private static exampleText(col: LinkColumn, rows: IDataRow[]) {\r\n    const numExampleRows = 5;\r\n    const examples = <string[]>[];\r\n    for (const row of rows) {\r\n      if (col.isMissing(row)) {\r\n        continue;\r\n      }\r\n      const v = col.getLink(row);\r\n      examples.push(`<a target=\"_blank\" href=\"${v ? v.href : ''}\">${v ? v.alt : ''}</a>`);\r\n      if (examples.length >= numExampleRows) {\r\n        break;\r\n      }\r\n    }\r\n    return `${examples.join(', ')}${examples.length < rows.length ? ', &hellip;' : ''}`;\r\n  }\r\n\r\n  createGroup(col: LinkColumn) {\r\n    return {\r\n      template: `<div> </div>`,\r\n      update: (n: HTMLDivElement, _group: IGroup, rows: IDataRow[]) => {\r\n        n.innerHTML = LinkCellRenderer.exampleText(col, rows);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {IDataRow, IGroup, isMissingValue} from '../model';\r\nimport Column from '../model/Column';\r\nimport {IArrayColumn, IKeyValue, IMapColumn, isArrayColumn, isMapColumn} from '../model/IArrayColumn';\r\nimport {ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {forEach, noop} from './utils';\r\n\r\n/** @internal */\r\nexport default class TableCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Table';\r\n\r\n  canRender(col: Column) {\r\n    return isMapColumn(col);\r\n  }\r\n\r\n  create(col: IMapColumn<any>) {\r\n    if (isArrayColumn(col) && col.dataLength) {\r\n      // fixed length optimized rendering\r\n      return this.createFixed(col);\r\n    }\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (node: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(node, col, d)) {\r\n          return;\r\n        }\r\n        node.innerHTML = col.getMapLabel(d).map(({key, value}) => `<div>${key}</div><div>${value}</div>`).join('');\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  private static template(col: IArrayColumn<any>) {\r\n    const labels = col.labels;\r\n    return `<div>${labels.map((l) => `<div>${l}</div><div data-v></div>`).join('\\n')}</div>`;\r\n  }\r\n\r\n  private createFixed(col: IArrayColumn<any>) {\r\n    return {\r\n      template: TableCellRenderer.template(col),\r\n      update: (node: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(node, col, d)) {\r\n          return;\r\n        }\r\n        const value = col.getLabels(d);\r\n        forEach(node, '[data-v]', (n: HTMLElement, i) => {\r\n          n.innerHTML = value[i];\r\n        });\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  private static example(arr: IKeyValue<string>[]) {\r\n    const numExampleRows = 5;\r\n    return `${arr.slice(0, numExampleRows).map((d) => d.value).join(', ')}${numExampleRows < arr.length ? ', &hellip;' : ''}`;\r\n  }\r\n\r\n  createGroup(col: IMapColumn<any>) {\r\n    if (isArrayColumn(col) && col.dataLength) {\r\n      // fixed length optimized rendering\r\n      return this.createFixedGroup(col);\r\n    }\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (node: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const vs = rows.filter((d) => !col.isMissing(d)).map((d) => col.getMapLabel(d));\r\n\r\n        const entries = groupByKey(vs);\r\n\r\n        node.innerHTML = entries.map(({key, values}) => `<div>${key}</div><div>${TableCellRenderer.example(values)}</div>`).join('');\r\n      }\r\n    };\r\n  }\r\n\r\n  private createFixedGroup(col: IArrayColumn<any>) {\r\n    return {\r\n      template: TableCellRenderer.template(col),\r\n      update: (node: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const numExampleRows = 5;\r\n        const vs = rows.filter((d) => !col.isMissing(d)).map((d) => col.getLabels(d));\r\n        forEach(node, '[data-v]', (n: HTMLElement, i) => {\r\n          const values = <string[]>[];\r\n          for (const v of vs) {\r\n            const vi = v[i];\r\n            if (isMissingValue(vi)) {\r\n              continue;\r\n            }\r\n            values.push(vi);\r\n            if (values.length >= numExampleRows) {\r\n              break;\r\n            }\r\n          }\r\n          n.innerHTML = `${values.join(', ')}${numExampleRows < vs.length ? ', &hellip;' : ''}`;\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return {\r\n      template: `<div><div>Key</div><div>Value</div></div>`,\r\n      update: noop\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport function groupByKey<T extends { key: string }>(arr: T[][]) {\r\n  const m = new Map<string, T[]>();\r\n  arr.forEach((a) => a.forEach((d) => {\r\n    if (!m.has(d.key)) {\r\n      m.set(d.key, [d]);\r\n    } else {\r\n      m.get(d.key)!.push(d);\r\n    }\r\n  }));\r\n  return Array.from(m).sort((a, b) => a[0].localeCompare(b[0])).map(([key, values]) => ({key, values}));\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {groupByKey} from './TableCellRenderer';\r\nimport {noop, noRenderer} from './utils';\r\nimport LinkMapColumn from '../model/LinkMapColumn';\r\nimport {ILink} from '../model/LinkColumn';\r\nimport {IKeyValue} from '../model/IArrayColumn';\r\n\r\n/** @internal */\r\nexport default class LinkMapCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Table with Links';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return col instanceof LinkMapColumn && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  create(col: LinkMapColumn) {\r\n    const align = col.alignment || 'left';\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (node: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(node, col, d)) {\r\n          return;\r\n        }\r\n        node.innerHTML = col.getLinkMap(d).map(({key, value}) => `<div>${key}</div><div${align !== 'left' ? ` class=\"lu-${align}\"` : ''}><a href=\"${value.href}\" target=\"_blank\">${value.alt}</a></div>`).join('');\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  private static example(arr: IKeyValue<ILink>[]) {\r\n    const numExampleRows = 5;\r\n    const examples = <string[]>[];\r\n    for (const row of arr) {\r\n      examples.push(`<a target=\"_blank\" href=\"${row.value.href}\">${row.value.alt}</a>`);\r\n      if (examples.length >= numExampleRows) {\r\n        break;\r\n      }\r\n    }\r\n    return `${examples.join(', ')}${examples.length < arr.length} ? ', &hellip;': ''}`;\r\n  }\r\n\r\n  createGroup(col: LinkMapColumn) {\r\n    const align = col.alignment || 'left';\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (node: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const vs = rows.filter((d) => !col.isMissing(d)).map((d) => col.getLinkMap(d));\r\n\r\n        const entries = groupByKey(vs);\r\n\r\n        node.innerHTML = entries.map(({key, values}) => `<div>${key}</div><div${align !== 'left' ? ` class=\"lu-${align}\"` : ''}>${LinkMapCellRenderer.example(values)}</div>`).join('');\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {ICellRendererFactory} from './interfaces';\r\nimport {noop} from './utils';\r\n\r\n/** @internal */\r\nexport default class LoadingCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Loading';\r\n\r\n  canRender() {\r\n    return false; // just direct selection\r\n  }\r\n\r\n  create() {\r\n    return {\r\n      template: `<div>Loading</div>`,\r\n      update: noop,\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return this.create();\r\n  }\r\n\r\n  createSummary() {\r\n    return this.create();\r\n  }\r\n}\r\n","import {ICategoricalStatistics, IStatistics} from '../internal/math';\r\nimport {IDataRow, isMissingValue, isNumberColumn} from '../model';\r\nimport Column from '../model/Column';\r\nimport {IMapColumn, isMapColumn} from '../model/IArrayColumn';\r\nimport {DEFAULT_FORMATTER} from '../model/INumberColumn';\r\nimport {IMapAbleColumn, isMapAbleColumn} from '../model/MappingFunction';\r\nimport {colorOf} from './impose';\r\nimport {ICellRendererFactory, IImposer, default as IRenderContext, ERenderMode} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport default class MapBarCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Bar Table';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isMapColumn(col) && isNumberColumn(col) && (mode === ERenderMode.CELL || (mode === ERenderMode.SUMMARY && isMapAbleColumn(col)));\r\n  }\r\n\r\n  create(col: IMapColumn<number>, _context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (node: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(node, col, d)) {\r\n          return;\r\n        }\r\n        node.innerHTML = col.getMap(d).map(({key, value}) => {\r\n          if (isMissingValue(value)) {\r\n            return `<div>${key}</div><div class=\"lu-missing\"></div>`;\r\n          }\r\n          const w = isNaN(value) ? 0 : Math.round(value * 100 * 100) / 100;\r\n          return `<div>${key}</div><div title=\"${DEFAULT_FORMATTER(value)}\"><div style=\"width: ${w}%; background-color: ${colorOf(col, d, imposer)}\"><span class=\"lu-hover-only\">${value}</span></div></div>`;\r\n        }).join('');\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup() {\r\n    return noRenderer;\r\n  }\r\n\r\n  createSummary(col: IMapColumn<number> & IMapAbleColumn) {\r\n    return {\r\n      template: `<div><div>Key</div><div><span></span><span></span>Value</div></div>`,\r\n      update: (node: HTMLElement) => {\r\n        const range = col.getRange();\r\n        const value = <HTMLElement>node.lastElementChild!;\r\n        value.firstElementChild!.textContent = range[0];\r\n        value.children[1]!.textContent = range[1];\r\n      }\r\n    };\r\n  }\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport RankColumn from '../model/RankColumn';\r\nimport {ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, noRenderer, setText} from './utils';\r\n\r\n/** @internal */\r\nexport default class RankCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof RankColumn;\r\n  }\r\n\r\n  create(col: Column) {\r\n    return {\r\n      template: `<div class=\"lu-right\"> </div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow) => {\r\n        renderMissingDOM(n, col, d);\r\n        setText(n, col.getLabel(d));\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(col: Column) {\r\n    return {\r\n      template: `<div><div></div><div></div></div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const fromTSpan = <HTMLElement>n.firstElementChild!;\r\n        const toTSpan = <HTMLElement>n.lastElementChild!;\r\n        if (rows.length === 0) {\r\n          fromTSpan.textContent = '';\r\n          toTSpan.textContent = '';\r\n          return;\r\n        }\r\n        fromTSpan.textContent = col.getLabel(rows[0]);\r\n        toTSpan.textContent = col.getLabel(rows[rows.length - 1],);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {IDataRow, IGroup, isMissingValue} from '../model';\r\nimport Column from '../model/Column';\r\nimport {INumbersColumn, isNumbersColumn} from '../model/INumberColumn';\r\nimport NumbersColumn from '../model/NumbersColumn';\r\nimport {matchRows} from './ANumbersCellRenderer';\r\nimport {ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {forEachChild, noop, noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport function line(data: number[]) {\r\n  if (data.length === 0) {\r\n    return '';\r\n  }\r\n  let p = '';\r\n  let moveNext = true;\r\n\r\n  data.forEach((d, i) => {\r\n    if (isMissingValue(d)) {\r\n      moveNext = true;\r\n    } else if (moveNext) {\r\n      p += `M${i},${1 - d} `;\r\n      moveNext = false;\r\n    } else {\r\n      p += `L${i},${1 - d} `;\r\n    }\r\n  });\r\n  return p;\r\n}\r\n\r\n/** @internal */\r\nexport default class SparklineCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Sparkline';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isNumbersColumn(col) && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  create(col: INumbersColumn) {\r\n    const dataLength = col.dataLength!;\r\n    const yPos = 1 - col.getMapping().apply(NumbersColumn.CENTER);\r\n    return {\r\n      template: `<svg viewBox=\"0 0 ${dataLength - 1} 1\" preserveAspectRatio=\"none meet\"><line x1=\"0\" x2=\"${dataLength - 1}\" y1=\"${yPos}\" y2=\"${yPos}\"></line><path></path></svg>`,\r\n      update: (n: HTMLElement, d: IDataRow) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        const data = col.getNumbers(d);\r\n        n.querySelector('path')!.setAttribute('d', line(data));\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(col: INumbersColumn) {\r\n    const dataLength = col.dataLength!;\r\n    const yPos = 1 - col.getMapping().apply(NumbersColumn.CENTER);\r\n    return {\r\n      template: `<svg viewBox=\"0 0 ${dataLength} 1\" preserveAspectRatio=\"none meet\"><line x1=\"0\" x2=\"${dataLength - 1}\" y1=\"${yPos}\" y2=\"${yPos}\"></line><path></path></svg>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        //overlapping ones\r\n        matchRows(n, rows, `<path></path>`);\r\n        forEachChild(n, ((row, i) => {\r\n          const d = rows[i];\r\n          row.setAttribute('d', line(col.getNumbers(d)));\r\n        }));\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n\r\n}\r\n","import {IDataRow} from '../model';\r\nimport Column from '../model/Column';\r\nimport {DEFAULT_FORMATTER, INumbersColumn, isNumbersColumn} from '../model/INumberColumn';\r\nimport NumbersColumn from '../model/NumbersColumn';\r\nimport {CANVAS_HEIGHT} from '../styles';\r\nimport {ANumbersCellRenderer} from './ANumbersCellRenderer';\r\nimport {toHeatMapColor} from './BrightnessCellRenderer';\r\nimport IRenderContext, {ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {attr, forEachChild, noRenderer} from './utils';\r\n\r\n/** @internal */\r\nexport default class VerticalBarCellRenderer extends ANumbersCellRenderer implements ICellRendererFactory {\r\n  readonly title = 'Bar Chart';\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isNumbersColumn(col) && Boolean(col.dataLength) && mode === ERenderMode.CELL;\r\n  }\r\n\r\n  private static compute(v: number, threshold: number, domain: number[]) {\r\n    if (v < threshold) {\r\n      //threshold to down\r\n      return {height: (threshold - v), bottom: (v - domain[0])};\r\n    }\r\n    //from top to down\r\n    return {height: (v - threshold), bottom: (threshold - domain[0])};\r\n  }\r\n\r\n  protected createContext(col: INumbersColumn, context: IRenderContext, imposer?: IImposer) {\r\n    const cellDimension = context.colWidth(col) / col.dataLength!;\r\n    const threshold = col.getMapping().apply(NumbersColumn.CENTER);\r\n    const range = 1;\r\n    let templateRows = '';\r\n    for (let i = 0; i < col.dataLength!; ++i) {\r\n      templateRows += `<div style=\"background-color: white\" title=\"\"></div>`;\r\n    }\r\n    return {\r\n      templateRow: templateRows,\r\n      update: (row: HTMLElement, data: number[], raw: number[], item: IDataRow) => {\r\n        const zero = toHeatMapColor(0, item, col, imposer);\r\n        const one = toHeatMapColor(1, item, col, imposer);\r\n\r\n        forEachChild(row, (d, i) => {\r\n          const v = data[i];\r\n          const {bottom, height} = VerticalBarCellRenderer.compute(v, threshold, [0, 1]);\r\n          attr(<HTMLElement>d, {\r\n            title: DEFAULT_FORMATTER(raw[i])\r\n          }, {\r\n            'background-color': v < threshold ? zero : one,\r\n            bottom: `${Math.round((100 * bottom) / range)}%`,\r\n            height: `${Math.round((100 * height) / range)}%`\r\n          });\r\n        });\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, data: number[], item: IDataRow) => {\r\n        const zero = toHeatMapColor(0, item, col, imposer);\r\n        const one = toHeatMapColor(1, item, col, imposer);\r\n        const scale = CANVAS_HEIGHT / range;\r\n        data.forEach((v, j) => {\r\n          ctx.fillStyle = v < threshold ? zero : one;\r\n          const xpos = (j * cellDimension);\r\n          const {bottom, height} = VerticalBarCellRenderer.compute(v, threshold, [0, 1]);\r\n          ctx.fillRect(xpos, (range - height - bottom) * scale, cellDimension, height * scale);\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport {ICellRendererFactory, IGroupCellRenderer, ISummaryRenderer, ICellRenderer} from './interfaces';\r\nimport {renderMissingDOM} from './missing';\r\nimport {noop, noRenderer, setText, exampleText} from './utils';\r\nimport DateColumn, {choose} from '../model/DateColumn';\r\n\r\nexport default class DateCellRenderer implements ICellRendererFactory {\r\n  title = 'Date';\r\n  groupTitle = 'Date';\r\n  summaryTitle = 'Date';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof DateColumn;\r\n  }\r\n\r\n  create(col: DateColumn): ICellRenderer {\r\n    return {\r\n      template: `<div> </div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow) => {\r\n        renderMissingDOM(n, col, d);\r\n        setText(n, col.getLabel(d));\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(col: DateColumn): IGroupCellRenderer {\r\n    const isGrouped = col.isGroupedBy() >= 0;\r\n    const grouper = col.getDateGrouper();\r\n    return {\r\n      template: `<div> </div>`,\r\n      update: (n: HTMLDivElement, _group: IGroup, rows: IDataRow[]) => {\r\n        if (isGrouped) {\r\n          const chosen = choose(rows, grouper, col);\r\n          setText(n, chosen.name);\r\n          return;\r\n        }\r\n        setText(n, exampleText(col, rows));\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(): ISummaryRenderer {\r\n    return noRenderer;\r\n  }\r\n}\r\n","import Column from '../model/Column';\r\nimport ActionRenderer from './ActionRenderer';\r\nimport AggregateGroupRenderer from './AggregateGroupRenderer';\r\nimport AnnotationRenderer from './AnnotationRenderer';\r\nimport BarCellRenderer from './BarCellRenderer';\r\nimport BooleanCellRenderer from './BooleanCellRenderer';\r\nimport BoxplotCellRenderer from './BoxplotCellRenderer';\r\nimport BrightnessCellRenderer from './BrightnessCellRenderer';\r\nimport CategoricalCellRenderer from './CategoricalCellRenderer';\r\nimport CategoricalHeatmapCellRenderer from './CategoricalHeatmapCellRenderer';\r\nimport CategoricalStackedDistributionlCellRenderer from './CategoricalStackedDistributionlCellRenderer';\r\nimport CircleCellRenderer from './CircleCellRenderer';\r\nimport {DefaultCellRenderer} from './DefaultCellRenderer';\r\nimport DotCellRenderer from './DotCellRenderer';\r\nimport GroupCellRenderer from './GroupCellRenderer';\r\nimport HeatmapCellRenderer from './HeatmapCellRenderer';\r\nimport HistogramCellRenderer from './HistogramCellRenderer';\r\nimport ImageCellRenderer from './ImageCellRenderer';\r\nimport {ERenderMode, ICellRendererFactory} from './interfaces';\r\nimport InterleavingCellRenderer from './InterleavingCellRenderer';\r\nimport LinkCellRenderer from './LinkCellRenderer';\r\nimport LinkMapCellRenderer from './LinkMapCellRenderer';\r\nimport LoadingCellRenderer from './LoadingCellRenderer';\r\nimport MapBarCellRenderer from './MapBarCellRenderer';\r\nimport MultiLevelCellRenderer from './MultiLevelCellRenderer';\r\nimport RankCellRenderer from './RankCellRenderer';\r\nimport SelectionRenderer from './SelectionRenderer';\r\nimport SparklineCellRenderer from './SparklineCellRenderer';\r\nimport StringCellRenderer from './StringCellRenderer';\r\nimport TableCellRenderer from './TableCellRenderer';\r\nimport UpSetCellRenderer from './UpSetCellRenderer';\r\nimport VerticalBarCellRenderer from './VerticalBarCellRenderer';\r\nimport DateCellRenderer from './DateCellRenderer';\r\n\r\nexport {\r\n  default as IRenderContext,\r\n  IImposer,\r\n  ERenderMode,\r\n  ISummaryRenderer,\r\n  IGroupCellRenderer,\r\n  ICellRenderer,\r\n  ICellRendererFactory\r\n} from './interfaces';\r\n\r\nexport {colorOf} from './impose';\r\nexport {renderMissingDOM, renderMissingCanvas} from './missing';\r\n\r\n\r\nconst defaultCellRenderer = new DefaultCellRenderer();\r\n/**\r\n * default render factories\r\n */\r\nexport const renderers: { [key: string]: ICellRendererFactory } = {\r\n  actions: new ActionRenderer(),\r\n  aggregate: new AggregateGroupRenderer(),\r\n  annotate: new AnnotationRenderer(),\r\n  boolean: new BooleanCellRenderer(),\r\n  boxplot: new BoxplotCellRenderer(),\r\n  brightness: new BrightnessCellRenderer(),\r\n  catdistributionbar: new CategoricalStackedDistributionlCellRenderer(),\r\n  categorical: new CategoricalCellRenderer(),\r\n  circle: new CircleCellRenderer(),\r\n  date: new DateCellRenderer(),\r\n  default: defaultCellRenderer,\r\n  dot: new DotCellRenderer(),\r\n  group: new GroupCellRenderer(),\r\n  heatmap: new HeatmapCellRenderer(),\r\n  catheatmap: new CategoricalHeatmapCellRenderer(),\r\n  histogram: new HistogramCellRenderer(),\r\n  image: new ImageCellRenderer(),\r\n  interleaving: new InterleavingCellRenderer(),\r\n  link: new LinkCellRenderer(),\r\n  linkMap: new LinkMapCellRenderer(),\r\n  loading: new LoadingCellRenderer(),\r\n  nested: new MultiLevelCellRenderer(false),\r\n  number: new BarCellRenderer(),\r\n  mapbars: new MapBarCellRenderer(),\r\n  rank: new RankCellRenderer(),\r\n  selection: new SelectionRenderer(),\r\n  sparkline: new SparklineCellRenderer(),\r\n  stack: new MultiLevelCellRenderer(),\r\n  string: new StringCellRenderer(),\r\n  table: new TableCellRenderer(),\r\n  upset: new UpSetCellRenderer(),\r\n  verticalbar: new VerticalBarCellRenderer()\r\n};\r\n\r\n\r\nexport function chooseRenderer(col: Column, renderers: { [key: string]: ICellRendererFactory }): ICellRendererFactory {\r\n  const r = renderers[col.getRenderer()];\r\n  return r || defaultCellRenderer;\r\n}\r\n\r\nexport function chooseGroupRenderer(col: Column, renderers: { [key: string]: ICellRendererFactory }): ICellRendererFactory {\r\n  const r = renderers[col.getGroupRenderer()];\r\n  return r || defaultCellRenderer;\r\n}\r\n\r\nexport function chooseSummaryRenderer(col: Column, renderers: { [key: string]: ICellRendererFactory }): ICellRendererFactory {\r\n  const r = renderers[col.getSummaryRenderer()];\r\n  return r || defaultCellRenderer;\r\n}\r\n\r\nexport function possibleRenderer(col: Column, renderers: { [key: string]: ICellRendererFactory }, mode: ERenderMode = ERenderMode.CELL): { type: string, label: string }[] {\r\n  const valid = Object.keys(renderers).filter((type) => {\r\n    const factory = renderers[type];\r\n    return factory.canRender(col, mode);\r\n  });\r\n  // TODO some magic to remove and order\r\n\r\n\r\n  return valid.map((type) => {\r\n    const r = renderers[type];\r\n    return {\r\n      type,\r\n      label: mode === ERenderMode.CELL ? r.title : (mode === ERenderMode.GROUP ? r.groupTitle || r.title : r.summaryTitle || r.groupTitle || r.title)\r\n    };\r\n  });\r\n}\r\n\r\nexport function possibleGroupRenderer(col: Column, renderers: { [key: string]: ICellRendererFactory }) {\r\n  return possibleRenderer(col, renderers, ERenderMode.GROUP);\r\n}\r\n\r\nexport function possibleSummaryRenderer(col: Column, renderers: { [key: string]: ICellRendererFactory }) {\r\n  return possibleRenderer(col, renderers, ERenderMode.SUMMARY);\r\n}\r\n","export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import constant from \"./constant\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis\";\nimport basisClosed from \"./basisClosed\";\nimport nogamma, {gamma} from \"./color\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","import value from \"./value\";\n\nexport default function(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","import {basis} from \"./basis\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b -= a, function(t) {\n    return d.setTime(a + b * t), d;\n  };\n}\n","export default function(a, b) {\n  return a = +a, b -= a, function(t) {\n    return a + b * t;\n  };\n}\n","import value from \"./value\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","import number from \"./number\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","import decompose, {identity} from \"./decompose\";\n\nvar cssNode,\n    cssRoot,\n    cssView,\n    svgNode;\n\nexport function parseCss(value) {\n  if (value === \"none\") return identity;\n  if (!cssNode) cssNode = document.createElement(\"DIV\"), cssRoot = document.documentElement, cssView = document.defaultView;\n  cssNode.style.transform = value;\n  value = cssView.getComputedStyle(cssRoot.appendChild(cssNode), null).getPropertyValue(\"transform\");\n  cssRoot.removeChild(cssNode);\n  value = value.slice(7, -1).split(\",\");\n  return decompose(+value[0], +value[1], +value[2], +value[3], +value[4], +value[5]);\n}\n\nexport function parseSvg(value) {\n  if (value == null) return identity;\n  if (!svgNode) svgNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n  svgNode.setAttribute(\"transform\", value);\n  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;\n  value = value.matrix;\n  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb\";\nimport array from \"./array\";\nimport date from \"./date\";\nimport number from \"./number\";\nimport object from \"./object\";\nimport string from \"./string\";\nimport constant from \"./constant\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : Array.isArray(b) ? array\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","export default function(a, b) {\n  return a = +a, b -= a, function(t) {\n    return Math.round(a + b * t);\n  };\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","import number from \"../number\";\nimport {parseCss, parseSvg} from \"./parse\";\n\nfunction interpolateTransform(parse, pxComma, pxParen, degParen) {\n\n  function pop(s) {\n    return s.length ? s.pop() + \" \" : \"\";\n  }\n\n  function translate(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(\"translate(\", null, pxComma, null, pxParen);\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb || yb) {\n      s.push(\"translate(\" + xb + pxComma + yb + pxParen);\n    }\n  }\n\n  function rotate(a, b, s, q) {\n    if (a !== b) {\n      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path\n      q.push({i: s.push(pop(s) + \"rotate(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"rotate(\" + b + degParen);\n    }\n  }\n\n  function skewX(a, b, s, q) {\n    if (a !== b) {\n      q.push({i: s.push(pop(s) + \"skewX(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"skewX(\" + b + degParen);\n    }\n  }\n\n  function scale(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(pop(s) + \"scale(\", null, \",\", null, \")\");\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb !== 1 || yb !== 1) {\n      s.push(pop(s) + \"scale(\" + xb + \",\" + yb + \")\");\n    }\n  }\n\n  return function(a, b) {\n    var s = [], // string constants and placeholders\n        q = []; // number interpolators\n    a = parse(a), b = parse(b);\n    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);\n    rotate(a.rotate, b.rotate, s, q);\n    skewX(a.skewX, b.skewX, s, q);\n    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);\n    a = b = null; // gc\n    return function(t) {\n      var i = -1, n = q.length, o;\n      while (++i < n) s[(o = q[i]).i] = o.x(t);\n      return s.join(\"\");\n    };\n  };\n}\n\nexport var interpolateTransformCss = interpolateTransform(parseCss, \"px, \", \"px)\", \"deg)\");\nexport var interpolateTransformSvg = interpolateTransform(parseSvg, \", \", \")\", \")\");\n","var rho = Math.SQRT2,\n    rho2 = 2,\n    rho4 = 4,\n    epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\n// p0 = [ux0, uy0, w0]\n// p1 = [ux1, uy1, w1]\nexport default function(p0, p1) {\n  var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n      ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n      dx = ux1 - ux0,\n      dy = uy1 - uy0,\n      d2 = dx * dx + dy * dy,\n      i,\n      S;\n\n  // Special case for u0  u1.\n  if (d2 < epsilon2) {\n    S = Math.log(w1 / w0) / rho;\n    i = function(t) {\n      return [\n        ux0 + t * dx,\n        uy0 + t * dy,\n        w0 * Math.exp(rho * t * S)\n      ];\n    }\n  }\n\n  // General case.\n  else {\n    var d1 = Math.sqrt(d2),\n        b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n        b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n        r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n        r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n    S = (r1 - r0) / rho;\n    i = function(t) {\n      var s = t * S,\n          coshr0 = cosh(r0),\n          u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n      return [\n        ux0 + u * dx,\n        uy0 + u * dy,\n        w0 * coshr0 / cosh(rho * s + r0)\n      ];\n    }\n  }\n\n  i.duration = S * 1000;\n\n  return i;\n}\n","import {hsl as colorHsl} from \"d3-color\";\nimport color, {hue} from \"./color\";\n\nfunction hsl(hue) {\n  return function(start, end) {\n    var h = hue((start = colorHsl(start)).h, (end = colorHsl(end)).h),\n        s = color(start.s, end.s),\n        l = color(start.l, end.l),\n        opacity = color(start.opacity, end.opacity);\n    return function(t) {\n      start.h = h(t);\n      start.s = s(t);\n      start.l = l(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n}\n\nexport default hsl(hue);\nexport var hslLong = hsl(color);\n","import {hcl as colorHcl} from \"d3-color\";\nimport color, {hue} from \"./color\";\n\nfunction hcl(hue) {\n  return function(start, end) {\n    var h = hue((start = colorHcl(start)).h, (end = colorHcl(end)).h),\n        c = color(start.c, end.c),\n        l = color(start.l, end.l),\n        opacity = color(start.opacity, end.opacity);\n    return function(t) {\n      start.h = h(t);\n      start.c = c(t);\n      start.l = l(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n}\n\nexport default hcl(hue);\nexport var hclLong = hcl(color);\n","import {cubehelix as colorCubehelix} from \"d3-color\";\nimport color, {hue} from \"./color\";\n\nfunction cubehelix(hue) {\n  return (function cubehelixGamma(y) {\n    y = +y;\n\n    function cubehelix(start, end) {\n      var h = hue((start = colorCubehelix(start)).h, (end = colorCubehelix(end)).h),\n          s = color(start.s, end.s),\n          l = color(start.l, end.l),\n          opacity = color(start.opacity, end.opacity);\n      return function(t) {\n        start.h = h(t);\n        start.s = s(t);\n        start.l = l(Math.pow(t, y));\n        start.opacity = opacity(t);\n        return start + \"\";\n      };\n    }\n\n    cubehelix.gamma = cubehelixGamma;\n\n    return cubehelix;\n  })(1);\n}\n\nexport default cubehelix(hue);\nexport var cubehelixLong = cubehelix(color);\n","export {default as interpolate} from \"./value\";\nexport {default as interpolateArray} from \"./array\";\nexport {default as interpolateBasis} from \"./basis\";\nexport {default as interpolateBasisClosed} from \"./basisClosed\";\nexport {default as interpolateDate} from \"./date\";\nexport {default as interpolateDiscrete} from \"./discrete\";\nexport {default as interpolateHue} from \"./hue\";\nexport {default as interpolateNumber} from \"./number\";\nexport {default as interpolateObject} from \"./object\";\nexport {default as interpolateRound} from \"./round\";\nexport {default as interpolateString} from \"./string\";\nexport {interpolateTransformCss, interpolateTransformSvg} from \"./transform/index\";\nexport {default as interpolateZoom} from \"./zoom\";\nexport {default as interpolateRgb, rgbBasis as interpolateRgbBasis, rgbBasisClosed as interpolateRgbBasisClosed} from \"./rgb\";\nexport {default as interpolateHsl, hslLong as interpolateHslLong} from \"./hsl\";\nexport {default as interpolateLab} from \"./lab\";\nexport {default as interpolateHcl, hclLong as interpolateHclLong} from \"./hcl\";\nexport {default as interpolateCubehelix, cubehelixLong as interpolateCubehelixLong} from \"./cubehelix\";\nexport {default as piecewise} from \"./piecewise\";\nexport {default as quantize} from \"./quantize\";\n","import {Category, SupportType, toolbar} from './annotations';\nimport {IDataRow, IGroup} from './interfaces';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n/**\n * factory for creating a description creating a rank column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createSelectionDesc(label: string = 'Selection Checkboxes') {\n  return {type: 'selection', label, fixed: true};\n}\n\nexport interface ISelectionColumnDesc extends IValueColumnDesc<boolean> {\n  /**\n   * setter for selecting/deselecting the given row\n   */\n  setter(row: IDataRow, value: boolean): void;\n\n  /**\n   * setter for selecting/deselecting the given row\n   */\n  setterAll(rows: IDataRow[], value: boolean): void;\n}\n\n\n/**\n * emitted when rows are selected\n * @asMemberOf SelectionColumn\n * @param row the (de)seleced row\n * @param value true if selected else false\n * @param rows in case of multiple rows are selected\n * @event\n */\nexport declare function select(row: IDataRow, value: boolean, rows?: IDataRow[]): void;\n\n/**\n * a checkbox column for selections\n */\n@SupportType()\n@toolbar('sort', 'sortBy', 'group', 'groupBy', 'invertSelection')\n@Category('support')\nexport default class SelectionColumn extends ValueColumn<boolean> {\n  private static SELECTED_GROUP: IGroup = {\n    name: 'Selected',\n    color: 'orange'\n  };\n  private static NOT_SELECTED_GROUP: IGroup = {\n    name: 'Unselected',\n    color: 'gray'\n  };\n  static readonly EVENT_SELECT = 'select';\n\n  constructor(id: string, desc: Readonly<ISelectionColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(20);\n  }\n\n  get frozen() {\n    return this.desc.frozen !== false;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([SelectionColumn.EVENT_SELECT]);\n  }\n\n  on(type: typeof SelectionColumn.EVENT_SELECT, listener: typeof select | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  setValue(row: IDataRow, value: boolean) {\n    const old = this.getValue(row);\n    if (old === value) {\n      return true;\n    }\n    return this.setImpl(row, value);\n  }\n\n  setValues(rows: IDataRow[], value: boolean) {\n    if (rows.length === 0) {\n      return;\n    }\n    if ((<ISelectionColumnDesc>this.desc).setterAll) {\n      (<ISelectionColumnDesc>this.desc).setterAll(rows, value);\n    }\n    this.fire(SelectionColumn.EVENT_SELECT, rows[0], value, rows);\n    return true;\n  }\n\n  private setImpl(row: IDataRow, value: boolean) {\n    if ((<ISelectionColumnDesc>this.desc).setter) {\n      (<ISelectionColumnDesc>this.desc).setter(row, value);\n    }\n    this.fire(SelectionColumn.EVENT_SELECT, row, value);\n    return true;\n  }\n\n  toggleValue(row: IDataRow) {\n    const old = this.getValue(row);\n    this.setImpl(row, !old);\n    return !old;\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    const va = this.getValue(a) === true;\n    const vb = this.getValue(b) === true;\n    return va === vb ? 0 : (va < vb ? -1 : +1);\n  }\n\n  group(row: IDataRow) {\n    const isSelected = this.getValue(row);\n    return isSelected ? SelectionColumn.SELECTED_GROUP : SelectionColumn.NOT_SELECTED_GROUP;\n  }\n}\n","import Column from './Column';\r\nimport {IDataRow} from './interfaces';\r\n\r\n\r\nexport interface IKeyValue<T> {\r\n  key: string;\r\n  value: T;\r\n}\r\n\r\nexport interface IMapColumn<T> extends Column {\r\n  getMap(row: IDataRow): IKeyValue<T>[];\r\n\r\n  getMapLabel(row: IDataRow): IKeyValue<string>[];\r\n}\r\n\r\nexport function isMapColumn(col: Column): col is IMapColumn<any> {\r\n  return typeof (<IMapColumn<any>>col).getMap === 'function' && typeof (<IMapColumn<any>>col).getMapLabel === 'function';\r\n}\r\n\r\nexport interface IArrayColumn<T> extends IMapColumn<T> {\r\n  readonly labels: string[];\r\n  readonly dataLength: number | null;\r\n\r\n  getLabels(row: IDataRow): string[];\r\n\r\n  getValues(row: IDataRow): T[];\r\n}\r\n\r\nexport function isArrayColumn(col: Column): col is IArrayColumn<any> {\r\n  return typeof (<IArrayColumn<any>>col).getLabels === 'function' && typeof (<IArrayColumn<any>>col).getValues === 'function' && isMapColumn(col);\r\n}\r\n","export interface IStyleColumn {\r\n  /**\r\n   * column description\r\n   */\r\n  description: string;\r\n\r\n  /**\r\n   * color of this column\r\n   * @deprecated not used anymore\r\n   */\r\n  color: string;\r\n\r\n  /**\r\n   * frozen column\r\n   * @default isSupportType\r\n   */\r\n  frozen: boolean;\r\n\r\n  /**\r\n   * whether the column can be removed or not\r\n   * @default false\r\n   */\r\n  fixed: boolean;\r\n\r\n  /**\r\n   * default renderer to use\r\n   */\r\n  renderer: string;\r\n\r\n  /**\r\n   * default group renderer to use\r\n   */\r\n  groupRenderer: string;\r\n\r\n  /**\r\n   * default summary renderer to use\r\n   */\r\n  summaryRenderer: string;\r\n\r\n  /**\r\n   * initial width of the column\r\n   * @default 100 or 200 for strings\r\n   */\r\n  width: number;\r\n\r\n  /**\r\n   * is this column visible by default\r\n   * @default true\r\n   */\r\n  visible: boolean;\r\n}\r\n\r\n\r\nexport interface IColumnDesc extends Partial<IStyleColumn> {\r\n  /**\r\n   * label of the column\r\n   */\r\n  label: string;\r\n  /**\r\n   * the column type\r\n   */\r\n  type: string;\r\n}\r\n\r\n\r\n/**\r\n * a data row for rendering\r\n */\r\nexport interface IDataRow {\r\n  /**\r\n   * the value\r\n   */\r\n  readonly v: any;\r\n  /**\r\n   * the underlying data index\r\n   */\r\n  readonly i: number;\r\n}\r\n\r\n\r\nexport interface IGroup {\r\n  name: string;\r\n  color: string;\r\n  parent?: Readonly<IGroupParent> | null;\r\n}\r\n\r\nexport interface IGroupParent extends IGroup {\r\n  subGroups: (Readonly<IGroupParent> | Readonly<IGroup>)[];\r\n}\r\n\r\nexport interface IGroupItem extends IDataRow {\r\n  readonly group: IGroup;\r\n  readonly relativeIndex: number;\r\n  readonly meta?: 'first' | 'last' | 'first last';\r\n}\r\n\r\nexport interface IGroupData extends Readonly<IGroup> {\r\n  readonly rows: IDataRow[];\r\n}\r\n\r\nexport function isGroup(item: IGroupData | IGroupItem): item is IGroupData {\r\n  return item && (<IGroupData>item).name !== undefined; // use .name as separator\r\n}\r\n","import {Category, SupportType} from './annotations';\r\nimport Column, {IColumnDesc} from './Column';\r\nimport {IDataRow, IGroup} from './interfaces';\r\n\r\nexport interface IAction {\r\n  name: string;\r\n  icon?: string;\r\n  className?: string;\r\n\r\n  action(row: IDataRow): void;\r\n}\r\n\r\nexport interface IGroupAction {\r\n  name: string;\r\n  icon?: string;\r\n  className?: string;\r\n\r\n  action(group: IGroup, rows: IDataRow[]): void;\r\n}\r\n\r\n/**\r\n * utility for creating an action description with optional label\r\n * @param label\r\n * @param actions\r\n * @param groupActions\r\n * @returns {{type: string, label: string}}\r\n */\r\nexport function createActionDesc(label = 'actions', actions: Readonly<IAction>[] = [], groupActions: Readonly<IGroupAction>[] = []) {\r\n  return {type: 'actions', label, actions, groupActions, fixed: true};\r\n}\r\n\r\nexport interface IActionDesc {\r\n  actions?: Readonly<IAction>[];\r\n  groupActions?: Readonly<IGroupAction>[];\r\n}\r\n\r\nexport declare type IActionColumnDesc = IColumnDesc & IActionDesc;\r\n\r\n/**\r\n * a default column with no values\r\n */\r\n@SupportType()\r\n@Category('support')\r\nexport default class ActionColumn extends Column {\r\n\r\n  readonly actions: IAction[];\r\n  readonly groupActions: IGroupAction[];\r\n\r\n  constructor(id: string, desc: Readonly<IActionColumnDesc>) {\r\n    super(id, desc);\r\n\r\n    this.actions = desc.actions || [];\r\n    this.groupActions = desc.groupActions || [];\r\n  }\r\n\r\n  getLabel() {\r\n    return '';\r\n  }\r\n\r\n  getValue() {\r\n    return '';\r\n  }\r\n\r\n  compare() {\r\n    return 0; //can't compare\r\n  }\r\n}\r\n","import {Category, SupportType, toolbar, dialogAddons} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IGroupData} from './interfaces';\nimport {FIRST_IS_NAN, missingGroup} from './missing';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport function createGroupDesc(label = 'Group Name') {\n  return {type: 'group', label};\n}\n\nexport enum EGroupSortMethod {\n  name = 'name',\n  count ='count'\n}\n\n/**\n * emitted when the sort method property changes\n * @asMemberOf GroupColumn\n * @event\n */\nexport declare function sortMethodChanged(previous: EGroupSortMethod, current: EGroupSortMethod): void;\n\n\n@SupportType()\n@toolbar('sortGroupBy')\n@dialogAddons('sortGroup', 'sortGroups')\n@Category('support')\nexport default class GroupColumn extends Column {\n  static readonly EVENT_SORTMETHOD_CHANGED = 'sortMethodChanged';\n\n  private groupSortMethod: EGroupSortMethod = EGroupSortMethod.name;\n\n  get frozen() {\n    return this.desc.frozen !== false;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([GroupColumn.EVENT_SORTMETHOD_CHANGED]);\n  }\n\n  on(type: typeof GroupColumn.EVENT_SORTMETHOD_CHANGED, listener: typeof sortMethodChanged | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getLabel() {\n    return '';\n  }\n\n  getValue() {\n    return '';\n  }\n\n  compare() {\n    return 0; //can't compare\n  }\n\n  getSortMethod() {\n    return this.groupSortMethod;\n  }\n\n  setSortMethod(sortMethod: EGroupSortMethod) {\n    if (this.groupSortMethod === sortMethod) {\n      return;\n    }\n    this.fire([GroupColumn.EVENT_SORTMETHOD_CHANGED], this.groupSortMethod, this.groupSortMethod = sortMethod);\n    // sort by me if not already sorted by me\n    if (!this.isGroupSortedByMe().asc) {\n      this.toggleMyGroupSorting();\n    }\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData) {\n    switch (this.groupSortMethod) {\n      case 'count':\n        return a.rows.length - b.rows.length;\n      default:\n        if (a.name === missingGroup.name) {\n          return b.name === missingGroup.name ? 0 : FIRST_IS_NAN;\n        }\n        if (b.name === missingGroup.name) {\n          return -FIRST_IS_NAN;\n        }\n        return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n    }\n  }\n}\n","import {extent} from 'd3-array';\nimport {equalArrays} from '../internal';\nimport {Category, toolbar} from './annotations';\nimport CategoricalColumn from './CategoricalColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {\n  ICategoricalColumn, ICategoricalDesc, ICategoricalFilter, ICategory, toCategories,\n  toCategory\n} from './ICategoricalColumn';\nimport {IDataRow} from './interfaces';\nimport NumberColumn, {INumberColumn} from './NumberColumn';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport declare type ICategoricalNumberColumnDesc = ICategoricalDesc & IValueColumnDesc<number>;\n\n/**\n * emitted when the mapping property changes\n * @asMemberOf OrdinalColumn\n * @event\n */\nexport declare function mappingChanged(previous: number[], current: number[]): void;\n\n/**\n * emitted when the filter property changes\n * @asMemberOf OrdinalColumn\n * @event\n */\nexport declare function filterChanged(previous: ICategoricalFilter | null, current: ICategoricalFilter | null): void;\n\n/**\n * similar to a categorical column but the categories are mapped to numbers\n */\n@toolbar('group', 'filterOrdinal')\n@Category('categorical')\nexport default class OrdinalColumn extends ValueColumn<number> implements INumberColumn, ICategoricalColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumberColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_FILTER_CHANGED = CategoricalColumn.EVENT_FILTER_CHANGED;\n\n  readonly categories: ICategory[];\n\n  private missingCategory: ICategory | null;\n\n  private readonly lookup = new Map<string, Readonly<ICategory>>();\n\n  private currentFilter: ICategoricalFilter | null = null;\n\n\n  constructor(id: string, desc: Readonly<ICategoricalNumberColumnDesc>) {\n    super(id, desc);\n    this.categories = toCategories(desc);\n    this.missingCategory = desc.missingCategory ? toCategory(desc.missingCategory, NaN) : null;\n    this.categories.forEach((d) => this.lookup.set(d.name, d));\n    this.setDefaultRenderer('number');\n    this.setDefaultGroupRenderer('boxplot');\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([OrdinalColumn.EVENT_MAPPING_CHANGED, OrdinalColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof OrdinalColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof OrdinalColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  get dataLength() {\n    return this.categories.length;\n  }\n\n  get labels() {\n    return this.categories.map((d) => d.label);\n  }\n\n  getValue(row: IDataRow) {\n    const v = this.getCategory(row);\n    return v ? v.value : NaN;\n  }\n\n  getCategory(row: IDataRow) {\n    const v = super.getValue(row);\n    if (!v) {\n      return this.missingCategory;\n    }\n    const vs = String(v);\n    return this.lookup.has(vs) ? this.lookup.get(vs)! : this.missingCategory;\n  }\n\n  getColor(row: IDataRow) {\n    return CategoricalColumn.prototype.getColor.call(this, row);\n  }\n\n  getLabel(row: IDataRow) {\n    return CategoricalColumn.prototype.getLabel.call(this, row);\n  }\n\n  getLabels(row: IDataRow) {\n    return CategoricalColumn.prototype.getLabels.call(this, row);\n  }\n\n  getValues(row: IDataRow) {\n    return CategoricalColumn.prototype.getValues.call(this, row);\n  }\n\n  getMap(row: IDataRow) {\n    return CategoricalColumn.prototype.getMap.call(this, row);\n  }\n\n  getMapLabel(row: IDataRow) {\n    return CategoricalColumn.prototype.getMapLabel.call(this, row);\n  }\n\n  getSet(row: IDataRow) {\n    return CategoricalColumn.prototype.getSet.call(this, row);\n  }\n\n  getNumber(row: IDataRow) {\n    return this.getValue(row);\n  }\n\n  isMissing(row: IDataRow) {\n    return CategoricalColumn.prototype.isMissing.call(this, row);\n  }\n\n  getRawNumber(row: IDataRow) {\n    return this.getNumber(row);\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      if (this.isMissing(row)) {\n        return null;\n      }\n      return {\n        name: this.getLabel(row),\n        value: this.getValue(row)\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = CategoricalColumn.prototype.dump.call(this, toDescRef);\n    r.mapping = this.getMapping();\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    CategoricalColumn.prototype.restore.call(this, dump, factory);\n    if (dump.mapping) {\n      this.setMapping(dump.mapping);\n    }\n  }\n\n  getMapping() {\n    return this.categories.map((d) => d.value);\n  }\n\n  setMapping(mapping: number[]) {\n    const r = extent(mapping);\n    mapping = mapping.map((d) => (d - r[0]!) / (r[1]! - r[0]!));\n    const bak = this.getMapping();\n    if (equalArrays(bak, mapping)) {\n      return;\n    }\n    this.categories.forEach((d, i) => d.value = mapping[i] || 0);\n    this.fire([OrdinalColumn.EVENT_MAPPING_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], bak, this.getMapping());\n  }\n\n  isFiltered() {\n    return this.currentFilter != null;\n  }\n\n  filter(row: IDataRow): boolean {\n    return CategoricalColumn.prototype.filter.call(this, row);\n  }\n\n  group(row: IDataRow) {\n    return CategoricalColumn.prototype.group.call(this, row);\n  }\n\n  getFilter() {\n    return this.currentFilter;\n  }\n\n  setFilter(filter: ICategoricalFilter | null) {\n    return CategoricalColumn.prototype.setFilter.call(this, filter);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return CategoricalColumn.prototype.compare.call(this, a, b);\n  }\n\n  getRenderer(): string {\n    return NumberColumn.prototype.getRenderer.call(this);\n  }\n}\n","import {ICategoricalStatistics, IStatistics} from '../internal';\r\nimport {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport {\r\n  default as IRenderContext, ERenderMode, ICellRenderer, ICellRendererFactory, IGroupCellRenderer,\r\n  IImposer\r\n} from './interfaces';\r\nimport {noRenderer} from './utils';\r\n\r\n/**\r\n * helper class that renders a group renderer as a selected (e.g. median) single item\r\n * @internal\r\n */\r\nexport abstract class AAggregatedGroupRenderer<T extends Column> implements ICellRendererFactory {\r\n  abstract readonly title: string;\r\n\r\n  abstract canRender(col: Column, mode: ERenderMode): boolean;\r\n\r\n  abstract create(col: T, context: IRenderContext, hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer): ICellRenderer;\r\n\r\n  protected abstract aggregatedIndex(rows: IDataRow[], col: T): number;\r\n\r\n  createGroup(col: T, context: IRenderContext, hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer): IGroupCellRenderer {\r\n    const single = this.create(col, context, hist, imposer);\r\n    return {\r\n      template: `<div>${single.template}</div>`,\r\n      update: (node: HTMLElement, group: IGroup, rows: IDataRow[]) => {\r\n        const aggregate = this.aggregatedIndex(rows, col);\r\n        single.update(<HTMLElement>node.firstElementChild!, rows[aggregate], aggregate, group);\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary() {\r\n    return noRenderer;\r\n  }\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport default AAggregatedGroupRenderer;\r\n","import {ICategoricalStatistics, IStatistics, round} from '../internal';\r\nimport {IDataRow, IGroup, IMultiLevelColumn, isMultiLevelColumn} from '../model';\r\nimport Column from '../model/Column';\r\nimport {medianIndex} from '../model/internal';\r\nimport {default as INumberColumn, isNumberColumn} from '../model/INumberColumn';\r\nimport {COLUMN_PADDING} from '../styles';\r\nimport {AAggregatedGroupRenderer} from './AAggregatedGroupRenderer';\r\nimport {default as IRenderContext, ERenderMode, ICellRendererFactory, IImposer} from './interfaces';\r\nimport {renderMissingCanvas, renderMissingDOM} from './missing';\r\nimport {matchColumns} from './utils';\r\n\r\n/** @internal */\r\nexport function gridClass(column: Column) {\r\n  return `lu-stacked-${column.id}`;\r\n}\r\n\r\n/** @internal */\r\nexport function createData(col: { children: Column[] } & Column, context: IRenderContext, stacked: boolean, mode: ERenderMode, imposer?: IImposer) {\r\n  const padding = COLUMN_PADDING;\r\n  let offset = 0;\r\n  const cols = col.children.map((d) => {\r\n    const shift = offset;\r\n    const width = d.getWidth();\r\n    offset += width;\r\n    offset += (!stacked ? padding : 0);\r\n\r\n    const renderer = mode === ERenderMode.CELL ? context.renderer(d, imposer) : null;\r\n    const groupRenderer = mode === ERenderMode.GROUP ? context.groupRenderer(d, imposer) : null;\r\n    const summaryRenderer = mode === ERenderMode.GROUP ? context.summaryRenderer(d, false, imposer) : null;\r\n    let template: string = '';\r\n    let rendererId: string = '';\r\n    switch (mode) {\r\n      case ERenderMode.CELL:\r\n        template = renderer!.template;\r\n        rendererId = col.getRenderer();\r\n        break;\r\n      case ERenderMode.GROUP:\r\n        template = groupRenderer!.template;\r\n        rendererId = col.getGroupRenderer();\r\n        break;\r\n      case ERenderMode.SUMMARY:\r\n        template = summaryRenderer!.template;\r\n        rendererId = col.getSummaryRenderer();\r\n        break;\r\n    }\r\n    // inject data attributes\r\n    template = template.replace(/^<([^ >]+)([ >])/, `<$1 data-column-id=\"${d.id}\" data-renderer=\"${rendererId}\"$2`);\r\n    return {\r\n      column: d,\r\n      shift,\r\n      width,\r\n      template,\r\n      rendererId,\r\n      renderer,\r\n      groupRenderer,\r\n      summaryRenderer\r\n    };\r\n  });\r\n  return {cols, stacked, padding};\r\n}\r\n\r\n/** @internal */\r\nexport default class MultiLevelCellRenderer extends AAggregatedGroupRenderer<IMultiLevelColumn & Column> implements ICellRendererFactory {\r\n  readonly title: string;\r\n\r\n  constructor(private readonly stacked: boolean = true) {\r\n    super();\r\n    this.title = this.stacked ? 'Stacked Bar' : 'Nested';\r\n  }\r\n\r\n  canRender(col: Column, mode: ERenderMode) {\r\n    return isMultiLevelColumn(col) && mode !== ERenderMode.SUMMARY;\r\n  }\r\n\r\n  create(col: IMultiLevelColumn & Column, context: IRenderContext, _hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    const {cols, stacked, padding} = createData(col, context, this.stacked, ERenderMode.CELL, imposer);\r\n    const useGrid = context.option('useGridLayout', false);\r\n    const width = context.colWidth(col);\r\n    return {\r\n      template: `<div class='${useGrid ? gridClass(col) : ''}${useGrid && !stacked ? ' lu-grid-space' : ''}'>${cols.map((d) => d.template).join('')}</div>`,\r\n      update: (n: HTMLDivElement, d: IDataRow, i: number, group: IGroup) => {\r\n        if (renderMissingDOM(n, col, d)) {\r\n          return;\r\n        }\r\n        matchColumns(n, cols);\r\n\r\n        const children = <HTMLElement[]>Array.from(n.children);\r\n        const total = col.getWidth();\r\n        let missingWeight = 0;\r\n        cols.forEach((col, ci) => {\r\n          const weight = col.column.getWidth() / total;\r\n          const cnode = children[ci];\r\n          cnode.style.transform = stacked ? `translate(-${round((missingWeight / weight) * 100, 4)}%,0)` : '';\r\n          if (!useGrid) {\r\n            cnode.style.width = `${round(weight * 100, 2)}%`;\r\n            cnode.style.marginRight = stacked ? null : `${padding}px`;\r\n          } else {\r\n            (<any>cnode.style).gridColumnStart = (ci + 1).toString();\r\n          }\r\n          col.renderer!.update(cnode, d, i, group);\r\n          if (stacked) {\r\n            missingWeight += (1 - col.column.getValue(d)) * weight;\r\n          }\r\n        });\r\n      },\r\n      render: (ctx: CanvasRenderingContext2D, d: IDataRow, i: number, group: IGroup) => {\r\n        if (renderMissingCanvas(ctx, col, d, width)) {\r\n          return;\r\n        }\r\n        let stackShift = 0;\r\n        cols.forEach((col) => {\r\n          const shift = col.shift - stackShift;\r\n          ctx.translate(shift, 0);\r\n          col.renderer!.render(ctx, d, i, group);\r\n          ctx.translate(-shift, 0);\r\n          if (stacked) {\r\n            stackShift += col.width * (1 - col.column.getValue(d));\r\n          }\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n\r\n  createGroup(col: IMultiLevelColumn & Column, context: IRenderContext, hist: IStatistics | ICategoricalStatistics | null, imposer?: IImposer) {\r\n    if (this.stacked && isNumberColumn(col)) {\r\n      return super.createGroup(col, context, hist, imposer);\r\n    }\r\n\r\n    const {cols, padding} = createData(col, context, false, ERenderMode.GROUP, imposer);\r\n    const useGrid = context.option('useGridLayout', false);\r\n    return {\r\n      template: `<div class='${useGrid ? gridClass(col) : ''}${useGrid ? ' lu-grid-space' : ''}'>${cols.map((d) => d.template).join('')}</div>`,\r\n      update: (n: HTMLElement, group: IGroup, rows: IDataRow[]) => {\r\n        matchColumns(n, cols);\r\n\r\n        const children = <HTMLElement[]>Array.from(n.children);\r\n        const total = col.getWidth();\r\n        cols.forEach((col, ci) => {\r\n          const weight = col.column.getWidth() / total;\r\n          const cnode = children[ci];\r\n          if (!useGrid) {\r\n            cnode.style.width = `${round(weight * 100, 2)}%`;\r\n            cnode.style.marginRight = `${padding}px`;\r\n          } else {\r\n            (<any>cnode.style).gridColumnStart = (ci + 1).toString();\r\n          }\r\n          col.groupRenderer!.update(cnode, group, rows);\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  protected aggregatedIndex(rows: IDataRow[], col: IMultiLevelColumn & Column) {\r\n    console.assert(isNumberColumn(col));\r\n    return medianIndex(rows, (<INumberColumn><any>col));\r\n  }\r\n}\r\n","export function initRange(domain, range) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.range(domain); break;\n    default: this.range(range).domain(domain); break;\n  }\n  return this;\n}\n\nexport function initInterpolator(domain, interpolator) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.interpolator(domain); break;\n    default: this.interpolator(interpolator).domain(domain); break;\n  }\n  return this;\n}\n","export var prefix = \"$\";\n\nfunction Map() {}\n\nMap.prototype = map.prototype = {\n  constructor: Map,\n  has: function(key) {\n    return (prefix + key) in this;\n  },\n  get: function(key) {\n    return this[prefix + key];\n  },\n  set: function(key, value) {\n    this[prefix + key] = value;\n    return this;\n  },\n  remove: function(key) {\n    var property = prefix + key;\n    return property in this && delete this[property];\n  },\n  clear: function() {\n    for (var property in this) if (property[0] === prefix) delete this[property];\n  },\n  keys: function() {\n    var keys = [];\n    for (var property in this) if (property[0] === prefix) keys.push(property.slice(1));\n    return keys;\n  },\n  values: function() {\n    var values = [];\n    for (var property in this) if (property[0] === prefix) values.push(this[property]);\n    return values;\n  },\n  entries: function() {\n    var entries = [];\n    for (var property in this) if (property[0] === prefix) entries.push({key: property.slice(1), value: this[property]});\n    return entries;\n  },\n  size: function() {\n    var size = 0;\n    for (var property in this) if (property[0] === prefix) ++size;\n    return size;\n  },\n  empty: function() {\n    for (var property in this) if (property[0] === prefix) return false;\n    return true;\n  },\n  each: function(f) {\n    for (var property in this) if (property[0] === prefix) f(this[property], property.slice(1), this);\n  }\n};\n\nfunction map(object, f) {\n  var map = new Map;\n\n  // Copy constructor.\n  if (object instanceof Map) object.each(function(value, key) { map.set(key, value); });\n\n  // Index array by numeric index or specified key function.\n  else if (Array.isArray(object)) {\n    var i = -1,\n        n = object.length,\n        o;\n\n    if (f == null) while (++i < n) map.set(i, object[i]);\n    else while (++i < n) map.set(f(o = object[i], i, object), o);\n  }\n\n  // Convert object to map.\n  else if (object) for (var key in object) map.set(key, object[key]);\n\n  return map;\n}\n\nexport default map;\n","import {default as map, prefix} from \"./map\";\n\nfunction Set() {}\n\nvar proto = map.prototype;\n\nSet.prototype = set.prototype = {\n  constructor: Set,\n  has: proto.has,\n  add: function(value) {\n    value += \"\";\n    this[prefix + value] = value;\n    return this;\n  },\n  remove: proto.remove,\n  clear: proto.clear,\n  values: proto.keys,\n  size: proto.size,\n  empty: proto.empty,\n  each: proto.each\n};\n\nfunction set(object, f) {\n  var set = new Set;\n\n  // Copy constructor.\n  if (object instanceof Set) object.each(function(value) { set.add(value); });\n\n  // Otherwise, assume its an array.\n  else if (object) {\n    var i = -1, n = object.length;\n    if (f == null) while (++i < n) set.add(object[i]);\n    else while (++i < n) set.add(f(object[i], i, object));\n  }\n\n  return set;\n}\n\nexport default set;\n","var array = Array.prototype;\n\nexport var map = array.map;\nexport var slice = array.slice;\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function(x) {\n  return +x;\n}\n","import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateNumber, interpolateRound} from \"d3-interpolate\";\nimport {map, slice} from \"./array\";\nimport constant from \"./constant\";\nimport number from \"./number\";\n\nvar unit = [0, 1];\n\nexport function identity(x) {\n  return x;\n}\n\nfunction normalize(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(isNaN(b) ? NaN : 0.5);\n}\n\nfunction clamper(domain) {\n  var a = domain[0], b = domain[domain.length - 1], t;\n  if (a > b) t = a, a = b, b = t;\n  return function(x) { return Math.max(a, Math.min(b, x)); };\n}\n\n// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].\nfunction bimap(domain, range, interpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);\n  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, interpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = normalize(domain[i], domain[i + 1]);\n    r[i] = interpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp())\n      .unknown(source.unknown());\n}\n\nexport function transformer() {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      transform,\n      untransform,\n      unknown,\n      clamp = identity,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    piecewise = Math.min(domain.length, range.length) > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n  }\n\n  scale.invert = function(y) {\n    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = map.call(_, number), clamp === identity || (clamp = clamper(domain)), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = slice.call(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = slice.call(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = _ ? clamper(domain) : identity, scale) : clamp !== identity;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  return function(t, u) {\n    transform = t, untransform = u;\n    return rescale();\n  };\n}\n\nexport default function continuous(transform, untransform) {\n  return transformer()(transform, untransform);\n}\n","import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function(start, stop, count, specifier) {\n  var step = tickStep(start, stop, count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n","import {ticks, tickIncrement} from \"d3-array\";\nimport continuous, {copy, identity} from \"./continuous\";\nimport {initRange} from \"./init\";\nimport tickFormat from \"./tickFormat\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    var d = domain();\n    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain(),\n        i0 = 0,\n        i1 = d.length - 1,\n        start = d[i0],\n        stop = d[i1],\n        step;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n\n    step = tickIncrement(start, stop, count);\n\n    if (step > 0) {\n      start = Math.floor(start / step) * step;\n      stop = Math.ceil(stop / step) * step;\n      step = tickIncrement(start, stop, count);\n    } else if (step < 0) {\n      start = Math.ceil(start * step) / step;\n      stop = Math.floor(stop * step) / step;\n      step = tickIncrement(start, stop, count);\n    }\n\n    if (step > 0) {\n      d[i0] = Math.floor(start / step) * step;\n      d[i1] = Math.ceil(stop / step) * step;\n      domain(d);\n    } else if (step < 0) {\n      d[i0] = Math.ceil(start * step) / step;\n      d[i1] = Math.floor(stop * step) / step;\n      domain(d);\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous(identity, identity);\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n","export default function(domain, interval) {\n  domain = domain.slice();\n\n  var i0 = 0,\n      i1 = domain.length - 1,\n      x0 = domain[i0],\n      x1 = domain[i1],\n      t;\n\n  if (x1 < x0) {\n    t = i0, i0 = i1, i1 = t;\n    t = x0, x0 = x1, x1 = t;\n  }\n\n  domain[i0] = interval.floor(x0);\n  domain[i1] = interval.ceil(x1);\n  return domain;\n}\n","import {ticks} from \"d3-array\";\nimport {format} from \"d3-format\";\nimport nice from \"./nice\";\nimport {copy, transformer} from \"./continuous\";\nimport {initRange} from \"./init\";\n\nfunction transformLog(x) {\n  return Math.log(x);\n}\n\nfunction transformExp(x) {\n  return Math.exp(x);\n}\n\nfunction transformLogn(x) {\n  return -Math.log(-x);\n}\n\nfunction transformExpn(x) {\n  return -Math.exp(-x);\n}\n\nfunction pow10(x) {\n  return isFinite(x) ? +(\"1e\" + x) : x < 0 ? 0 : x;\n}\n\nfunction powp(base) {\n  return base === 10 ? pow10\n      : base === Math.E ? Math.exp\n      : function(x) { return Math.pow(base, x); };\n}\n\nfunction logp(base) {\n  return base === Math.E ? Math.log\n      : base === 10 && Math.log10\n      || base === 2 && Math.log2\n      || (base = Math.log(base), function(x) { return Math.log(x) / base; });\n}\n\nfunction reflect(f) {\n  return function(x) {\n    return -f(-x);\n  };\n}\n\nexport function loggish(transform) {\n  var scale = transform(transformLog, transformExp),\n      domain = scale.domain,\n      base = 10,\n      logs,\n      pows;\n\n  function rescale() {\n    logs = logp(base), pows = powp(base);\n    if (domain()[0] < 0) {\n      logs = reflect(logs), pows = reflect(pows);\n      transform(transformLogn, transformExpn);\n    } else {\n      transform(transformLog, transformExp);\n    }\n    return scale;\n  }\n\n  scale.base = function(_) {\n    return arguments.length ? (base = +_, rescale()) : base;\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain(_), rescale()) : domain();\n  };\n\n  scale.ticks = function(count) {\n    var d = domain(),\n        u = d[0],\n        v = d[d.length - 1],\n        r;\n\n    if (r = v < u) i = u, u = v, v = i;\n\n    var i = logs(u),\n        j = logs(v),\n        p,\n        k,\n        t,\n        n = count == null ? 10 : +count,\n        z = [];\n\n    if (!(base % 1) && j - i < n) {\n      i = Math.round(i) - 1, j = Math.round(j) + 1;\n      if (u > 0) for (; i < j; ++i) {\n        for (k = 1, p = pows(i); k < base; ++k) {\n          t = p * k;\n          if (t < u) continue;\n          if (t > v) break;\n          z.push(t);\n        }\n      } else for (; i < j; ++i) {\n        for (k = base - 1, p = pows(i); k >= 1; --k) {\n          t = p * k;\n          if (t < u) continue;\n          if (t > v) break;\n          z.push(t);\n        }\n      }\n    } else {\n      z = ticks(i, j, Math.min(j - i, n)).map(pows);\n    }\n\n    return r ? z.reverse() : z;\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    if (specifier == null) specifier = base === 10 ? \".0e\" : \",\";\n    if (typeof specifier !== \"function\") specifier = format(specifier);\n    if (count === Infinity) return specifier;\n    if (count == null) count = 10;\n    var k = Math.max(1, base * count / scale.ticks().length); // TODO fast estimate?\n    return function(d) {\n      var i = d / pows(Math.round(logs(d)));\n      if (i * base < base - 0.5) i *= base;\n      return i <= k ? specifier(d) : \"\";\n    };\n  };\n\n  scale.nice = function() {\n    return domain(nice(domain(), {\n      floor: function(x) { return pows(Math.floor(logs(x))); },\n      ceil: function(x) { return pows(Math.ceil(logs(x))); }\n    }));\n  };\n\n  return scale;\n}\n\nexport default function log() {\n  var scale = loggish(transformer()).domain([1, 10]);\n\n  scale.copy = function() {\n    return copy(scale, log()).base(scale.base());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n","import {linearish} from \"./linear\";\nimport {copy, identity, transformer} from \"./continuous\";\nimport {initRange} from \"./init\";\n\nfunction transformPow(exponent) {\n  return function(x) {\n    return x < 0 ? -Math.pow(-x, exponent) : Math.pow(x, exponent);\n  };\n}\n\nfunction transformSqrt(x) {\n  return x < 0 ? -Math.sqrt(-x) : Math.sqrt(x);\n}\n\nfunction transformSquare(x) {\n  return x < 0 ? -x * x : x * x;\n}\n\nexport function powish(transform) {\n  var scale = transform(identity, identity),\n      exponent = 1;\n\n  function rescale() {\n    return exponent === 1 ? transform(identity, identity)\n        : exponent === 0.5 ? transform(transformSqrt, transformSquare)\n        : transform(transformPow(exponent), transformPow(1 / exponent));\n  }\n\n  scale.exponent = function(_) {\n    return arguments.length ? (exponent = +_, rescale()) : exponent;\n  };\n\n  return linearish(scale);\n}\n\nexport default function pow() {\n  var scale = powish(transformer());\n\n  scale.copy = function() {\n    return copy(scale, pow()).exponent(scale.exponent());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n\nexport function sqrt() {\n  return pow.apply(null, arguments).exponent(0.5);\n}\n","export {\n  default as scaleBand,\n  point as scalePoint\n} from \"./band\";\n\nexport {\n  default as scaleIdentity\n} from \"./identity\";\n\nexport {\n  default as scaleLinear\n} from \"./linear\";\n\nexport {\n  default as scaleLog\n} from \"./log\";\n\nexport {\n  default as scaleSymlog\n} from \"./symlog\";\n\nexport {\n  default as scaleOrdinal,\n  implicit as scaleImplicit\n} from \"./ordinal\";\n\nexport {\n  default as scalePow,\n  sqrt as scaleSqrt\n} from \"./pow\";\n\nexport {\n  default as scaleQuantile\n} from \"./quantile\";\n\nexport {\n  default as scaleQuantize\n} from \"./quantize\";\n\nexport {\n  default as scaleThreshold\n} from \"./threshold\";\n\nexport {\n  default as scaleTime\n} from \"./time\";\n\nexport {\n  default as scaleUtc\n} from \"./utcTime\";\n\nexport {\n  default as scaleSequential,\n  sequentialLog as scaleSequentialLog,\n  sequentialPow as scaleSequentialPow,\n  sequentialSqrt as scaleSequentialSqrt,\n  sequentialSymlog as scaleSequentialSymlog\n} from \"./sequential\";\n\nexport {\n  default as scaleSequentialQuantile\n} from \"./sequentialQuantile\";\n\nexport {\n  default as scaleDiverging,\n  divergingLog as scaleDivergingLog,\n  divergingPow as scaleDivergingPow,\n  divergingSqrt as scaleDivergingSqrt,\n  divergingSymlog as scaleDivergingSymlog\n} from \"./diverging\";\n\nexport {\n  default as tickFormat\n} from \"./tickFormat\";\n","import {Category, toolbar} from './annotations';\nimport CategoricalColumn from './CategoricalColumn';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {IValueColumnDesc, dataLoaded} from './ValueColumn';\nimport {ICategoricalColumn, ICategory} from './ICategoricalColumn';\nimport {IDataRow} from './interfaces';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nexport interface IBooleanDesc {\n  /**\n   * string to show for true\n   * @default \n   */\n  trueMarker?: string;\n  /**\n   * strint to show for false\n   * @default (empty)\n   */\n  falseMarker?: string;\n}\n\nexport declare type IBooleanColumnDesc = IValueColumnDesc<boolean> & IBooleanDesc;\n\n\n/**\n * emitted when the filter property changes\n * @asMemberOf BooleanColumn\n * @event\n */\nexport declare function filterChanged(previous: boolean | null, current: boolean | null): void;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('group', 'groupBy', 'filterBoolean')\n@Category('categorical')\nexport default class BooleanColumn extends ValueColumn<boolean> implements ICategoricalColumn {\n  static readonly EVENT_FILTER_CHANGED = 'filterChanged';\n\n  static readonly GROUP_TRUE = {name: 'True', color: 'black'};\n  static readonly GROUP_FALSE = {name: 'False', color: 'white'};\n\n  private currentFilter: boolean | null = null;\n  readonly categories: ICategory[];\n\n  constructor(id: string, desc: Readonly<IBooleanColumnDesc>) {\n    super(id, desc);\n    this.setWidthImpl(30);\n    this.categories = [\n      {\n        name: desc.trueMarker || '',\n        color: BooleanColumn.GROUP_TRUE.color,\n        label: BooleanColumn.GROUP_TRUE.name,\n        value: 0\n      },\n      {\n        name: desc.trueMarker || '',\n        color: BooleanColumn.GROUP_FALSE.color,\n        label: BooleanColumn.GROUP_FALSE.name,\n        value: 1\n      }\n    ];\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([BooleanColumn.EVENT_FILTER_CHANGED]);\n  }\n\n  on(type: typeof BooleanColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n\n  get dataLength() {\n    return this.categories.length;\n  }\n\n  get labels() {\n    return this.categories.map((d) => d.label);\n  }\n\n  getValue(row: IDataRow) {\n    const v: any = super.getValue(row);\n    if (typeof(v) === 'undefined' || v == null) {\n      return false;\n    }\n    return v === true || v === 'true' || v === 'yes' || v === 'x';\n  }\n\n  isMissing() {\n    return false;\n  }\n\n  getCategory(row: IDataRow) {\n    const v = this.getValue(row);\n    return this.categories[v ? 0 : 1];\n  }\n\n  getColor(row: IDataRow) {\n    return CategoricalColumn.prototype.getColor.call(this, row);\n  }\n\n  getLabel(row: IDataRow) {\n    return CategoricalColumn.prototype.getLabel.call(this, row);\n  }\n\n  getLabels(row: IDataRow) {\n    return CategoricalColumn.prototype.getLabels.call(this, row);\n  }\n\n  getValues(row: IDataRow) {\n    return CategoricalColumn.prototype.getValues.call(this, row);\n  }\n\n  getMap(row: IDataRow) {\n    return CategoricalColumn.prototype.getMap.call(this, row);\n  }\n\n  getMapLabel(row: IDataRow) {\n    return CategoricalColumn.prototype.getMapLabel.call(this, row);\n  }\n\n  getSet(row: IDataRow) {\n    const v = this.getValue(row);\n    const r = new Set<ICategory>();\n    r.add(this.categories[v ? 0 : 1]);\n    return r;\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    if (this.currentFilter != null) {\n      r.filter = this.currentFilter;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (typeof dump.filter !== 'undefined') {\n      this.currentFilter = dump.filter;\n    }\n  }\n\n  isFiltered() {\n    return this.currentFilter != null;\n  }\n\n  filter(row: IDataRow) {\n    if (!this.isFiltered()) {\n      return true;\n    }\n    const r = this.getValue(row);\n    return r === this.currentFilter;\n  }\n\n  getFilter() {\n    return this.currentFilter;\n  }\n\n  setFilter(filter: boolean | null) {\n    if (this.currentFilter === filter) {\n      return;\n    }\n    this.fire([BooleanColumn.EVENT_FILTER_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.currentFilter, this.currentFilter = filter);\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    const av = this.getValue(a);\n    const bv = this.getValue(b);\n    return av === bv ? 0 : (av < bv ? -1 : +1);\n  }\n\n  group(row: IDataRow) {\n    const enabled = this.getValue(row);\n    return enabled ? BooleanColumn.GROUP_TRUE : BooleanColumn.GROUP_FALSE;\n  }\n}\n","import {IBoxPlotData} from '../internal';\nimport {suffix, IEventListener} from '../internal/AEventDispatcher';\nimport {toolbar, SortByDefault, dialogAddons} from './annotations';\nimport BoxPlotColumn, {mappingChanged} from './BoxPlotColumn';\nimport Column, {IColumnDesc, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport {IDataRow, IGroupData} from './interfaces';\nimport {ESortMethod, IBoxPlotColumn, INumberFilter, isBoxPlotColumn, noNumberFilter} from './INumberColumn';\nimport {IMappingFunction, ScaleMappingFunction, isMapAbleColumn} from './MappingFunction';\nimport NumbersColumn from './NumbersColumn';\nimport {colorMappingChanged} from './NumberColumn';\nimport {DEFAULT_COLOR_FUNCTION, IColorMappingFunction} from './ColorMappingFunction';\n\n\n/**\n *  factory for creating a description creating a max column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createImpositionBoxPlotDesc(label: string = 'Imposition') {\n  return {type: 'impositions', label};\n}\n\n/**\n * implementation of a combine column, standard operations how to select\n */\n@toolbar('filterNumber', 'colorMapped', 'editMapping')\n@dialogAddons('sort', 'sortBoxPlot')\n@SortByDefault('descending')\nexport default class ImpositionBoxPlotColumn extends CompositeColumn implements IBoxPlotColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumbersColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_COLOR_MAPPING_CHANGED = NumbersColumn.EVENT_COLOR_MAPPING_CHANGED;\n\n  constructor(id: string, desc: Readonly<IColumnDesc>) {\n    super(id, desc);\n\n    this.setDefaultRenderer('boxplot');\n    this.setDefaultGroupRenderer('boxplot');\n  }\n\n  get label() {\n    const l = super.getMetaData().label;\n    const c = this._children;\n    if (l !== 'Imposition' || c.length === 0) {\n      return l;\n    }\n    if (c.length === 1) {\n      return c[0].label;\n    }\n    return `${c[0].label} (${c.slice(1).map((c) => c.label).join(', ')})`;\n  }\n\n  private get wrapper(): IBoxPlotColumn | null {\n    const c = this._children;\n    return c.length === 0 ? null : <IBoxPlotColumn>c[0];\n  }\n\n  getLabel(row: IDataRow) {\n    const c = this._children;\n    if (c.length === 0) {\n      return '';\n    }\n    if (c.length === 1) {\n      return c[0].getLabel(row);\n    }\n    return `${c[0].getLabel(row)} (${c.slice(1).map((c) => `${c.label} = ${c.getLabel(row)}`)})`;\n  }\n\n  getColor(row: IDataRow) {\n    const c = this._children;\n    switch(c.length) {\n      case 0:\n        return Column.DEFAULT_COLOR;\n      case 1:\n        return c[0].getColor(row);\n      default:\n        return c[1].getColor(row);\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ImpositionBoxPlotColumn.EVENT_MAPPING_CHANGED, ImpositionBoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED]);\n  }\n\n  on(type: typeof ImpositionBoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof ImpositionBoxPlotColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getValue(row) : null;\n  }\n\n  getNumber(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getNumber(row) : NaN;\n  }\n\n  getRawNumber(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getRawNumber(row) : NaN;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      if (this.isMissing(row)) {\n        return null;\n      }\n      return {\n        label: this.getLabel(row),\n        color: this.getColor(row),\n        value: this.getRawNumber(row)\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n\n  getBoxPlotData(row: IDataRow): IBoxPlotData | null {\n    const w = this.wrapper;\n    return w ? w.getBoxPlotData(row) : null;\n  }\n\n  getRawBoxPlotData(row: IDataRow): IBoxPlotData | null {\n    const w = this.wrapper;\n    return w ? w.getRawBoxPlotData(row) : null;\n  }\n\n  getMapping() {\n    const w = this.wrapper;\n    return w ? w.getMapping() : new ScaleMappingFunction();\n  }\n\n  getOriginalMapping() {\n    const w = this.wrapper;\n    return w ? w.getOriginalMapping() : new ScaleMappingFunction();\n  }\n\n  getSortMethod() {\n    const w = this.wrapper;\n    return w ? w.getSortMethod() : ESortMethod.min;\n  }\n\n  setSortMethod(value: ESortMethod) {\n    const w = this.wrapper;\n    return w ? w.setSortMethod(value) : undefined;\n  }\n\n  isMissing(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.isMissing(row) : true;\n  }\n\n  setMapping(mapping: IMappingFunction): void {\n    const w = this.wrapper;\n    return w ? w.setMapping(mapping) : undefined;\n  }\n\n  getColorMapping() {\n    const w = this.wrapper;\n    return w ? w.getColorMapping() : DEFAULT_COLOR_FUNCTION;\n  }\n\n  setColorMapping(mapping: IColorMappingFunction) {\n    const w = this.wrapper;\n    return w ? w.setColorMapping(mapping) : undefined;\n  }\n\n  getFilter() {\n    const w = this.wrapper;\n    return w ? w.getFilter() : noNumberFilter();\n  }\n\n  setFilter(value?: INumberFilter): void {\n    const w = this.wrapper;\n    return w ? w.setFilter(value) : undefined;\n  }\n\n  getRange(): [string, string] {\n    const w = this.wrapper;\n    return w ? w.getRange() : ['0', '1'];\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return BoxPlotColumn.prototype.compare.call(this, a, b);\n  }\n\n  group(row: IDataRow) {\n    return BoxPlotColumn.prototype.group.call(this, row);\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData) {\n    return BoxPlotColumn.prototype.groupCompare.call(this, a, b);\n  }\n\n  insert(col: Column, index: number): Column | null {\n    if (this._children.length === 0 && !isBoxPlotColumn(col)) {\n      return null;\n    }\n    if (this._children.length >= 2) {\n      // limit to two\n      return null;\n    }\n    return super.insert(col, index);\n  }\n\n  protected insertImpl(col: Column, index: number) {\n    if (isBoxPlotColumn(col)) {\n      this.forward(col, ...suffix('.impose', BoxPlotColumn.EVENT_MAPPING_CHANGED, BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    if (isMapAbleColumn(col)) {\n      this.forward(col, ...suffix('.impose', BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    return super.insertImpl(col, index);\n  }\n\n  protected removeImpl(child: Column, index: number) {\n    if (isBoxPlotColumn(child)) {\n      this.unforward(child, ...suffix('.impose', BoxPlotColumn.EVENT_MAPPING_CHANGED, BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    if (isMapAbleColumn(child)) {\n      this.unforward(child, ...suffix('.impose', BoxPlotColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    return super.removeImpl(child, index);\n  }\n}\n","import {suffix, IEventListener} from '../internal/AEventDispatcher';\nimport {toolbar, SortByDefault} from './annotations';\nimport Column, {IColumnDesc, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport {IDataRow, IGroupData} from './interfaces';\nimport {isNumberColumn} from './INumberColumn';\nimport NumberColumn, {INumberColumn, mappingChanged, colorMappingChanged} from './NumberColumn';\nimport {isMapAbleColumn} from './MappingFunction';\n\n\n/**\n *  factory for creating a description creating a max column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createImpositionDesc(label: string = 'Imposition') {\n  return {type: 'imposition', label};\n}\n\n/**\n * implementation of a combine column, standard operations how to select\n */\n@toolbar('filterNumber', 'colorMapped', 'editMapping')\n@SortByDefault('descending')\nexport default class ImpositionCompositeColumn extends CompositeColumn implements INumberColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumberColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_COLOR_MAPPING_CHANGED = NumberColumn.EVENT_COLOR_MAPPING_CHANGED;\n\n  constructor(id: string, desc: Readonly<IColumnDesc>) {\n    super(id, desc);\n\n    this.setDefaultRenderer('number');\n    this.setDefaultGroupRenderer('boxplot');\n  }\n\n  get label() {\n    const l = super.getMetaData().label;\n    const c = this._children;\n    if (l !== 'Imposition' || c.length === 0) {\n      return l;\n    }\n    if (c.length === 1) {\n      return c[0].label;\n    }\n    return `${c[0].label} (${c.slice(1).map((c) => c.label).join(', ')})`;\n  }\n\n  private get wrapper(): INumberColumn | null {\n    const c = this._children;\n    return c.length === 0 ? null : <INumberColumn>c[0];\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ImpositionCompositeColumn.EVENT_MAPPING_CHANGED, ImpositionCompositeColumn.EVENT_COLOR_MAPPING_CHANGED]);\n  }\n\n  on(type: typeof ImpositionCompositeColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof ImpositionCompositeColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  getLabel(row: IDataRow) {\n    const c = this._children;\n    if (c.length === 0) {\n      return '';\n    }\n    if (c.length === 1) {\n      return c[0].getLabel(row);\n    }\n    return `${c[0].getLabel(row)} (${c.slice(1).map((c) => `${c.label} = ${c.getLabel(row)}`).join(', ')})`;\n  }\n\n  getColor(row: IDataRow) {\n    const c = this._children;\n    switch(c.length) {\n      case 0:\n        return Column.DEFAULT_COLOR;\n      case 1:\n        return c[0].getColor(row);\n      default:\n        return c[1].getColor(row);\n    }\n  }\n\n  getValue(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getValue(row) : NaN;\n  }\n\n  getNumber(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getNumber(row) : NaN;\n  }\n\n  getRawNumber(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getRawNumber(row) : NaN;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      if (this.isMissing(row)) {\n        return null;\n      }\n      return {\n        label: this.getLabel(row),\n        color: this.getColor(row),\n        value: this.getRawNumber(row)\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n\n  isMissing(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.isMissing(row) : true;\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return NumberColumn.prototype.compare.call(this, a, b);\n  }\n\n  group(row: IDataRow) {\n    return NumberColumn.prototype.group.call(this, row);\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData) {\n    return NumberColumn.prototype.groupCompare.call(this, a, b);\n  }\n\n  insert(col: Column, index: number): Column | null {\n    if (this._children.length === 0 && !isNumberColumn(col)) {\n      return null;\n    }\n    if (this._children.length >= 2) {\n      // limit to two\n      return null;\n    }\n    return super.insert(col, index);\n  }\n\n  protected insertImpl(col: Column, index: number) {\n    if (isNumberColumn(col)) {\n      this.forward(col, ...suffix('.impose', NumberColumn.EVENT_MAPPING_CHANGED));\n    }\n    if (isMapAbleColumn(col)) {\n      this.forward(col, ...suffix('.impose', NumberColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    return super.insertImpl(col, index);\n  }\n\n  protected removeImpl(child: Column, index: number) {\n    if (isNumberColumn(child)) {\n      this.unforward(child, ...suffix('.impose', NumberColumn.EVENT_MAPPING_CHANGED));\n    }\n    if (isMapAbleColumn(child)) {\n      this.unforward(child, ...suffix('.impose', NumberColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    return super.removeImpl(child, index);\n  }\n}\n","import {IAdvancedBoxPlotData} from '../internal';\nimport {suffix, IEventListener} from '../internal/AEventDispatcher';\nimport {toolbar, dialogAddons, SortByDefault} from './annotations';\nimport Column, {IColumnDesc, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport {IKeyValue} from './IArrayColumn';\nimport {IDataRow, IGroupData} from './interfaces';\nimport {EAdvancedSortMethod, INumberFilter, INumbersColumn, isNumbersColumn, noNumberFilter} from './INumberColumn';\nimport {IMappingFunction, ScaleMappingFunction, isMapAbleColumn} from './MappingFunction';\nimport NumbersColumn, {mappingChanged} from './NumbersColumn';\nimport {colorMappingChanged} from './NumberColumn';\nimport {DEFAULT_COLOR_FUNCTION, IColorMappingFunction} from './ColorMappingFunction';\n\n\n/**\n *  factory for creating a description creating a max column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createImpositionsDesc(label: string = 'Imposition') {\n  return {type: 'impositions', label};\n}\n\n/**\n * implementation of a combine column, standard operations how to select\n */\n@toolbar('filterNumber', 'colorMapped', 'editMapping')\n@dialogAddons('sort', 'sortNumbers')\n@SortByDefault('descending')\nexport default class ImpositionCompositesColumn extends CompositeColumn implements INumbersColumn {\n  static readonly EVENT_MAPPING_CHANGED = NumbersColumn.EVENT_MAPPING_CHANGED;\n  static readonly EVENT_COLOR_MAPPING_CHANGED = NumbersColumn.EVENT_COLOR_MAPPING_CHANGED;\n\n  constructor(id: string, desc: Readonly<IColumnDesc>) {\n    super(id, desc);\n\n    this.setDefaultRenderer('numbers');\n    this.setDefaultGroupRenderer('numbers');\n  }\n\n  get label() {\n    const l = super.getMetaData().label;\n    const c = this._children;\n    if (l !== 'Imposition' || c.length === 0) {\n      return l;\n    }\n    if (c.length === 1) {\n      return c[0].label;\n    }\n    return `${c[0].label} (${c.slice(1).map((c) => c.label).join(', ')})`;\n  }\n\n  private get wrapper(): INumbersColumn | null {\n    const c = this._children;\n    return c.length === 0 ? null : <INumbersColumn>c[0];\n  }\n\n  getLabel(row: IDataRow) {\n    const c = this._children;\n    if (c.length === 0) {\n      return '';\n    }\n    if (c.length === 1) {\n      return c[0].getLabel(row);\n    }\n    return `${c[0].getLabel(row)} (${c.slice(1).map((c) => `${c.label} = ${c.getLabel(row)}`)})`;\n  }\n\n  getColor(row: IDataRow) {\n    const c = this._children;\n    switch(c.length) {\n      case 0:\n        return Column.DEFAULT_COLOR;\n      case 1:\n        return c[0].getColor(row);\n      default:\n        return c[1].getColor(row);\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ImpositionCompositesColumn.EVENT_MAPPING_CHANGED, ImpositionCompositesColumn.EVENT_COLOR_MAPPING_CHANGED]);\n  }\n\n  on(type: typeof ImpositionCompositesColumn.EVENT_COLOR_MAPPING_CHANGED, listener: typeof colorMappingChanged | null): this;\n  on(type: typeof ImpositionCompositesColumn.EVENT_MAPPING_CHANGED, listener: typeof mappingChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  get labels() {\n    const w = this.wrapper;\n    return w ? w.labels : [];\n  }\n\n  get dataLength() {\n    const w = this.wrapper;\n    return w ? w.dataLength : null;\n  }\n\n  getValue(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getValue(row) : [];\n  }\n\n  getNumber(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getNumber(row) : NaN;\n  }\n\n  getRawNumber(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getRawNumber(row) : NaN;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      if (this.isMissing(row)) {\n        return null;\n      }\n      return {\n        label: this.getLabels(row),\n        color: this.getColor(row),\n        value: this.getRawNumbers(row)\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n\n  getNumbers(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getNumbers(row) : [];\n  }\n\n  getRawNumbers(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getRawNumbers(row) : [];\n  }\n\n  getBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null {\n    const w = this.wrapper;\n    return w ? w.getBoxPlotData(row) : null;\n  }\n\n  getRawBoxPlotData(row: IDataRow): IAdvancedBoxPlotData | null {\n    const w = this.wrapper;\n    return w ? w.getRawBoxPlotData(row) : null;\n  }\n\n  getMapping() {\n    const w = this.wrapper;\n    return w ? w.getMapping() : new ScaleMappingFunction();\n  }\n\n  getOriginalMapping() {\n    const w = this.wrapper;\n    return w ? w.getOriginalMapping() : new ScaleMappingFunction();\n  }\n\n  getSortMethod() {\n    const w = this.wrapper;\n    return w ? w.getSortMethod() : EAdvancedSortMethod.min;\n  }\n\n  setSortMethod(value: EAdvancedSortMethod) {\n    const w = this.wrapper;\n    return w ? w.setSortMethod(value) : undefined;\n  }\n\n  isMissing(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.isMissing(row) : true;\n  }\n\n  setMapping(mapping: IMappingFunction): void {\n    const w = this.wrapper;\n    return w ? w.setMapping(mapping) : undefined;\n  }\n\n  getColorMapping() {\n    const w = this.wrapper;\n    return w ? w.getColorMapping() : DEFAULT_COLOR_FUNCTION;\n  }\n\n  setColorMapping(mapping: IColorMappingFunction) {\n    const w = this.wrapper;\n    return w ? w.setColorMapping(mapping) : undefined;\n  }\n\n  getFilter() {\n    const w = this.wrapper;\n    return w ? w.getFilter() : noNumberFilter();\n  }\n\n  setFilter(value?: INumberFilter): void {\n    const w = this.wrapper;\n    return w ? w.setFilter(value) : undefined;\n  }\n\n  getRange(): [string, string] {\n    const w = this.wrapper;\n    return w ? w.getRange() : ['0', '1'];\n  }\n\n  getMap(row: IDataRow): IKeyValue<number>[] {\n    const w = this.wrapper;\n    return w ? w.getMap(row) : [];\n  }\n\n  getMapLabel(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getMapLabel(row) : [];\n  }\n\n  getLabels(row: IDataRow): string[] {\n    const w = this.wrapper;\n    return w ? w.getLabels(row) : [];\n  }\n\n  getValues(row: IDataRow) {\n    const w = this.wrapper;\n    return w ? w.getValues(row) : [];\n  }\n\n  compare(a: IDataRow, b: IDataRow) {\n    return NumbersColumn.prototype.compare.call(this, a, b);\n  }\n\n  group(row: IDataRow) {\n    return NumbersColumn.prototype.group.call(this, row);\n  }\n\n  groupCompare(a: IGroupData, b: IGroupData) {\n    return NumbersColumn.prototype.groupCompare.call(this, a, b);\n  }\n\n  insert(col: Column, index: number): Column | null {\n    if (this._children.length === 0 && !isNumbersColumn(col)) {\n      return null;\n    }\n    if (this._children.length >= 2) {\n      // limit to two\n      return null;\n    }\n    return super.insert(col, index);\n  }\n\n  protected insertImpl(col: Column, index: number) {\n    if (isNumbersColumn(col)) {\n      this.forward(col, ...suffix('.impose', NumbersColumn.EVENT_MAPPING_CHANGED));\n    }\n    if (isMapAbleColumn(col)) {\n      this.forward(col, ...suffix('.impose', NumbersColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    return super.insertImpl(col, index);\n  }\n\n  protected removeImpl(child: Column, index: number) {\n    if (isNumbersColumn(child)) {\n      this.unforward(child, ...suffix('.impose', NumbersColumn.EVENT_MAPPING_CHANGED));\n    }\n    if (isMapAbleColumn(child)) {\n      this.unforward(child, ...suffix('.impose', NumbersColumn.EVENT_COLOR_MAPPING_CHANGED));\n    }\n    return super.removeImpl(child, index);\n  }\n}\n","import {toolbar} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\nimport {IDataRow} from './interfaces';\nimport {patternFunction} from './internal';\nimport MapColumn, {IMapColumnDesc} from './MapColumn';\nimport LinkColumn, {ILinkDesc, patternChanged} from './LinkColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {EAlignment} from './StringColumn';\nimport {IKeyValue} from './IArrayColumn';\nimport {ILink} from './LinkColumn';\n\nexport declare type ILinkMapColumnDesc = ILinkDesc & IMapColumnDesc<string>;\n\n/**\n * a string column with optional alignment\n */\n@toolbar('search', 'editPattern')\nexport default class LinkMapColumn extends MapColumn<string> {\n  static readonly EVENT_PATTERN_CHANGED = LinkColumn.EVENT_PATTERN_CHANGED;\n\n  readonly alignment: EAlignment;\n  readonly escape: boolean;\n  private pattern: string;\n  private patternFunction: Function | null = null;\n  readonly patternTemplates: string[];\n\n  constructor(id: string, desc: Readonly<ILinkMapColumnDesc>) {\n    super(id, desc);\n    this.setDefaultWidth(200); //by default 200\n    this.alignment = <any>desc.alignment || EAlignment.left;\n    this.escape = desc.escape !== false;\n    this.pattern = desc.pattern || '';\n    this.patternTemplates = desc.patternTemplates || [];\n    this.setDefaultRenderer('map');\n  }\n\n  setPattern(pattern: string) {\n    LinkColumn.prototype.setPattern.call(this, pattern);\n  }\n\n  getPattern() {\n    return this.pattern;\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([LinkColumn.EVENT_PATTERN_CHANGED]);\n  }\n\n  on(type: typeof LinkColumn.EVENT_PATTERN_CHANGED, listener: typeof patternChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    return this.getLinkMap(row).map(({key, value}) => ({\n      key,\n      value: value ? value.href : ''\n    }));\n  }\n\n  getLabels(row: IDataRow) {\n    return this.getLinkMap(row).map(({key, value}) => ({\n      key,\n      value: value ? value.alt : ''\n    }));\n  }\n\n  getLinkMap(row: IDataRow): IKeyValue<ILink>[] {\n    return super.getValue(row).map(({key, value}) => ({\n      key,\n      value: this.transformValue(value, row, key)\n    }));\n  }\n\n  private transformValue(v: any, row: IDataRow, key: string) {\n    if (v == null || v === '') {\n      return null;\n    }\n    if (typeof v === 'string') {\n      if (!this.pattern) {\n        return {\n          alt: v,\n          href: v\n        };\n      }\n      if (!this.patternFunction) {\n        this.patternFunction = patternFunction(this.pattern, 'item', 'key');\n      }\n      return {\n        alt: v,\n        href: this.patternFunction.call(this, v, row.v, key)\n      };\n    }\n    return v;\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    if (this.pattern !== (<any>this.desc).pattern) {\n      r.pattern = this.pattern;\n    }\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    if (dump.pattern) {\n      this.pattern = dump.pattern;\n    }\n    super.restore(dump, factory);\n  }\n}\n","import {extent} from 'd3-array';\r\nimport {isNumberColumn, isSupportType} from '../model';\r\nimport {default as Column, IColumnDesc} from '../model/Column';\r\nimport {colorPool} from '../model/internal';\r\nimport Ranking from '../model/Ranking';\r\n\r\n\r\nexport interface IDeriveOptions {\r\n  /**\r\n   * maximal percentage of unique values to be treated as a categorical column\r\n   */\r\n  categoricalThreshold: number;\r\n\r\n  columns: string[];\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function cleanCategories(categories: Set<string>) {\r\n  // remove missing values\r\n  categories.delete(<any>null);\r\n  categories.delete(<any>undefined);\r\n  categories.delete('');\r\n  categories.delete('NA');\r\n  categories.delete('NaN');\r\n  categories.delete('na');\r\n\r\n  return Array.from(categories).map(String).sort();\r\n}\r\n\r\nfunction deriveType(label: string, value: any, column: number | string, data: any[], options: IDeriveOptions): IColumnDesc {\r\n  const base: any = {\r\n    type: 'string',\r\n    label,\r\n    column,\r\n  };\r\n  if (typeof value === 'number') {\r\n    base.type = 'number';\r\n    base.domain = extent(data, (d) => d[column]);\r\n    return base;\r\n  }\r\n  if (value && value instanceof Date) {\r\n    base.type = 'date';\r\n    return base;\r\n  }\r\n  if (typeof value === 'boolean') {\r\n    base.type = 'boolean';\r\n    return base;\r\n  }\r\n  if (typeof value === 'string') {\r\n    //maybe a categorical\r\n    const categories = new Set(data.map((d) => d[column]));\r\n    if (categories.size < data.length * options.categoricalThreshold) { // 70% unique guess categorical\r\n      base.type = 'categorical';\r\n      base.categories = cleanCategories(categories);\r\n    }\r\n    return base;\r\n  }\r\n  if (Array.isArray(value)) {\r\n    base.type = 'strings';\r\n    base.dataLength = value.length;\r\n    const vs = value[0];\r\n    if (typeof vs === 'number') {\r\n      base.type = 'numbers';\r\n      base.domain = extent((<number[]>[]).concat(...data.map((d) => d[column])));\r\n      return base;\r\n    }\r\n    if (vs && value instanceof Date) {\r\n      base.type = 'dates';\r\n      return base;\r\n    }\r\n    if (typeof value === 'boolean') {\r\n      base.type = 'booleans';\r\n      return base;\r\n    }\r\n    if (typeof value === 'string') {\r\n      //maybe a categorical\r\n      const categories = new Set((<string[]>[]).concat(...data.map((d) => d[column])));\r\n      if (categories.size < data.length * options.categoricalThreshold) { // 70% unique guess categorical\r\n        base.type = 'categoricals';\r\n        base.categories = cleanCategories(categories);\r\n      }\r\n      return base;\r\n    }\r\n  }\r\n  console.log('cannot infer type of column:', column);\r\n  //unknown type\r\n  return base;\r\n}\r\n\r\nexport function deriveColumnDescriptions(data: any[], options: Partial<IDeriveOptions> = {}) {\r\n  const config = Object.assign({\r\n    categoricalThreshold: 0.7,\r\n    columns: []\r\n  }, options);\r\n  const r: IColumnDesc[] = [];\r\n  if (data.length === 0) {\r\n    // no data to derive something from\r\n    return r;\r\n  }\r\n  const first = data[0];\r\n  if (Array.isArray(first)) {\r\n    //array of arrays\r\n    return first.map((v, i) => deriveType(`Col${i}`, v, i, data, config));\r\n  }\r\n  //objects\r\n  const columns = config.columns.length > 0 ? config.columns : Object.keys(first);\r\n  return columns.map((key) => deriveType(key, first[key], key, data, config));\r\n}\r\n\r\n\r\n/**\r\n * assigns colors to columns if they are numbers and not yet defined\r\n * @param columns\r\n * @returns {IColumnDesc[]}\r\n */\r\nexport function deriveColors(columns: IColumnDesc[]) {\r\n  const colors = colorPool();\r\n  columns.forEach((col: any) => {\r\n    switch (col.type) {\r\n      case 'number':\r\n        col.color = col.color || colors() || Column.DEFAULT_COLOR;\r\n        break;\r\n    }\r\n  });\r\n  return columns;\r\n}\r\n\r\n\r\nexport interface IExportOptions {\r\n  /**\r\n   * export separator, default: '\\t'\r\n   */\r\n  separator: string;\r\n  /**\r\n   * new line character, default: '\\n'\r\n   */\r\n  newline: string;\r\n  /**\r\n   * should a header be generated, default: true\r\n   */\r\n  header: boolean;\r\n  /**\r\n   * quote strings, default: false\r\n   */\r\n  quote: boolean;\r\n  /**\r\n   * quote string to use, default: '\"'\r\n   */\r\n  quoteChar: string;\r\n  /**\r\n   * filter specific column types, default: exclude all support types (selection, action, rank)\r\n   * @param col the column description to filter\r\n   */\r\n  filter: (col: Column) => boolean; //!isSupportType\r\n\r\n  /**\r\n   * whether the description should be part of the column header\r\n   */\r\n  verboseColumnHeaders: boolean;\r\n}\r\n\r\n/**\r\n * utility to export a ranking to a table with the given separator\r\n * @param ranking\r\n * @param data\r\n * @param options\r\n * @returns {Promise<string>}\r\n */\r\nexport function exportRanking(ranking: Ranking, data: any[], options: Partial<IExportOptions> = {}) {\r\n  const opts = <IExportOptions>Object.assign({\r\n    separator: '\\t',\r\n    newline: '\\n',\r\n    header: true,\r\n    quote: false,\r\n    quoteChar: '\"',\r\n    filter: (c: Column) => !isSupportType(c),\r\n    verboseColumnHeaders: false\r\n  }, options);\r\n\r\n  //optionally quote not numbers\r\n  const escape = new RegExp(`[${opts.quoteChar}]`, 'g');\r\n\r\n  function quote(v: any, c?: Column) {\r\n    const l = String(v);\r\n    if ((opts.quote || l.indexOf('\\n') >= 0) && (!c || !isNumberColumn(c))) {\r\n      return `${opts.quoteChar}${l.replace(escape, opts.quoteChar + opts.quoteChar)}${opts.quoteChar}`;\r\n    }\r\n    return l;\r\n  }\r\n\r\n  const columns = ranking.flatColumns.filter((c) => opts.filter(c));\r\n  const order = ranking.getOrder();\r\n\r\n  const r: string[] = [];\r\n  if (opts.header) {\r\n    r.push(columns.map((d) => quote(`${d.label}${opts.verboseColumnHeaders && d.description ? `\\n${d.description}` : ''}`)).join(opts.separator));\r\n  }\r\n  data.forEach((row, i) => {\r\n    r.push(columns.map((c) => quote(c.getExportValue({v: row, i: order[i]}, 'text'), c)).join(opts.separator));\r\n  });\r\n  return r.join(opts.newline);\r\n}\r\n","import {computeHist, computeStats} from '../internal';\r\nimport Column, {\r\n  defaultGroup, ICategoricalColumn, IColumnDesc, IDataRow, IGroup, IGroupData, INumberColumn,\r\n  IOrderedGroup,\r\n  NumberColumn\r\n} from '../model';\r\nimport Ranking from '../model/Ranking';\r\nimport ACommonDataProvider from './ACommonDataProvider';\r\nimport {IDataProviderOptions, IStatsBuilder} from './ADataProvider';\r\n\r\n\r\nexport interface ILocalDataProviderOptions {\r\n  /**\r\n   * whether the filter should be applied to all rankings regardless where they are\r\n   * default: false\r\n   */\r\n  filterGlobally: boolean;\r\n  /**\r\n   * jump to search results such that they are visible\r\n   * default: false\r\n   */\r\n  jumpToSearchResult: boolean;\r\n\r\n  /**\r\n   * the maximum number of nested sorting criteria\r\n   */\r\n  maxNestedSortingCriteria: number;\r\n  maxGroupColumns: number;\r\n}\r\n\r\n/**\r\n * a data provider based on an local array\r\n */\r\nexport default class LocalDataProvider extends ACommonDataProvider {\r\n  private options: ILocalDataProviderOptions = {\r\n    /**\r\n     * whether the filter should be applied to all rankings regardless where they are\r\n     */\r\n    filterGlobally: false,\r\n\r\n    jumpToSearchResult: false,\r\n\r\n    maxNestedSortingCriteria: Infinity,\r\n    maxGroupColumns: Infinity\r\n  };\r\n\r\n  private readonly reorderAll: () => void;\r\n\r\n  private _dataRows: IDataRow[];\r\n  private filter: ((row: IDataRow) => boolean) | null = null;\r\n\r\n  constructor(private _data: any[], columns: IColumnDesc[] = [], options: Partial<ILocalDataProviderOptions & IDataProviderOptions> = {}) {\r\n    super(columns, options);\r\n    Object.assign(this.options, options);\r\n    this._dataRows = toRows(_data);\r\n\r\n\r\n    const that = this;\r\n    this.reorderAll = function (this: {source: Ranking}) {\r\n      //fire for all other rankings a dirty order event, too\r\n      const ranking = this.source;\r\n      that.getRankings().forEach((r) => {\r\n        if (r !== ranking) {\r\n          r.dirtyOrder();\r\n        }\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * set a globally applied filter to all data without changing the data source itself\r\n   * @param {((row: IDataRow) => boolean) | null} filter\r\n   */\r\n  setFilter(filter: ((row: IDataRow) => boolean) | null) {\r\n    this.filter = filter;\r\n    this.reorderAll();\r\n  }\r\n\r\n  getFilter() {\r\n    return this.filter;\r\n  }\r\n\r\n  getTotalNumberOfRows() {\r\n    return this.data.length;\r\n  }\r\n\r\n\r\n  protected getMaxGroupColumns() {\r\n    return this.options.maxGroupColumns;\r\n  }\r\n\r\n  protected getMaxNestedSortingCriteria() {\r\n    return this.options.maxNestedSortingCriteria;\r\n  }\r\n\r\n  get data() {\r\n    return this._data;\r\n  }\r\n\r\n  /**\r\n   * replaces the dataset rows with a new one\r\n   * @param data\r\n   */\r\n  setData(data: any[]) {\r\n    this._data = data;\r\n    this._dataRows = toRows(data);\r\n    this.reorderAll();\r\n  }\r\n\r\n  clearData() {\r\n    this.setData([]);\r\n  }\r\n\r\n  /**\r\n   * append rows to the dataset\r\n   * @param data\r\n   */\r\n  appendData(data: any[]) {\r\n    this._data.push(...data);\r\n    this._dataRows.push(...toRows(data));\r\n    this.reorderAll();\r\n  }\r\n\r\n  cloneRanking(existing?: Ranking) {\r\n    const clone = super.cloneRanking(existing);\r\n\r\n    if (this.options.filterGlobally) {\r\n      clone.on(`${NumberColumn.EVENT_FILTER_CHANGED}.reorderAll`, this.reorderAll);\r\n    }\r\n\r\n    return clone;\r\n  }\r\n\r\n  cleanUpRanking(ranking: Ranking) {\r\n    if (this.options.filterGlobally) {\r\n      ranking.on(`${NumberColumn.EVENT_FILTER_CHANGED}.reorderAll`, null);\r\n    }\r\n    super.cleanUpRanking(ranking);\r\n  }\r\n\r\n  sortImpl(ranking: Ranking): IOrderedGroup[] {\r\n    if (this._data.length === 0) {\r\n      return [];\r\n    }\r\n    //wrap in a helper and store the initial index\r\n    let helper = this._data.map((r, i) => ({v: r, i, group: <IGroup | null>null}));\r\n\r\n    //do the optional filtering step\r\n    let filter: ((d: IDataRow) => boolean) | null = null;\r\n    if (this.options.filterGlobally) {\r\n      const filtered = this.getRankings().filter((d) => d.isFiltered());\r\n      if (filtered.length > 0) {\r\n        filter = (d: IDataRow) => filtered.every((f) => f.filter(d));\r\n      }\r\n    } else if (ranking.isFiltered()) {\r\n      filter = (d) => ranking.filter(d);\r\n    }\r\n\r\n    if (filter || this.filter) {\r\n      helper = helper.filter((d) => (!this.filter || this.filter(d)) && (!filter || filter(d)));\r\n    }\r\n\r\n    if (helper.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    //create the groups for each row\r\n    helper.forEach((r) => r.group = ranking.grouper(r) || defaultGroup);\r\n    if ((new Set<string>(helper.map((r) => r.group!.name))).size === 1) {\r\n      const group = helper[0].group;\r\n      //no need to split\r\n      //sort by the ranking column\r\n      helper.sort((a, b) => ranking.comparator(a, b));\r\n\r\n      //store the ranking index and create an argsort version, i.e. rank 0 -> index i\r\n      const order = helper.map((r) => r.i);\r\n      return [Object.assign({order}, group!)];\r\n    }\r\n    //sort by group and within by order\r\n    helper.sort((a, b) => {\r\n      const ga = a.group!;\r\n      const gb = b.group!;\r\n      if (ga.name !== gb.name) {\r\n        return ga.name.toLowerCase().localeCompare(gb.name.toLowerCase());\r\n      }\r\n      return ranking.comparator(a, b);\r\n    });\r\n    //iterate over groups and create within orders\r\n    const groups: (IOrderedGroup & IGroupData)[] = [Object.assign({order: [], rows: []}, helper[0].group!)];\r\n    let group = groups[0];\r\n    helper.forEach((row) => {\r\n      const rowGroup = row.group!;\r\n      if (rowGroup.name === group.name) {\r\n        group.order.push(row.i);\r\n        group.rows.push(row);\r\n      } else { // change in groups\r\n        group = Object.assign({order: [row.i], rows: [row]}, rowGroup);\r\n        groups.push(group);\r\n      }\r\n    });\r\n\r\n    // sort groups\r\n    groups.sort((a, b) => ranking.groupComparator(a, b));\r\n\r\n    return groups;\r\n  }\r\n\r\n\r\n  viewRaw(indices: number[]) {\r\n    //filter invalid indices\r\n    return indices.map((index) => this._data[index]);\r\n  }\r\n\r\n  viewRawRows(indices: number[]) {\r\n    //filter invalid indices\r\n    return indices.map((index) => this._dataRows[index]);\r\n  }\r\n\r\n  view(indices: number[]) {\r\n    return this.viewRaw(indices);\r\n  }\r\n\r\n  fetch(orders: number[][]): IDataRow[][] {\r\n    return orders.map((order) => order.map((index) => this._dataRows[index]));\r\n  }\r\n\r\n  /**\r\n   * helper for computing statistics\r\n   * @param indices\r\n   * @returns {{stats: (function(INumberColumn): *), hist: (function(ICategoricalColumn): *)}}\r\n   */\r\n  stats(indices: number[]): IStatsBuilder {\r\n    let d: IDataRow[] | null = null;\r\n    const getD = () => {\r\n      if (d == null) {\r\n        d = this.viewRawRows(indices);\r\n      }\r\n      return d;\r\n    };\r\n\r\n    return {\r\n      stats: (col: INumberColumn) => computeStats(getD(), (d) => col.getNumber(d), (d) => col.isMissing(d), [0, 1]),\r\n      hist: (col: ICategoricalColumn) => computeHist(getD(), (d) => col.getCategory(d), col.categories)\r\n    };\r\n  }\r\n\r\n\r\n  mappingSample(col: INumberColumn): number[] {\r\n    const MAX_SAMPLE = 120; //at most 500 sample lines\r\n    const l = this._dataRows.length;\r\n    if (l <= MAX_SAMPLE) {\r\n      return <number[]>this._dataRows.map(col.getRawNumber.bind(col));\r\n    }\r\n    //randomly select 500 elements\r\n    const indices: number[] = [];\r\n    for (let i = 0; i < MAX_SAMPLE; ++i) {\r\n      let j = Math.floor(Math.random() * (l - 1));\r\n      while (indices.indexOf(j) >= 0) {\r\n        j = Math.floor(Math.random() * (l - 1));\r\n      }\r\n      indices.push(j);\r\n    }\r\n    return indices.map((i) => col.getRawNumber(this._dataRows[i]));\r\n  }\r\n\r\n  searchAndJump(search: string | RegExp, col: Column) {\r\n    //case insensitive search\r\n    search = typeof search === 'string' ? search.toLowerCase() : search;\r\n    const f = typeof search === 'string' ? (v: string) => v.toLowerCase().indexOf((<string>search)) >= 0 : (<RegExp>search).test.bind(search);\r\n    const indices = <number[]>[];\r\n    for (let i = 0; i < this._dataRows.length; ++i) {\r\n      if (f(col.getLabel(this._dataRows[i]))) {\r\n        indices.push(i);\r\n      }\r\n    }\r\n    this.jumpToNearest(indices);\r\n  }\r\n\r\n}\r\n\r\nfunction toRows(data: any[]) {\r\n  return data.map((v, i) => ({v, i}));\r\n}\r\n","import {defaultOptions} from '../config';\r\nimport {ILineUpOptions} from '../interfaces';\r\nimport merge from '../internal/merge';\r\nimport DataProvider from '../provider/ADataProvider';\r\nimport {ALineUp} from './ALineUp';\r\nimport EngineRenderer from './EngineRenderer';\r\nimport SidePanel from './panel/SidePanel';\r\n\r\nexport {ILineUpOptions} from '../interfaces';\r\n\r\nexport default class LineUp extends ALineUp {\r\n  private readonly renderer: EngineRenderer | null;\r\n  private readonly panel: SidePanel | null;\r\n\r\n  private readonly options = defaultOptions();\r\n\r\n  constructor(node: HTMLElement, data: DataProvider, options: Partial<ILineUpOptions> = {}) {\r\n    super(node, data, options && options.ignoreUnsupportedBrowser === true);\r\n\r\n    merge(this.options, options);\r\n\r\n    if (!this.isBrowserSupported) {\r\n      this.renderer = null;\r\n      this.panel = null;\r\n      return;\r\n    }\r\n\r\n    this.node.classList.add('lu');\r\n\r\n    this.renderer = new EngineRenderer(data, this.node, this.options);\r\n    if (this.options.sidePanel) {\r\n      console.assert(this.node.ownerDocument != null);\r\n      this.panel = new SidePanel(this.renderer.ctx, this.node.ownerDocument!, {\r\n        collapseable: this.options.sidePanelCollapsed ? 'collapsed' : true,\r\n        hierarchy: this.options.hierarchyIndicator && this.options.flags.advancedRankingFeatures\r\n      });\r\n      this.renderer.pushUpdateAble((ctx) => this.panel!.update(ctx));\r\n      this.node.insertBefore(this.panel!.node, this.node.firstChild);\r\n    } else {\r\n      this.panel = null;\r\n    }\r\n    this.forward(this.renderer, `${EngineRenderer.EVENT_HIGHLIGHT_CHANGED}.main`);\r\n  }\r\n\r\n  destroy() {\r\n    this.node.classList.remove('lu');\r\n    if (this.renderer) {\r\n      this.renderer.destroy();\r\n    }\r\n    if (this.panel) {\r\n      this.panel.destroy();\r\n    }\r\n    super.destroy();\r\n  }\r\n\r\n  update() {\r\n    if (this.renderer) {\r\n      this.renderer.update();\r\n    }\r\n  }\r\n\r\n  setDataProvider(data: DataProvider, dump?: any) {\r\n    super.setDataProvider(data, dump);\r\n    if (!this.renderer) {\r\n      return;\r\n    }\r\n    this.renderer.setDataProvider(data);\r\n    this.update();\r\n    if (this.panel) {\r\n      this.panel.update(this.renderer.ctx);\r\n    }\r\n  }\r\n\r\n  setHighlight(dataIndex: number, scrollIntoView: boolean = true) {\r\n    return this.renderer != null && this.renderer.setHighlight(dataIndex, scrollIntoView);\r\n  }\r\n\r\n  getHighlight() {\r\n    return this.renderer ? this.renderer.getHighlight() : -1;\r\n  }\r\n\r\n  protected enableHighlightListening(enable: boolean) {\r\n    if (this.renderer) {\r\n      this.renderer.enableHighlightListening(enable);\r\n    }\r\n  }\r\n}\r\n","import ADialog from './ADialog';\r\nimport Column from '../../model';\r\n\r\n\r\nexport default class DialogManager {\r\n\r\n  private readonly escKeyListener = (evt: KeyboardEvent) => {\r\n    if (evt.which === 27) {\r\n      this.removeLast();\r\n    }\r\n  }\r\n\r\n  private readonly openDialogs: ADialog[] = [];\r\n  readonly node: HTMLElement;\r\n\r\n  constructor(doc = document) {\r\n    this.node = doc.createElement('div');\r\n    this.node.classList.add('lu-backdrop');\r\n    this.node.innerHTML = `<div></div>`;\r\n    this.node.onclick = () => {\r\n      this.removeAll();\r\n    };\r\n  }\r\n\r\n  setHighlight(mask: { left: number, top: number, width: number, height: number }) {\r\n    const area = <HTMLElement>this.node.firstElementChild;\r\n    // @see http://bennettfeely.com/clippy/ -> select `Frame` example\r\n    area.style.clipPath = `polygon(\r\n      0% 0%,\r\n      0% 100%,\r\n      ${mask.left}px 100%,\r\n      ${mask.left}px ${mask.top}px,\r\n      ${mask.left + mask.width}px ${mask.top}px,\r\n      ${mask.left + mask.width}px ${mask.top + mask.height}px,\r\n      ${mask.left}px ${mask.top + mask.height}px,\r\n      ${mask.left}px 100%,\r\n      100% 100%,\r\n      100% 0%\r\n    )`;\r\n  }\r\n\r\n  setHighlightColumn(column: Column) {\r\n    const root = <HTMLElement>this.node.parentElement!;\r\n    if (!root) {\r\n      this.clearHighlight();\r\n      return;\r\n    }\r\n    const header = <HTMLElement>root.querySelector(`.lu-header[data-col-id=\"${column.id}\"]`);\r\n    if (!header) {\r\n      this.clearHighlight();\r\n      return;\r\n    }\r\n    const base = header.getBoundingClientRect();\r\n    const offset = root.getBoundingClientRect();\r\n    this.setHighlight({\r\n      left: base.left - offset.left,\r\n      top: base.top - offset.top,\r\n      width: base.width,\r\n      height: offset.height\r\n    });\r\n  }\r\n\r\n  clearHighlight() {\r\n    const area = <HTMLElement>this.node.firstElementChild;\r\n    area.style.clipPath = '';\r\n  }\r\n\r\n  private removeLast() {\r\n    if (this.openDialogs.length === 0) {\r\n      return;\r\n    }\r\n    this.remove(this.openDialogs[this.openDialogs.length - 1]);\r\n  }\r\n\r\n  removeAll() {\r\n    if (this.openDialogs.length === 0) {\r\n      return;\r\n    }\r\n    const all = this.openDialogs.splice(0, this.openDialogs.length);\r\n    all.forEach((d) => d.destroy());\r\n    this.takeDown();\r\n  }\r\n\r\n  remove(dialog: ADialog) {\r\n    const index = this.openDialogs.indexOf(dialog);\r\n    if (index < 0) {\r\n      return false;\r\n    }\r\n    // destroy self and all levels below that = after that\r\n    const destroyed = this.openDialogs.splice(index, this.openDialogs.length - index);\r\n    destroyed.reverse().forEach((d) => d.destroy());\r\n\r\n    if (this.openDialogs.length === 0) {\r\n      this.takeDown();\r\n    }\r\n    return true;\r\n  }\r\n\r\n  removeAboveLevel(level: number) {\r\n    // hide all dialogs which have a higher or equal level to the newly opened one\r\n    this.openDialogs.filter((d) => d.level >= level).reverse().forEach((d) => this.remove(d));\r\n  }\r\n\r\n  removeLike(dialog: ADialog) {\r\n    const similar = this.openDialogs.find((d) => dialog.equals(d));\r\n    if (!similar) {\r\n      return false;\r\n    }\r\n    this.remove(similar);\r\n    return true;\r\n  }\r\n\r\n  private setUp() {\r\n    console.assert(this.node.ownerDocument != null);\r\n    this.node.ownerDocument!.addEventListener('keyup', this.escKeyListener, {\r\n      passive: true\r\n    });\r\n    this.node.style.display = 'block';\r\n  }\r\n\r\n  private takeDown() {\r\n    this.clearHighlight();\r\n    console.assert(this.node.ownerDocument != null);\r\n    this.node.ownerDocument!.removeEventListener('keyup', this.escKeyListener);\r\n    this.node.style.display = null;\r\n  }\r\n\r\n  push(dialog: ADialog) {\r\n    this.removeAboveLevel(dialog.level);\r\n\r\n    if (this.openDialogs.length === 0) {\r\n      this.setUp();\r\n    }\r\n\r\n    this.openDialogs.push(dialog);\r\n  }\r\n}\r\n","import {nonUniformContext, MultiTableRowRenderer, GridStyleManager} from 'lineupengine';\nimport {ILineUpOptions, ILineUpFlags} from '../interfaces';\nimport {findOption, ICategoricalStatistics, IStatistics, round} from '../internal';\nimport AEventDispatcher, {suffix, IEventListener} from '../internal/AEventDispatcher';\nimport {\n  Column, ICategoricalColumn, IDataRow, IGroupData, IGroupItem, isCategoricalColumn, isGroup,\n  isNumberColumn, INumberColumn\n} from '../model';\nimport Ranking from '../model/Ranking';\nimport ADataProvider from '../provider/ADataProvider';\nimport {\n  chooseGroupRenderer, chooseRenderer, chooseSummaryRenderer, IImposer, IRenderContext, possibleGroupRenderer,\n  possibleRenderer, possibleSummaryRenderer\n} from '../renderer';\nimport EngineRanking, {IEngineRankingContext} from './EngineRanking';\nimport {IRankingHeaderContext, IRankingHeaderContextContainer} from './interfaces';\nimport SlopeGraph, {EMode} from './SlopeGraph';\nimport DialogManager from './dialogs/DialogManager';\n\n/**\n * emitted when the highlight changes\n * @asMemberOf EngineRenderer\n * @param dataIndex the highlghted data index or -1 for none\n * @event\n */\nexport declare function highlightChanged(dataIndex: number): void;\n\nexport default class EngineRenderer extends AEventDispatcher {\n  static readonly EVENT_HIGHLIGHT_CHANGED = EngineRanking.EVENT_HIGHLIGHT_CHANGED;\n\n  protected readonly options: Readonly<ILineUpOptions>;\n\n  private readonly histCache = new Map<string, IStatistics | ICategoricalStatistics | null | Promise<IStatistics | ICategoricalStatistics>>();\n\n  readonly node: HTMLElement;\n  private readonly table: MultiTableRowRenderer;\n  private readonly rankings: EngineRanking[] = [];\n  private readonly slopeGraphs: SlopeGraph[] = [];\n\n  readonly ctx: IRankingHeaderContextContainer & IRenderContext & IEngineRankingContext;\n\n  private readonly updateAbles: ((ctx: IRankingHeaderContext) => void)[] = [];\n  private zoomFactor = 1;\n  readonly idPrefix = `lu${Math.random().toString(36).slice(-8).substr(0, 3)}`; //generate a random string with length3;\n\n  private enabledHighlightListening: boolean = false;\n\n  constructor(protected data: ADataProvider, parent: HTMLElement, options: Readonly<ILineUpOptions>) {\n    super();\n    this.options = options;\n    console.assert(parent.ownerDocument != null);\n    this.node = parent.ownerDocument!.createElement('main');\n    this.node.id = this.idPrefix;\n    this.node.classList.toggle('lu-whole-hover', options.expandLineOnHover);\n    parent.appendChild(this.node);\n\n    const statsOf = (col: Column) => {\n      const r = this.histCache.get(col.id);\n      if (r == null || r instanceof Promise) {\n        return null;\n      }\n      return r;\n    };\n    const dialogManager = new DialogManager(parent.ownerDocument!);\n    parent.appendChild(dialogManager.node);\n    this.ctx = {\n      idPrefix: this.idPrefix,\n      document: parent.ownerDocument!,\n      provider: data,\n      dialogManager,\n      toolbar: this.options.toolbar,\n      flags: <ILineUpFlags>this.options.flags,\n      option: findOption(Object.assign({useGridLayout: true}, this.options)),\n      statsOf,\n      renderer: (col: Column, imposer?: IImposer) => {\n        const r = chooseRenderer(col, this.options.renderers);\n        return r.create(col, this.ctx, statsOf(col), imposer);\n      },\n      groupRenderer: (col: Column, imposer?: IImposer) => {\n        const r = chooseGroupRenderer(col, this.options.renderers);\n        return r.createGroup(col, this.ctx, statsOf(col), imposer);\n      },\n      summaryRenderer: (col: Column, interactive: boolean, imposer?: IImposer) => {\n        const r = chooseSummaryRenderer(col, this.options.renderers);\n        return r.createSummary(col, this.ctx, interactive, imposer);\n      },\n      totalNumberOfRows: 0,\n      createRenderer(col: Column, imposer?: IImposer) {\n        const single = this.renderer(col, imposer);\n        const group = this.groupRenderer(col, imposer);\n        const summary = options.summaryHeader ? this.summaryRenderer(col, false, imposer) : null;\n        return {\n          single,\n          group,\n          summary,\n          singleId: col.getRenderer(),\n          groupId: col.getGroupRenderer(),\n          summaryId: col.getSummaryRenderer(),\n          singleTemplate: null,\n          groupTemplate: null,\n          summaryTemplate: null\n        };\n      },\n      getPossibleRenderer: (col: Column) => ({\n        item: possibleRenderer(col, this.options.renderers),\n        group: possibleGroupRenderer(col, this.options.renderers),\n        summary: possibleSummaryRenderer(col, this.options.renderers)\n      }),\n      colWidth: (col: Column) => !col.isVisible() ? 0 : col.getWidth()\n    };\n\n    this.table = new MultiTableRowRenderer(this.node, `#${this.idPrefix}`);\n\n    //apply rules\n    {\n      this.style.addRule('lineup_groupPadding', `\n       #${this.idPrefix} .lu-row[data-agg=group],\n       #${this.idPrefix} .lu-row[data-meta~=last] {\n        margin-bottom: ${options.groupPadding}px;\n       }`, false);\n\n      this.style.addRule('lineup_rowPadding', `\n       #${this.idPrefix} .lu-row[data-lod] {\n         padding-top: 0;\n       }`, false);\n\n       // padding in general and for hovered low detail rows + their afterwards\n       this.style.addRule('lineup_rowPadding2', `\n        #${this.idPrefix} .lu-row,\n        #${this.idPrefix} .lu-row[data-lod]:hover,\n        #${this.idPrefix} .lu-row[data-lod].le-highlighted,\n        #${this.idPrefix} .lu-row[data-lod].lu-selected,\n        #${this.idPrefix} .lu-row[data-lod]:hover + .lu-row,\n        #${this.idPrefix} .lu-row[data-lod].le-highlighted + .lu-row,\n        #${this.idPrefix} .lu-row[data-lod].lu-selected + .lu-row {\n          padding-top: ${options.rowPadding}px;\n        }`, false);\n\n      this.style.addRule('lineup_rotation', `\n       #${this.idPrefix}.lu-rotated-label .lu-label.lu-rotated {\n           transform: rotate(${-this.options.labelRotation}deg);\n       }`);\n\n      const toDisable: string[] = [];\n      if (!this.options.flags.advancedRankingFeatures) {\n        toDisable.push('ranking');\n      }\n       if (!this.options.flags.advancedModelFeatures) {\n        toDisable.push('model');\n      }\n      if (!this.options.flags.advancedUIFeatures) {\n        toDisable.push('ui');\n      }\n      if (toDisable.length > 0) {\n        this.style.addRule('lineup_feature_disable', `\n        ${toDisable.map((d) => `.lu-feature-${d}.lu-feature-advanced`).join(', ')} {\n            display: none !important;\n        }`);\n      }\n    }\n\n    this.initProvider(data);\n  }\n\n  get style(): GridStyleManager {\n    return this.table.style;\n  }\n\n  zoomOut() {\n    this.zoomFactor = Math.max(this.zoomFactor - 0.1, 0.5);\n    this.updateZoomFactor();\n    this.update();\n  }\n\n  zoomIn() {\n    this.zoomFactor = Math.min(this.zoomFactor + 0.1, 2.0);\n    this.updateZoomFactor();\n    this.update();\n  }\n\n  private updateZoomFactor() {\n    const body = <HTMLElement>this.node.querySelector('main')!;\n    body.style.fontSize = `${this.zoomFactor * 100}%`;\n  }\n\n  pushUpdateAble(updateAble: (ctx: IRankingHeaderContext) => void) {\n    this.updateAbles.push(updateAble);\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([EngineRenderer.EVENT_HIGHLIGHT_CHANGED]);\n  }\n\n  on(type: typeof EngineRenderer.EVENT_HIGHLIGHT_CHANGED, listener: typeof highlightChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n\n  setDataProvider(data: ADataProvider) {\n    this.takeDownProvider();\n\n    this.data = data;\n    (<any>this.ctx).provider = data;\n\n    this.initProvider(data);\n  }\n\n  private takeDownProvider() {\n    this.data.on(`${ADataProvider.EVENT_SELECTION_CHANGED}.body`, null);\n    this.data.on(`${ADataProvider.EVENT_ADD_RANKING}.body`, null);\n    this.data.on(`${ADataProvider.EVENT_REMOVE_RANKING}.body`, null);\n    this.data.on(`${ADataProvider.EVENT_GROUP_AGGREGATION_CHANGED}.body`, null);\n    this.data.on(`${ADataProvider.EVENT_JUMP_TO_NEAREST}.body`, null);\n\n    this.rankings.forEach((r) => this.table.remove(r));\n    this.rankings.splice(0, this.rankings.length);\n    this.slopeGraphs.forEach((s) => this.table.remove(s));\n    this.slopeGraphs.splice(0, this.slopeGraphs.length);\n  }\n\n  private initProvider(data: ADataProvider) {\n    data.on(`${ADataProvider.EVENT_SELECTION_CHANGED}.body`, () => this.updateSelection(data.getSelection()));\n    data.on(`${ADataProvider.EVENT_ADD_RANKING}.body`, (ranking: Ranking) => {\n      this.addRanking(ranking);\n    });\n    data.on(`${ADataProvider.EVENT_REMOVE_RANKING}.body`, (ranking: Ranking) => {\n      this.removeRanking(ranking);\n    });\n    data.on(`${ADataProvider.EVENT_GROUP_AGGREGATION_CHANGED}.body`, (ranking: Ranking) => {\n      this.update(this.rankings.filter((r) => r.ranking === ranking));\n    });\n    data.on(`${ADataProvider.EVENT_JUMP_TO_NEAREST}.body`, (indices: number[]) => {\n      this.setHighlightToNearest(indices, true);\n    });\n\n    this.data.getRankings().forEach((r) => this.addRanking(r));\n  }\n\n  private updateSelection(dataIndices: number[]) {\n    const s = new Set(dataIndices);\n    this.rankings.forEach((r) => r.updateSelection(s));\n\n    this.slopeGraphs.forEach((r) => r.updateSelection(s));\n  }\n\n  private updateHist(ranking?: EngineRanking, col?: Column) {\n    if (!this.options.summaryHeader) {\n      return;\n    }\n    const rankings = ranking ? [ranking] : this.rankings;\n    rankings.forEach((r) => {\n      const ranking = r.ranking;\n      const order = ranking.getOrder();\n      const cols = col ? [col] : ranking.flatColumns;\n      const histo = order == null ? null : this.data.stats(order);\n      cols.filter((d) => d.isVisible() && isNumberColumn(d)).forEach((col: Column) => {\n        this.histCache.set(col.id, histo == null ? null : histo.stats(<INumberColumn>col));\n      });\n      cols.filter((d) => isCategoricalColumn(d) && d.isVisible()).forEach((col: Column) => {\n        this.histCache.set(col.id, histo == null ? null : histo.hist(<ICategoricalColumn>col));\n      });\n      if (col) {\n        // single update\n        r.updateHeaderOf(col);\n      } else {\n        r.updateHeaders();\n      }\n    });\n\n    this.updateAbles.forEach((u) => u(this.ctx));\n  }\n\n  private addRanking(ranking: Ranking) {\n    if (this.rankings.length > 0) {\n      // add slope graph first\n      const s = this.table.pushSeparator((header, body) => new SlopeGraph(header, body, `${ranking.id}S`, this.ctx, {\n        mode: this.options.defaultSlopeGraphMode === 'band' ? EMode.BAND : EMode.ITEM\n      }));\n      this.slopeGraphs.push(s);\n    }\n\n    const r = this.table.pushTable((header, body, tableId, style) => new EngineRanking(ranking, header, body, tableId, style, this.ctx, {\n      animation: this.options.animated,\n      customRowUpdate: this.options.customRowUpdate || (() => undefined),\n      levelOfDetail: this.options.levelOfDetail || (() => 'high'),\n      flags: <ILineUpFlags>this.options.flags\n    }));\n    r.on(EngineRanking.EVENT_WIDTH_CHANGED, () => {\n      this.updateRotatedHeaderState();\n      this.table.widthChanged();\n    });\n    r.on(EngineRanking.EVENT_UPDATE_DATA, () => this.update([r]));\n    r.on(EngineRanking.EVENT_UPDATE_HIST, (col: Column) => this.updateHist(r, col));\n    this.forward(r, EngineRanking.EVENT_HIGHLIGHT_CHANGED);\n    if (this.enabledHighlightListening) {\n      r.enableHighlightListening(true);\n    }\n\n    ranking.on(suffix('.renderer', Ranking.EVENT_ORDER_CHANGED), () => this.updateHist(r));\n\n    this.rankings.push(r);\n    this.update([r]);\n  }\n\n  private updateRotatedHeaderState() {\n    if (this.options.labelRotation === 0) {\n      return;\n    }\n    const l = this.node.querySelector('.lu-label.lu-rotated');\n    this.node.classList.toggle('lu-rotated-label', Boolean(l));\n  }\n\n  private removeRanking(ranking: Ranking | null) {\n    if (!ranking) {\n      // remove all\n      this.rankings.splice(0, this.rankings.length);\n      this.slopeGraphs.splice(0, this.slopeGraphs.length);\n      this.table.clear();\n      return;\n    }\n    const index = this.rankings.findIndex((r) => r.ranking === ranking);\n    if (index < 0) {\n      return; // error\n    }\n    const section = this.rankings.splice(index, 1)[0]!;\n    const slope = this.slopeGraphs.splice(index === 0 ? index : index - 1, 1)[0];\n    this.table.remove(section);\n    if (slope) {\n      this.table.remove(slope);\n    }\n  }\n\n  update(rankings: EngineRanking[] = this.rankings) {\n    // visible and has parent = part of dom\n    rankings = rankings.filter((d) => !d.hidden && d.body.parentElement!);\n    if (rankings.length === 0) {\n      return;\n    }\n    const orders = rankings.map((r) => r.ranking.getOrder());\n    const data = this.data.fetch(orders);\n\n    (<any>this.ctx).totalNumberOfRows = Math.max(...data.map((d) => d.length));\n\n    // TODO support async\n    const localData = data.map((d) => d.map((d) => <IDataRow>d));\n\n    if (this.histCache.size === 0) {\n      this.updateHist();\n    }\n\n    const round2 = (v: number) => round(v, 2);\n    const rowPadding = round2(this.zoomFactor * this.options.rowPadding!);\n    const groupPadding = round2(this.zoomFactor * this.options.groupPadding!);\n\n    const heightsFor = (ranking: Ranking, data: (IGroupItem | IGroupData)[]) => {\n      if (this.options.dynamicHeight) {\n        const impl = this.options.dynamicHeight(data, ranking);\n        const f = (v: number | any, d: any) => typeof v === 'number' ? v : v(d);\n        if (impl) {\n          return {\n            defaultHeight: round2(this.zoomFactor * impl.defaultHeight),\n            height: (d: IGroupItem | IGroupData) => round2(this.zoomFactor * f(impl.height, d)),\n            padding: (d: IGroupItem | IGroupData) => round2(this.zoomFactor * f(impl.padding, d)),\n          };\n        }\n      }\n      const item = round2(this.zoomFactor * this.options.rowHeight!);\n      const group = round2(this.zoomFactor * this.options.groupHeight!);\n      return {\n        defaultHeight: item,\n        height: (d: IGroupItem | IGroupData) => isGroup(d) ? group : item,\n        padding: rowPadding\n      };\n    };\n\n    rankings.forEach((r, i) => {\n      const grouped = r.groupData(localData[i]);\n\n      const {height, defaultHeight, padding} = heightsFor(r.ranking, grouped);\n\n      const rowContext = nonUniformContext(grouped.map(height), defaultHeight, (index) => {\n        const pad = (typeof padding === 'number' ? padding : padding(grouped[index] || null));\n        if (index >= 0 && grouped[index] && (isGroup(grouped[index]) || (<IGroupItem>grouped[index]).meta === 'last' || (<IGroupItem>grouped[index]).meta === 'first last')) {\n          return groupPadding + pad;\n        }\n        return pad;\n      });\n      r.render(grouped, rowContext);\n    });\n\n    this.updateSlopeGraphs(rankings);\n\n    this.updateRotatedHeaderState();\n    this.table.widthChanged();\n  }\n\n  private updateSlopeGraphs(rankings: EngineRanking[] = this.rankings) {\n    const indices = new Set(rankings.map((d) => this.rankings.indexOf(d)));\n    this.slopeGraphs.forEach((s, i) => {\n      if (s.hidden) {\n        return;\n      }\n      const left = i;\n      const right = i + 1;\n      if (!indices.has(left) && !indices.has(right)) {\n        return;\n      }\n      const leftRanking = this.rankings[left];\n      const rightRanking = this.rankings[right];\n      s.rebuild(leftRanking.currentData, leftRanking.context, rightRanking.currentData, rightRanking.context);\n    });\n  }\n\n  setHighlight(dataIndex: number, scrollIntoView: boolean) {\n    const found = this.rankings.map((r) => r.setHighlight(dataIndex));\n    this.fire(EngineRenderer.EVENT_HIGHLIGHT_CHANGED, dataIndex);\n    if (this.rankings.length === 0 || dataIndex < 0) {\n      return false;\n    }\n    if (!scrollIntoView) {\n      return found[0]!;\n    }\n    return this.rankings[0].scrollIntoView(dataIndex);\n  }\n\n  setHighlightToNearest(dataIndices: number[], scrollIntoView: boolean) {\n    if (this.rankings.length === 0) {\n      return false;\n    }\n    const nearest = this.rankings[0].findNearest(dataIndices);\n    if (nearest >= 0) {\n      return this.setHighlight(nearest, scrollIntoView);\n    }\n    return false;\n  }\n\n  getHighlight() {\n    for (const ranking of this.rankings) {\n      const h = ranking.getHighlight();\n      if (h >= 0) {\n        return h;\n      }\n    }\n    return -1;\n  }\n\n  enableHighlightListening(enable: boolean) {\n    for (const ranking of this.rankings) {\n        ranking.enableHighlightListening(enable);\n    }\n    this.enabledHighlightListening = enable;\n  }\n\n  destroy() {\n    this.takeDownProvider();\n    this.table.destroy();\n    this.node.remove();\n  }\n}\n\n","import {median, quantile} from 'd3-array';\nimport {toolbar} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport CompositeNumberColumn, {ICompositeNumberColumnDesc} from './CompositeNumberColumn';\nimport {IDataRow} from './interfaces';\nimport {EAdvancedSortMethod} from './INumberColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n/**\n *  factory for creating a description creating a max column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createReduceDesc(label: string = 'Reduce') {\n  return {type: 'reduce', label};\n}\n\nexport interface IReduceDesc {\n  readonly reduce?: EAdvancedSortMethod;\n}\n\n\nexport declare type IReduceColumnDesc = IReduceDesc & ICompositeNumberColumnDesc;\n\n/**\n * emitted when the mapping property changes\n * @asMemberOf ReduceColumn\n * @event\n */\nexport declare function reduceChanged(previous: EAdvancedSortMethod, current: EAdvancedSortMethod): void;\n\n/**\n * combines multiple columns by using the maximal value\n */\n@toolbar('reduce')\nexport default class ReduceColumn extends CompositeNumberColumn {\n  static readonly EVENT_REDUCE_CHANGED = 'reduceChanged';\n\n  private reduce: EAdvancedSortMethod;\n\n  constructor(id: string, desc: Readonly<IReduceColumnDesc>) {\n    super(id, desc);\n    this.reduce = desc.reduce || EAdvancedSortMethod.max;\n    this.setDefaultRenderer('interleaving');\n    this.setDefaultGroupRenderer('interleaving');\n    this.setDefaultSummaryRenderer('interleaving');\n  }\n\n  get label() {\n    const l = super.getMetaData().label;\n    if (l !== 'Reduce') {\n      return l;\n    }\n    return `${this.reduce[0].toUpperCase()}${this.reduce.slice(1)}(${this.children.map((d) => d.label).join(', ')})`;\n  }\n\n  getColor(row: IDataRow) {\n    //compute the index of the maximal one\n    const c = this._children;\n    if (c.length === 0 || this.reduce === EAdvancedSortMethod.q1 || this.reduce === EAdvancedSortMethod.q3 || this.reduce === EAdvancedSortMethod.mean) {\n      return Column.DEFAULT_COLOR;\n    }\n    const v = this.compute(row);\n    const selected = c.find((c) => c.getValue(row) === v);\n    return selected ? selected.getColor(row) : Column.DEFAULT_COLOR;\n  }\n\n  protected compute(row: IDataRow) {\n    const vs = this._children.map((d) => d.getValue(row)).filter((d) => !isNaN(d));\n    if (vs.length === 0) {\n      return NaN;\n    }\n    switch (this.reduce) {\n      case EAdvancedSortMethod.mean:\n        return vs.reduce((a, b) => a + b, 0) / vs.length;\n      case EAdvancedSortMethod.max:\n        return Math.max(...vs);\n      case EAdvancedSortMethod.min:\n        return Math.min(...vs);\n      case EAdvancedSortMethod.median:\n        return median(vs)!;\n      case EAdvancedSortMethod.q1:\n        return quantile(vs.sort((a, b) => a - b), 0.25)!;\n      case EAdvancedSortMethod.q3:\n        return quantile(vs.sort((a, b) => a - b), 0.75)!;\n    }\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ReduceColumn.EVENT_REDUCE_CHANGED]);\n  }\n\n  on(type: typeof ReduceColumn.EVENT_REDUCE_CHANGED, listener: typeof reduceChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  getReduce() {\n    return this.reduce;\n  }\n\n  setReduce(reduce: EAdvancedSortMethod) {\n    if (this.reduce === reduce) {\n      return;\n    }\n    this.fire([ReduceColumn.EVENT_REDUCE_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.reduce, this.reduce = reduce);\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.reduce = this.reduce;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    this.reduce = dump.reduce || this.reduce;\n    super.restore(dump, factory);\n  }\n\n  get canJustAddNumbers() {\n    return true;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      return {\n        value: this.getRawNumber(row),\n        children: this.children.map((d) => d.getExportValue(row, format))\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n}\n","import {toolbar} from './annotations';\nimport Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport CompositeNumberColumn, {ICompositeNumberDesc} from './CompositeNumberColumn';\nimport {IDataRow} from './interfaces';\nimport {isNumberColumn} from './INumberColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\nconst DEFAULT_SCRIPT = `let s = 0;\ncol.forEach((c) => s += c.v);\nreturn s / col.length`;\n\n/**\n * factory for creating a description creating a mean column\n * @param label\n * @returns {{type: string, label: string}}\n */\nexport function createScriptDesc(label: string = 'script') {\n  return {type: 'script', label, script: DEFAULT_SCRIPT};\n}\n\n\nfunction wrapWithContext(code: string) {\n  let clean = code.trim();\n  if (!clean.includes('return')) {\n    clean = `return (${clean});`;\n  }\n  return `\n  const max = function(arr) { return Math.max.apply(Math, arr); };\n  const min = function(arr) { return Math.min.apply(Math, arr); };\n  const extent = function(arr) { return [min(arr), max(arr)]; };\n  const clamp = function(v, minValue, maxValue) { return v < minValue ? minValue : (v > maxValue ? maxValue : v); };\n  const normalize = function(v, minMax, max) {\n    if (Array.isArray(minMax)) {\n      minMax = minMax[0];\n      max = minMax[1];\n    }\n    return (v - minMax) / (max - minMax);\n  };\n  const denormalize = function(v, minMax, max) {\n    if (Array.isArray(minMax)) {\n      minMax = minMax[0];\n      max = minMax[1];\n    }\n    return v * (max - minMax) + minMax;\n  };\n  const linear = function(v, source, target) {\n    target = target || [0, 1];\n    return denormalize(normalize(v, source), target);\n  };\n  const v = (function custom() {\n    ${clean}\n  })();\n\n  return typeof v === 'number' ? v : NaN`;\n}\n\n\n/**\n * wrapper class for simpler column accessing\n */\nclass ColumnWrapper {\n  constructor(private readonly c: Column, public readonly v: any, public readonly raw: number | null) {\n\n  }\n\n  get type() {\n    return this.c.desc.type;\n  }\n\n  get name() {\n    return this.c.getMetaData().label;\n  }\n\n  get id() {\n    return this.c.id;\n  }\n}\n\n/**\n * helper context for accessing columns within a scripted columns\n */\nclass ColumnContext {\n  private readonly lookup = new Map<string, ColumnWrapper>();\n  private _all: ColumnContext | null = null;\n\n  constructor(private readonly children: ColumnWrapper[], private readonly allFactory?: () => ColumnContext) {\n    children.forEach((c) => {\n      this.lookup.set(`ID@${c.id}`, c);\n      this.lookup.set(`NAME@${c.name}`, c);\n    });\n  }\n\n  /**\n   * get a column by name\n   * @param {string} name\n   * @return {ColumnWrapper}\n   */\n  byName(name: string) {\n    return this.lookup.get(`NAME@${name}`);\n  }\n\n  /**\n   * get a column by id\n   * @param {string} id\n   * @return {ColumnWrapper}\n   */\n  byID(id: string) {\n    return this.lookup.get(`ID@${id}`);\n  }\n\n  /**\n   * get a column by index\n   * @param {number} index\n   * @return {ColumnWrapper}\n   */\n  byIndex(index: number) {\n    return this.children[index];\n  }\n\n  forEach(callback: ((c: ColumnWrapper, index: number) => void)) {\n    return this.children.forEach(callback);\n  }\n\n  /**\n   * number of columns\n   * @return {number}\n   */\n  get length() {\n    return this.children.length;\n  }\n\n  /**\n   * get the all context, i.e one with all columns of this ranking\n   * @return {ColumnContext}\n   */\n  get all() {\n    if (this._all == null) {\n      this._all = this.allFactory ? this.allFactory() : null;\n    }\n    return this._all!;\n  }\n}\n\n\nexport interface IScriptDesc extends ICompositeNumberDesc {\n  /**\n   * the function to use, it has two parameters: children (current children) and values (their row values)\n   * @default 'return Math.max.apply(Math,values)'\n   */\n  script?: string;\n}\n\nexport declare type IScriptColumnDesc = IScriptDesc & ICompositeNumberDesc;\n\n/**\n * emitted when the script property changes\n * @asMemberOf ScriptColumn\n * @event\n */\nexport declare function scriptChanged(previous: string, current: string): void;\n\n\n@toolbar('script')\nexport default class ScriptColumn extends CompositeNumberColumn {\n  static readonly EVENT_SCRIPT_CHANGED = 'scriptChanged';\n  static readonly DEFAULT_SCRIPT = DEFAULT_SCRIPT;\n\n  private script = ScriptColumn.DEFAULT_SCRIPT;\n  private f: Function | null = null;\n\n  constructor(id: string, desc: Readonly<IScriptColumnDesc>) {\n    super(id, desc);\n    this.script = desc.script || this.script;\n\n    this.setDefaultRenderer('number');\n    this.setDefaultGroupRenderer('number');\n    this.setDefaultSummaryRenderer('number');\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ScriptColumn.EVENT_SCRIPT_CHANGED]);\n  }\n\n  on(type: typeof ScriptColumn.EVENT_SCRIPT_CHANGED, listener: typeof scriptChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  setScript(script: string) {\n    if (this.script === script) {\n      return;\n    }\n    this.f = null;\n    this.fire([ScriptColumn.EVENT_SCRIPT_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.script, this.script = script);\n  }\n\n  getScript() {\n    return this.script;\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.script = this.script;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    this.script = dump.script || this.script;\n    super.restore(dump, factory);\n  }\n\n  protected compute(row: IDataRow) {\n    if (this.f == null) {\n      this.f = new Function('children', 'values', 'raws', 'col', 'row', 'index', wrapWithContext(this.script));\n    }\n    const children = this._children;\n    const values = this._children.map((d) => d.getValue(row));\n    const raws = <number[]>this._children.map((d) => isNumberColumn(d) ? d.getRawNumber(row) : null);\n    const col = new ColumnContext(children.map((c, i) => new ColumnWrapper(c, values[i], raws[i])), () => {\n      const cols = this.findMyRanker()!.flatColumns;\n      return new ColumnContext(cols.map((c) => new ColumnWrapper(c, c.getValue(row), isNumberColumn(c) ? c.getRawNumber(row) : null)));\n    });\n    return this.f.call(this, children, values, raws, col, row.v, row.i);\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      return {\n        value: this.getRawNumber(row),\n        children: this.children.map((d) => d.getExportValue(row, format))\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n}\n","import Column from '../../model/Column';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport {IToolbarDialogAddon} from '../toolbar';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\n\r\n/** @internal */\r\nexport default class AddonDialog extends ADialog {\r\n  constructor(private readonly column: Column, private readonly addons: IToolbarDialogAddon[], dialog: IDialogContext, private readonly ctx: IRankingHeaderContext, private readonly onClick?: ()=>void) {\r\n    super(dialog, {\r\n      fullDialog: Boolean(onClick),\r\n      resetPossible: false\r\n    });\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    for(const addon of this.addons) {\r\n      this.node.insertAdjacentHTML('beforeend', `<strong>${addon.title}</strong>`);\r\n      addon.append(this.column, node, this.dialog, this.ctx);\r\n    }\r\n  }\r\n\r\n  protected submit(): boolean {\r\n    if (this.onClick) {\r\n      this.onClick();\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import Ranking from '../../model/Ranking';\r\nimport Column from '../../model/Column';\r\nimport {ISortCriteria} from '../../model/Ranking';\r\nimport {updateHeader} from '../header';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport SearchBox, {ISearchBoxOptions} from './SearchBox';\r\nimport {isSupportType, categoryOf, isSortingAscByDefault} from '../../model/annotations';\r\nimport {isSortAble, isGroupAble, getToolbarDialogAddons, IToolbarDialogAddon, dialogContext, isGroupSortAble} from '../toolbar';\r\nimport AddonDialog from '../dialogs/AddonDialog';\r\n\r\ninterface IColumnItem {\r\n  col: Column;\r\n  id: string;\r\n  text: string;\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport default class Hierarchy {\r\n  readonly node: HTMLElement;\r\n  readonly groupAdder: SearchBox<IColumnItem>;\r\n  readonly sortAdder: SearchBox<IColumnItem>;\r\n  readonly groupSortAdder: SearchBox<IColumnItem>;\r\n\r\n  constructor(private readonly ctx: IRankingHeaderContext, document: Document) {\r\n    this.node = document.createElement('aside');\r\n    this.node.classList.add('lu-hierarchy', 'lu-feature-advanced', 'lu-feature-ranking');\r\n    this.node.innerHTML = `\r\n      <section class=\"lu-hierarchy-group\">\r\n      </section>\r\n      <section class=\"lu-hierarchy-sort\">\r\n      </section>\r\n      <section class=\"lu-hierarchy-sortgroup\">\r\n      </section>\r\n    `;\r\n    const options = <Partial<ISearchBoxOptions<IColumnItem>>>{\r\n      doc: document,\r\n      placeholder: 'Add Sort Criteria...',\r\n      formatItem: (item: IColumnItem, node: HTMLElement) => {\r\n        node.dataset.typeCat = categoryOf(item.col).name;\r\n        node.dataset.type = item.col.desc.type;\r\n        return item.text;\r\n      },\r\n\r\n    };\r\n    this.groupAdder = new SearchBox(Object.assign({}, options, {\r\n      placeholder: 'Add Grouping Criteria...'\r\n    }));\r\n    this.groupSortAdder = new SearchBox(Object.assign({}, options, {\r\n      placeholder: 'Add Grouping Sort Criteria...'\r\n    }));\r\n    this.sortAdder = new SearchBox(options);\r\n  }\r\n\r\n  update(ranking: Ranking | null) {\r\n    if (!ranking) {\r\n      this.node.style.display = 'none';\r\n      return;\r\n    }\r\n    this.node.style.display = null;\r\n    this.renderGroups(ranking, <HTMLElement>this.node.firstElementChild!);\r\n    this.renderSorting(ranking, <HTMLElement>this.node.children[1]!);\r\n    this.renderGroupSorting(ranking, <HTMLElement>this.node.lastElementChild!);\r\n  }\r\n\r\n  private render<T>(node: HTMLElement, items: T[], toColumn: (item: T)=>Column, extras: (item: T, node: HTMLElement)=>void, addonKey: string, onChange: (item: T, delta: number)=>void) {\r\n    const cache = new Map((<HTMLElement[]>Array.from(node.children)).map((d) => <[string, HTMLElement]>[d.dataset.id, d]));\r\n    node.innerHTML = '';\r\n\r\n    items.forEach((d) => {\r\n      const col = toColumn(d);\r\n      const item = cache.get(col.id);\r\n      if (item) {\r\n        node.appendChild(item);\r\n        updateHeader(item, col);\r\n        return;\r\n      }\r\n      const addons = getToolbarDialogAddons(col, addonKey, this.ctx);\r\n\r\n      node.insertAdjacentHTML('beforeend', `<div data-id=\"${col.id}\" class=\"lu-toolbar\">\r\n      <div class=\"lu-label\">${col.label}</div>\r\n      ${addons.length > 0 ? `<i title=\"Customize\" class=\"lu-action\"><span aria-hidden=\"true\">Customize</span> </i>` : ''}\r\n      <i title=\"Move Up\" class=\"lu-action\"><span aria-hidden=\"true\">Move Up</span> </i>\r\n      <i title=\"Move Down\" class=\"lu-action\"><span aria-hidden=\"true\">Move Down</span> </i>\r\n      <i title=\"Remove from hierarchy\" class=\"lu-action\"><span aria-hidden=\"true\">Remove from hierarchy</span> </i>\r\n      </div>`);\r\n      const last = <HTMLElement>node.lastElementChild!;\r\n\r\n      function prevent(evt: Event) {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n      }\r\n\r\n      (<HTMLElement>last.querySelector('i[title=\"Move Down\"]')!).onclick = (evt) => {\r\n        prevent(evt);\r\n        onChange(d, + 1);\r\n      };\r\n      (<HTMLElement>last.querySelector('i[title=\"Move Up\"]')!).onclick = (evt) => {\r\n        prevent(evt);\r\n        onChange(d, -1);\r\n      };\r\n      (<HTMLElement>last.querySelector('i[title^=Remove]')!).onclick = (evt) => {\r\n        prevent(evt);\r\n        onChange(d, 0);\r\n      };\r\n\r\n      if (addons.length > 0) {\r\n        (<HTMLElement>last.querySelector('i[title=Customize]')!).onclick = (evt) => {\r\n          prevent(evt);\r\n          this.customize(col, addons, <any>evt);\r\n        };\r\n      }\r\n\r\n      extras(d, last);\r\n\r\n      updateHeader(last, col);\r\n    });\r\n  }\r\n\r\n  private renderGroups(ranking: Ranking, node: HTMLElement) {\r\n    const groups = ranking.getGroupCriteria();\r\n\r\n    if (groups.length === 0) {\r\n      node.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    const click = (col: Column, delta: number) => {\r\n      if (delta === 0) {\r\n        col.groupByMe();\r\n        return;\r\n      }\r\n      const current = col.isGroupedBy();\r\n      col.findMyRanker()!.groupBy(col, current + delta);\r\n    };\r\n\r\n    const addButton = (_: Column, last: HTMLElement) => {\r\n      last.insertAdjacentHTML('afterbegin', `<i title=\"Group\" class=\"lu-action\" data-group=\"true\"><span aria-hidden=\"true\">Group</span> </i>`);\r\n    };\r\n\r\n    this.render(node, groups, (d) => d, addButton, 'group', click);\r\n    this.addGroupAdder(ranking, groups, node);\r\n  }\r\n\r\n  private renderSorting(ranking: Ranking, node: HTMLElement) {\r\n    const sortCriterias = ranking.getSortCriteria();\r\n\r\n    if (sortCriterias.length === 0) {\r\n      node.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    const click = ({col}: ISortCriteria, delta: number) => {\r\n      const current = col.isSortedByMe();\r\n      if (!isFinite(delta)) {\r\n        col.sortByMe(current.asc === 'desc', current.priority);\r\n        return;\r\n      }\r\n      if (delta === 0) {\r\n        col.sortByMe(current.asc === 'asc', -1);\r\n        return;\r\n      }\r\n      col.sortByMe(current.asc === 'asc', current.priority! + delta);\r\n    };\r\n\r\n    const addButton = (s: ISortCriteria, last: HTMLElement) => {\r\n      last.insertAdjacentHTML('afterbegin', `\r\n      <i title=\"Sort\" class=\"lu-action\" data-sort=\"${s.asc ? 'asc' : 'desc'}\"><span aria-hidden=\"true\">Toggle Sorting</span> </i>`);\r\n      (<HTMLElement>last.querySelector('i[title=Sort]')!).onclick = (evt) => {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        click(s, Infinity);\r\n      };\r\n    };\r\n\r\n    this.render(node, sortCriterias, (d) => d.col, addButton, 'sort', click);\r\n\r\n    this.addSortAdder(ranking, sortCriterias, node);\r\n  }\r\n\r\n  private renderGroupSorting(ranking: Ranking, node: HTMLElement) {\r\n    const sortCriterias = ranking.getGroupSortCriteria();\r\n\r\n    if (sortCriterias.length === 0) {\r\n      node.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    const click = ({col}: ISortCriteria, delta: number) => {\r\n      const current = col.isGroupSortedByMe();\r\n      if (!isFinite(delta)) {\r\n        col.groupSortByMe(current.asc === 'desc', current.priority);\r\n        return;\r\n      }\r\n      if (delta === 0) {\r\n        col.groupSortByMe(current.asc === 'asc', -1);\r\n        return;\r\n      }\r\n      col.groupSortByMe(current.asc === 'asc', current.priority! + delta);\r\n    };\r\n\r\n    const addButton = (s: ISortCriteria, last: HTMLElement) => {\r\n      last.insertAdjacentHTML('afterbegin', `\r\n      <i title=\"Sort Group\" class=\"lu-action\" data-sort=\"${s.asc ? 'asc' : 'desc'}\"><span aria-hidden=\"true\">Toggle Sorting</span> </i>`);\r\n      (<HTMLElement>last.querySelector('i[title=\"Sort Group\"]')!).onclick = (evt) => {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        click(s, Infinity);\r\n      };\r\n    };\r\n\r\n    this.render(node, sortCriterias, (d) => d.col, addButton, 'sortGroup', click);\r\n\r\n    this.addGroupSortAdder(ranking, sortCriterias, node);\r\n  }\r\n\r\n  private addAdder(adder: SearchBox<IColumnItem>, ranking: Ranking, addonKey: string, current: Column[], node: HTMLElement, check: (col: Column)=>boolean, onSelect: (col: Column)=>void) {\r\n    const used = new Set(current);\r\n\r\n    adder.data = ranking.children.filter((col) => !isSupportType(col) && !used.has(col) && check(col)).map((col) => ({col, id: col.id, text: col.label}));\r\n\r\n    adder.on(SearchBox.EVENT_SELECT, (item: IColumnItem) => {\r\n      const addons = getToolbarDialogAddons(item.col, addonKey, this.ctx);\r\n      if (addons.length > 0) {\r\n        this.customize(item.col, addons, { currentTarget: adder.node}, () => onSelect(item.col));\r\n      } else {\r\n        onSelect(item.col);\r\n      }\r\n    });\r\n\r\n    if (adder.data.length <= 0) {\r\n      return;\r\n    }\r\n\r\n    console.assert(node.ownerDocument != null);\r\n    const wrapper = node.ownerDocument!.createElement('footer');\r\n    wrapper.appendChild(adder.node);\r\n    node.appendChild(wrapper);\r\n  }\r\n\r\n  private addSortAdder(ranking: Ranking, sortCriterias: ISortCriteria[], node: HTMLElement) {\r\n    this.addAdder(this.sortAdder, ranking, 'sort', sortCriterias.map((d) => d.col), node, (d) => isSortAble(d, this.ctx), (col) => {\r\n      ranking.sortBy(col, isSortingAscByDefault(col), sortCriterias.length);\r\n    });\r\n  }\r\n\r\n  private addGroupAdder(ranking: Ranking, groups: Column[], node: HTMLElement) {\r\n    this.addAdder(this.groupAdder, ranking, 'group', groups, node, (d) => isGroupAble(d, this.ctx), (col) => {\r\n      ranking.groupBy(col, groups.length);\r\n    });\r\n  }\r\n\r\n  private addGroupSortAdder(ranking: Ranking, sortCriterias: ISortCriteria[], node: HTMLElement) {\r\n    this.addAdder(this.groupSortAdder, ranking, 'sortGroup', sortCriterias.map((d) => d.col), node, (d) => isGroupSortAble(d, this.ctx), (col) => {\r\n      ranking.groupSortBy(col, isSortingAscByDefault(col), sortCriterias.length);\r\n    });\r\n  }\r\n\r\n  private customize(col: Column, addons: IToolbarDialogAddon[], evt: { currentTarget: Element }, onClick?: ()=>void) {\r\n    const dialog = new AddonDialog(col, addons, dialogContext(this.ctx, 0, evt), this.ctx, onClick);\r\n    dialog.open();\r\n  }\r\n}\r\n\r\n","import Column from '../../model/Column';\r\nimport {ISummaryRenderer} from '../../renderer/interfaces';\r\nimport {dragAbleColumn, updateHeader, createShortcutMenuItems} from '../header';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport {NumberColumn} from '../../model';\r\n\r\n/** @internal */\r\nexport default class SidePanelEntryVis {\r\n  readonly node: HTMLElement;\r\n  private readonly summary: ISummaryRenderer;\r\n\r\n  constructor(public readonly column: Column, private ctx: IRankingHeaderContext, document: Document) {\r\n    this.node = document.createElement('article');\r\n    this.node.classList.add('lu-side-panel-entry');\r\n    this.node.dataset.colId = column.id;\r\n    this.node.dataset.type = column.desc.type;\r\n\r\n    this.summary = ctx.summaryRenderer(column, true);\r\n\r\n    this.column.on([`${NumberColumn.EVENT_FILTER_CHANGED}.panel`, `${Column.EVENT_DIRTY_HEADER}.panel`], () => {\r\n      this.update();\r\n    });\r\n    this.init();\r\n    this.update();\r\n  }\r\n\r\n  private init() {\r\n    this.node.innerHTML = `\r\n      <header><div class=\"lu-label\"></div><div class=\"lu-toolbar\"></div></header>${this.summary.template}`;\r\n    createShortcutMenuItems(<HTMLElement>this.node.querySelector('.lu-toolbar'), 0, this.column, this.ctx, false);\r\n    dragAbleColumn(<HTMLElement>this.node.querySelector('header'), this.column, this.ctx);\r\n\r\n    const summary = <HTMLElement>this.node.lastElementChild!;\r\n    summary.classList.add('lu-summary');\r\n    summary.dataset.renderer = this.column.getSummaryRenderer();\r\n    summary.dataset.interactive = '';\r\n  }\r\n\r\n  update(ctx: IRankingHeaderContext = this.ctx) {\r\n    this.ctx = ctx;\r\n    updateHeader(this.node, this.column);\r\n    this.summary.update(<HTMLElement>this.node.querySelector('.lu-summary')!, ctx.statsOf(<any>this.column));\r\n  }\r\n\r\n  destroy() {\r\n    this.column.on([`${NumberColumn.EVENT_FILTER_CHANGED}.panel`, `${Column.EVENT_DIRTY_HEADER}.panel`], null);\r\n    this.node.remove();\r\n  }\r\n}\r\n","import Ranking from '../../model/Ranking';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class RenameRankingDialog extends ADialog {\r\n\r\n  private readonly before: string;\r\n\r\n  constructor(private readonly ranking: Ranking, dialog: IDialogContext) {\r\n    super(dialog, {\r\n      fullDialog: true\r\n    });\r\n    this.before = ranking.getLabel();\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-rename-dialog');\r\n    node.insertAdjacentHTML('beforeend', `\r\n      <input type=\"text\" value=\"${this.ranking.getLabel()}\" required autofocus placeholder=\"name\">`);\r\n  }\r\n\r\n  protected reset() {\r\n    this.findInput('input[type=\"text\"]').value = this.before;\r\n    this.ranking.setLabel(this.before);\r\n  }\r\n\r\n  protected submit() {\r\n    const newValue = this.findInput('input[type=\"text\"]').value;\r\n    this.ranking.setLabel(newValue);\r\n    return true;\r\n  }\r\n}\r\n","import Ranking from '../../model/Ranking';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport {dialogContext} from '../toolbar';\r\nimport ADialog, {IDialogContext} from './ADialog';\r\nimport RenameRankingDialog from './RenameRankingDialog';\r\n\r\n/** @internal */\r\nexport default class MoreRankingOptionsDialog extends ADialog {\r\n\r\n  constructor(private readonly ranking: Ranking, dialog: IDialogContext, private readonly ctx: IRankingHeaderContext) {\r\n    super(dialog);\r\n  }\r\n\r\n  private addIcon(node: HTMLElement, title: string, onClick: (evt: MouseEvent)=>void) {\r\n    node.insertAdjacentHTML('beforeend', `<i title=\"${title}\" class=\"lu-action\"><span>${title}</span> </i>`);\r\n    const i = <HTMLElement>node.lastElementChild;\r\n    i.onclick = (evt) => {\r\n      evt.stopPropagation();\r\n      onClick(evt);\r\n    };\r\n  }\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-more-options');\r\n    this.addIcon(node, 'Rename', (evt) => {\r\n      const dialog = new RenameRankingDialog(this.ranking, dialogContext(this.ctx, this.level + 1, <any>evt));\r\n      dialog.open();\r\n    });\r\n    this.addIcon(node, 'Remove', () => {\r\n      this.destroy();\r\n      this.ctx.provider.removeRanking(this.ranking);\r\n    });\r\n  }\r\n}\r\n","import {suffix} from '../../internal/AEventDispatcher';\r\nimport {isSupportType} from '../../model';\r\nimport Ranking from '../../model/Ranking';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport Hierarchy from './Hierarchy';\r\nimport {ISidePanelOptions} from './SidePanel';\r\nimport SidePanelEntryVis from './SidePanelEntryVis';\r\nimport {dialogContext} from '../toolbar';\r\nimport MoreRankingOptionsDialog from '../dialogs/MoreRankingOptionsDialog';\r\n\r\n\r\nexport default class SidePanelRanking {\r\n\r\n  readonly header: HTMLElement;\r\n  readonly dropdown: HTMLElement;\r\n  readonly node: HTMLElement;\r\n  private readonly hierarchy: Hierarchy | null;\r\n  private readonly entries = new Map<string, SidePanelEntryVis>();\r\n\r\n  constructor(public readonly ranking: Ranking, private ctx: IRankingHeaderContext, document: Document, private readonly options: Readonly<ISidePanelOptions>) {\r\n    this.node = document.createElement('section');\r\n    this.header = document.createElement('div');\r\n    this.dropdown = document.createElement('div');\r\n\r\n    this.dropdown.innerHTML = this.header.innerHTML = `<span>${ranking.getLabel()}</span><i class=\"lu-action\" title=\"More &hellip;\"><span aria-hidden=\"true\">More &hellip;\"></span></i>`;\r\n    (<HTMLElement>this.header.lastElementChild!).onclick = (<HTMLElement>this.dropdown.lastElementChild!).onclick = (evt) => {\r\n      evt.stopPropagation();\r\n      const dialog = new MoreRankingOptionsDialog(ranking, dialogContext(ctx, 1, <any>evt), ctx);\r\n      dialog.open();\r\n    };\r\n\r\n    this.hierarchy = this.options.hierarchy ? new Hierarchy(ctx, document) : null;\r\n\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    this.node.innerHTML = `\r\n      <div><main></main></div>\r\n    `;\r\n    if (this.hierarchy) {\r\n      this.node.insertBefore(this.hierarchy.node, this.node.firstChild);\r\n    }\r\n\r\n    if (this.hierarchy) {\r\n      this.ranking.on(suffix('.panel', Ranking.EVENT_GROUP_CRITERIA_CHANGED, Ranking.EVENT_SORT_CRITERIA_CHANGED, Ranking.EVENT_GROUP_SORT_CRITERIA_CHANGED), () => {\r\n        this.updateHierarchy();\r\n      });\r\n    }\r\n    this.ranking.on(suffix('.panel', Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_REMOVE_COLUMN, Ranking.EVENT_MOVE_COLUMN), () => {\r\n      this.updateList();\r\n      this.updateHierarchy();\r\n    });\r\n    this.ranking.on(suffix('.panel', Ranking.EVENT_LABEL_CHANGED), () => {\r\n      this.dropdown.firstElementChild!.textContent = this.header.firstElementChild!.textContent = this.ranking.getLabel();\r\n    });\r\n  }\r\n\r\n  get active() {\r\n    return this.node.classList.contains('lu-active');\r\n  }\r\n\r\n  set active(value: boolean) {\r\n    this.node.classList.toggle('lu-active', value);\r\n    this.header.classList.toggle('lu-active', value);\r\n    this.dropdown.classList.toggle('lu-active', value);\r\n    if (value) {\r\n      return;\r\n    }\r\n    this.updateList();\r\n    this.updateHierarchy();\r\n  }\r\n\r\n  update(ctx: IRankingHeaderContext) {\r\n    this.ctx = ctx;\r\n    this.updateList();\r\n    this.updateHierarchy();\r\n  }\r\n\r\n  private updateHierarchy() {\r\n    if (!this.hierarchy || !this.active) {\r\n      return;\r\n    }\r\n    this.hierarchy.update(this.ranking);\r\n  }\r\n\r\n  private updateList() {\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    const node = this.node.querySelector('main')!;\r\n    const columns = this.ranking.flatColumns.filter((d) => !isSupportType(d));\r\n\r\n    if (columns.length === 0) {\r\n      node.innerHTML = '';\r\n      this.entries.forEach((d) => d.destroy());\r\n      this.entries.clear();\r\n      return;\r\n    }\r\n\r\n    node.innerHTML = ``;\r\n\r\n    const copy = new Map(this.entries);\r\n    this.entries.clear();\r\n\r\n    columns.forEach((col) => {\r\n      const existing = copy.get(col.id);\r\n      if (existing) {\r\n        existing.update(this.ctx);\r\n        node.appendChild(existing.node);\r\n        this.entries.set(col.id, existing);\r\n        copy.delete(col.id);\r\n        return;\r\n      }\r\n\r\n      console.assert(node.ownerDocument != null);\r\n      const entry = new SidePanelEntryVis(col, this.ctx, node.ownerDocument!);\r\n      node.appendChild(entry.node);\r\n      this.entries.set(col.id, entry);\r\n    });\r\n\r\n    copy.forEach((d) => d.destroy());\r\n  }\r\n\r\n  destroy() {\r\n    this.header.remove();\r\n    this.node.remove();\r\n    this.ranking.on(suffix('.panel', Ranking.EVENT_GROUP_CRITERIA_CHANGED, Ranking.EVENT_SORT_CRITERIA_CHANGED, Ranking.EVENT_GROUP_SORT_CRITERIA_CHANGED, Ranking.EVENT_ADD_COLUMN, Ranking.EVENT_MOVE_COLUMN, Ranking.EVENT_REMOVE_COLUMN, Ranking.EVENT_LABEL_CHANGED), null);\r\n\r\n    this.entries.forEach((d) => d.destroy());\r\n    this.entries.clear();\r\n  }\r\n}\r\n","import ADialog, {IDialogContext} from './ADialog';\r\n\r\n/** @internal */\r\nexport default class ChooseRankingDialog extends ADialog {\r\n\r\n  constructor(private readonly items: HTMLElement[], dialog: IDialogContext) {\r\n    super(dialog);\r\n  }\r\n\r\n\r\n  protected build(node: HTMLElement) {\r\n    node.classList.add('lu-more-options', 'lu-choose-options');\r\n    for (const item of this.items) {\r\n      node.appendChild(item);\r\n    }\r\n  }\r\n}\r\n","import {suffix} from '../../internal/AEventDispatcher';\r\nimport {\r\n  createImpositionDesc,\r\n  createNestedDesc,\r\n  createReduceDesc,\r\n  createScriptDesc,\r\n  createStackDesc,\r\n  createRankDesc,\r\n  createGroupDesc,\r\n  createAggregateDesc,\r\n  createSelectionDesc,\r\n  IColumnDesc\r\n} from '../../model';\r\nimport {categoryOfDesc, IColumnCategory} from '../../model/annotations';\r\nimport Ranking from '../../model/Ranking';\r\nimport DataProvider, {IDataProvider} from '../../provider/ADataProvider';\r\nimport {IRankingHeaderContext} from '../interfaces';\r\nimport SearchBox, {IGroupSearchItem, ISearchBoxOptions} from './SearchBox';\r\nimport SidePanelRanking from './SidePanelRanking';\r\nimport {dialogContext} from '../toolbar';\r\nimport ChooseRankingDialog from '../dialogs/ChooseRankingDialog';\r\n\r\n\r\ninterface IColumnWrapper {\r\n  desc: IColumnDesc;\r\n  category: IColumnCategory;\r\n  id: string;\r\n  text: string;\r\n}\r\n\r\nfunction isWrapper(item: IColumnWrapper | IGroupSearchItem<IColumnWrapper>): item is IColumnWrapper {\r\n  return (<IColumnWrapper>item).desc != null;\r\n}\r\n\r\nexport interface ISidePanelOptions extends Partial<ISearchBoxOptions<IColumnWrapper>> {\r\n  additionalDescs: IColumnDesc[];\r\n  chooser: boolean;\r\n  hierarchy: boolean;\r\n  collapseable: boolean | 'collapsed';\r\n}\r\n\r\nexport default class SidePanel {\r\n\r\n  private readonly options: ISidePanelOptions = {\r\n    additionalDescs: [\r\n      createStackDesc('Weighted Sum'),\r\n      createScriptDesc('Scripted Formula'),\r\n      createNestedDesc('Nested'),\r\n      createReduceDesc(),\r\n      createImpositionDesc(),\r\n      createRankDesc(),\r\n      createSelectionDesc(),\r\n      createGroupDesc(),\r\n      createAggregateDesc(),\r\n    ],\r\n    chooser: true,\r\n    hierarchy: true,\r\n    placeholder: 'Add Column...',\r\n    formatItem: (item: IColumnWrapper | IGroupSearchItem<IColumnWrapper>, node: HTMLElement) => {\r\n      const w: IColumnWrapper = isWrapper(item) ? item : (<IColumnWrapper>item.children[0]);\r\n      node.dataset.typeCat = w.category.name;\r\n      if (isWrapper(item)) {\r\n        node.dataset.type = w.desc.type;\r\n      }\r\n      if (node.parentElement) {\r\n        node.parentElement.classList.add('lu-feature-model');\r\n        node.parentElement.classList.toggle('lu-feature-advanced', w.category.featureLevel === 'advanced');\r\n        node.parentElement.classList.toggle('lu-feature-basic', w.category.featureLevel === 'basic');\r\n      }\r\n      return item.text;\r\n    },\r\n    collapseable: true\r\n  };\r\n\r\n  readonly node: HTMLElement;\r\n  private readonly search: SearchBox<IColumnWrapper> | null;\r\n  private chooser: HTMLElement | null = null;\r\n  private readonly descs: IColumnWrapper[] = [];\r\n  private data: IDataProvider;\r\n  private readonly rankings: SidePanelRanking[] = [];\r\n\r\n  constructor(private ctx: IRankingHeaderContext, document: Document, options: Partial<ISidePanelOptions> = {}) {\r\n    Object.assign(this.options, options);\r\n\r\n    this.node = document.createElement('aside');\r\n    this.node.classList.add('lu-side-panel');\r\n\r\n    this.search = this.options.chooser ? new SearchBox<IColumnWrapper>(this.options) : null;\r\n\r\n    this.data = ctx.provider;\r\n    this.init();\r\n    this.update(ctx);\r\n  }\r\n\r\n  private init() {\r\n    this.node.innerHTML = `\r\n      <aside class=\"lu-stats\"></aside>\r\n      <header>\r\n        <i class=\"lu-action\" title=\"Choose &hellip;\"><span aria-hidden=\"true\">Choose &hellip;</span></i>\r\n      </header>\r\n      <main></main>\r\n    `;\r\n\r\n    {\r\n      const choose = <HTMLElement>this.node.querySelector('header > i');\r\n      choose.onclick = (evt) => {\r\n        evt.stopPropagation();\r\n        const dialog = new ChooseRankingDialog(this.rankings.map((d) => d.dropdown), dialogContext(this.ctx, 1, <any>evt));\r\n        dialog.open();\r\n      };\r\n    }\r\n\r\n    if (this.options.collapseable) {\r\n      this.node.insertAdjacentHTML('beforeend', `<div class=\"lu-collapser\" title=\"Collapse Panel\"></div>`);\r\n      const last = <HTMLElement>this.node.lastElementChild;\r\n      last.onclick = () => this.collapsed = !this.collapsed;\r\n      this.collapsed = this.options.collapseable === 'collapsed';\r\n    }\r\n    this.initChooser();\r\n    this.changeDataStorage(null, this.data);\r\n  }\r\n\r\n  private initChooser() {\r\n    if (!this.search) {\r\n      return;\r\n    }\r\n    console.assert(this.node.ownerDocument != null);\r\n    this.chooser = this.node.ownerDocument!.createElement('header');\r\n    this.chooser.innerHTML = '<form></form>';\r\n    this.chooser.firstElementChild!.appendChild(this.search.node);\r\n    this.search.on(SearchBox.EVENT_SELECT, (panel: IColumnWrapper) => {\r\n      const col = this.data.create(panel.desc);\r\n      if (!col) {\r\n        return;\r\n      }\r\n      const a = this.active;\r\n      if (a) {\r\n        a.ranking.push(col);\r\n      }\r\n    });\r\n  }\r\n\r\n  private get active() {\r\n    return this.rankings.find((d) => d.active);\r\n  }\r\n\r\n  private changeDataStorage(old: IDataProvider | null, data: IDataProvider) {\r\n    if (old) {\r\n      old.on(suffix('.panel', DataProvider.EVENT_ADD_RANKING, DataProvider.EVENT_REMOVE_RANKING,\r\n        DataProvider.EVENT_ADD_DESC, DataProvider.EVENT_CLEAR_DESC, DataProvider.EVENT_ORDER_CHANGED, DataProvider.EVENT_SELECTION_CHANGED), null);\r\n    }\r\n    this.data = data;\r\n\r\n    const wrapDesc = (desc: IColumnDesc) => ({\r\n        desc,\r\n        category: categoryOfDesc(desc, data.columnTypes),\r\n        id: `${desc.type}@${desc.label}`,\r\n        text: desc.label\r\n      });\r\n    this.descs.splice(0, this.descs.length, ...data.getColumns().concat(this.options.additionalDescs).map(wrapDesc));\r\n\r\n    data.on(`${DataProvider.EVENT_ADD_DESC}.panel`, (desc) => {\r\n      this.descs.push(wrapDesc(desc));\r\n      this.updateChooser();\r\n    });\r\n\r\n    data.on(`${DataProvider.EVENT_CLEAR_DESC}.panel`, () => {\r\n      this.descs.splice(0, this.descs.length);\r\n      this.updateChooser();\r\n    });\r\n\r\n    data.on(suffix('.panel', DataProvider.EVENT_SELECTION_CHANGED, DataProvider.EVENT_ORDER_CHANGED), () => {\r\n      this.updateStats();\r\n    });\r\n\r\n    data.on(suffix('.panel', DataProvider.EVENT_ADD_RANKING), (ranking: Ranking, index: number) => {\r\n      this.createEntry(ranking, index);\r\n      this.makeActive(index);\r\n    });\r\n\r\n    data.on(suffix('.panel', DataProvider.EVENT_REMOVE_RANKING), (_: Ranking, index: number) => {\r\n      if (index < 0) {\r\n        // remove all\r\n        this.rankings.splice(0, this.rankings.length).forEach((d) => d.destroy());\r\n        this.node.querySelector('header')!.dataset.count = '0';\r\n        this.makeActive(-1);\r\n        return;\r\n      }\r\n      const r = this.rankings.splice(index, 1)[0];\r\n      this.node.querySelector('header')!.dataset.count = String(this.rankings.length);\r\n      r.destroy();\r\n      if (r.active) {\r\n        this.makeActive(this.rankings.length === 0 ? -1 : Math.max(index - 1, 0));\r\n      }\r\n    });\r\n\r\n    this.rankings.splice(0, this.rankings.length).forEach((d) => d.destroy());\r\n    data.getRankings().forEach((d, i) => {\r\n      this.createEntry(d, i);\r\n    });\r\n    if (this.rankings.length > 0) {\r\n      this.makeActive(0);\r\n    }\r\n\r\n    this.updateStats();\r\n  }\r\n\r\n  private createEntry(ranking: Ranking, index: number) {\r\n    console.assert(this.node.ownerDocument != null);\r\n    const entry = new SidePanelRanking(ranking, this.ctx, this.node.ownerDocument!, this.options);\r\n\r\n    const header = this.node.querySelector('header')!;\r\n    const main = this.node.querySelector('main')!;\r\n\r\n    header.insertBefore(entry.header, header.children[index + 1]); // for the action\r\n    header.dataset.count = String(this.rankings.length + 1);\r\n\r\n    entry.header.onclick = (evt) => {\r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n      this.makeActive(this.rankings.indexOf(entry));\r\n    };\r\n    entry.dropdown.onclick = entry.header.onclick = (evt) => {\r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n      this.ctx.dialogManager.removeAboveLevel(0);\r\n      this.makeActive(this.rankings.indexOf(entry));\r\n    };\r\n\r\n    main.insertBefore(entry.node, main.children[index]);\r\n\r\n    this.rankings.splice(index, 0, entry);\r\n  }\r\n\r\n  get collapsed() {\r\n    return this.node.classList.contains('lu-collapsed');\r\n  }\r\n\r\n  set collapsed(value: boolean) {\r\n    this.node.classList.toggle('lu-collapsed', value);\r\n    if (value) {\r\n      return;\r\n    }\r\n    this.updateChooser();\r\n    this.updateStats();\r\n    this.updateRanking();\r\n  }\r\n\r\n  private makeActive(index: number) {\r\n    this.rankings.forEach((d, i) => d.active = index === i);\r\n\r\n    const active = this.active;\r\n    if (active && this.chooser) {\r\n      active.node.insertAdjacentElement('afterbegin', this.chooser);\r\n      // scroll to body\r\n      const parent = <HTMLElement>this.node.closest('.lu')!;\r\n      const body = parent ? parent.querySelector(`article[data-ranking=\"${active.ranking.id}\"]`) : null;\r\n      if (body) {\r\n        body.scrollIntoView();\r\n      }\r\n    }\r\n    this.updateRanking();\r\n  }\r\n\r\n  private updateRanking() {\r\n    const active = this.active;\r\n    if (active && !this.collapsed) {\r\n      active.update(this.ctx);\r\n    }\r\n  }\r\n\r\n  update(ctx: IRankingHeaderContext) {\r\n    const bak = this.data;\r\n    this.ctx = ctx;\r\n    if (ctx.provider !== bak) {\r\n      this.changeDataStorage(bak, ctx.provider);\r\n    }\r\n    this.updateChooser();\r\n    this.updateStats();\r\n\r\n    const active = this.active;\r\n    if (active) {\r\n      active.update(ctx);\r\n    }\r\n  }\r\n\r\n  private updateStats() {\r\n    if (this.collapsed) {\r\n      return;\r\n    }\r\n    const stats = <HTMLElement>this.node.querySelector('aside.lu-stats');\r\n    const s = this.data.getSelection();\r\n    const r = this.data.getFirstRanking();\r\n    const visible = r ? r.getGroups().reduce((a, b) => a + b.order.length, 0) : 0;\r\n    stats.innerHTML = `Showing <strong>${visible}</strong> of ${this.data.getTotalNumberOfRows()} items${s.length > 0 ? `; <span>${s.length} selected</span>` : ''}`;\r\n  }\r\n\r\n  destroy() {\r\n    this.node.remove();\r\n    if (!this.data) {\r\n      return;\r\n    }\r\n    this.rankings.forEach((d) => d.destroy());\r\n    this.rankings.length = 0;\r\n    this.data.on(suffix('.panel', DataProvider.EVENT_ADD_RANKING, DataProvider.EVENT_REMOVE_RANKING,\r\n      DataProvider.EVENT_ADD_DESC), null);\r\n  }\r\n\r\n  private static groupByType(entries: IColumnWrapper[]): { text: string, children: IColumnWrapper[] }[] {\r\n    const map = new Map<IColumnCategory, IColumnWrapper[]>();\r\n    entries.forEach((entry) => {\r\n      if (!map.has(entry.category)) {\r\n        map.set(entry.category, [entry]);\r\n      } else {\r\n        map.get(entry.category)!.push(entry);\r\n      }\r\n    });\r\n    return Array.from(map).map(([key, value]) => {\r\n      return {\r\n        text: key.label,\r\n        order: key.order,\r\n        children: value.sort((a, b) => a.text.localeCompare(b.text))\r\n      };\r\n    }).sort((a, b) => a.order - b.order);\r\n  }\r\n\r\n  private updateChooser() {\r\n    if (!this.search || this.collapsed) {\r\n      return;\r\n    }\r\n    this.search.data = SidePanel.groupByType(this.descs);\r\n  }\r\n}\r\n","import {IExceptionContext, range, ITableSection} from 'lineupengine';\r\nimport {IDataRow, IGroup, IGroupData, IGroupItem, isGroup} from '../model';\r\nimport {SLOPEGRAPH_WIDTH} from '../styles';\r\nimport {IRankingHeaderContextContainer} from './interfaces';\r\n\r\ninterface ISlope {\r\n  isSelected(selection: {has(dataIndex: number): boolean}): boolean;\r\n\r\n  update(path: SVGPathElement, width: number): void;\r\n\r\n  readonly dataIndices: number[];\r\n}\r\n\r\nclass ItemSlope implements ISlope {\r\n  constructor(private readonly left: number, private readonly right: number, public readonly dataIndices: number[]) {\r\n\r\n  }\r\n\r\n  isSelected(selection: {has(dataIndex: number): boolean}) {\r\n    return this.dataIndices.length === 1 ? selection.has(this.dataIndices[0]) : this.dataIndices.some((s) => selection.has(s));\r\n  }\r\n\r\n  update(path: SVGPathElement, width: number) {\r\n    path.setAttribute('data-i', String(this.dataIndices[0]));\r\n    path.setAttribute('class', 'lu-slope');\r\n    path.setAttribute('d', `M0,${this.left}L${width},${this.right}`);\r\n  }\r\n}\r\n\r\nclass GroupSlope implements ISlope {\r\n  constructor(private readonly left: [number, number], private readonly right: [number, number], public readonly dataIndices: number[]) {\r\n\r\n  }\r\n\r\n  isSelected(selection: {has(dataIndex: number): boolean}) {\r\n    return this.dataIndices.some((s) => selection.has(s));\r\n  }\r\n\r\n  update(path: SVGPathElement, width: number) {\r\n    path.setAttribute('class', 'lu-group-slope');\r\n    path.setAttribute('d', `M0,${this.left[0]}L${width},${this.right[0]}L${width},${this.right[1]}L0,${this.left[1]}Z`);\r\n  }\r\n}\r\n\r\ninterface IPos {\r\n  start: number;\r\n  heightPerRow: number;\r\n  rows: number[]; // data indices\r\n  offset: number;\r\n  ref: number[];\r\n  group: IGroup;\r\n}\r\n\r\nexport enum EMode {\r\n  ITEM = 'item',\r\n  BAND = 'band'\r\n}\r\n\r\nexport interface ISlopeGraphOptions {\r\n  mode: EMode;\r\n}\r\n\r\nexport default class SlopeGraph implements ITableSection {\r\n  readonly node: SVGSVGElement;\r\n\r\n  private leftSlopes: ISlope[][] = [];\r\n  // rendered row to one ore multiple slopes\r\n  private rightSlopes: ISlope[][] = [];\r\n  private readonly pool: SVGPathElement[] = [];\r\n\r\n  private scrollListener: ((act: { top: number, height: number}) => void) | null = null;\r\n\r\n  readonly width = SLOPEGRAPH_WIDTH;\r\n  readonly height = 0;\r\n\r\n  private current: {\r\n    left: (IGroupItem | IGroupData)[];\r\n    leftContext: IExceptionContext;\r\n    right: (IGroupItem | IGroupData)[];\r\n    rightContext: IExceptionContext;\r\n  } | null = null;\r\n  private _mode: EMode = EMode.ITEM;\r\n\r\n  constructor(public readonly header: HTMLElement, public readonly body: HTMLElement, public readonly id: string, private readonly ctx: IRankingHeaderContextContainer, options: Partial<ISlopeGraphOptions> = {}) {\r\n    console.assert(header.ownerDocument != null);\r\n    this.node = header.ownerDocument!.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n    this.node.innerHTML = `<g transform=\"translate(0,0)\"></g>`;\r\n    header.classList.add('lu-slopegraph-header');\r\n    this._mode = options.mode === EMode.BAND ? EMode.BAND : EMode.ITEM;\r\n    this.initHeader(header);\r\n    body.classList.add('lu-slopegraph');\r\n    this.body.style.height = `1px`;\r\n    body.appendChild(this.node);\r\n  }\r\n\r\n  init() {\r\n    this.hide(); // hide by default\r\n\r\n    const scroller = <any>this.body.parentElement!;\r\n\r\n    //sync scrolling of header and body\r\n    // use internals from lineup engine\r\n    const scroll = (<any>scroller).__le_scroller__;\r\n    let old: { top: number, height: number} = scroll.asInfo();\r\n    scroll.push('animation', this.scrollListener = (act: { top: number, height: number}) => {\r\n      if (Math.abs(old.top - act.top) < 5) {\r\n        return;\r\n      }\r\n      old = act;\r\n      this.onScrolledVertically(act.top, act.height);\r\n    });\r\n  }\r\n\r\n  private initHeader(header: HTMLElement) {\r\n    header.innerHTML = `<i title=\"Item\" class=\"${this._mode === EMode.ITEM ? 'active' : ''}\"><span aria-hidden=\"true\">Item</span></i>\r\n        <i title=\"Band\" class=\"${this._mode === EMode.BAND ? 'active' : ''}\"><span aria-hidden=\"true\">Band</span></i>`;\r\n\r\n    const icons = <HTMLElement[]>Array.from(header.children);\r\n    icons.forEach((n: HTMLElement, i) => {\r\n      n.onclick = (evt) => {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        if (n.classList.contains('active')) {\r\n          return;\r\n        }\r\n        this.mode = i === 0 ? EMode.ITEM : EMode.BAND;\r\n        icons.forEach((d, j) => d.classList.toggle('active', j === i));\r\n      };\r\n    });\r\n  }\r\n\r\n  get mode() {\r\n    return this._mode;\r\n  }\r\n\r\n  set mode(value: EMode) {\r\n    if (value === this._mode) {\r\n      return;\r\n    }\r\n    this._mode = value;\r\n    if (this.current) {\r\n      this.rebuild(this.current.left, this.current.leftContext, this.current.right, this.current.rightContext);\r\n    }\r\n  }\r\n\r\n  get hidden() {\r\n    return this.header.classList.contains('loading');\r\n  }\r\n\r\n  set hidden(value: boolean) {\r\n    this.header.classList.toggle('loading', value);\r\n    this.body.classList.toggle('loading', value);\r\n  }\r\n\r\n  hide() {\r\n    this.hidden = true;\r\n  }\r\n\r\n  show() {\r\n    const was = this.hidden;\r\n    this.hidden = false;\r\n    if (was) {\r\n      this.revalidate();\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.header.remove();\r\n    if (this.scrollListener) {\r\n      //sync scrolling of header and body\r\n      // use internals from lineup engine\r\n      const scroll = (<any>this.body.parentElement!).__le_scroller__;\r\n      scroll.remove(this.scrollListener);\r\n    }\r\n    this.body.remove();\r\n  }\r\n\r\n  rebuild(left: (IGroupItem | IGroupData)[], leftContext: IExceptionContext, right: (IGroupItem | IGroupData)[], rightContext: IExceptionContext) {\r\n    this.current = {left, leftContext, right, rightContext};\r\n\r\n    const lookup: Map<number, IPos> = this.prepareRightSlopes(right, rightContext);\r\n    this.computeSlopes(left, leftContext, lookup);\r\n\r\n    this.revalidate();\r\n  }\r\n\r\n  private computeSlopes(left: (IGroupItem | IGroupData)[], leftContext: IExceptionContext, lookup: Map<number, IPos>) {\r\n    const mode = this.mode;\r\n    const fakeGroups = new Map<IGroup, ISlope[]>();\r\n\r\n    const createFakeGroup = (first: number, group: IGroup) => {\r\n      let count = 0;\r\n      let height = 0;\r\n      const rows: IDataRow[] = [];\r\n      // find all items in this group, assuming that they are in order\r\n      for (let i = first; i < left.length; ++i) {\r\n        const item = left[i];\r\n        if (isGroup(item) || (<IGroupItem>item).group !== group) {\r\n          break;\r\n        }\r\n        count++;\r\n        height += (leftContext.exceptionsLookup.get(i) || leftContext.defaultRowHeight);\r\n        rows.push(item);\r\n      }\r\n\r\n      const padded = height - leftContext.padding(first + count - 1);\r\n\r\n      const gr = <IGroupData>Object.assign({\r\n        rows\r\n      }, group);\r\n\r\n      return {gr, padded, height};\r\n    };\r\n\r\n    let acc = 0;\r\n    this.leftSlopes = left.map((r, i) => {\r\n\r\n      let height = (leftContext.exceptionsLookup.get(i) || leftContext.defaultRowHeight);\r\n      let padded = height - 0; //leftContext.padding(i);\r\n      const slopes = <ISlope[]>[];\r\n      const start = acc;\r\n\r\n      // shift by item height\r\n      acc += height;\r\n\r\n      let offset = 0;\r\n\r\n      const push = (s: ISlope, right: IPos, common = 1, heightPerRow = 0) => {\r\n        // store slope in both\r\n        slopes.push(s);\r\n        right.ref.forEach((r) => this.rightSlopes[r].push(s));\r\n\r\n        // update the offset of myself and of the right side\r\n        right.offset += common * right.heightPerRow;\r\n        offset += common * heightPerRow;\r\n      };\r\n\r\n      let gr: IGroupData;\r\n\r\n      if (isGroup(r)) {\r\n        gr = r;\r\n      } else {\r\n        const item = (<IGroupItem>r);\r\n        const dataIndex = item.i;\r\n        const right = lookup.get(dataIndex);\r\n\r\n        if (!right) { // no match\r\n          return slopes;\r\n        }\r\n        if (mode === EMode.ITEM) {\r\n          const s = new ItemSlope(start + padded / 2, right.start + right.offset + right.heightPerRow / 2, [dataIndex]);\r\n          push(s, right);\r\n          return slopes;\r\n        }\r\n\r\n        if (fakeGroups.has(item.group)) {\r\n          // already handled by the first one, take the fake slopes\r\n          return fakeGroups.get(item.group)!;\r\n        }\r\n\r\n        const fakeGroup = createFakeGroup(i, item.group);\r\n        gr = fakeGroup.gr;\r\n        height = fakeGroup.height;\r\n        padded = fakeGroup.padded;\r\n        fakeGroups.set(item.group, slopes);\r\n      }\r\n\r\n      // free group items to share\r\n      const free = new Set(gr.rows.map((d) => d.i));\r\n\r\n      const heightPerRow = padded / gr.rows.length;\r\n\r\n      gr.rows.forEach((d) => {\r\n        if (!free.has(d.i)) {\r\n          return; // already handled\r\n        }\r\n        free.delete(d.i);\r\n        const right = lookup.get(d.i);\r\n        if (!right) {\r\n          return; // no matching\r\n        }\r\n        // find all of this group\r\n        const intersection = right.rows.filter((r) => free.delete(r));\r\n        intersection.push(d.i); //self\r\n\r\n        const common = intersection.length;\r\n        let s: ISlope;\r\n        if (common === 1) {\r\n          s = new ItemSlope(start + offset + heightPerRow / 2, right.start + right.offset + right.heightPerRow / 2, [d.i]);\r\n        } else if (mode === EMode.ITEM) {\r\n          // fake item\r\n          s = new ItemSlope(start + offset + heightPerRow * common / 2, right.start + right.offset + right.heightPerRow * common / 2, intersection);\r\n        } else {\r\n          s = new GroupSlope([start + offset, start + offset + heightPerRow * common], [right.start + right.offset, right.start + right.offset + right.heightPerRow * common], intersection);\r\n        }\r\n        push(s, right, common, heightPerRow);\r\n      });\r\n      return slopes;\r\n    });\r\n  }\r\n\r\n  private prepareRightSlopes(right: (IGroupItem | IGroupData)[], rightContext: IExceptionContext) {\r\n    const lookup = new Map<number, IPos>();\r\n    const mode = this.mode;\r\n\r\n    const fakeGroups = new Map<IGroup, IPos>();\r\n    let acc = 0;\r\n\r\n    this.rightSlopes = right.map((r, i) => {\r\n      const height = (rightContext.exceptionsLookup.get(i) || rightContext.defaultRowHeight);\r\n      const padded = height - 0; //rightContext.padding(i);\r\n      const start = acc;\r\n      acc += height;\r\n      const slopes = <ISlope[]>[];\r\n\r\n      const base = {\r\n        start,\r\n        offset: 0,\r\n        ref: [i]\r\n      };\r\n      if (isGroup(r)) {\r\n        const p = Object.assign(base, {\r\n          rows: r.rows.map((d) => d.i),\r\n          heightPerRow: padded / r.rows.length,\r\n          group: r\r\n        });\r\n\r\n        r.rows.forEach((ri) => lookup.set(ri.i, p));\r\n        return slopes;\r\n      }\r\n      // item\r\n      const item = (<IGroupItem>r);\r\n      const dataIndex = r.i;\r\n\r\n      let p = Object.assign(base, {\r\n        rows: [dataIndex],\r\n        heightPerRow: padded,\r\n        group: item.group\r\n      });\r\n\r\n      if (mode === EMode.ITEM) {\r\n        lookup.set(dataIndex, p);\r\n        return slopes;\r\n      }\r\n      // forced band mode\r\n      // merge with the 'ueber' band\r\n      if (!fakeGroups.has(item.group)) {\r\n        p.heightPerRow = height; // include padding\r\n        // TODO just support uniform item height\r\n        fakeGroups.set(item.group, p);\r\n      } else { // reuse old\r\n        p = fakeGroups.get(item.group)!;\r\n        p.rows.push(dataIndex);\r\n        p.ref.push(i);\r\n      }\r\n      lookup.set(dataIndex, p);\r\n      return slopes;\r\n    });\r\n\r\n    return lookup;\r\n  }\r\n\r\n  private revalidate() {\r\n    if (!this.current || this.hidden) {\r\n      return;\r\n    }\r\n    const p = this.body.parentElement!;\r\n    this.onScrolledVertically(p.scrollTop, p.clientHeight);\r\n  }\r\n\r\n\r\n  highlight(dataIndex: number) {\r\n    const old = this.body.querySelector(`[data-i].le-highlighted`);\r\n    if (old) {\r\n      old.classList.remove('le-highlighted');\r\n    }\r\n    if (dataIndex < 0) {\r\n      return;\r\n    }\r\n    const item = this.body.querySelector(`[data-i=\"${dataIndex}\"]`);\r\n    if (item) {\r\n      item.classList.add('le-highlighted');\r\n    }\r\n    return item != null;\r\n  }\r\n\r\n  private onScrolledVertically(scrollTop: number, clientHeight: number) {\r\n    if (!this.current) {\r\n      return;\r\n    }\r\n\r\n    // which lines are currently shown\r\n    const {leftContext, rightContext} = this.current;\r\n    const left = range(scrollTop, clientHeight, leftContext.defaultRowHeight, leftContext.exceptions, leftContext.numberOfRows);\r\n    const right = range(scrollTop, clientHeight, rightContext.defaultRowHeight, rightContext.exceptions, rightContext.numberOfRows);\r\n\r\n    const start = Math.min(left.firstRowPos, right.firstRowPos);\r\n    const end = Math.max(left.endPos, right.endPos);\r\n\r\n    // move to right position\r\n    this.body.style.transform = `translate(0, ${start.toFixed(0)}px)`;\r\n    this.body.style.height = `${(end - start).toFixed(0)}px`;\r\n    (this.node.firstElementChild!).setAttribute('transform', `translate(0,-${start.toFixed(0)})`);\r\n\r\n    this.choose(left.first, left.last, right.first, right.last);\r\n  }\r\n\r\n  private choose(leftVisibleFirst: number, leftVisibleLast: number, rightVisibleFirst: number, rightVisibleLast: number) {\r\n    // assume no separate scrolling\r\n\r\n    const slopes = new Set<ISlope>();\r\n    for (let i = leftVisibleFirst; i <= leftVisibleLast; ++i) {\r\n      this.leftSlopes[i].forEach((s) => slopes.add(s));\r\n    }\r\n    for (let i = rightVisibleFirst; i <= rightVisibleLast; ++i) {\r\n      this.rightSlopes[i].forEach((s) => slopes.add(s));\r\n    }\r\n    this.render(slopes);\r\n  }\r\n\r\n  private render(slopes: Set<ISlope>) {\r\n    const g = <SVGGElement>this.node.firstElementChild!;\r\n    const width = g.ownerSVGElement!.getBoundingClientRect()!.width;\r\n    const paths = this.matchLength(slopes, g);\r\n\r\n    const p = this.ctx.provider;\r\n    const selectionLookup = {has: (dataIndex: number) => p.isSelected(dataIndex)};\r\n\r\n    // update paths\r\n    let i = 0;\r\n    slopes.forEach((s) => {\r\n      const p = paths[i++]; // since a set\r\n      s.update(p, width);\r\n      (<any>p).__data__ = s; // data binding\r\n      const selected = s.isSelected(selectionLookup);\r\n      p.classList.toggle('lu-selected', selected);\r\n      if (selected) {\r\n        g.appendChild(p); // to put it on top\r\n      }\r\n    });\r\n  }\r\n\r\n  private matchLength(slopes: Set<ISlope>, g: SVGGElement) {\r\n    const paths = <SVGPathElement[]>Array.from(g.children);\r\n    for (let i = slopes.size; i < paths.length; ++i) {\r\n      const elem = paths[i];\r\n      this.pool.push(elem);\r\n      elem.remove();\r\n    }\r\n\r\n    for (let i = paths.length; i < slopes.size; ++i) {\r\n      const elem = this.pool.pop();\r\n      if (elem) {\r\n        g.appendChild(elem);\r\n        paths.push(elem);\r\n      } else {\r\n        console.assert(g.ownerDocument != null);\r\n        const path = g.ownerDocument!.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n        path.onclick = (evt) => {\r\n          // d3 style\r\n          const s: ISlope = (<any>path).__data__;\r\n          const p = this.ctx.provider;\r\n          const ids = s.dataIndices;\r\n          if (evt.ctrlKey) {\r\n            ids.forEach((id) => p.toggleSelection(id, true));\r\n          } else {\r\n            // either unset or set depending on the first state\r\n            const isSelected = p.isSelected(ids[0]!);\r\n            p.setSelection(isSelected ? [] : ids);\r\n          }\r\n        };\r\n        g.appendChild(path);\r\n        paths.push(path);\r\n      }\r\n    }\r\n    return paths;\r\n  }\r\n\r\n  updateSelection(selectedDataIndices: Set<number>) {\r\n    const g = this.node.firstElementChild!;\r\n    const paths = <SVGPathElement[]>Array.from(g.children);\r\n\r\n    paths.forEach((p) => {\r\n      const s: ISlope = (<any>p).__data__;\r\n      const selected = s.isSelected(selectedDataIndices);\r\n      p.classList.toggle('lu-selected', selected);\r\n      if (selected) {\r\n        g.appendChild(p); // to put it on top\r\n      }\r\n    });\r\n  }\r\n}\r\n","\r\nexport interface IDragHandleOptions {\r\n  container: HTMLElement|SVGElement;\r\n  filter(evt: MouseEvent): boolean;\r\n  onStart(handle: HTMLElement|SVGElement, x: number, delta: number, evt: MouseEvent): void;\r\n  onDrag(handle: HTMLElement|SVGElement, x: number, delta: number, evt: MouseEvent): void;\r\n  onEnd(handle: HTMLElement|SVGElement, x: number, delta: number, evt: MouseEvent): void;\r\n  minDelta: number;\r\n}\r\n\r\n/**\r\n * allow to change the width of a column using dragging the handle\r\n * @internal\r\n */\r\nexport function dragHandle(handle: HTMLElement|SVGElement, options: Partial<IDragHandleOptions> = {}) {\r\n  const o: Readonly<IDragHandleOptions> = Object.assign({\r\n    container: handle.parentElement!,\r\n    filter: () => true,\r\n    onStart: () => undefined,\r\n    onDrag: () => undefined,\r\n    onEnd: () => undefined,\r\n    minDelta: 2\r\n  }, options);\r\n\r\n  const toContainerRelative = (x: number, elem: HTMLElement|SVGElement) => {\r\n    const rect = elem.getBoundingClientRect();\r\n    return x - rect.left - elem.clientLeft;\r\n  };\r\n\r\n  let start = 0;\r\n  let last = 0;\r\n  let handleShift = 0;\r\n  const mouseMove = (evt: MouseEvent) => {\r\n    if (!o.filter(evt)) {\r\n      return;\r\n    }\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    const end = toContainerRelative(evt.clientX, o.container) - handleShift;\r\n    if (Math.abs(last - end) < o.minDelta) {\r\n      //ignore\r\n      return;\r\n    }\r\n    last = end;\r\n    o.onDrag(handle, end, last - end, evt);\r\n  };\r\n\r\n  const mouseUp = (evt: MouseEvent) => {\r\n    if (!o.filter(evt)) {\r\n      return;\r\n    }\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    const end = toContainerRelative(evt.clientX, o.container) - handleShift;\r\n    o.container.removeEventListener('mousemove', <any>mouseMove);\r\n    o.container.removeEventListener('mouseup', <any>mouseUp);\r\n    o.container.removeEventListener('mouseleave', <any>mouseUp);\r\n\r\n    if (Math.abs(start - end) < 2) {\r\n      //ignore\r\n      return;\r\n    }\r\n    o.onEnd(handle, end, start - end, evt);\r\n  };\r\n  handle.onmousedown = (evt) => {\r\n    if (!o.filter(evt)) {\r\n      return;\r\n    }\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    handleShift = toContainerRelative(evt.clientX, handle);\r\n    start = last = toContainerRelative(evt.clientX, o.container) - handleShift;\r\n    o.container.addEventListener('mousemove', <any>mouseMove);\r\n    o.container.addEventListener('mouseup', <any>mouseUp);\r\n    o.container.addEventListener('mouseleave', <any>mouseUp);\r\n    o.onStart(handle, start, 0, evt);\r\n  };\r\n}\r\n","import {IDataRow} from './interfaces';\r\nimport MultiLevelCompositeColumn from './MultiLevelCompositeColumn';\r\n\r\n/**\r\n * factory for creating a description creating a mean column\r\n * @param label\r\n * @returns {{type: string, label: string}}\r\n */\r\nexport function createNestedDesc(label: string = 'Nested') {\r\n  return {type: 'nested', label};\r\n}\r\n\r\n/**\r\n * a nested column is a composite column where the sorting order is determined by the nested ordering of the children\r\n * i.e., sort by the first child if equal sort by the second child,...\r\n */\r\nexport default class NestedColumn extends MultiLevelCompositeColumn {\r\n\r\n  compare(a: IDataRow, b: IDataRow) {\r\n    const c = this.children;\r\n    for (const ci of c) {\r\n      const ciResult = ci.compare(a, b);\r\n      if (ciResult !== 0) {\r\n        return ciResult;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  getLabel(row: IDataRow) {\r\n    return this.children.map((d) => d.getLabel(row)).join(';');\r\n  }\r\n\r\n  getValue(row: IDataRow) {\r\n    return this.children.map((d) => d.getValue(row)).join(';');\r\n  }\r\n}\r\n","import Column, {widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport {IDataRow} from './interfaces';\nimport StringColumn, {filterChanged, groupingChanged} from './StringColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport ValueColumn, {dataLoaded} from './ValueColumn';\n\n\n/**\n * emitted when the value of a row changes\n * @asMemberOf AnnotateColumn\n * @event\n */\nexport declare function valueChanged(dataIndex: number, previous: string, current: string): void;\n\n/**\n * a string column in which the values can be edited locally\n */\nexport default class AnnotateColumn extends StringColumn {\n  static readonly EVENT_VALUE_CHANGED = 'valueChanged';\n\n  private readonly annotations = new Map<number, string>();\n\n  protected createEventList() {\n    return super.createEventList().concat([AnnotateColumn.EVENT_VALUE_CHANGED]);\n  }\n\n  on(type: typeof AnnotateColumn.EVENT_VALUE_CHANGED, listener: typeof valueChanged | null): this;\n  on(type: typeof StringColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof StringColumn.EVENT_GROUPING_CHANGED, listener: typeof groupingChanged | null): this;\n  on(type: typeof ValueColumn.EVENT_DATA_LOADED, listener: typeof dataLoaded | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(<any>type, listener);\n  }\n\n  getValue(row: IDataRow) {\n    if (this.annotations.has(row.i)) {\n      return this.annotations.get(row.i)!;\n    }\n    return super.getValue(row);\n  }\n\n  dump(toDescRef: (desc: any) => any): any {\n    const r = super.dump(toDescRef);\n    r.annotations = {};\n    this.annotations.forEach((v, k) => {\n      r.annotations[k] = v;\n    });\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    super.restore(dump, factory);\n    if (!dump.annotations) {\n      return;\n    }\n    Object.keys(dump.annotations).forEach((k) => {\n      this.annotations.set(Number(k), dump.annotations[k]);\n    });\n  }\n\n  setValue(row: IDataRow, value: string) {\n    const old = this.getValue(row);\n    if (old === value) {\n      return true;\n    }\n    if (value === '' || value == null) {\n      this.annotations.delete(row.i);\n    } else {\n      this.annotations.set(row.i, value);\n    }\n    this.fire([AnnotateColumn.EVENT_VALUE_CHANGED, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], row.i, old, value);\n    return true;\n  }\n}\n","const TYPE_OBJECT = '[object Object]';\r\n\r\n//credits to https://github.com/vladmiller/dextend/blob/master/lib/dextend.js\r\n/**\r\n * @internal\r\n * @param args\r\n * @returns {any}\r\n */\r\nexport default function merge(...args: any[]) {\r\n  let result = null;\r\n\r\n  for (const toMerge of args) {\r\n    const keys = Object.keys(toMerge);\r\n\r\n    if (result == null) {\r\n      result = toMerge;\r\n      continue;\r\n    }\r\n\r\n    for (const keyName of keys) {\r\n      const value = toMerge[keyName];\r\n\r\n      //merge just POJOs\r\n      if (Object.prototype.toString.call(value) === TYPE_OBJECT && (Object.getPrototypeOf(value) === Object.prototype)) { //pojo\r\n        if (result[keyName] === undefined) {\r\n          result[keyName] = {};\r\n        }\r\n        result[keyName] = merge(result[keyName], value);\r\n      } else if (Array.isArray(value)) {\r\n        if (result[keyName] === undefined) {\r\n          result[keyName] = [];\r\n        }\r\n        result[keyName] = value.concat(result[keyName]);\r\n      } else {\r\n        result[keyName] = value;\r\n      }\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n","import {detect} from 'detect-browser';\r\n\r\nexport const SUPPORTED_FIREFOX_VERSION = 57;\r\nexport const SUPPORTED_CHROME_VERSION = 64;\r\nexport const SUPPORTED_EDGE_VERSION = 16;\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function getUnsupportedBrowserError() {\r\n  const info = detect();\r\n  if (!info) {\r\n    return 'browser cannot be detected';\r\n  }\r\n  const prefix = `unsupported browser detected:`;\r\n  switch(info.name) {\r\n    case 'firefox':\r\n      const fVersion = parseInt(info.version.slice(0, info.version.indexOf('.')), 10);\r\n      if(fVersion <= SUPPORTED_FIREFOX_VERSION && fVersion !== 52) { // ESR\r\n        return `${prefix} Firefox ${info.version} (&lt; ${SUPPORTED_FIREFOX_VERSION})`;\r\n      }\r\n      return null;\r\n    case 'edge':\r\n      const eVersion = parseInt(info.version.slice(0, info.version.indexOf('.')), 10);\r\n      if(eVersion <= SUPPORTED_EDGE_VERSION) {\r\n        return `${prefix} Edge ${info.version} (&lt; ${SUPPORTED_EDGE_VERSION})`;\r\n      }\r\n      return null;\r\n    case 'chrome':\r\n      const cVersion = parseInt(info.version.slice(0, info.version.indexOf('.')), 10);\r\n      if(cVersion <= SUPPORTED_CHROME_VERSION) {\r\n        return `${prefix} Chrome ${info.version} (&lt; ${SUPPORTED_CHROME_VERSION})`;\r\n      }\r\n      return null;\r\n    case 'ie':\r\n      return `${prefix} Internet Explorer`;\r\n  }\r\n  console.warn('unknown browser detected', info, 'assuming fine...');\r\n  return null;\r\n}\r\n/**\r\n * checks whether the current browser is compatible with lineupjs\r\n * @return boolean\r\n */\r\nexport function isBrowserSupported() {\r\n  return getUnsupportedBrowserError() == null;\r\n}\r\n\r\n","import {ILineUpLike} from '../interfaces';\nimport AEventDispatcher from '../internal/AEventDispatcher';\nimport Column from '../model/Column';\nimport DataProvider from '../provider/ADataProvider';\nimport {IEventListener} from '../internal/AEventDispatcher';\nimport {getUnsupportedBrowserError, SUPPORTED_FIREFOX_VERSION, SUPPORTED_CHROME_VERSION, SUPPORTED_EDGE_VERSION} from '../browser';\n\n/**\n * emitted when the highlight changes\n * @asMemberOf ALineUp\n * @param dataIndex the highlghted data index or -1 for none\n * @event\n */\nexport declare function highlightChanged(dataIndex: number): void;\n\n/**\n * emitted when the selection changes\n * @asMemberOf ALineUp\n * @param dataIndices the selected data indices\n * @event\n */\nexport declare function selectionChanged(dataIndices: number[]): void;\n\nexport abstract class ALineUp extends AEventDispatcher implements ILineUpLike {\n  static readonly EVENT_SELECTION_CHANGED = DataProvider.EVENT_SELECTION_CHANGED;\n  static readonly EVENT_HIGHLIGHT_CHANGED = 'highlightChanged';\n\n  private highlightListeners = 0;\n\n  public readonly isBrowserSupported: boolean;\n\n  constructor(public readonly node: HTMLElement, public data: DataProvider, ignoreIncompatibleBrowser: boolean) {\n    super();\n\n    const error = getUnsupportedBrowserError();\n    this.isBrowserSupported = ignoreIncompatibleBrowser || !error;\n\n    if (!this.isBrowserSupported) {\n      this.node.classList.add('lu-unsupported-browser');\n      this.node.innerHTML = `<span>${error}</span>\n      <div class=\"lu-unsupported-browser-hint\">\n        <a href=\"https://www.mozilla.org/en-US/firefox/\" rel=\"noopener\" target=\"_blank\" data-browser=\"firefox\" data-version=\"${SUPPORTED_FIREFOX_VERSION}\"></a>\n        <a href=\"https://www.google.com/chrome/index.html\" rel=\"noopener\" target=\"_blank\" data-browser=\"chrome\" data-version=\"${SUPPORTED_CHROME_VERSION}\" title=\"best support\"></a>\n        <a href=\"https://www.microsoft.com/en-us/windows/microsoft-edge\" rel=\"noopener\" target=\"_blank\" data-browser=\"edge\" data-version=\"${SUPPORTED_EDGE_VERSION}\"></a>\n      </div><span>use the <code>ignoreUnsupportedBrowser=true</code> option to ignore this error at your own risk</span>`;\n    }\n\n    this.forward(this.data, `${DataProvider.EVENT_SELECTION_CHANGED}.main`);\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([ALineUp.EVENT_HIGHLIGHT_CHANGED, ALineUp.EVENT_SELECTION_CHANGED]);\n  }\n\n  on(type: typeof ALineUp.EVENT_HIGHLIGHT_CHANGED, listener: typeof highlightChanged | null): this;\n  on(type: typeof ALineUp.EVENT_SELECTION_CHANGED, listener: typeof selectionChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  destroy() {\n    // just clear since we hand in the node itself\n    this.node.innerHTML = '';\n  }\n\n  dump() {\n    return this.data.dump();\n  }\n\n  abstract update(): void;\n\n  setDataProvider(data: DataProvider, dump?: any) {\n    if (this.data) {\n      this.unforward(this.data, `${DataProvider.EVENT_SELECTION_CHANGED}.taggle`);\n    }\n    this.data = data;\n    if (dump) {\n      this.data.restore(dump);\n    }\n    this.forward(this.data, `${DataProvider.EVENT_SELECTION_CHANGED}.taggle`);\n  }\n\n  getSelection() {\n    return this.data.getSelection();\n  }\n\n  setSelection(dataIndices: number[]) {\n    this.data.setSelection(dataIndices);\n  }\n\n  /**\n   * sorts LineUp by he given column\n   * @param column callback function finding the column to sort\n   * @param ascending\n   * @returns {boolean}\n   */\n  sortBy(column: string | ((col: Column) => boolean), ascending = false) {\n    const col = this.data.find(column);\n    if (col) {\n      col.sortByMe(ascending);\n    }\n    return col != null;\n  }\n\n  abstract setHighlight(dataIndex: number, scrollIntoView: boolean): boolean;\n\n  abstract getHighlight(): number;\n\n  protected listenersChanged(type: string, enabled: boolean) {\n    super.listenersChanged(type, enabled);\n    if (!type.startsWith(ALineUp.EVENT_HIGHLIGHT_CHANGED)) {\n      return;\n    }\n    if (enabled) {\n      this.highlightListeners += 1;\n      if (this.highlightListeners === 1) { // first\n        this.enableHighlightListening(true);\n      }\n    } else {\n      this.highlightListeners -= 1;\n      if (this.highlightListeners === 0) { // last\n        this.enableHighlightListening(false);\n      }\n    }\n  }\n\n  protected enableHighlightListening(_enable: boolean) {\n    // hook\n  }\n}\n\nexport default ALineUp;\n","export {default as Taggle, ITaggleOptions, TaggleRenderer, IRuleInstance, IRule, spaceFillingRule} from './taggle';\r\nexport {default as EngineRenderer} from './EngineRenderer';\r\nexport {default as EngineRanking, IEngineRankingContext, IEngineRankingOptions} from './EngineRanking';\r\nexport {default as SlopeGraph, EMode} from './SlopeGraph';\r\nexport * from './dialogs';\r\nexport * from './panel';\r\nexport * from './toolbar';\r\nexport * from './interfaces';\r\nexport {default as LineUp, ILineUpOptions} from './LineUp';\r\n","import Column, {IColumnDesc, IDataRow} from '../model';\r\nimport {defaultGroup, IOrderedGroup} from '../model/Group';\r\nimport Ranking from '../model/Ranking';\r\nimport ACommonDataProvider from './ACommonDataProvider';\r\nimport {IDataProviderOptions, IStatsBuilder} from './ADataProvider';\r\n\r\n/**\r\n * interface what the server side has to provide\r\n */\r\nexport interface IServerData {\r\n  /**\r\n   * sort the dataset by the given description\r\n   * @param ranking\r\n   */\r\n  sort(ranking: Ranking): Promise<number[]>;\r\n\r\n  /**\r\n   * returns a slice of the data array identified by a list of indices\r\n   * @param indices\r\n   */\r\n  view(indices: number[]): Promise<any[]>;\r\n\r\n  /**\r\n   * returns a sample of the values for a given column\r\n   * @param column\r\n   */\r\n  mappingSample(column: any): Promise<number[]>;\r\n\r\n  /**\r\n   * return the matching indices matching the given arguments\r\n   * @param search\r\n   * @param column\r\n   */\r\n  search(search: string | RegExp, column: any): Promise<number[]>;\r\n\r\n  stats(indices: number[]): IStatsBuilder;\r\n}\r\n\r\n\r\nexport interface IRemoteDataProviderOptions {\r\n  /**\r\n   * maximal cache size (unused at the moment)\r\n   */\r\n  maxCacheSize: number;\r\n}\r\n\r\n/**\r\n * a remote implementation of the data provider\r\n */\r\nexport default class RemoteDataProvider extends ACommonDataProvider {\r\n  private readonly options: IRemoteDataProviderOptions = {\r\n    maxCacheSize: 1000\r\n  };\r\n\r\n  private readonly cache = new Map<number, Promise<IDataRow>>();\r\n\r\n\r\n  constructor(private server: IServerData, columns: IColumnDesc[] = [], options: Partial<IRemoteDataProviderOptions & IDataProviderOptions> = {}) {\r\n    super(columns, options);\r\n    Object.assign(this.options, options);\r\n  }\r\n\r\n  getTotalNumberOfRows() {\r\n    // TODO not correct\r\n    return this.cache.size;\r\n  }\r\n\r\n  sortImpl(ranking: Ranking): Promise<IOrderedGroup[]> {\r\n    //use the server side to sort\r\n    return this.server.sort(ranking).then((order) => [Object.assign({order}, defaultGroup)]);\r\n  }\r\n\r\n  private loadFromServer(indices: number[]) {\r\n    return this.server.view(indices).then((view) => {\r\n      //enhance with the data index\r\n      return view.map((v, i) => {\r\n        const dataIndex = indices[i];\r\n        return {v, dataIndex};\r\n      });\r\n    });\r\n  }\r\n\r\n  view(indices: number[]): Promise<any[]> {\r\n    if (indices.length === 0) {\r\n      return Promise.resolve([]);\r\n    }\r\n    const base = this.fetch([indices])[0];\r\n    return Promise.all(base).then((rows) => rows.map((d) => d.v));\r\n  }\r\n\r\n\r\n  private computeMissing(orders: number[][]): number[] {\r\n    const union = new Set<number>();\r\n    const unionAdd = union.add.bind(union);\r\n    orders.forEach((order) => order.forEach(unionAdd));\r\n\r\n    // removed cached\r\n    this.cache.forEach((_v, k) => union.delete(k));\r\n\r\n    if ((this.cache.size + union.size) > this.options.maxCacheSize) {\r\n      // clean up cache\r\n    }\r\n    // const maxLength = Math.max(...orders.map((o) => o.length));\r\n    return Array.from(union);\r\n  }\r\n\r\n  private loadInCache(missing: number[]) {\r\n    if (missing.length === 0) {\r\n      return;\r\n    }\r\n    // load data and map to rows;\r\n    const v = this.loadFromServer(missing);\r\n    missing.forEach((_m, i) => {\r\n      const dataIndex = missing[i];\r\n      this.cache.set(dataIndex, v.then((loaded) => ({v: loaded[i], i: dataIndex})));\r\n    });\r\n  }\r\n\r\n  fetch(orders: number[][]): Promise<IDataRow>[][] {\r\n    const toLoad = this.computeMissing(orders);\r\n    this.loadInCache(toLoad);\r\n\r\n    return orders.map((order) =>\r\n      order.map((i) => this.cache.get(i)!));\r\n  }\r\n\r\n\r\n  mappingSample(col: Column): Promise<number[]> {\r\n    return this.server.mappingSample((<any>col.desc).column);\r\n  }\r\n\r\n  searchAndJump(search: string | RegExp, col: Column) {\r\n    this.server.search(search, (<any>col.desc).column).then((indices) => {\r\n      this.jumpToNearest(indices);\r\n    });\r\n  }\r\n\r\n  stats(indices: number[]) {\r\n    return this.server.stats(indices);\r\n  }\r\n}\r\n","export {default as DataProvider, IStatsBuilder, IDataProviderOptions, IDataProvider, IExportOptions} from './ADataProvider';\r\nexport {default as LocalDataProvider} from './LocalDataProvider';\r\nexport {default as RemoteDataProvider} from './RemoteDataProvider';\r\nexport * from './LocalDataProvider';\r\nexport * from './RemoteDataProvider';\r\nexport * from './utils';\r\n","import {similar} from '../internal/math';\nimport {toolbar} from './annotations';\nimport Column, {IColumnDesc, IFlatColumn, widthChanged, labelChanged, metaDataChanged, dirty, dirtyHeader, dirtyValues, rendererTypeChanged, groupRendererChanged, summaryRendererChanged, visibilityChanged} from './Column';\nimport CompositeColumn, {IMultiLevelColumn, isMultiLevelColumn, addColumn, filterChanged, moveColumn, removeColumn} from './CompositeColumn';\nimport {IDataRow} from './interfaces';\nimport {isNumberColumn} from './INumberColumn';\nimport StackColumn from './StackColumn';\nimport {IEventListener} from '../internal/AEventDispatcher';\n\n\n/**\n * emitted when the collapse property changes\n * @asMemberOf MultiLevelCompositeColumn\n * @event\n */\nexport declare function collapseChanged(previous: boolean, current: boolean): void;\n\n/**\n * emitted when the ratios between the children changes\n * @asMemberOf MultiLevelCompositeColumn\n * @event\n */\nexport declare function nestedChildRatio(previous: number, current: number): void;\n\n\n@toolbar('collapse')\nexport default class MultiLevelCompositeColumn extends CompositeColumn implements IMultiLevelColumn {\n  static readonly EVENT_COLLAPSE_CHANGED = StackColumn.EVENT_COLLAPSE_CHANGED;\n  static readonly EVENT_MULTI_LEVEL_CHANGED = StackColumn.EVENT_MULTI_LEVEL_CHANGED;\n\n  private readonly adaptChange: (old: number, newValue: number) => void;\n\n  /**\n   * whether this stack column is collapsed i.e. just looks like an ordinary number column\n   * @type {boolean}\n   * @private\n   */\n  private collapsed = false;\n\n  constructor(id: string, desc: Readonly<IColumnDesc>) {\n    super(id, desc);\n    const that = this;\n    this.adaptChange = function (old, newValue) {\n      that.adaptWidthChange(old, newValue);\n    };\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([MultiLevelCompositeColumn.EVENT_COLLAPSE_CHANGED, MultiLevelCompositeColumn.EVENT_MULTI_LEVEL_CHANGED]);\n  }\n\n  on(type: typeof MultiLevelCompositeColumn.EVENT_COLLAPSE_CHANGED, listener: typeof collapseChanged | null): this;\n  on(type: typeof MultiLevelCompositeColumn.EVENT_MULTI_LEVEL_CHANGED, listener: typeof nestedChildRatio | null): this;\n  on(type: typeof CompositeColumn.EVENT_FILTER_CHANGED, listener: typeof filterChanged | null): this;\n  on(type: typeof CompositeColumn.EVENT_ADD_COLUMN, listener: typeof addColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_MOVE_COLUMN, listener: typeof moveColumn | null): this;\n  on(type: typeof CompositeColumn.EVENT_REMOVE_COLUMN, listener: typeof removeColumn | null): this;\n  on(type: typeof Column.EVENT_WIDTH_CHANGED, listener: typeof widthChanged | null): this;\n  on(type: typeof Column.EVENT_LABEL_CHANGED, listener: typeof labelChanged | null): this;\n  on(type: typeof Column.EVENT_METADATA_CHANGED, listener: typeof metaDataChanged | null): this;\n  on(type: typeof Column.EVENT_DIRTY, listener: typeof dirty | null): this;\n  on(type: typeof Column.EVENT_DIRTY_HEADER, listener: typeof dirtyHeader | null): this;\n  on(type: typeof Column.EVENT_DIRTY_VALUES, listener: typeof dirtyValues | null): this;\n  on(type: typeof Column.EVENT_RENDERER_TYPE_CHANGED, listener: typeof rendererTypeChanged | null): this;\n  on(type: typeof Column.EVENT_GROUP_RENDERER_TYPE_CHANGED, listener: typeof groupRendererChanged | null): this;\n  on(type: typeof Column.EVENT_SUMMARY_RENDERER_TYPE_CHANGED, listener: typeof summaryRendererChanged | null): this;\n  on(type: typeof Column.EVENT_VISIBILITY_CHANGED, listener: typeof visibilityChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n  setCollapsed(value: boolean) {\n    if (this.collapsed === value) {\n      return;\n    }\n    this.fire([StackColumn.EVENT_COLLAPSE_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY_VALUES, Column.EVENT_DIRTY], this.collapsed, this.collapsed = value);\n  }\n\n  getCollapsed() {\n    return this.collapsed;\n  }\n\n  dump(toDescRef: (desc: any) => any) {\n    const r = super.dump(toDescRef);\n    r.collapsed = this.collapsed;\n    return r;\n  }\n\n  restore(dump: any, factory: (dump: any) => Column | null) {\n    this.collapsed = dump.collapsed === true;\n    super.restore(dump, factory);\n  }\n\n  flatten(r: IFlatColumn[], offset: number, levelsToGo = 0, padding = 0) {\n    return StackColumn.prototype.flatten.call(this, r, offset, levelsToGo, padding);\n  }\n\n  /**\n   * inserts a column at a the given position\n   * @param col\n   * @param index\n   */\n  insert(col: Column, index: number) {\n    col.on(`${Column.EVENT_WIDTH_CHANGED}.stack`, this.adaptChange);\n    //increase my width\n    super.setWidth(this.length === 0 ? col.getWidth() : (this.getWidth() + col.getWidth()));\n\n    return super.insert(col, index);\n  }\n\n  /**\n   * adapts weights according to an own width change\n   * @param oldValue\n   * @param newValue\n   */\n  private adaptWidthChange(oldValue: number, newValue: number) {\n    if (similar(oldValue, newValue, 0.5)) {\n      return;\n    }\n    const act = this.getWidth();\n    const next = act + (newValue - oldValue);\n    this.fire([MultiLevelCompositeColumn.EVENT_MULTI_LEVEL_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], act, next);\n    super.setWidth(next);\n  }\n\n  removeImpl(child: Column, index: number) {\n    child.on(`${Column.EVENT_WIDTH_CHANGED}.stack`, null);\n    super.setWidth(this.length === 0 ? 100 : this.getWidth() - child.getWidth());\n    return super.removeImpl(child, index);\n  }\n\n  setWidth(value: number) {\n    const act = this.getWidth();\n    const factor = value / act;\n    this._children.forEach((child) => {\n      //disable since we change it\n      child.setWidthImpl(child.getWidth() * factor);\n    });\n    if (!similar(act, value, 0.5)) {\n      this.fire([MultiLevelCompositeColumn.EVENT_MULTI_LEVEL_CHANGED, Column.EVENT_DIRTY_HEADER, Column.EVENT_DIRTY], act, value);\n    }\n    super.setWidth(value);\n  }\n\n  getRenderer() {\n    if (this.getCollapsed()) {\n      return MultiLevelCompositeColumn.EVENT_COLLAPSE_CHANGED;\n    }\n    return super.getRenderer();\n  }\n\n  isMissing(row: IDataRow) {\n    if (this.getCollapsed()) {\n      return this._children.some((c) => (isNumberColumn(c) || isMultiLevelColumn(c)) && c.isMissing(row));\n    }\n    return false;\n  }\n\n  getExportValue(row: IDataRow, format: 'text' | 'json'): any {\n    if (format === 'json') {\n      return {\n        children: this.children.map((d) => d.getExportValue(row, format))\n      };\n    }\n    return super.getExportValue(row, format);\n  }\n}\n","/**\r\n * a set that preserves the insertion order\r\n */\r\nexport default class OrderedSet<T> implements Iterable<T> {\r\n  readonly [Symbol.toStringTag] = Symbol('OrderedSet');\r\n  private readonly set = new Set<T>();\r\n  private readonly list = <T[]>[];\r\n\r\n  constructor(values: T[] = []) {\r\n    this.addAll(values);\r\n  }\r\n\r\n  get size() {\r\n    return this.set.size;\r\n  }\r\n\r\n  clear() {\r\n    this.set.clear();\r\n    this.list.splice(0, this.list.length);\r\n  }\r\n\r\n  addAll(values: T[]) {\r\n    values.forEach((v) => this.add(v));\r\n    return this;\r\n  }\r\n\r\n  add(value: T) {\r\n    if (this.set.has(value)) {\r\n      return this;\r\n    }\r\n    this.set.add(value);\r\n    this.list.push(value);\r\n    return this;\r\n  }\r\n\r\n  has(value: T) {\r\n    return this.set.has(value);\r\n  }\r\n\r\n  delete(value: T) {\r\n    const r = this.set.delete(value);\r\n    if (!r) {\r\n      return false;\r\n    }\r\n    const index = this.list.indexOf(value);\r\n    console.assert(index >= 0);\r\n    this.list.splice(index, 1);\r\n    return true;\r\n  }\r\n\r\n  deleteAll(values: T[]) {\r\n    return values.reduce((acc, act) => this.delete(act) && acc, true);\r\n  }\r\n\r\n  forEach(callbackfn: (value: T, value2: T, set: Set<T>) => void, thisArg?: any) {\r\n    this.list.forEach(function (this: any, v: T) {\r\n      callbackfn.call(this, v, v, <any>this);\r\n    }, thisArg);\r\n  }\r\n\r\n  [Symbol.iterator]() {\r\n    return this.list[Symbol.iterator]();\r\n  }\r\n}\r\n","import {createAggregateDesc, createRankDesc, createSelectionDesc, IColumnDesc, IDataRow, isSupportType} from '../model';\r\nimport {IOrderedGroup} from '../model/Group';\r\nimport Ranking from '../model/Ranking';\r\nimport ADataProvider, {IDataProviderOptions} from './ADataProvider';\r\n\r\n\r\nfunction isComplexAccessor(column: any) {\r\n  // something like a.b or a[4]\r\n  return typeof column === 'string' && column.indexOf('.') >= 0;\r\n}\r\n\r\nfunction resolveComplex(column: string, row: any) {\r\n  if (row.hasOwnProperty(column)) { // well complex but a direct hit\r\n    return row[column];\r\n  }\r\n  const resolve = (obj: any, col: string) => {\r\n    if (obj === undefined) {\r\n      return obj; // propagate invalid values\r\n    }\r\n    if (/\\d+/.test(col)) { // index\r\n      return obj[+col];\r\n    }\r\n    return obj[col];\r\n  };\r\n  return column.split('.').reduce(resolve, row);\r\n}\r\n\r\nfunction rowGetter(row: IDataRow, _id: string, desc: any) {\r\n  const column = desc.column;\r\n  if (isComplexAccessor(column)) {\r\n    return resolveComplex(<string>column, row.v);\r\n  }\r\n  return row.v[column];\r\n}\r\n\r\n/**\r\n * common base implementation of a DataProvider with a fixed list of column descriptions\r\n */\r\nabstract class ACommonDataProvider extends ADataProvider {\r\n\r\n  private rankingIndex = 0;\r\n\r\n  /**\r\n   * the local ranking orders\r\n   */\r\n  private readonly ranks = new Map<string, IOrderedGroup[]>();\r\n\r\n  constructor(private columns: IColumnDesc[] = [], options: Partial<IDataProviderOptions> = {}) {\r\n    super(options);\r\n    //generate the accessor\r\n    columns.forEach((d: any) => {\r\n      d.accessor = d.accessor || rowGetter;\r\n      d.label = d.label || d.column;\r\n    });\r\n  }\r\n\r\n  protected rankAccessor(row: IDataRow, _id: string, _desc: IColumnDesc, ranking: Ranking) {\r\n    const groups = this.ranks.get(ranking.id) || [];\r\n    let acc = 0;\r\n    for (const group of groups) {\r\n      const rank = group.order.indexOf(row.i);\r\n      if (rank >= 0) {\r\n        return acc + rank + 1; // starting with 1\r\n      }\r\n      acc += group.order.length;\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  /**\r\n   * returns the maximal number of nested/hierarchical sorting criteria\r\n   * @return {number}\r\n   */\r\n  protected getMaxNestedSortingCriteria() {\r\n    return 1;\r\n  }\r\n\r\n  protected getMaxGroupColumns() {\r\n    return 1;\r\n  }\r\n\r\n  cloneRanking(existing?: Ranking) {\r\n    const id = this.nextRankingId();\r\n    const clone = new Ranking(id, this.getMaxNestedSortingCriteria(), this.getMaxGroupColumns());\r\n\r\n    if (existing) { //copy the ranking of the other one\r\n      //copy the ranking\r\n      this.ranks.set(id, this.ranks.get(existing.id)!);\r\n      //TODO better cloning\r\n      existing.children.forEach((child) => {\r\n        this.push(clone, child.desc);\r\n      });\r\n    }\r\n\r\n    return clone;\r\n  }\r\n\r\n  cleanUpRanking(ranking: Ranking) {\r\n    //delete all stored information\r\n    this.ranks.delete(ranking.id);\r\n  }\r\n\r\n  sort(ranking: Ranking): Promise<IOrderedGroup[]> | IOrderedGroup[] {\r\n    //use the server side to sort\r\n    const r = this.sortImpl(ranking);\r\n    if (Array.isArray(r)) {\r\n      //store the result\r\n      this.ranks.set(ranking.id, r);\r\n      return r;\r\n    }\r\n    return r.then((r) => {\r\n      this.ranks.set(ranking.id, r);\r\n      return r;\r\n    });\r\n  }\r\n\r\n  protected abstract sortImpl(ranking: Ranking): Promise<IOrderedGroup[]> | IOrderedGroup[];\r\n\r\n  /**\r\n   * adds another column description to this data provider\r\n   * @param column\r\n   */\r\n  pushDesc(column: IColumnDesc) {\r\n    const d: any = column;\r\n    d.accessor = d.accessor || rowGetter;\r\n    d.label = column.label || d.column;\r\n    this.columns.push(column);\r\n    this.fire(ADataProvider.EVENT_ADD_DESC, d);\r\n  }\r\n\r\n  clearColumns() {\r\n    this.clearRankings();\r\n    this.columns.splice(0, this.columns.length);\r\n    this.fire(ADataProvider.EVENT_CLEAR_DESC);\r\n  }\r\n\r\n  getColumns(): IColumnDesc[] {\r\n    return this.columns.slice();\r\n  }\r\n\r\n  findDesc(ref: string) {\r\n    return this.columns.filter((c) => (<any>c).column === ref)[0];\r\n  }\r\n\r\n  /**\r\n   * identify by the tuple type@columnname\r\n   * @param desc\r\n   * @returns {string}\r\n   */\r\n  toDescRef(desc: any): any {\r\n    return typeof desc.column !== 'undefined' ? `${desc.type}@${desc.column}` : desc;\r\n  }\r\n\r\n  /**\r\n   * generates a default ranking by using all column descriptions ones\r\n   */\r\n  deriveDefault(addSupportType: boolean = true) {\r\n    const r = this.pushRanking();\r\n    if (addSupportType) {\r\n      if (this.getMaxGroupColumns() > 0) {\r\n        r.push(this.create(createAggregateDesc())!);\r\n      }\r\n      r.push(this.create(createRankDesc())!);\r\n      if (this.multiSelections) {\r\n        r.push(this.create(createSelectionDesc())!);\r\n      }\r\n    }\r\n    this.getColumns().forEach((col) => {\r\n      const c = this.create(col);\r\n      if (!c || isSupportType(c)) {\r\n        return;\r\n      }\r\n      r.push(c);\r\n    });\r\n    return r;\r\n  }\r\n\r\n  fromDescRef(descRef: any): any {\r\n    if (typeof (descRef) === 'string') {\r\n      return this.columns.find((d: any) => `${d.type}@${d.column}` === descRef);\r\n    }\r\n    const existing = this.columns.find((d) => descRef.column === (<any>d).column && descRef.label === d.label && descRef.type === d.type);\r\n    if (existing) {\r\n      return existing;\r\n    }\r\n    return descRef;\r\n  }\r\n\r\n  restore(dump: any) {\r\n    super.restore(dump);\r\n    this.rankingIndex = 1 + Math.max(...this.getRankings().map((r) => +r.id.substring(4)));\r\n  }\r\n\r\n  nextRankingId() {\r\n    return `rank${this.rankingIndex++}`;\r\n  }\r\n}\r\n\r\nexport default ACommonDataProvider;\r\n","import {IDataRow, IGroup} from '../model';\r\nimport Column from '../model/Column';\r\nimport SelectionColumn from '../model/SelectionColumn';\r\nimport {default as IRenderContext, ICellRendererFactory} from './interfaces';\r\nimport {noop} from './utils';\r\nimport {IDataProvider} from '../provider/ADataProvider';\r\n\r\n/** @internal */\r\nexport default class SelectionRenderer implements ICellRendererFactory {\r\n  readonly title = 'Default';\r\n\r\n  canRender(col: Column) {\r\n    return col instanceof SelectionColumn;\r\n  }\r\n\r\n  create(col: SelectionColumn, ctx: IRenderContext) {\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (n: HTMLElement, d: IDataRow, i: number) => {\r\n        n.onclick = function (event) {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          if (event.shiftKey) {\r\n            const ranking = col.findMyRanker()!.id;\r\n            if (rangeSelection(ctx.provider, ranking, d.i, i, event.ctrlKey)) {\r\n              return;\r\n            }\r\n          }\r\n\r\n          col.toggleValue(d);\r\n        };\r\n      },\r\n      render: noop\r\n    };\r\n  }\r\n\r\n  createGroup(col: SelectionColumn) {\r\n    return {\r\n      template: `<div></div>`,\r\n      update: (n: HTMLElement, _group: IGroup, rows: IDataRow[]) => {\r\n        const selected = rows.reduce((act, r) => col.getValue(r) ? act + 1 : act, 0);\r\n        const all = selected >= rows.length / 2;\r\n        if (all) {\r\n          n.classList.add('lu-group-selected');\r\n        } else {\r\n          n.classList.remove('lu-group-selected');\r\n        }\r\n        n.onclick = function (event) {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          const value = n.classList.toggle('lu-group-selected');\r\n          col.setValues(rows, value);\r\n        };\r\n      }\r\n    };\r\n  }\r\n\r\n  createSummary(col: SelectionColumn, context: IRenderContext) {\r\n    return {\r\n      template: `<div title=\"(Un)Select All\" data-icon=\"unchecked\"></div>`,\r\n      update: (node: HTMLElement) => {\r\n        node.onclick = (evt) => {\r\n          evt.stopPropagation();\r\n          const icon = node.dataset.icon;\r\n          if (icon === 'unchecked') {\r\n            context.provider.selectAllOf(col.findMyRanker()!);\r\n            node.dataset.icon = 'checked';\r\n          } else {\r\n            context.provider.setSelection([]);\r\n            node.dataset.icon = 'unchecked';\r\n          }\r\n        };\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n/** @internal */\r\nexport function rangeSelection(provider: IDataProvider, rankingId: string, dataIndex: number, relIndex: number, ctrlKey: boolean) {\r\n  const ranking = provider.getRankings().find((d) => d.id === rankingId);\r\n  if (!ranking) { // no known reference\r\n    return false;\r\n  }\r\n  const selection = provider.getSelection();\r\n  if (selection.length === 0 || selection.includes(dataIndex)) {\r\n    return false; // no other or deselect\r\n  }\r\n  const order = ranking.getOrder();\r\n  const lookup = new Map(ranking.getOrder().map((d, i) => <[number, number]>[d, i]));\r\n  const distances = selection.map((d) => {\r\n    const index = (lookup.has(d) ? lookup.get(d)! : Infinity);\r\n    return {s: d, index, distance: Math.abs(relIndex - index)};\r\n  });\r\n  const nearest = distances.sort((a, b) => a.distance - b.distance)[0]!;\r\n  if (!isFinite(nearest.distance)) {\r\n    return false; // all outside\r\n  }\r\n  if (!ctrlKey) {\r\n    selection.splice(0, selection.length);\r\n    selection.push(nearest.s);\r\n  }\r\n  if (nearest.index < relIndex) {\r\n    for(let i = nearest.index + 1; i <= relIndex; ++i) {\r\n      selection.push(order[i]);\r\n    }\r\n  } else {\r\n    for(let i = relIndex; i <= nearest.index; ++i) {\r\n      selection.push(order[i]);\r\n    }\r\n  }\r\n  provider.setSelection(selection);\r\n  return true;\r\n}\r\n","import {defaultOptions} from '../../config';\r\nimport {ITaggleOptions} from '../../interfaces';\r\nimport merge from '../../internal/merge';\r\nimport DataProvider from '../../provider/ADataProvider';\r\nimport {ALineUp} from '../ALineUp';\r\nimport SidePanel from '../panel/SidePanel';\r\nimport spaceFillingRule from './spaceFillingRule';\r\nimport TaggleRenderer from './TaggleRenderer';\r\n\r\nexport {ITaggleOptions} from '../../interfaces';\r\n\r\nexport default class Taggle extends ALineUp {\r\n  private readonly spaceFilling: HTMLElement | null;\r\n  private readonly renderer: TaggleRenderer | null;\r\n  private readonly panel: SidePanel | null;\r\n\r\n  private readonly options = defaultOptions();\r\n\r\n\r\n  constructor(node: HTMLElement, data: DataProvider, options: Partial<ITaggleOptions> = {}) {\r\n    super(node, data, options && options.ignoreUnsupportedBrowser === true);\r\n    merge(this.options, options, {\r\n      violationChanged: (_rule: any, violation?: string) => this.setViolation(violation)\r\n    });\r\n\r\n    if (!this.isBrowserSupported) {\r\n      this.spaceFilling = null;\r\n      this.renderer = null;\r\n      this.panel = null;\r\n      return;\r\n    }\r\n\r\n    this.node.classList.add('lu-taggle', 'lu');\r\n\r\n    this.renderer = new TaggleRenderer(data, this.node, this.options);\r\n    console.assert(this.node.ownerDocument != null);\r\n    this.panel = new SidePanel(this.renderer.ctx, this.node.ownerDocument!, {\r\n      collapseable: this.options.sidePanelCollapsed ? 'collapsed' : true,\r\n      hierarchy: this.options.hierarchyIndicator && this.options.flags.advancedRankingFeatures\r\n    });\r\n    this.renderer.pushUpdateAble((ctx) => this.panel!.update(ctx));\r\n    this.node.insertBefore(this.panel.node, this.node.firstChild);\r\n    {\r\n      this.panel.node.insertAdjacentHTML('afterbegin', `<div class=\"lu-rule-button-chooser lu-feature-advanced lu-feature-ui\"><label>\r\n            <input type=\"checkbox\">\r\n            <span>Overview</span>\r\n            <div></div>\r\n          </label></div>`);\r\n      const spaceFilling = spaceFillingRule(this.options);\r\n      this.spaceFilling = <HTMLElement>this.node.querySelector('.lu-rule-button-chooser')!;\r\n      const input = <HTMLInputElement>this.spaceFilling.querySelector('input');\r\n      input.onchange = () => {\r\n        const selected = this.spaceFilling!.classList.toggle('chosen');\r\n        self.setTimeout(() => this.renderer!.switchRule(selected ? spaceFilling : null));\r\n      };\r\n      if (this.options.overviewMode) {\r\n        input.checked = true;\r\n        this.spaceFilling.classList.toggle('chosen');\r\n        this.renderer.switchRule(spaceFilling);\r\n      }\r\n    }\r\n    this.forward(this.renderer, `${ALineUp.EVENT_HIGHLIGHT_CHANGED}.main`);\r\n  }\r\n\r\n  private setViolation(violation?: string) {\r\n    violation = violation || '';\r\n    if (this.spaceFilling) {\r\n      this.spaceFilling.classList.toggle('violated', Boolean(violation));\r\n      this.spaceFilling.lastElementChild!.innerHTML = violation.replace(/\\n/g, '<br>');\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.node.classList.remove('lu-taggle', 'lu');\r\n    if (this.renderer) {\r\n      this.renderer.destroy();\r\n    }\r\n    if (this.panel) {\r\n      this.panel.destroy();\r\n    }\r\n    super.destroy();\r\n  }\r\n\r\n  update() {\r\n    if (this.renderer) {\r\n      this.renderer.update();\r\n    }\r\n  }\r\n\r\n  setHighlight(dataIndex: number, scrollIntoView: boolean = true) {\r\n    return this.renderer != null && this.renderer.setHighlight(dataIndex, scrollIntoView);\r\n  }\r\n\r\n  getHighlight() {\r\n    return this.renderer ? this.renderer.getHighlight() : -1;\r\n  }\r\n\r\n  protected enableHighlightListening(enable: boolean) {\r\n    if (this.renderer) {\r\n      this.renderer.enableHighlightListening(enable);\r\n    }\r\n  }\r\n\r\n  setDataProvider(data: DataProvider, dump?: any) {\r\n    super.setDataProvider(data, dump);\r\n    if (!this.renderer) {\r\n      return;\r\n    }\r\n    this.renderer.setDataProvider(data);\r\n    this.update();\r\n    this.panel!.update(this.renderer.ctx);\r\n  }\r\n}\r\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a)\n      , arrB = isArray(b)\n      , i\n      , length\n      , key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n\n    var dateA = a instanceof Date\n      , dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n\n    var regexpA = a instanceof RegExp\n      , regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n\n    var keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length)\n      return false;\n\n    for (i = length; i-- !== 0;)\n      if (!hasProp.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  return a!==a && b!==b;\n};\n","import {ILineUpOptions} from '../../interfaces';\nimport AEventDispatcher, {IEventListener} from '../../internal/AEventDispatcher';\nimport debounce from '../../internal/debounce';\nimport {IGroupData, IGroupItem, isGroup} from '../../model';\nimport Ranking from '../../model/Ranking';\nimport DataProvider from '../../provider/ADataProvider';\nimport {IRenderContext} from '../../renderer';\nimport {IEngineRankingContext} from '../EngineRanking';\nimport EngineRenderer from '../EngineRenderer';\nimport {IRankingHeaderContext, IRankingHeaderContextContainer} from '../interfaces';\nimport {IRule} from './interfaces';\n\n/**\n * emitted when the highlight changes\n * @asMemberOf TaggleRenderer\n * @param dataIndex the highlghted data index or -1 for none\n * @event\n */\nexport declare function highlightChanged(dataIndex: number): void;\n\nexport interface ITaggleOptions {\n  violationChanged(rule: IRule, violation: string): void;\n\n  rowPadding: number;\n}\n\nexport default class TaggleRenderer extends AEventDispatcher {\n  static readonly EVENT_HIGHLIGHT_CHANGED = EngineRenderer.EVENT_HIGHLIGHT_CHANGED;\n\n  private isDynamicLeafHeight: boolean = false;\n\n  private rule: IRule | null = null;\n  private levelOfDetail: ((rowIndex: number) => 'high' | 'low') | null = null;\n  private readonly resizeListener = () => debounce(() => this.update(), 100);\n  private readonly renderer: EngineRenderer;\n\n  private readonly options: Readonly<ITaggleOptions> = {\n    violationChanged: () => undefined,\n    rowPadding: 2\n  };\n\n  constructor(public data: DataProvider, parent: HTMLElement, options: (Partial<ITaggleOptions> & Readonly<ILineUpOptions>)) {\n    super();\n\n\n    this.renderer = new EngineRenderer(data, parent, Object.assign({}, options, {\n      dynamicHeight: (data: (IGroupData | IGroupItem)[], ranking: Ranking) => {\n        const r = this.dynamicHeight(data);\n        if (r) {\n          return r;\n        }\n        return options.dynamicHeight ? options.dynamicHeight(data, ranking) : null;\n      },\n      levelOfDetail: (rowIndex: number) => this.levelOfDetail ? this.levelOfDetail(rowIndex) : 'high'\n    }));\n\n    //\n    this.renderer.style.addRule('taggle_lod_rule', `\n      #${this.renderer.idPrefix} [data-lod=low][data-agg=detail]:hover {\n        /* show regular height for hovered rows in low + medium LOD */\n        height: ${options.rowHeight}px !important;\n      }\n    `);\n\n\n    this.data.on(`${DataProvider.EVENT_SELECTION_CHANGED}.rule`, () => {\n      if (this.isDynamicLeafHeight) {\n        this.update();\n      }\n    });\n    this.forward(this.renderer, `${TaggleRenderer.EVENT_HIGHLIGHT_CHANGED}.main`);\n\n    window.addEventListener('resize', this.resizeListener, {\n      passive: true\n    });\n  }\n\n  get ctx(): IRankingHeaderContextContainer & IRenderContext & IEngineRankingContext {\n    return this.renderer.ctx;\n  }\n\n  pushUpdateAble(updateAble: (ctx: IRankingHeaderContext) => void) {\n    this.renderer.pushUpdateAble(updateAble);\n  }\n\n  private dynamicHeight(data: (IGroupData | IGroupItem)[]) {\n    if (!this.rule) {\n      this.levelOfDetail = null;\n      return null;\n    }\n\n    const availableHeight = this.renderer ? this.renderer.node.querySelector('main')!.clientHeight : 100;\n    const instance = this.rule.apply(data, availableHeight, new Set(this.data.getSelection()));\n    this.isDynamicLeafHeight = typeof instance.item === 'function';\n\n    this.options.violationChanged(this.rule, instance.violation || '');\n\n    const height = (item: IGroupItem | IGroupData) => {\n      if (isGroup(item)) {\n        return typeof instance.group === 'number' ? instance.group : instance.group(item);\n      }\n      return typeof instance.item === 'number' ? instance.item : instance.item(item);\n    };\n\n    this.levelOfDetail = (rowIndex: number) => {\n      const item = data[rowIndex];\n      return this.rule ? this.rule.levelOfDetail(item, height(item)) : 'high';\n    };\n\n    // padding is always 0 since included in height\n    // const padding = (item: IGroupData | IGroupItem | null) => {\n    //   if (!item) {\n    //     item = data[0];\n    //   }\n    //   const lod = this.rule ? this.rule.levelOfDetail(item, height(item)) : 'high';\n    //   return lod === 'high' ? 0 : 0; // always 0 since\n    // };\n\n    return {\n      defaultHeight: typeof instance.item === 'number' ? instance.item : NaN,\n      height,\n      padding: 0\n    };\n  }\n\n  protected createEventList() {\n    return super.createEventList().concat([TaggleRenderer.EVENT_HIGHLIGHT_CHANGED]);\n  }\n\n  on(type: typeof TaggleRenderer.EVENT_HIGHLIGHT_CHANGED, listener: typeof highlightChanged | null): this;\n  on(type: string | string[], listener: IEventListener | null): this; // required for correct typings in *.d.ts\n  on(type: string | string[], listener: IEventListener | null): this {\n    return super.on(type, listener);\n  }\n\n\n  zoomOut() {\n    this.renderer.zoomOut();\n  }\n\n  zoomIn() {\n    this.renderer.zoomIn();\n  }\n\n  switchRule(rule: IRule | null) {\n    if (this.rule === rule) {\n      return;\n    }\n    this.rule = rule;\n    this.update();\n  }\n\n  destroy() {\n    this.renderer.destroy();\n    window.removeEventListener('resize', this.resizeListener);\n  }\n\n  update() {\n    this.renderer.update();\n  }\n\n  setDataProvider(data: DataProvider) {\n    if (this.data) {\n      this.data.on(`${DataProvider.EVENT_SELECTION_CHANGED}.rule`, null);\n    }\n    this.data = data;\n    this.data.on(`${DataProvider.EVENT_SELECTION_CHANGED}.rule`, () => {\n      if (this.isDynamicLeafHeight) {\n        this.update();\n      }\n    });\n    this.renderer.setDataProvider(data);\n    this.update();\n  }\n\n  setHighlight(dataIndex: number, scrollIntoView: boolean) {\n    return this.renderer.setHighlight(dataIndex, scrollIntoView);\n  }\n\n  getHighlight() {\n    return this.renderer.getHighlight();\n  }\n\n  enableHighlightListening(enable: boolean) {\n    this.renderer.enableHighlightListening(enable);\n  }\n}\n","import {IGroupData, IGroupItem, isGroup} from '../../model';\r\nimport {IRule} from './interfaces';\r\n\r\nexport default function spaceFillingRule(config: { groupHeight: number, rowHeight: number, groupPadding: number }) {\r\n  function levelOfDetail(item: IGroupData | IGroupItem, height: number): 'high' | 'low' {\r\n    const group = isGroup(item);\r\n    const maxHeight = group ? config.groupHeight : config.rowHeight;\r\n    if (height >= maxHeight * 0.9) {\r\n      return 'high';\r\n    }\r\n    return 'low';\r\n  }\r\n\r\n  function itemHeight(data: (IGroupData | IGroupItem)[], availableHeight: number, selection: Set<number>) {\r\n    const visibleHeight = availableHeight - config.rowHeight - 5; // some padding for hover\r\n    const items = <IGroupItem[]>data.filter((d) => !isGroup(d));\r\n    const groups = data.length - items.length;\r\n    const lastItems = items.reduce((a, d) => a + (d.meta === 'last' || d.meta === 'first last' ? 1 : 0), 0);\r\n    const selected = items.reduce((a, d) => a + (selection.has(d.i) ? 1 : 0), 0);\r\n    const unselected = items.length - selected;\r\n    const groupSeparators = groups + lastItems;\r\n\r\n    if (unselected <= 0) {\r\n      // doesn't matter since all are selected anyhow\r\n      return {height: config.rowHeight, violation: ''};\r\n    }\r\n    const available = visibleHeight - groups * config.groupHeight - groupSeparators * config.groupPadding - selected * config.rowHeight;\r\n\r\n    const height = available / unselected;\r\n    if (height < 1) {\r\n      return {\r\n        height: 1,\r\n        violation: `Not possible to fit all rows on the screen. Set filters or aggregate groups to make it fit again.`\r\n      };\r\n    }\r\n    // clamp to max height\r\n    if (height > config.rowHeight) {\r\n      return {\r\n        height: config.rowHeight,\r\n        violation: ``\r\n      };\r\n    }\r\n    return {height, violation: ''};\r\n  }\r\n\r\n  return <IRule>{\r\n    apply: (data: (IGroupData | IGroupItem)[], availableHeight: number, selection: Set<number>) => {\r\n\r\n      const {violation, height} = itemHeight(data, availableHeight, selection);\r\n\r\n      const item = (item: IGroupItem) => {\r\n        if (selection.has(item.i)) {\r\n          return config.rowHeight;\r\n        }\r\n        return height;\r\n      };\r\n      return {item, group: config.groupHeight, violation};\r\n    },\r\n    levelOfDetail\r\n  };\r\n}\r\n","export {IDialogOptions, default as ADialog, IDialogContext} from './ADialog';\r\n","export {default as SidePanel, ISidePanelOptions} from './SidePanel';\r\nexport {default as SearchBox, IGroupSearchItem, IItem, ISearchBoxOptions} from './SearchBox';\r\n","import {IArrayDesc, IColumnDesc} from '../../model';\r\n\r\nexport default class ColumnBuilder<T extends IColumnDesc = IColumnDesc> {\r\n  protected readonly desc: T;\r\n\r\n  constructor(type: string, column: string) {\r\n    this.desc = <any>{column, type, label: column ? column[0].toUpperCase() + column.slice(1): type};\r\n  }\r\n\r\n  /**\r\n   * column label\r\n   */\r\n  label(label: string) {\r\n    this.desc.label = label;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * column description\r\n   */\r\n  description(description: string) {\r\n    this.desc.description = description;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * sets the frozen state of this column, i.e is sticky to the left side when scrolling horizontally\r\n   */\r\n  frozen() {\r\n    this.desc.frozen = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * specify the renderer to used for this column\r\n   * @param {string} renderer within a cell\r\n   * @param {string} groupRenderer within an aggregated cell\r\n   * @param {string} summaryRenderer within the summary in the header and side panel\r\n   */\r\n  renderer(renderer?: string, groupRenderer?: string, summaryRenderer?: string) {\r\n    if (renderer) {\r\n      this.desc.renderer = renderer;\r\n    }\r\n    if (groupRenderer) {\r\n      this.desc.groupRenderer = groupRenderer;\r\n    }\r\n    if (summaryRenderer) {\r\n      this.desc.summaryRenderer = summaryRenderer;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * specify a custom additional attribute for the description\r\n   * @param {string} key the property key\r\n   * @param value its value\r\n   */\r\n  custom(key: string, value: any) {\r\n    (<any>this.desc)[key] = value;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * sets the default width of the column\r\n   */\r\n  width(width: number) {\r\n    this.desc.width = width;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * sets the column color in case of numerical columns\r\n   * @deprecated use colorMapping in the number case instead\r\n   */\r\n  color(_color: string) {\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * converts the column type to be an array type, supports only base types: boolean, categorical, date, number, and string\r\n   * @param {string[] | number} labels labels to use for each array item or the expected length of an value\r\n   */\r\n  asArray(labels?: string[] | number) {\r\n    console.assert(['boolean', 'categorical', 'date', 'number', 'string', 'link'].includes(this.desc.type!));\r\n    this.desc.type += 's';\r\n    const a = <IArrayDesc>this.desc;\r\n    if (Array.isArray(labels)) {\r\n      a.labels = labels;\r\n      a.dataLength = labels.length;\r\n    } else if (typeof labels === 'number') {\r\n      a.dataLength = labels;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * converts the column type to be a map type, supports only base types: categorical, date, number, and string\r\n   */\r\n  asMap() {\r\n    console.assert(['categorical', 'date', 'number', 'string', 'link'].includes(this.desc.type!));\r\n    this.desc.type += 'Map';\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * build the column description\r\n   */\r\n  build(_data: any[]): T {\r\n    return <any>this.desc;\r\n  }\r\n}\r\n\r\n/**\r\n * build a column of a given type\r\n * @param {string} type column type\r\n * @param {string} column column which contains the associated data\r\n * @returns {ColumnBuilder<IColumnDesc>}\r\n */\r\nexport function buildColumn(type: string, column: string) {\r\n  return new ColumnBuilder(type, column);\r\n}\r\n","import {IDynamicHeight, ITaggleOptions} from '../interfaces';\r\nimport {IGroupData, IGroupItem} from '../model';\r\nimport Ranking from '../model/Ranking';\r\nimport {ICellRendererFactory} from '../renderer';\r\nimport {IToolbarAction, IToolbarDialogAddon} from '../ui';\r\n\r\n/**\r\n * builder for LineUp/Taggle instance\r\n */\r\nexport default class LineUpBuilder {\r\n  protected readonly options: Partial<ITaggleOptions> = {\r\n    renderers: {},\r\n    toolbar: {},\r\n    flags: {}\r\n  };\r\n\r\n  /**\r\n   * option to enable/disable animated transitions\r\n   * @default true\r\n   */\r\n  animated(enable: boolean) {\r\n    this.options.animated = enable;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to rotate labels on demand in narrow columns\r\n   * @param rotation rotation in degrees\r\n   * @default 0 - disabled\r\n   */\r\n  labelRotation(rotation: number) {\r\n    this.options.labelRotation = rotation;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to enable/disable the side panel\r\n   * @param {boolean} enable enable flag\r\n   * @param {boolean} collapsed whether collapsed by default\r\n   */\r\n  sidePanel(enable: boolean, collapsed: boolean = false) {\r\n    this.options.sidePanel = enable;\r\n    this.options.sidePanelCollapsed = collapsed;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * show the sorting and grouping hierarchy indicator in the side panel\r\n   * @param {boolean} enable enable flag\r\n   */\r\n  hierarchyIndicator(enable: boolean) {\r\n    this.options.hierarchyIndicator = enable;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to specify the default slope graph mode\r\n   * @default 'item'\r\n   */\r\n  defaultSlopeGraphMode(mode: 'item' | 'band') {\r\n    this.options.defaultSlopeGraphMode = mode;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to enable/disable showing a summary (histogram, ...) in the header\r\n   * @default true\r\n   */\r\n  summaryHeader(enable: boolean) {\r\n    this.options.summaryHeader = enable;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to enforce that the whole row is shown upon hover without overflow hidden\r\n   * @default false\r\n   */\r\n  expandLineOnHover(enable: boolean) {\r\n    this.options.expandLineOnHover = enable;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to enable overview mode by default, just valid when building a Taggle instance\r\n   * @returns {this}\r\n   */\r\n  overviewMode() {\r\n    this.options.overviewMode = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * option to ignore unsupported browser check - at own risk\r\n   * @returns {this}\r\n   */\r\n  ignoreUnsupportedBrowser() {\r\n    this.options.ignoreUnsupportedBrowser = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * register a new renderer factory function\r\n   * @param id the rederer id\r\n   * @param factory factory class implementing the renderer\r\n   */\r\n  registerRenderer(id: string, factory: ICellRendererFactory) {\r\n    this.options.renderers![id] = factory;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * register another toolbar action which can be used within a model class\r\n   * @param id toolbar id\r\n   * @param action\r\n   */\r\n  registerToolbarAction(id: string, action: IToolbarAction) {\r\n    this.options.toolbar![id] = action;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * register another toolbar action which can be sued within a model class\r\n   * @param id  dialog id\r\n   * @param addon addon description\r\n   */\r\n  registerToolbarDialogAddon(id: string, addon: IToolbarDialogAddon) {\r\n    this.options.toolbar![id] = addon;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * height and padding of a row\r\n   * @default 18 and 2\r\n   */\r\n  rowHeight(rowHeight: number, rowPadding: number) {\r\n    this.options.rowHeight = rowHeight;\r\n    this.options.rowPadding = rowPadding;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * height and padding of an aggregated group in pixel\r\n   * @default 40 and 5\r\n   */\r\n  groupRowHeight(groupHeight: number, groupPadding: number) {\r\n    this.options.groupHeight = groupHeight;\r\n    this.options.groupPadding = groupPadding;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * custom function to compute the height of a row (group or item)\r\n   * @param {(data: (IGroupItem | IGroupData)[], ranking: Ranking) => (IDynamicHeight | null)} callback\r\n   */\r\n  dynamicHeight(callback: (data: (IGroupItem | IGroupData)[], ranking: Ranking) => (IDynamicHeight | null)) {\r\n    this.options.dynamicHeight = callback;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * disables advanced ranking features (sort by, group by, sorting hierarchy, ...)\r\n   */\r\n  disableAdvancedRankingFeatures() {\r\n    this.options.flags!.advancedRankingFeatures = false;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * disables advanced model features (add combine column, data mapping, edit pattern, ...)\r\n   */\r\n  disableAdvancedModelFeatures() {\r\n    this.options.flags!.advancedModelFeatures = false;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * disables advanced ui features (change visualization, color mapping)\r\n   */\r\n  disableAdvancedUIFeatures() {\r\n    this.options.flags!.advancedUIFeatures = false;\r\n    return this;\r\n  }\r\n}\r\n","import {\r\n  createAggregateDesc, createGroupDesc, createImpositionBoxPlotDesc, createImpositionDesc, createImpositionsDesc,\r\n  createNestedDesc, createRankDesc, createReduceDesc, createScriptDesc, createSelectionDesc, createStackDesc,\r\n  EAdvancedSortMethod, IColumnDesc, ISortCriteria\r\n} from '../model';\r\nimport Column from '../model/Column';\r\nimport CompositeColumn from '../model/CompositeColumn';\r\nimport Ranking from '../model/Ranking';\r\nimport ReduceColumn from '../model/ReduceColumn';\r\nimport ScriptColumn from '../model/ScriptColumn';\r\nimport StackColumn from '../model/StackColumn';\r\nimport ADataProvider from '../provider/ADataProvider';\r\n\r\nexport interface IImposeColumnBuilder {\r\n  type: 'impose';\r\n  column: string;\r\n  label?: string;\r\n  categoricalColumn: string;\r\n}\r\n\r\nexport interface INestedBuilder {\r\n  type: 'nested';\r\n  label?: string;\r\n  columns: string[];\r\n}\r\n\r\nexport interface IWeightedSumBuilder {\r\n  type: 'weightedSum';\r\n  columns: string[];\r\n  label?: string;\r\n  weights: number[];\r\n}\r\n\r\nexport interface IReduceBuilder {\r\n  type: 'min' | 'max' | 'mean' | 'median';\r\n  columns: string[];\r\n  label?: string;\r\n}\r\n\r\nexport interface IScriptedBuilder {\r\n  type: 'script';\r\n  code: string;\r\n  columns: string[];\r\n  label?: string;\r\n}\r\n\r\n/**\r\n * builder for a ranking\r\n */\r\nexport default class RankingBuilder {\r\n  private static readonly ALL_MAGIC_FLAG = '*';\r\n\r\n  private readonly columns: (string | { desc: IColumnDesc | ((data: ADataProvider) => IColumnDesc), columns: string[], post?: (col: Column) => void })[] = [];\r\n  private readonly sort: { column: string, asc: boolean }[] = [];\r\n  private readonly groups: string[] = [];\r\n\r\n  /**\r\n   * specify another sorting criteria\r\n   * @param {string} column the column name optionally with encoded sorting separated by colon, e.g. a:desc\r\n   * @param {boolean | \"asc\" | \"desc\"} asc ascending or descending order\r\n   */\r\n  sortBy(column: string, asc: boolean | 'asc' | 'desc' = true) {\r\n    if (column.includes(':')) {\r\n      // encoded sorting order\r\n      const index = column.indexOf(':');\r\n      asc = <'asc' | 'desc'>column.slice(index + 1);\r\n      column = column.slice(0, index);\r\n    }\r\n    this.sort.push({column, asc: asc === true || String(asc)[0] === 'a'});\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * specify grouping criteria\r\n   * @returns {this}\r\n   */\r\n  groupBy(...columns: string[]) {\r\n    this.groups.push(...columns);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add another column to this ranking, identified by column name or label. magic names are used for special columns:\r\n   * <ul>\r\n   *     <li>'*' = all columns</li>\r\n   *     <li>'_*' = all support columns</li>\r\n   *     <li>'_aggregate' = aggregate column</li>\r\n   *     <li>'_selection' = selection column</li>\r\n   *     <li>'_group' = group column</li>\r\n   *     <li>'_rank' = rank column</li>\r\n   * </ul>\r\n   * In addition build objects for combined columns are supported.\r\n   * @param {string | IImposeColumnBuilder | INestedBuilder | IWeightedSumBuilder | IReduceBuilder | IScriptedBuilder} column\r\n   */\r\n  column(column: string | IImposeColumnBuilder | INestedBuilder | IWeightedSumBuilder | IReduceBuilder | IScriptedBuilder) {\r\n    if (typeof column === 'string') {\r\n      switch (column) {\r\n        case '_aggregate':\r\n          return this.aggregate();\r\n        case '_selection':\r\n          return this.selection();\r\n        case '_group':\r\n          return this.group();\r\n        case '_rank':\r\n          return this.rank();\r\n        case '_*':\r\n          return this.supportTypes();\r\n        case '*':\r\n          return this.allColumns();\r\n      }\r\n      this.columns.push(column);\r\n      return this;\r\n    }\r\n    const label = column.label || null;\r\n    // builder ish\r\n    switch (column.type) {\r\n      case 'impose':\r\n        return this.impose(label, column.column, column.categoricalColumn);\r\n      case 'min':\r\n      case 'max':\r\n      case 'median':\r\n      case 'mean':\r\n        console.assert(column.columns.length >= 2);\r\n        return this.reduce(label, <any>column.type, column.columns[0], column.columns[1], ...column.columns.slice(2));\r\n      case 'nested':\r\n        console.assert(column.columns.length >= 1);\r\n        return this.nested(label, column.columns[0], ... column.columns.slice(1));\r\n      case 'script':\r\n        console.assert(column.columns.length >= 2);\r\n        return this.scripted(label, column.code, column.columns[0], column.columns[1], ...column.columns.slice(2));\r\n      case 'weightedSum':\r\n        console.assert(column.columns.length >= 2);\r\n        console.assert(column.columns.length === column.weights.length);\r\n        const mixed: (string | number)[] = [];\r\n        column.columns.slice(2).forEach((c, i) => {\r\n          mixed.push(c);\r\n          mixed.push(column.weights[i + 2]);\r\n        });\r\n        return this.weightedSum(label, column.columns[0], column.weights[0], column.columns[1], column.weights[1], ...mixed);\r\n    }\r\n    console.error('invalid column type: ', column);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add an imposed column (numerical column colored by categorical column) to this ranking\r\n   * @param {string | null} label optional label\r\n   * @param {string} numberColumn numerical column reference\r\n   * @param {string} categoricalColumn categorical column reference\r\n   */\r\n  impose(label: string | null, numberColumn: string, categoricalColumn: string) {\r\n    this.columns.push({\r\n      desc: (data) => {\r\n        const base = data.getColumns().find((d) => d.label === numberColumn || (<any>d).column === numberColumn);\r\n        switch (base ? base.type : '') {\r\n          case 'boxplot':\r\n            return createImpositionBoxPlotDesc(label ? label : undefined);\r\n          case 'numbers':\r\n            return createImpositionsDesc(label ? label : undefined);\r\n          default:\r\n            return createImpositionDesc(label ? label : undefined);\r\n        }\r\n      },\r\n      columns: [numberColumn, categoricalColumn]\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add a nested / group composite column\r\n   * @param {string | null} label optional label\r\n   * @param {string} column first element of the group enforcing not empty ones\r\n   * @param {string} columns additional columns\r\n   */\r\n  nested(label: string | null, column: string, ...columns: string[]) {\r\n    this.columns.push({\r\n      desc: createNestedDesc(label ? label : undefined),\r\n      columns: [column].concat(columns)\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add a weighted sum / stack column\r\n   * @param {string | null} label optional label\r\n   * @param {string} numberColumn1 the first numerical column\r\n   * @param {number} weight1 its weight (0..1)\r\n   * @param {string} numberColumn2 the second numerical column\r\n   * @param {number} weight2 its weight (0..1)\r\n   * @param {string | number} numberColumnAndWeights alternating column weight references\r\n   */\r\n  weightedSum(label: string | null, numberColumn1: string, weight1: number, numberColumn2: string, weight2: number, ...numberColumnAndWeights: (string | number)[]) {\r\n    const weights = [weight1, weight2].concat(<number[]>numberColumnAndWeights.filter((_, i) => i % 2 === 1));\r\n    this.columns.push({\r\n      desc: createStackDesc(label ? label : undefined),\r\n      columns: [numberColumn1, numberColumn2].concat(<string[]>numberColumnAndWeights.filter((_, i) => i % 2 === 0)),\r\n      post: (col) => {\r\n        (<StackColumn>col).setWeights(weights);\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add reducing column (min, max, median, mean, ...)\r\n   * @param {string | null} label optional label\r\n   * @param {EAdvancedSortMethod} operation operation to apply (min, max, median, mean, ...)\r\n   * @param {string} numberColumn1 first numerical column\r\n   * @param {string} numberColumn2 second numerical column\r\n   * @param {string} numberColumns additional numerical columns\r\n   */\r\n  reduce(label: string | null, operation: EAdvancedSortMethod, numberColumn1: string, numberColumn2: string, ...numberColumns: string[]) {\r\n    this.columns.push({\r\n      desc: createReduceDesc(label ? label : undefined),\r\n      columns: [numberColumn1, numberColumn2].concat(numberColumns),\r\n      post: (col) => {\r\n        (<ReduceColumn>col).setReduce(operation);\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add a scripted / formula column\r\n   * @param {string | null} label optional label\r\n   * @param {string} code the JS code see ScriptColumn for details\r\n   * @param {string} numberColumn1 first numerical column\r\n   * @param {string} numberColumn2 second numerical column\r\n   * @param {string} numberColumns additional numerical columns\r\n   */\r\n  scripted(label: string | null, code: string, numberColumn1: string, numberColumn2: string, ...numberColumns: string[]) {\r\n    this.columns.push({\r\n      desc: createScriptDesc(label ? label : undefined),\r\n      columns: [numberColumn1, numberColumn2].concat(numberColumns),\r\n      post: (col) => {\r\n        (<ScriptColumn>col).setScript(code);\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add a selection column for easier multi selections\r\n   */\r\n  selection() {\r\n    this.columns.push({\r\n      desc: createSelectionDesc(),\r\n      columns: []\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add a group column to show the current group name\r\n   */\r\n  group() {\r\n    this.columns.push({\r\n      desc: createGroupDesc(),\r\n      columns: []\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add an aggregate column to this ranking to collapse/expand groups\r\n   */\r\n  aggregate() {\r\n    this.columns.push({\r\n      desc: createAggregateDesc(),\r\n      columns: []\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add a ranking column\r\n   */\r\n  rank() {\r\n    this.columns.push({\r\n      desc: createRankDesc(),\r\n      columns: []\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add suporttypes (aggregate, rank, selection) to the ranking\r\n   */\r\n  supportTypes() {\r\n    return this.aggregate().rank().selection();\r\n  }\r\n\r\n  /**\r\n   * add all columns to this ranking\r\n   */\r\n  allColumns() {\r\n    this.columns.push(RankingBuilder.ALL_MAGIC_FLAG);\r\n    return this;\r\n  }\r\n\r\n  build(data: ADataProvider): Ranking {\r\n    const r = data.pushRanking();\r\n    const cols = data.getColumns();\r\n\r\n    const findDesc = (c: string) => cols.find((d) => d.label === c || (<any>d).column === c);\r\n\r\n    const addColumn = (c: string) => {\r\n      const desc = findDesc(c);\r\n      if (desc) {\r\n        return data.push(r, desc) != null;\r\n      }\r\n      console.warn('invalid column: ', c);\r\n      return false;\r\n    };\r\n\r\n    this.columns.forEach((c) => {\r\n      if (c === RankingBuilder.ALL_MAGIC_FLAG) {\r\n        cols.forEach((col) => data.push(r, col));\r\n        return;\r\n      }\r\n      if (typeof c === 'string') {\r\n        addColumn(c);\r\n        return;\r\n      }\r\n      const col = data.create(typeof c.desc === 'function' ? c.desc(data) : c.desc)!;\r\n      r.push(col);\r\n      c.columns.forEach((ci) => {\r\n        const d = findDesc(ci);\r\n        const child = d ? data.create(d) : null;\r\n        if (!child) {\r\n          console.warn('invalid column: ', ci);\r\n          return;\r\n        }\r\n        (<CompositeColumn>col).push(child);\r\n      });\r\n      if (c.post) {\r\n        c.post(col);\r\n      }\r\n    });\r\n\r\n    const children = r.children;\r\n    {\r\n      const groups: Column[] = [];\r\n      this.groups.forEach((column) => {\r\n        const col = children.find((d) => d.desc.label === column || (<any>d).desc.column === column);\r\n        if (col) {\r\n          groups.push(col);\r\n          return;\r\n        }\r\n        const desc = findDesc(column);\r\n        if (desc && data.push(r, desc)) {\r\n          return;\r\n        }\r\n        console.warn('invalid group criteria column: ', column);\r\n      });\r\n      if (groups.length > 0) {\r\n        r.setGroupCriteria(groups);\r\n      }\r\n    }\r\n    {\r\n      const sorts: ISortCriteria[] = [];\r\n      this.sort.forEach(({column, asc}) => {\r\n        const col = children.find((d) => d.desc.label === column || (<any>d).desc.column === column);\r\n        if (col) {\r\n          sorts.push({col, asc});\r\n          return;\r\n        }\r\n        const desc = findDesc(column);\r\n        if (desc && data.push(r, desc)) {\r\n          return;\r\n        }\r\n        console.warn('invalid sort criteria column: ', column);\r\n      });\r\n      if (sorts.length > 0) {\r\n        r.setSortCriteria(sorts);\r\n      }\r\n    }\r\n    return r;\r\n  }\r\n}\r\n\r\n/**\r\n * creates a new instance of a ranking builder\r\n * @returns {RankingBuilder}\r\n */\r\nexport function buildRanking() {\r\n  return new RankingBuilder();\r\n}\r\n","import {IColumnDesc} from '../model';\r\nimport Column from '../model/Column';\r\nimport {deriveColors, deriveColumnDescriptions, IDataProviderOptions, ILocalDataProviderOptions} from '../provider';\r\nimport ADataProvider from '../provider/ADataProvider';\r\nimport LocalDataProvider from '../provider/LocalDataProvider';\r\nimport LineUp from '../ui/LineUp';\r\nimport Taggle from '../ui/taggle/Taggle';\r\nimport ColumnBuilder from './column/ColumnBuilder';\r\nimport LineUpBuilder from './LineUpBuilder';\r\nimport RankingBuilder from './RankingBuilder';\r\n\r\n/**\r\n * builder for a LocalDataProvider along with LineUp configuration options\r\n */\r\nexport default class DataBuilder extends LineUpBuilder {\r\n  private readonly columns: (IColumnDesc | ((data: any[]) => IColumnDesc))[] = [];\r\n  private readonly providerOptions: Partial<ILocalDataProviderOptions & IDataProviderOptions> = {\r\n    columnTypes: {}\r\n  };\r\n\r\n  private readonly rankBuilders: ((data: ADataProvider) => void)[] = [];\r\n  private _deriveColors: boolean = false;\r\n\r\n  constructor(private readonly data: object[]) {\r\n    super();\r\n  }\r\n\r\n  /**\r\n   * allow just a single selection\r\n   */\r\n  singleSelection() {\r\n    this.providerOptions.multiSelection = false;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * filter all rankings by all filters in LineUp\r\n   */\r\n  filterGlobally() {\r\n    this.providerOptions.filterGlobally = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * no limits for the number of sorting and grouping criteria\r\n   */\r\n  noCriteriaLimits() {\r\n    this.providerOptions.maxGroupColumns = Infinity;\r\n    this.providerOptions.maxNestedSortingCriteria = Infinity;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * limit the number of sort and grouping criterias i.e the nesting level\r\n   * @param {number} sortingCritera\r\n   * @param {number} groupingCriteria\r\n   * @returns {this}\r\n   */\r\n  limitCriteria(sortingCritera: number, groupingCriteria: number) {\r\n    this.providerOptions.maxGroupColumns = sortingCritera;\r\n    this.providerOptions.maxNestedSortingCriteria = groupingCriteria;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * triggers to derive the column descriptions for the given data\r\n   * @param {string} columns optional enforced order of columns\r\n   */\r\n  deriveColumns(...columns: string[]) {\r\n    this.columns.push(...deriveColumnDescriptions(this.data, {columns}));\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * tirggers to assign colors for the given descriptions\r\n   */\r\n  deriveColors() {\r\n    this._deriveColors = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * register another column type to this data provider\r\n   * @param {string} type unique type id\r\n   * @param {typeof Column} clazz column class\r\n   */\r\n  registerColumnType(type: string, clazz: typeof Column) {\r\n    this.providerOptions.columnTypes![type] = clazz;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * push another column description to this data provider\r\n   * @param {IColumnDesc | ColumnBuilder} column column description or builder instance\r\n   */\r\n  column(column: IColumnDesc | ColumnBuilder) {\r\n    this.columns.push(column instanceof ColumnBuilder ? column.build.bind(column) : column);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * restores a given ranking dump\r\n   * @param dump dump as created using '.dump()'\r\n   */\r\n  restore(dump: any) {\r\n    this.rankBuilders.push((data) => data.restore(dump));\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add the default ranking (all columns) to this data provider\r\n   * @param {boolean} addSupportTypes add support types, too, default: true\r\n   */\r\n  defaultRanking(addSupportTypes: boolean = true) {\r\n    this.rankBuilders.push((data) => data.deriveDefault(addSupportTypes));\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add another ranking to this data provider\r\n   * @param {((data: ADataProvider) => void) | RankingBuilder} builder ranking builder\r\n   */\r\n  ranking(builder: ((data: ADataProvider) => void) | RankingBuilder) {\r\n    this.rankBuilders.push(builder instanceof RankingBuilder ? builder.build.bind(builder) : builder);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * builds the data provider itself\r\n   * @returns {LocalDataProvider}\r\n   */\r\n  buildData() {\r\n    const columns = this.columns.map((d) => typeof d === 'function' ? d(this.data) : d);\r\n    if (this._deriveColors) {\r\n      deriveColors(columns);\r\n    }\r\n    const r = new LocalDataProvider(this.data, columns, this.providerOptions);\r\n    if (this.rankBuilders.length === 0) {\r\n      this.defaultRanking();\r\n    }\r\n    this.rankBuilders.forEach((builder) => builder(r));\r\n    return r;\r\n  }\r\n\r\n  /**\r\n   * builds LineUp at the given parent DOM node\r\n   * @param {HTMLElement} node parent DOM node to attach\r\n   * @returns {LineUp}\r\n   */\r\n  build(node: HTMLElement) {\r\n    return new LineUp(node, this.buildData(), this.options);\r\n  }\r\n\r\n  /**\r\n   * builds Taggle at the given parent DOM node\r\n   * @param {HTMLElement} node parent DOM node to attach\r\n   * @returns {Taggle}\r\n   */\r\n  buildTaggle(node: HTMLElement) {\r\n    return new Taggle(node, this.buildData(), this.options);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * creates a new builder instance for the given data\r\n * @param {object[]} arr data to visualize\r\n * @returns {DataBuilder}\r\n */\r\nexport function builder(arr: object[]) {\r\n  return new DataBuilder(arr);\r\n}\r\n","import {ICategoricalColumnDesc, ICategory} from '../../model';\r\nimport ColumnBuilder from './ColumnBuilder';\r\nimport {cleanCategories} from '../../provider/utils';\r\n\r\nexport default class CategoricalColumnBuilder extends ColumnBuilder<ICategoricalColumnDesc> {\r\n\r\n  constructor(column: string) {\r\n    super('categorical', column);\r\n  }\r\n\r\n  /**\r\n   * converts this type to an ordinal column type, such that categories are mapped to numbers\r\n   */\r\n  asOrdinal() {\r\n    this.desc.type = 'ordinal';\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * specify the categories of this categorical column\r\n   * @param {(string | Partial<ICategory>)[]} categories\r\n   */\r\n  categories(categories: (string | Partial<ICategory>)[]) {\r\n    this.desc.categories = categories;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * define the category to use in case of missing or null values\r\n   * @param {string | Partial<ICategory>} missingCategory\r\n   */\r\n  missingCategory(missingCategory: (string | Partial<ICategory>)) {\r\n    this.desc.missingCategory = missingCategory;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * converts this type to a set column, i.e. multiple unique category in a value\r\n   * @param {string} separator optional separator separating a string value\r\n   */\r\n  asSet(separator?: string) {\r\n    if (separator) {\r\n      (<any>this.desc).separator = separator;\r\n    }\r\n    this.desc.type = 'set';\r\n    return this;\r\n  }\r\n\r\n  private derive(data: any[]) {\r\n    // derive categories\r\n    const categories = new Set<string>();\r\n    const isSet = this.desc.type === 'set';\r\n    const separator = (<any>this.desc).separator || ';';\r\n    const val = (vi: any) => {\r\n      if (typeof vi === 'string' && vi !== '') {\r\n        return vi;\r\n      }\r\n      if (vi != null && typeof vi.value === 'string' && vi.value !== '') {\r\n        return vi.value;\r\n      }\r\n      return null;\r\n    };\r\n    data.forEach((d) => {\r\n      const v = d[(<any>this.desc).column];\r\n      if (Array.isArray(v)) {\r\n        v.forEach((vi) => categories.add(val(vi)));\r\n      } else if (v != null && v !== '') {\r\n        const vs: string[] = isSet ? [v.toString()] : v.toString().split(separator);\r\n        vs.forEach((vi) => categories.add(val(vi)));\r\n      }\r\n    });\r\n    this.categories(cleanCategories(categories));\r\n  }\r\n\r\n  build(data: any[]): ICategoricalColumnDesc {\r\n    if (!this.desc.categories) {\r\n      this.derive(data);\r\n    }\r\n    return super.build(data);\r\n  }\r\n}\r\n\r\n/**\r\n * build a categorical column type\r\n * @param {string} column column which contains the associated data\r\n * @param {(string | Partial<ICategory>)[]} categories optional category definition\r\n * @returns {CategoricalColumnBuilder}\r\n */\r\nexport function buildCategoricalColumn(column: string, categories?: (string | Partial<ICategory>)[]) {\r\n  const r = new CategoricalColumnBuilder(column);\r\n  if (categories) {\r\n    r.categories(categories);\r\n  }\r\n  return r;\r\n}\r\n","import {min, max} from 'd3-array';\r\nimport {EAdvancedSortMethod, ESortMethod, INumberColumnDesc, IMapAbleDesc} from '../../model';\r\nimport ColumnBuilder from './ColumnBuilder';\r\n\r\nexport default class NumberColumnBuilder extends ColumnBuilder<INumberColumnDesc> {\r\n\r\n  constructor(column: string) {\r\n    super('number', column);\r\n  }\r\n\r\n  /**\r\n   * defines the mapping for this number column to normalize the data\r\n   * @param {\"linear\" | \"sqrt\" | \"pow1.1\" | \"pow2\" | \"pow3\"} type mapping type\r\n   * @param {[number , number]} domain input data domain [min, max]\r\n   * @param {[number , number]} range optional output domain [0, 1]\r\n   */\r\n  mapping(type: 'linear' | 'sqrt' | 'pow1.1' | 'pow2' | 'pow3', domain: [number, number], range?: [number, number]) {\r\n    if (type === 'linear') {\r\n      this.desc.domain = domain;\r\n      if (range) {\r\n        this.desc.range = range;\r\n      }\r\n      return;\r\n    }\r\n    this.desc.map = {\r\n      type, domain, range: range || [0, 1]\r\n    };\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * sets the column color in case of numerical columns\r\n   * @deprecated use colorMapping instead\r\n   */\r\n  color(color: string) {\r\n    return this.colorMapping(color);\r\n  }\r\n\r\n  colorMapping(type: string | ((v: number)=>string) | any) {\r\n    (<IMapAbleDesc>this.desc).colorMapping = type;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * defines a script to normalize the data, see ScriptedMappingFunction for details\r\n   * @param {string} code the code to execute\r\n   * @param {[number , number]} domain the input data domain [min, max]\r\n   */\r\n  scripted(code: string, domain: [number, number]) {\r\n    this.desc.map = {domain, code, type: 'script'};\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * @inheritDoc\r\n   * @param {string[] | number} labels labels to use for each array item or the expected length of an value\r\n   * @param {EAdvancedSortMethod} sort sorting criteria when sorting by this column\r\n   */\r\n  asArray(labels?: string[] | number, sort?: EAdvancedSortMethod) {\r\n    if (sort) {\r\n      (<any>this.desc).sort = sort;\r\n    }\r\n    return super.asArray(labels);\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   * @param {EAdvancedSortMethod} sort sorting criteria when sorting by this column\r\n   */\r\n  asMap(sort?: EAdvancedSortMethod) {\r\n    if (sort) {\r\n      (<any>this.desc).sort = sort;\r\n    }\r\n    return super.asMap();\r\n  }\r\n\r\n  /**\r\n   * converts type to a boxplot column type\r\n   * @param {ESortMethod} sort sorting criteria when sorting by this column\r\n   */\r\n  asBoxPlot(sort?: ESortMethod) {\r\n    if (sort) {\r\n      (<any>this.desc).sort = sort;\r\n    }\r\n    this.desc.type = 'boxplot';\r\n    return this;\r\n  }\r\n\r\n  private derive(data: any[]) {\r\n    const col = (<any>this.desc).column;\r\n\r\n    const asArray = (v: any, extra: string) => {\r\n      const vs: number[] = [];\r\n      (Array.isArray(v) ? v : [v]).forEach((vi) => {\r\n        if (typeof vi === 'number' && !isNaN(vi)) {\r\n          vs.push(vi);\r\n        }\r\n        if (vi != null && typeof vi.value === 'number' && !isNaN(vi.value)) {\r\n          vs.push(vi.value);\r\n        }\r\n        if (vi != null && typeof vi[extra] === 'number' && !isNaN(vi[extra])) {\r\n          vs.push(vi[extra]);\r\n        }\r\n      });\r\n      return vs;\r\n    };\r\n\r\n    const minv = min(data, (d) => {\r\n      const v = d[col];\r\n      const vs: number[] = asArray(v, 'min');\r\n      return vs.length === 0 ? Infinity : min(vs);\r\n    });\r\n    const maxv = max(data, (d) => {\r\n      const v = d[col];\r\n      const vs: number[] = asArray(v, 'max');\r\n      return vs.length === 0 ? -Infinity : max(vs);\r\n    });\r\n    return <[number, number]>[minv, maxv];\r\n  }\r\n\r\n\r\n  build(data: any[]): INumberColumnDesc {\r\n    if (!this.desc.map && !this.desc.domain) {\r\n      // derive domain\r\n      this.mapping('linear', this.derive(data));\r\n    } else {\r\n      const d = this.desc.domain || this.desc.map!.domain;\r\n      if (isNaN(d[0]) || isNaN(d[1])) {\r\n        const ext = this.derive(data);\r\n        if (isNaN(d[0])) {\r\n          d[0] = ext[0];\r\n        }\r\n        if (isNaN(d[1])) {\r\n          d[1] = ext[1];\r\n        }\r\n      }\r\n    }\r\n    return super.build(data);\r\n  }\r\n}\r\n\r\n/**\r\n * builds numerical column builder\r\n * @param {string} column column which contains the associated data\r\n * @param {[number , number]} domain domain (min, max) of this column\r\n * @returns {NumberColumnBuilder}\r\n */\r\nexport function buildNumberColumn(column: string, domain?: [number, number]) {\r\n  const r = new NumberColumnBuilder(column);\r\n  if (domain) {\r\n    r.mapping('linear', domain);\r\n  }\r\n  return r;\r\n}\r\n","import {EAlignment, ILinkColumnDesc} from '../../model';\r\nimport ColumnBuilder from './ColumnBuilder';\r\n\r\nexport default class StringColumnBuilder extends ColumnBuilder<ILinkColumnDesc> {\r\n\r\n  constructor(column: string) {\r\n    super('string', column);\r\n  }\r\n\r\n  /**\r\n   * makes the text editable within a cell and switches to the annotate type\r\n   */\r\n  editable() {\r\n    this.desc.type = 'annotate';\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * changes the alignment of the column\r\n   */\r\n  alignment(align: EAlignment) {\r\n    this.desc.alignment = align;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * allow html text as values\r\n   */\r\n  html() {\r\n    this.desc.escape = false;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * provide a pattern with which the value will be wrapped, use <code>${value}</code> for the current and and <code>${item}</code> for the whole item\r\n   * @param {string} pattern pattern to apply\r\n   * @param {string[]} templates optional templates for patterns to provide in the edit pattern dialog\r\n   */\r\n  pattern(pattern: string, templates?: string[]) {\r\n    this.desc.type = 'link';\r\n    this.desc.pattern = pattern;\r\n    if (templates) {\r\n      this.desc.patternTemplates = templates;\r\n    }\r\n    return this;\r\n  }\r\n}\r\n\r\n/**\r\n * builds a string column builder\r\n * @param {string} column column which contains the associated data\r\n * @returns {StringColumnBuilder}\r\n */\r\nexport function buildStringColumn(column: string) {\r\n  return new StringColumnBuilder(column);\r\n}\r\n","import {IDateColumnDesc} from '../../model';\r\nimport ColumnBuilder from './ColumnBuilder';\r\n\r\nexport default class DateColumnBuilder extends ColumnBuilder<IDateColumnDesc> {\r\n\r\n  constructor(column: string) {\r\n    super('date', column);\r\n  }\r\n\r\n  /**\r\n   * specify the format and parsing d3-time pattern to convert Date to strings and vise versa\r\n   * @param {string} format d3-time-format pattern\r\n   * @param {string} parse optional different parsing pattern\r\n   */\r\n  format(format: string, parse?: string) {\r\n    this.desc.dateFormat = format;\r\n    if (parse) {\r\n      this.desc.dateParse = parse;\r\n    }\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * builds a date column builder\r\n * @param {string} column column which contains the associated data\r\n * @returns {DateColumnBuilder}\r\n */\r\nexport function buildDateColumn(column: string) {\r\n  return new DateColumnBuilder(column);\r\n}\r\n","import {IHierarchyColumnDesc, IPartialCategoryNode} from '../../model';\r\nimport ColumnBuilder from './ColumnBuilder';\r\n\r\nexport default class HierarchyColumnBuilder extends ColumnBuilder<IHierarchyColumnDesc> {\r\n\r\n  constructor(column: string) {\r\n    super('hierarchy', column);\r\n  }\r\n\r\n  /**\r\n   * specify the underlying hierarchy of this column\r\n   * @param {IPartialCategoryNode} hierarchy\r\n   * @param {string} hierarchySeparator specify the character to separate levels (default dot)\r\n   */\r\n  hierarchy(hierarchy: IPartialCategoryNode, hierarchySeparator?: string) {\r\n    this.desc.hierarchy = hierarchy;\r\n    if (hierarchySeparator) {\r\n      this.desc.hierarchySeparator = hierarchySeparator;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  build(data: any[]): IHierarchyColumnDesc {\r\n    console.assert(Boolean(this.desc.hierarchy));\r\n    return super.build(data);\r\n  }\r\n}\r\n\r\n/**\r\n * build a hierarchical column builder\r\n * @param {string} column column which contains the associated data\r\n * @param {IPartialCategoryNode} hierarchy\r\n * @returns {HierarchyColumnBuilder}\r\n */\r\nexport function buildHierarchicalColumn(column: string, hierarchy?: IPartialCategoryNode) {\r\n  const r = new HierarchyColumnBuilder(column);\r\n  if (hierarchy) {\r\n    r.hierarchy(hierarchy);\r\n  }\r\n  return r;\r\n}\r\n","import {IActionColumnDesc, IAction, IGroupAction} from '../../model';\r\nimport ColumnBuilder from './ColumnBuilder';\r\n\r\nexport default class ActionsColumnBuilder extends ColumnBuilder<IActionColumnDesc> {\r\n\r\n  constructor() {\r\n    super('actions', '');\r\n  }\r\n\r\n  /**\r\n   * adds another action\r\n   * @param action the action\r\n   */\r\n  action(action: IAction) {\r\n    return this.actions([action]);\r\n  }\r\n\r\n  /**\r\n   * adds multiple actions\r\n   * @param actions list of actions\r\n   */\r\n  actions(actions: IAction[]) {\r\n    if (!this.desc.actions) {\r\n      this.desc.actions = [];\r\n    }\r\n    this.desc.actions!.push(...actions);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * adds another action that is shown in group rows\r\n   * @param action the action\r\n   */\r\n  groupAction(action: IGroupAction) {\r\n    return this.groupActions([action]);\r\n  }\r\n\r\n  /**\r\n   * add multiple group actions that are shown in group rows\r\n   * @param actions list of actions\r\n   */\r\n  groupActions(actions: IGroupAction[]) {\r\n    if (!this.desc.groupActions) {\r\n      this.desc.groupActions = [];\r\n    }\r\n    this.desc.groupActions!.push(...actions);\r\n    return this;\r\n  }\r\n}\r\n\r\n/**\r\n * builds a actions column builder\r\n * @returns {ActionsColumnBuilder}\r\n */\r\nexport function buildActionsColumn() {\r\n  return new ActionsColumnBuilder();\r\n}\r\n","import {extent} from 'd3-array';\r\nimport {\r\n  EAdvancedSortMethod,\r\n  IAction,\r\n  IGroupAction,\r\n  IArrayDesc,\r\n  ICategoricalColumnDesc,\r\n  ICategory,\r\n  IColumnDesc,\r\n  IDateColumnDesc,\r\n  IHierarchyColumnDesc,\r\n  INumberColumnDesc,\r\n  IPartialCategoryNode,\r\n  IActionColumnDesc,\r\n  ILinkColumnDesc\r\n} from '../../model';\r\n\r\nexport interface IBuilderAdapterColumnDescProps extends Partial<IColumnDesc> {\r\n  column: string;\r\n  asMap?: boolean;\r\n  asArray?: string[] | number | boolean;\r\n  custom?: { [key: string]: any };\r\n}\r\n\r\nexport function build<T extends IBuilderAdapterColumnDescProps>(props: T, _data?: any[]): IColumnDesc {\r\n  const {column} = props;\r\n  const desc = <any>{column, type: props.type, label: column ? column[0].toUpperCase() + column.slice(1) : props.type};\r\n\r\n  (<(keyof IBuilderAdapterColumnDescProps)[]>['label', 'description', 'frozen', 'width', 'renderer', 'groupRenderer', 'summaryRenderer', 'visible', 'fixed']).forEach((key) => {\r\n    if (props.hasOwnProperty(key)) {\r\n      desc[key] = props[key];\r\n    }\r\n  });\r\n\r\n  if (props.custom) { // merge custom attributes\r\n    Object.assign(desc, props.custom);\r\n  }\r\n\r\n  if (props.asMap) {\r\n    console.assert(['categorical', 'date', 'number', 'string', 'link'].includes(desc.type!));\r\n    desc.type += 'Map';\r\n  }\r\n\r\n  if (props.asArray != null) {\r\n    console.assert(['boolean', 'categorical', 'date', 'number', 'string', 'link'].includes(desc.type!));\r\n    desc.type += 's';\r\n    const a = <IArrayDesc>desc;\r\n    const labels = props.asArray;\r\n    if (Array.isArray(labels)) {\r\n      a.labels = labels;\r\n      a.dataLength = labels.length;\r\n    } else if (typeof labels === 'number') {\r\n      a.dataLength = labels;\r\n    }\r\n  }\r\n\r\n  return <any>desc;\r\n}\r\n\r\n\r\nexport interface IBuilderAdapterCategoricalColumnDescProps extends IBuilderAdapterColumnDescProps {\r\n  asOrdinal?: boolean;\r\n  categories?: (string | Partial<ICategory>)[];\r\n  missingCategory?: (string | Partial<ICategory>);\r\n  asSet?: boolean | string;\r\n}\r\n\r\nexport function buildCategorical(props: IBuilderAdapterCategoricalColumnDescProps, data: any[]): ICategoricalColumnDesc {\r\n  const desc: any = build({...props, type: 'categorical'});\r\n\r\n  if (props.asOrdinal) {\r\n    desc.type = 'ordinal';\r\n  }\r\n  if (props.missingCategory) {\r\n    desc.missingCategory = props.missingCategory;\r\n  }\r\n  if (props.asSet) {\r\n    if (typeof props.asSet === 'string') {\r\n      (<any>desc).separator = props.asSet;\r\n    }\r\n    desc.type = 'set';\r\n  }\r\n\r\n\r\n  if (!props.categories) {\r\n    // derive categories\r\n    const categories = new Set(data.map((d) => <string>d[(<any>desc).column]));\r\n    desc.categories = Array.from(categories).sort();\r\n  } else {\r\n    desc.categories = props.categories;\r\n  }\r\n  return desc;\r\n}\r\n\r\nexport interface IBuilderAdapterDateColumnDescProps extends IBuilderAdapterColumnDescProps {\r\n  dateFormat?: string;\r\n  dateParse?: string;\r\n}\r\n\r\nexport function buildDate(props: IBuilderAdapterDateColumnDescProps): IDateColumnDesc {\r\n  const desc: any = build({...props, type: 'date'});\r\n\r\n  (<(keyof IBuilderAdapterDateColumnDescProps)[]>['dateFormat', 'dateParse']).forEach((key) => {\r\n    if (props.hasOwnProperty(key)) {\r\n      desc[key] = props[key];\r\n    }\r\n  });\r\n  return desc;\r\n}\r\n\r\nexport interface IBuilderAdapterHierarchyColumnDescProps extends IBuilderAdapterColumnDescProps {\r\n  hierarchy: IPartialCategoryNode;\r\n  hierarchySeparator?: string;\r\n}\r\n\r\nexport function buildHierarchy(props: Partial<IBuilderAdapterHierarchyColumnDescProps>): IHierarchyColumnDesc {\r\n  const desc: any = build({...(<any>props), type: 'hierarchy'});\r\n\r\n  (<(keyof IBuilderAdapterHierarchyColumnDescProps)[]>['hierarchy', 'hierarchySeparator']).forEach((key) => {\r\n    if (props.hasOwnProperty(key)) {\r\n      desc[key] = props[key];\r\n    }\r\n  });\r\n  return desc;\r\n}\r\n\r\nexport interface IBuilderAdapterNumberColumnDescProps extends IBuilderAdapterColumnDescProps {\r\n  domain?: [number, number];\r\n  range?: [number, number];\r\n  mapping?: 'linear' | 'sqrt' | 'pow1.1' | 'pow2' | 'pow3';\r\n  scripted?: string;\r\n  sort?: EAdvancedSortMethod;\r\n  colorMapping?: string;\r\n}\r\n\r\nexport function buildNumber(props: IBuilderAdapterNumberColumnDescProps, data: any[]): INumberColumnDesc {\r\n  const desc: any = build({...props, type: 'number'});\r\n\r\n  const domain = props.domain ? props.domain : <[number, number]>extent(data, (d) => <number>d[(<any>desc).column]);\r\n\r\n  if (props.hasOwnProperty('color')) {\r\n    desc.colorMapping = props.color;\r\n  }\r\n  (<(keyof IBuilderAdapterNumberColumnDescProps)[]>['sort', 'colorMapping']).forEach((key) => {\r\n    if (props.hasOwnProperty(key)) {\r\n      desc[key] = props[key];\r\n    }\r\n  });\r\n  if (props.scripted) {\r\n    desc.map = {domain, code: props.scripted, type: 'script'};\r\n  } else if (!props.mapping || props.mapping === 'linear') {\r\n    desc.domain = domain;\r\n    if (props.range) {\r\n      desc.range = props.range;\r\n    }\r\n  } else {\r\n    desc.map = {\r\n      type: props.mapping,\r\n      domain,\r\n      range: props.range || [0, 1]\r\n    };\r\n  }\r\n  return desc;\r\n}\r\n\r\nexport interface IBuilderAdapterStringColumnDescProps extends IBuilderAdapterColumnDescProps {\r\n  editable?: boolean;\r\n  html?: boolean;\r\n  pattern?: string;\r\n  patternTemplates?: string[];\r\n}\r\n\r\nexport function buildString(props: IBuilderAdapterStringColumnDescProps): ILinkColumnDesc {\r\n  const desc: any = build({...props, type: 'string'});\r\n\r\n  (<(keyof IBuilderAdapterStringColumnDescProps)[]>['pattern', 'patternTemplate', 'alignment']).forEach((key) => {\r\n    if (props.hasOwnProperty(key)) {\r\n      desc[key] = props[key];\r\n    }\r\n  });\r\n  if (props.editable) {\r\n    desc.type = 'annotate';\r\n  }\r\n  if (props.pattern) {\r\n    desc.type = 'link';\r\n  }\r\n  if (props.html) {\r\n    desc.escape = false;\r\n  }\r\n  return desc;\r\n}\r\n\r\nexport interface IBuilderAdapterActionsColumnDescProps extends IBuilderAdapterColumnDescProps {\r\n  actions?: IAction[];\r\n  groupActions?: IGroupAction[];\r\n}\r\n\r\nexport function buildActions(props: IBuilderAdapterActionsColumnDescProps): IActionColumnDesc {\r\n  const desc: any = build({...props, type: 'actions'});\r\n\r\n  (<(keyof IBuilderAdapterActionsColumnDescProps)[]>['actions', 'groupActions']).forEach((key) => {\r\n    if (props.hasOwnProperty(key)) {\r\n      desc[key] = props[key];\r\n    }\r\n  });\r\n  return desc;\r\n}\r\n\r\n","import {\r\n  buildRanking as buildRankingImpl,\r\n  IImposeColumnBuilder,\r\n  INestedBuilder,\r\n  IReduceBuilder,\r\n  IScriptedBuilder,\r\n  IWeightedSumBuilder\r\n} from '..';\r\nimport {Ranking} from '../../model';\r\nimport {LocalDataProvider} from '../../provider';\r\n\r\nexport interface IBuilderAdapterRankingProps {\r\n  sortBy?: (string | { column: string, asc: 'asc' | 'desc' | boolean }) | ((string | { column: string, asc: 'asc' | 'desc' | boolean })[]);\r\n  groupBy?: string[] | string;\r\n  columns?: (string | IImposeColumnBuilder | INestedBuilder | IWeightedSumBuilder | IReduceBuilder | IScriptedBuilder)[];\r\n}\r\n\r\n/*\r\n * build the column description\r\n */\r\nexport function buildRanking(props: IBuilderAdapterRankingProps, data: LocalDataProvider): Ranking {\r\n  const r = buildRankingImpl();\r\n\r\n  if (props.sortBy) {\r\n    const s = Array.isArray(props.sortBy) ? props.sortBy : [props.sortBy];\r\n    s.forEach((si) => {\r\n      if (typeof si === 'string') {\r\n        r.sortBy(si);\r\n      } else {\r\n        r.sortBy(si.column, si.asc);\r\n      }\r\n    });\r\n  }\r\n  if (props.groupBy) {\r\n    const s = Array.isArray(props.groupBy) ? props.groupBy : [props.groupBy];\r\n    r.groupBy(...s);\r\n  }\r\n  if (props.columns) {\r\n    props.columns.forEach((c) => r.column(c));\r\n  }\r\n  return r.build(data);\r\n}\r\n\r\nexport function buildGeneric(props: { column: '*' | string }) {\r\n  return props.column;\r\n}\r\n\r\nexport interface IBuilderAdapterImposeColumnProps {\r\n  label?: string;\r\n  column: string;\r\n  categoricalColumn: string;\r\n}\r\n\r\nexport function buildImposeRanking(props: IBuilderAdapterImposeColumnProps) {\r\n  return <any>Object.assign({\r\n    type: 'impose'\r\n  }, props);\r\n}\r\n\r\n\r\nexport interface IBuilderAdapterNestedColumnProps {\r\n  label?: string;\r\n}\r\n\r\nexport function buildNestedRanking(props: IBuilderAdapterNestedColumnProps, children: string[]) {\r\n  const r: INestedBuilder = {\r\n    type: 'nested',\r\n    columns: children\r\n  };\r\n  if (props.label) {\r\n    r.label = props.label;\r\n  }\r\n  return r;\r\n}\r\n\r\nexport interface IBuilderAdapterWeightedSumColumnProps {\r\n  label?: string;\r\n}\r\n\r\nexport function buildWeightedSumRanking(props: IBuilderAdapterWeightedSumColumnProps, children: { column: string, weight: number }[]) {\r\n  const r: IWeightedSumBuilder = {\r\n    type: 'weightedSum',\r\n    columns: children.map((d) => d.column),\r\n    weights: children.map((d) => d.weight)\r\n  };\r\n  if (props.label) {\r\n    r.label = props.label;\r\n  }\r\n  return r;\r\n}\r\n\r\nexport interface IBuilderAdapterReduceColumnProps {\r\n  type: 'min' | 'max' | 'mean' | 'median';\r\n  label?: string;\r\n}\r\n\r\nexport function buildReduceRanking(props: IBuilderAdapterReduceColumnProps, children: string[]) {\r\n  const r: IReduceBuilder = {\r\n    type: props.type,\r\n    columns: children\r\n  };\r\n  if (props.label) {\r\n    r.label = props.label;\r\n  }\r\n  return r;\r\n}\r\n\r\nexport interface IBuilderAdapterScriptColumnProps {\r\n  code: string;\r\n  label?: string;\r\n}\r\n\r\nexport function buildScriptRanking(props: IBuilderAdapterScriptColumnProps, children: string[]) {\r\n  const r: IScriptedBuilder = {\r\n    type: 'script',\r\n    code: props.code,\r\n    columns: children\r\n  };\r\n  if (props.label) {\r\n    r.label = props.label;\r\n  }\r\n  return r;\r\n}\r\n\r\nexport interface IBuilderAdapterSupportColumnProps {\r\n  type: 'rank' | 'selection' | 'group' | 'aggregate' | '*';\r\n}\r\n\r\nexport function buildSupportRanking(props: IBuilderAdapterSupportColumnProps) {\r\n  return `_${props.type}`;\r\n}\r\n\r\nexport function buildAllColumnsRanking() {\r\n  return '*';\r\n}\r\n","export {equal} from '../../internal/utils';\r\n\r\nexport function isTypeInstance(clazz: any, superClass: any) {\r\n  let c = clazz;\r\n  while (c && c !== superClass) {\r\n    c = c.__proto__;\r\n  }\r\n  return c === superClass;\r\n}\r\n\r\nexport function pick<T extends Object>(obj: T, keys: (keyof T)[]): Pick<T, keyof T> {\r\n  const r: Pick<T, keyof T> = <any>{};\r\n  keys.forEach((k) => {\r\n    if (obj.hasOwnProperty(k)) {\r\n      r[k] = obj[k];\r\n    }\r\n  });\r\n  return r;\r\n}\r\n\r\nexport function isSame<T>(current: T, changed: (prop: keyof T) => boolean, props: (keyof T)[]) {\r\n  if (props.every((p) => !changed(p))) {\r\n    return null;\r\n  }\r\n  return pick(current, props);\r\n}\r\n","import {Column, IColumnDesc} from '../../model';\r\nimport {Taggle, LineUp} from '../../ui';\r\nimport {ILineUpOptions, ITaggleOptions} from '../../interfaces';\r\nimport {IBuilderAdapterRankingProps, buildRanking} from './ranking';\r\nimport {pick, isSame, equal} from './utils';\r\nimport {LocalDataProvider, deriveColumnDescriptions, deriveColors} from '../../provider';\r\n\r\n\r\nexport interface IBuilderAdapterDataProps {\r\n  data: any[];\r\n  selection?: number[] | null;\r\n  highlight?: number | null;\r\n\r\n  onSelectionChanged?(selection: number[]): void;\r\n  onHighlightChanged?(highlight: number): void;\r\n\r\n  singleSelection?: boolean;\r\n  filterGlobally?: boolean;\r\n  noCriteriaLimits?: boolean;\r\n  maxGroupColumns?: number;\r\n  maxNestedSortingCriteria?: number;\r\n  columnTypes?: {[type: string]: typeof Column};\r\n\r\n  deriveColumns?: boolean | string[];\r\n  deriveColors?: boolean;\r\n\r\n  restore?: any;\r\n  defaultRanking?: boolean | 'noSupportTypes';\r\n}\r\n\r\n\r\nexport declare type IBuilderAdapterProps = Partial<ITaggleOptions> & IBuilderAdapterDataProps;\r\n\r\nconst providerOptions: (keyof IBuilderAdapterDataProps)[] = ['singleSelection', 'filterGlobally', 'noCriteriaLimits', 'maxGroupColumns', 'maxNestedSortingCriteria', 'columnTypes'];\r\nconst lineupOptions: (keyof IBuilderAdapterProps)[] = ['animated', 'sidePanel', 'sidePanelCollapsed', 'hierarchyIndicator', 'defaultSlopeGraphMode', 'summaryHeader', 'expandLineOnHover', 'overviewMode', 'renderers', 'toolbar', 'rowHeight', 'rowPadding', 'groupHeight', 'groupPadding', 'dynamicHeight', 'labelRotation', 'ignoreUnsupportedBrowser'];\r\n\r\ninterface IRankingContext {\r\n  builders: IBuilderAdapterRankingProps[];\r\n  restore: any;\r\n  derive: boolean;\r\n  supportTypes: boolean;\r\n}\r\n\r\ninterface IColumnContext {\r\n  columns: IColumnDesc[];\r\n  deriveColumns: boolean;\r\n  deriveColumnNames: string[];\r\n  deriveColors: boolean;\r\n}\r\n\r\nexport interface IChangeDetecter {\r\n  (prop: (keyof IBuilderAdapterProps)): boolean;\r\n}\r\n\r\nexport interface IBuilderAdapter {\r\n  props(): Readonly<IBuilderAdapterProps>;\r\n  createInstance(data: LocalDataProvider, options: Partial<ILineUpOptions>): LineUp | Taggle;\r\n  rankingBuilders(): IBuilderAdapterRankingProps[];\r\n  columnDescs(data: any[]): IColumnDesc[];\r\n}\r\n\r\nexport class Adapter {\r\n  private data: LocalDataProvider | null = null;\r\n  private instance: LineUp | Taggle | null = null;\r\n\r\n  private prevRankings: IRankingContext | null = null;\r\n  private prevColumns: IColumnContext | null = null;\r\n  private prevHighlight: number | null = null;\r\n\r\n  private readonly onSelectionChanged = (indices: number[]) => {\r\n    if (this.props.onSelectionChanged && !equal(this.props.selection, indices)) {\r\n      this.props.onSelectionChanged(indices);\r\n    }\r\n  }\r\n\r\n  private readonly onHighlightChanged = (highlight: number) => {\r\n    const prev = this.prevHighlight != null ? this.prevHighlight : -1;\r\n    if (prev === highlight) {\r\n      return;\r\n    }\r\n    this.prevHighlight = highlight;\r\n    if (this.props.onHighlightChanged) {\r\n      this.props.onHighlightChanged(highlight);\r\n    }\r\n  }\r\n\r\n  constructor(private readonly adapter: IBuilderAdapter) {\r\n\r\n  }\r\n\r\n  private get props() {\r\n    return this.adapter.props();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.data = this.buildProvider();\r\n    this.instance = this.adapter.createInstance(this.data, pick(this.props, lineupOptions));\r\n    this.instance.on(LineUp.EVENT_HIGHLIGHT_CHANGED, this.onHighlightChanged);\r\n  }\r\n\r\n  private resolveColumnDescs(data: any[]): IColumnContext {\r\n    const columns = this.adapter.columnDescs(data);\r\n    const deriveColumns = columns.length === 0 || Boolean(this.props.deriveColumns);\r\n    const deriveColumnNames = Array.isArray(this.props.deriveColumns) ? this.props.deriveColumns : [];\r\n    const deriveColors = Boolean(this.props.deriveColors);\r\n    return {\r\n      columns,\r\n      deriveColors,\r\n      deriveColumns,\r\n      deriveColumnNames\r\n    };\r\n  }\r\n\r\n  private resolveRankings(): IRankingContext {\r\n    const builders = this.adapter.rankingBuilders();\r\n\r\n    return {\r\n      builders,\r\n      restore: this.props.restore,\r\n      derive: (builders.length === 0 && !this.props.restore) || Boolean(this.props.defaultRanking),\r\n      supportTypes: this.props.defaultRanking !== 'noSupportTypes'\r\n    };\r\n  }\r\n\r\n  private buildColumns(data: any[], ctx: IColumnContext) {\r\n    this.prevColumns = ctx;\r\n    const columns = ctx.columns.map((d) => Object.assign({}, d)); // work on copy\r\n    if (ctx.deriveColumns) {\r\n      columns.push(...deriveColumnDescriptions(data, {columns: ctx.deriveColumnNames}));\r\n    }\r\n    if (ctx.deriveColors) {\r\n      deriveColors(columns);\r\n    }\r\n    return columns;\r\n  }\r\n\r\n  private buildRankings(data: LocalDataProvider, rankings: IRankingContext) {\r\n    data.clearRankings();\r\n    this.prevRankings = rankings;\r\n    if (rankings.derive) {\r\n      data.deriveDefault(rankings.supportTypes);\r\n    }\r\n    if (rankings.restore) {\r\n      data.restore(rankings.restore);\r\n    }\r\n    rankings.builders.forEach((b) => buildRanking(b, data!));\r\n  }\r\n\r\n  private buildProvider() {\r\n    const columns = this.buildColumns(this.props.data, this.resolveColumnDescs(this.props.data));\r\n    const data = new LocalDataProvider(this.props.data, columns, pick(this.props, providerOptions));\r\n\r\n    this.buildRankings(data, this.resolveRankings());\r\n\r\n    data.setSelection(this.props.selection || []);\r\n    data.on(LocalDataProvider.EVENT_SELECTION_CHANGED, this.onSelectionChanged);\r\n\r\n    return data;\r\n  }\r\n\r\n  private updateLineUp(changeDetector: IChangeDetecter, providerChanged: boolean) {\r\n    // check lineup instance properties\r\n    const changedLineUpOptions = isSame(this.props, changeDetector, lineupOptions);\r\n    if (!changedLineUpOptions) {\r\n      if (providerChanged) {\r\n        this.instance!.setDataProvider(this.data!);\r\n      }\r\n\r\n      if (providerChanged || (this.props.highlight != null && this.prevHighlight !== this.props.highlight)) {\r\n        this.prevHighlight = this.props.highlight == null ? -1 : this.props.highlight;\r\n        this.instance!.on(LineUp.EVENT_HIGHLIGHT_CHANGED, null);\r\n        this.instance!.setHighlight(this.prevHighlight);\r\n        this.instance!.on(LineUp.EVENT_HIGHLIGHT_CHANGED, this.onHighlightChanged);\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n    // recreate lineup\r\n    if (this.instance) {\r\n      this.instance.destroy();\r\n    }\r\n    this.instance = this.adapter.createInstance(this.data!, changedLineUpOptions);\r\n\r\n    this.prevHighlight = this.props.highlight == null ? -1 : this.props.highlight;\r\n    this.instance!.setHighlight(this.prevHighlight);\r\n    this.instance!.on(LineUp.EVENT_HIGHLIGHT_CHANGED, this.onHighlightChanged);\r\n    return true;\r\n  }\r\n\r\n  private updateProvider(changeDetector: IChangeDetecter) {\r\n    const changedProviderOptions = isSame(this.props, changeDetector, providerOptions);\r\n    if (changedProviderOptions || !this.data || changeDetector('data')) {\r\n      // big change start from scratch\r\n      this.data = this.buildProvider();\r\n      return true;\r\n    }\r\n\r\n    const rankings = this.resolveRankings();\r\n    const columns = this.resolveColumnDescs(this.props.data);\r\n    const columnsChanged = !equal(this.prevColumns, columns);\r\n    if (columnsChanged) {\r\n      const descs = this.buildColumns(this.props.data, columns);\r\n      this.data.clearColumns();\r\n      descs.forEach((d) => this.data!.pushDesc(d));\r\n    }\r\n\r\n    if (columnsChanged || !equal(rankings, this.prevRankings)) {\r\n      this.buildRankings(this.data, rankings);\r\n    }\r\n\r\n    this.data.on(LocalDataProvider.EVENT_SELECTION_CHANGED, null);\r\n    this.data.setSelection(this.props.selection || []);\r\n    this.data.on(LocalDataProvider.EVENT_SELECTION_CHANGED, this.onSelectionChanged);\r\n    return false;\r\n  }\r\n\r\n  componentDidUpdate(changeDetector: IChangeDetecter) {\r\n    const providerChanged = this.updateProvider(changeDetector);\r\n    this.updateLineUp(changeDetector, providerChanged);\r\n    // this.instance!.update();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.instance) {\r\n      this.instance.destroy();\r\n      this.instance = null;\r\n    }\r\n    this.data = null;\r\n  }\r\n}\r\n","export {\r\n  IBuilderAdapterCategoricalColumnDescProps,\r\n  IBuilderAdapterColumnDescProps,\r\n  IBuilderAdapterDateColumnDescProps,\r\n  IBuilderAdapterHierarchyColumnDescProps,\r\n  IBuilderAdapterNumberColumnDescProps,\r\n  IBuilderAdapterStringColumnDescProps,\r\n  IBuilderAdapterActionsColumnDescProps\r\n} from './column';\r\nexport {IChangeDetecter, IBuilderAdapter, IBuilderAdapterDataProps, IBuilderAdapterProps} from './lineup';\r\nexport {\r\n  IBuilderAdapterImposeColumnProps,\r\n  IBuilderAdapterNestedColumnProps,\r\n  IBuilderAdapterRankingProps,\r\n  IBuilderAdapterReduceColumnProps,\r\n  IBuilderAdapterScriptColumnProps,\r\n  IBuilderAdapterSupportColumnProps,\r\n  IBuilderAdapterWeightedSumColumnProps\r\n} from './ranking';\r\n\r\nimport {build, buildCategorical, buildDate, buildHierarchy, buildNumber, buildString, buildActions} from './column';\r\nimport {Adapter} from './lineup';\r\nimport {\r\n  buildAllColumnsRanking,\r\n  buildGeneric,\r\n  buildImposeRanking,\r\n  buildNestedRanking,\r\n  buildRanking,\r\n  buildReduceRanking,\r\n  buildScriptRanking,\r\n  buildSupportRanking,\r\n  buildWeightedSumRanking\r\n} from './ranking';\r\nimport {equal, isSame, isTypeInstance} from './utils';\r\n\r\nexport const builderAdapter = {\r\n  buildString,\r\n  buildNumber,\r\n  buildHierarchy,\r\n  buildDate,\r\n  buildCategorical,\r\n  buildActions,\r\n  build,\r\n  buildGeneric,\r\n  buildWeightedSumRanking,\r\n  buildSupportRanking,\r\n  buildScriptRanking,\r\n  buildReduceRanking,\r\n  buildRanking,\r\n  buildNestedRanking,\r\n  buildImposeRanking,\r\n  buildAllColumnsRanking,\r\n  equal,\r\n  isSame,\r\n  isTypeInstance,\r\n  Adapter\r\n};\r\n","import LineUp from '../ui/LineUp';\r\nimport Taggle from '../ui/taggle/Taggle';\r\nimport {builder} from './DataBuilder';\r\n\r\nexport * from './DataBuilder';\r\nexport * from './column';\r\nexport * from './RankingBuilder';\r\nexport * from './adapter';\r\n\r\n/**\r\n * build a new Taggle instance in the given node for the given data\r\n * @param {HTMLElement} node DOM node to attach to\r\n * @param {any[]} data data to visualize\r\n * @param {string[]} columns optional enforced column order\r\n * @returns {Taggle}\r\n */\r\nexport function asTaggle(node: HTMLElement, data: any[], ...columns: string[]): Taggle {\r\n  return builder(data)\r\n    .deriveColumns(...columns)\r\n    .deriveColors()\r\n    .defaultRanking()\r\n    .buildTaggle(node);\r\n}\r\n\r\n/**\r\n * build a new LineUp instance in the given node for the given data\r\n * @param {HTMLElement} node DOM node to attach to\r\n * @param {any[]} data data to visualize\r\n * @param {string[]} columns optional enforced column order\r\n * @returns {LineUp}\r\n */\r\nexport function asLineUp(node: HTMLElement, data: any[], ...columns: string[]): LineUp {\r\n  return builder(data)\r\n    .deriveColumns(...columns)\r\n    .deriveColors()\r\n    .defaultRanking()\r\n    .build(node);\r\n}\r\n","\"use strict\";\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BrowserInfo = /** @class */ (function () {\n    function BrowserInfo(name, version, os) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n    }\n    return BrowserInfo;\n}());\nexports.BrowserInfo = BrowserInfo;\nvar NodeInfo = /** @class */ (function () {\n    function NodeInfo(version) {\n        this.version = version;\n        this.name = 'node';\n        this.os = process.platform;\n    }\n    return NodeInfo;\n}());\nexports.NodeInfo = NodeInfo;\nvar BotInfo = /** @class */ (function () {\n    function BotInfo() {\n        this.bot = true; // NOTE: deprecated test name instead\n        this.name = 'bot';\n        this.version = null;\n        this.os = null;\n    }\n    return BotInfo;\n}());\nexports.BotInfo = BotInfo;\n// tslint:disable-next-line:max-line-length\nvar SEARCHBOX_UA_REGEX = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;\nvar SEARCHBOT_OS_REGEX = /(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\\/Teoma)|(ia_archiver)/;\nvar REQUIRED_VERSION_PARTS = 3;\nvar userAgentRules = [\n    ['aol', /AOLShield\\/([0-9\\._]+)/],\n    ['edge', /Edge\\/([0-9\\._]+)/],\n    ['yandexbrowser', /YaBrowser\\/([0-9\\._]+)/],\n    ['vivaldi', /Vivaldi\\/([0-9\\.]+)/],\n    ['kakaotalk', /KAKAOTALK\\s([0-9\\.]+)/],\n    ['samsung', /SamsungBrowser\\/([0-9\\.]+)/],\n    ['silk', /\\bSilk\\/([0-9._-]+)\\b/],\n    ['miui', /MiuiBrowser\\/([0-9\\.]+)$/],\n    ['beaker', /BeakerBrowser\\/([0-9\\.]+)/],\n    ['edge-chromium', /Edg\\/([0-9\\.]+)/],\n    [\n        'chromium-webview',\n        /(?!Chrom.*OPR)wv\\).*Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/,\n    ],\n    ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/],\n    ['phantomjs', /PhantomJS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['crios', /CriOS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/],\n    ['fxios', /FxiOS\\/([0-9\\.]+)/],\n    ['opera-mini', /Opera Mini.*Version\\/([0-9\\.]+)/],\n    ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/],\n    ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)/],\n    ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+).*\\).*Gecko$/],\n    ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/],\n    ['ie', /MSIE\\s(7\\.0)/],\n    ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/],\n    ['android', /Android\\s([0-9\\.]+)/],\n    ['ios', /Version\\/([0-9\\._]+).*Mobile.*Safari.*/],\n    ['safari', /Version\\/([0-9\\._]+).*Safari/],\n    ['facebook', /FBAV\\/([0-9\\.]+)/],\n    ['instagram', /Instagram\\s([0-9\\.]+)/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Mobile/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Gecko\\)$/],\n    ['searchbot', SEARCHBOX_UA_REGEX],\n];\nvar operatingSystemRules = [\n    ['iOS', /iP(hone|od|ad)/],\n    ['Android OS', /Android/],\n    ['BlackBerry OS', /BlackBerry|BB10/],\n    ['Windows Mobile', /IEMobile/],\n    ['Amazon OS', /Kindle/],\n    ['Windows 3.11', /Win16/],\n    ['Windows 95', /(Windows 95)|(Win95)|(Windows_95)/],\n    ['Windows 98', /(Windows 98)|(Win98)/],\n    ['Windows 2000', /(Windows NT 5.0)|(Windows 2000)/],\n    ['Windows XP', /(Windows NT 5.1)|(Windows XP)/],\n    ['Windows Server 2003', /(Windows NT 5.2)/],\n    ['Windows Vista', /(Windows NT 6.0)/],\n    ['Windows 7', /(Windows NT 6.1)/],\n    ['Windows 8', /(Windows NT 6.2)/],\n    ['Windows 8.1', /(Windows NT 6.3)/],\n    ['Windows 10', /(Windows NT 10.0)/],\n    ['Windows ME', /Windows ME/],\n    ['Open BSD', /OpenBSD/],\n    ['Sun OS', /SunOS/],\n    ['Chrome OS', /CrOS/],\n    ['Linux', /(Linux)|(X11)/],\n    ['Mac OS', /(Mac_PowerPC)|(Macintosh)/],\n    ['QNX', /QNX/],\n    ['BeOS', /BeOS/],\n    ['OS/2', /OS\\/2/],\n    ['Search Bot', SEARCHBOT_OS_REGEX],\n];\nfunction detect(userAgent) {\n    if (!!userAgent) {\n        return parseUserAgent(userAgent);\n    }\n    if (typeof navigator !== 'undefined') {\n        return parseUserAgent(navigator.userAgent);\n    }\n    return getNodeVersion();\n}\nexports.detect = detect;\nfunction parseUserAgent(ua) {\n    // opted for using reduce here rather than Array#first with a regex.test call\n    // this is primarily because using the reduce we only perform the regex\n    // execution once rather than once for the test and for the exec again below\n    // probably something that needs to be benchmarked though\n    var matchedRule = ua !== '' &&\n        userAgentRules.reduce(function (matched, _a) {\n            var browser = _a[0], regex = _a[1];\n            if (matched) {\n                return matched;\n            }\n            var uaMatch = regex.exec(ua);\n            return !!uaMatch && [browser, uaMatch];\n        }, false);\n    if (!matchedRule) {\n        return null;\n    }\n    var name = matchedRule[0], match = matchedRule[1];\n    if (name === 'searchbot') {\n        return new BotInfo();\n    }\n    var versionParts = match[1] && match[1].split(/[._]/).slice(0, 3);\n    if (versionParts) {\n        if (versionParts.length < REQUIRED_VERSION_PARTS) {\n            versionParts = __spreadArrays(versionParts, createVersionParts(REQUIRED_VERSION_PARTS - versionParts.length));\n        }\n    }\n    else {\n        versionParts = [];\n    }\n    return new BrowserInfo(name, versionParts.join('.'), detectOS(ua));\n}\nexports.parseUserAgent = parseUserAgent;\nfunction detectOS(ua) {\n    for (var ii = 0, count = operatingSystemRules.length; ii < count; ii++) {\n        var _a = operatingSystemRules[ii], os = _a[0], regex = _a[1];\n        var match = regex.test(ua);\n        if (match) {\n            return os;\n        }\n    }\n    return null;\n}\nexports.detectOS = detectOS;\nfunction getNodeVersion() {\n    var isNode = typeof process !== 'undefined' && process.version;\n    return isNode ? new NodeInfo(process.version.slice(1)) : null;\n}\nexports.getNodeVersion = getNodeVersion;\nfunction createVersionParts(count) {\n    var output = [];\n    for (var ii = 0; ii < count; ii++) {\n        output.push('0');\n    }\n    return output;\n}\n","/**\r\n * main module of LineUp.js containing the main class and exposes all other modules\r\n */\r\n\r\nimport './style.scss';\r\nimport {IColumnDesc} from './model';\r\nimport {ILocalDataProviderOptions} from './provider';\r\nimport ADataProvider from './provider/ADataProvider';\r\nimport LocalDataProvider from './provider/LocalDataProvider';\r\nimport LineUp, {ILineUpOptions} from './ui/LineUp';\r\nimport Taggle, {ITaggleOptions} from './ui/taggle';\r\n\r\nexport * from './provider';\r\nexport * from './renderer';\r\nexport * from './model';\r\nexport * from './builder';\r\nexport * from './ui';\r\nexport * from './interfaces';\r\nexport * from './config';\r\nexport {default} from './ui/LineUp';\r\nexport {IBoxPlotData, IAdvancedBoxPlotData, IStatistics, ICategoricalBin, ICategoricalStatistics, INumberBin} from './internal/math';\r\n\r\n\r\ndeclare const __VERSION__: string;\r\ndeclare const __BUILD_ID__: string;\r\ndeclare const __LICENSE__: string;\r\n/**\r\n * LineUp version\r\n * @type {string}\r\n */\r\nexport const version = __VERSION__;\r\n/**\r\n * LineUp unique build id\r\n * @type {string}\r\n */\r\nexport const buildId = __BUILD_ID__;\r\n/**\r\n * LineUp license type\r\n * @type {string}\r\n */\r\nexport const license = __LICENSE__;\r\n\r\n\r\nexport function createLocalDataProvider(data: any[], columns: IColumnDesc[], options: Partial<ILocalDataProviderOptions> = {}) {\r\n  return new LocalDataProvider(data, columns, options);\r\n}\r\n\r\n/**\r\n *\r\n * @param container the html element lineup should be built in\r\n * @param data {ADataProvider} the data providier\r\n * @param config {Partial<ILineUpOptions>} lineup configuration overrides\r\n * @returns {LineUp} the created lineup instance\r\n */\r\nexport function createLineUp(container: HTMLElement, data: ADataProvider, config: Partial<ILineUpOptions> = {}) {\r\n  return new LineUp(container, data, config);\r\n}\r\n\r\nexport function createTaggle(container: HTMLElement, data: ADataProvider, config: Partial<ITaggleOptions> = {}) {\r\n  return new Taggle(container, data, config);\r\n}\r\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof global === \"object\" ? global :\n            typeof self === \"object\" ? self :\n                typeof this === \"object\" ? this :\n                    Function(\"return this;\")();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        else {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter);\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                if (typeof target[key] !== \"function\") {\n                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                }\n                if (previous)\n                    previous(key, value);\n            };\n        }\n    })(function (exporter) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var usePolyfill = typeof process === \"object\" && process.env && process.env[\"REFLECT_METADATA_USE_MAP_POLYFILL\"] === \"true\";\n        var _Map = !usePolyfill && typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = !usePolyfill && typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = !usePolyfill && typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        // [[Metadata]] internal slot\n        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n        var Metadata = new _WeakMap();\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            if (!metadataMap.delete(metadataKey))\n                return false;\n            if (metadataMap.size > 0)\n                return true;\n            var targetMetadata = Metadata.get(target);\n            targetMetadata.delete(propertyKey);\n            if (targetMetadata.size > 0)\n                return true;\n            Metadata.delete(target);\n            return true;\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        function GetOrCreateMetadataMap(O, P, Create) {\n            var targetMetadata = Metadata.get(O);\n            if (IsUndefined(targetMetadata)) {\n                if (!Create)\n                    return undefined;\n                targetMetadata = new _Map();\n                Metadata.set(O, targetMetadata);\n            }\n            var metadataMap = targetMetadata.get(P);\n            if (IsUndefined(metadataMap)) {\n                if (!Create)\n                    return undefined;\n                metadataMap = new _Map();\n                targetMetadata.set(P, metadataMap);\n            }\n            return metadataMap;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            return ToBoolean(metadataMap.has(MetadataKey));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return undefined;\n            return metadataMap.get(MetadataKey);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n            metadataMap.set(MetadataKey, MetadataValue);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var keys = [];\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return keys;\n            var keysObj = metadataMap.keys();\n            var iterator = GetIterator(keysObj);\n            var k = 0;\n            while (true) {\n                var next = IteratorStep(iterator);\n                if (!next) {\n                    keys.length = k;\n                    return keys;\n                }\n                var nextValue = IteratorValue(next);\n                try {\n                    keys[k] = nextValue;\n                }\n                catch (e) {\n                    try {\n                        IteratorClose(iterator);\n                    }\n                    finally {\n                        throw e;\n                    }\n                }\n                k++;\n            }\n        }\n        // 6 ECMAScript Data Typ0es and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            return /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (key === this._cacheKey) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (this._cacheKey !== key) {\n                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            return /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.values(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    if (typeof crypto !== \"undefined\")\n                        return crypto.getRandomValues(new Uint8Array(size));\n                    if (typeof msCrypto !== \"undefined\")\n                        return msCrypto.getRandomValues(new Uint8Array(size));\n                    return FillRandomBytes(new Uint8Array(size), size);\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122  4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n","export default \"// removed by extract-text-webpack-plugin\""],"sourceRoot":""}